<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Viperals-svncheckins] r187 - in cms/trunk: . admin includes	includes/auth includes/forums includes/forums/admin	includes/forums/mcp includes/templates/admin/modules	includes/templates/modules/control_panel	includes/templates/modules/forums	includes/templates/modules/forums/admin install	javascript/forums modules/control_panel	modules/control_panel/modules modules/forums	modules/forums/admin modules/forums/images	modules/forums/images/admin modules/forums/images/en	modules/forums/language modules/members_list
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/viperals-svncheckins/2006-September/index.html" >
   <LINK REL="made" HREF="mailto:viperals-svncheckins%40lists.berlios.de?Subject=Re%3A%20%5BViperals-svncheckins%5D%20r187%20-%20in%20cms/trunk%3A%20.%20admin%20includes%0A%09includes/auth%20includes/forums%20includes/forums/admin%0A%09includes/forums/mcp%20includes/templates/admin/modules%0A%09includes/templates/modules/control_panel%0A%09includes/templates/modules/forums%0A%09includes/templates/modules/forums/admin%20install%0A%09javascript/forums%20modules/control_panel%0A%09modules/control_panel/modules%20modules/forums%0A%09modules/forums/admin%20modules/forums/images%0A%09modules/forums/images/admin%20modules/forums/images/en%0A%09modules/forums/language%20modules/members_list&In-Reply-To=%3C200609121455.k8CEtXw4027882%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000107.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Viperals-svncheckins] r187 - in cms/trunk: . admin includes	includes/auth includes/forums includes/forums/admin	includes/forums/mcp includes/templates/admin/modules	includes/templates/modules/control_panel	includes/templates/modules/forums	includes/templates/modules/forums/admin install	javascript/forums modules/control_panel	modules/control_panel/modules modules/forums	modules/forums/admin modules/forums/images	modules/forums/images/admin modules/forums/images/en	modules/forums/language modules/members_list</H1>
    <B>viperal at BerliOS</B> 
    <A HREF="mailto:viperals-svncheckins%40lists.berlios.de?Subject=Re%3A%20%5BViperals-svncheckins%5D%20r187%20-%20in%20cms/trunk%3A%20.%20admin%20includes%0A%09includes/auth%20includes/forums%20includes/forums/admin%0A%09includes/forums/mcp%20includes/templates/admin/modules%0A%09includes/templates/modules/control_panel%0A%09includes/templates/modules/forums%0A%09includes/templates/modules/forums/admin%20install%0A%09javascript/forums%20modules/control_panel%0A%09modules/control_panel/modules%20modules/forums%0A%09modules/forums/admin%20modules/forums/images%0A%09modules/forums/images/admin%20modules/forums/images/en%0A%09modules/forums/language%20modules/members_list&In-Reply-To=%3C200609121455.k8CEtXw4027882%40sheep.berlios.de%3E"
       TITLE="[Viperals-svncheckins] r187 - in cms/trunk: . admin includes	includes/auth includes/forums includes/forums/admin	includes/forums/mcp includes/templates/admin/modules	includes/templates/modules/control_panel	includes/templates/modules/forums	includes/templates/modules/forums/admin install	javascript/forums modules/control_panel	modules/control_panel/modules modules/forums	modules/forums/admin modules/forums/images	modules/forums/images/admin modules/forums/images/en	modules/forums/language modules/members_list">viperal at mail.berlios.de
       </A><BR>
    <I>Tue Sep 12 16:55:33 CEST 2006</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000107.html">[Viperals-svncheckins] r188 - in cms/trunk: . admin admin/functions	includes includes/auth includes/cache includes/display	includes/forums includes/forums/admin install javascript	modules/control_panel/modules modules/forums	modules/forums/admin modules/forums/language
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#106">[ date ]</a>
              <a href="thread.html#106">[ thread ]</a>
              <a href="subject.html#106">[ subject ]</a>
              <a href="author.html#106">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: viperal
Date: 2006-09-12 16:55:25 +0200 (Tue, 12 Sep 2006)
New Revision: 187

Added:
   cms/trunk/includes/forums/admin/auth.php
   cms/trunk/includes/templates/modules/forums/admin/acp_permissions.html
   cms/trunk/includes/templates/modules/forums/admin/overall_footer.html
   cms/trunk/includes/templates/modules/forums/admin/overall_header.html
   cms/trunk/includes/templates/modules/forums/admin/permission_mask.html
   cms/trunk/javascript/forums/tooltip.js
   cms/trunk/modules/forums/images/Thumbs.db
   cms/trunk/modules/forums/images/admin/Thumbs.db
   cms/trunk/modules/forums/images/en/Thumbs.db
   cms/trunk/modules/forums/language/admin.php
   cms/trunk/modules/forums/language/admin_common.php
   cms/trunk/modules/forums/language/admin_forums.php
   cms/trunk/modules/forums/language/admin_permissions.php
   cms/trunk/modules/forums/language/admin_permissions_phpbb.php
   cms/trunk/modules/forums/language/help_bbcode.php
   cms/trunk/modules/forums/language/help_faq.php
   cms/trunk/modules/forums/language/index.htm
   cms/trunk/modules/forums/language/mcp.php
   cms/trunk/modules/forums/language/posting.php
   cms/trunk/modules/forums/language/search.php
   cms/trunk/modules/forums/language/viewforum.php
   cms/trunk/modules/forums/language/viewtopic.php
Removed:
   cms/trunk/modules/forums/language/en/
Modified:
   cms/trunk/admin/blocks.php
   cms/trunk/admin/eaccelerator.php
   cms/trunk/admin/messages.php
   cms/trunk/admin/modules.php
   cms/trunk/core.php
   cms/trunk/includes/auth/auth.php
   cms/trunk/includes/forums/admin/admin_forums.php
   cms/trunk/includes/forums/admin/admin_permissions.php
   cms/trunk/includes/forums/admin/links.php
   cms/trunk/includes/forums/admin/main.php
   cms/trunk/includes/forums/auth.php
   cms/trunk/includes/forums/functions_admin.php
   cms/trunk/includes/forums/functions_posting.php
   cms/trunk/includes/forums/functions_privmsgs.php
   cms/trunk/includes/forums/functions_upload.php
   cms/trunk/includes/forums/mcp/mcp_forum.php
   cms/trunk/includes/functions.php
   cms/trunk/includes/session.php
   cms/trunk/includes/templates/admin/modules/edit.html
   cms/trunk/includes/templates/modules/control_panel/ucp_pm_viewfolder.html
   cms/trunk/includes/templates/modules/control_panel/ucp_pm_viewmessage.html
   cms/trunk/includes/templates/modules/forums/admin/acp_forums.html
   cms/trunk/includes/templates/modules/forums/admin/acp_main.html
   cms/trunk/includes/templates/modules/forums/mcp_viewlogs.html
   cms/trunk/includes/user.php
   cms/trunk/install/build_data.php
   cms/trunk/installer.php
   cms/trunk/modules/control_panel/index.php
   cms/trunk/modules/control_panel/modules/ucp_pm.php
   cms/trunk/modules/control_panel/modules/ucp_pm_compose.php
   cms/trunk/modules/control_panel/modules/ucp_pm_viewfolder.php
   cms/trunk/modules/control_panel/modules/ucp_pm_viewmessage.php
   cms/trunk/modules/forums/admin/index.php
   cms/trunk/modules/forums/download.php
   cms/trunk/modules/forums/main.php
   cms/trunk/modules/forums/mcp.php
   cms/trunk/modules/forums/posting.php
   cms/trunk/modules/forums/viewforum.php
   cms/trunk/modules/forums/viewtopic.php
   cms/trunk/modules/members_list/index.php
Log:


Modified: cms/trunk/admin/blocks.php
===================================================================
--- cms/trunk/admin/blocks.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/admin/blocks.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -175,10 +175,8 @@
 	'N_BLOCK_HTML'		=&gt; generate_link('blocks&amp;mode=add&amp;type='.BLOCKTYPE_HTML, array('admin' =&gt; true))
 ));
 
-$_CLASS['core_template']-&gt;display('admin/blocks/index.html');
+$_CLASS['core_display']-&gt;display(false, 'admin/blocks/index.html');
 	
-script_close(false);
-
 function blocks_change_position($position, $id)
 {
 	global $_CLASS;

Modified: cms/trunk/admin/eaccelerator.php
===================================================================
--- cms/trunk/admin/eaccelerator.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/admin/eaccelerator.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -4,7 +4,7 @@
 ||  Viperal CMS &#194;&#169; :												||
 ||**************************************************************||
 ||																||
-||	Copyright (C) 2004, 2005, 2006								||
+||	Copyright (C) 2004, 2005									||
 ||  By Ryan Marshall ( Viperal )								||
 ||																||
 ||  Email: <A HREF="https://lists.berlios.de/mailman/listinfo/viperals-svncheckins">viperal1 at gmail.com</A>									||

Modified: cms/trunk/admin/messages.php
===================================================================
--- cms/trunk/admin/messages.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/admin/messages.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -113,7 +113,7 @@
 
 	$_CLASS['core_template']-&gt;assign_vars_array($block_position[$row['block_position']].'_admin_messages', array(
 		'ACTIVE'		=&gt; $active,
-		'CHANGE'		=&gt; ($active) ? $_CLASS['core_user']-&gt;lang['DEACTIVATE'] : $_CLASS['core_user']-&gt;lang['ACTIVATE'],
+		'CHANGE'		=&gt; ($active) ? $_CLASS['core_user']-&gt;get_lang('DEACTIVATE') : $_CLASS['core_user']-&gt;get_lang('ACTIVATE'),
 
 		'AUTH_LINK'		=&gt; generate_link('messages&amp;mode=auth&amp;id='.$row['block_id'], array('admin' =&gt; true)),
 		'ACTIVE_LINK'	=&gt; generate_link('messages&amp;mode=change&amp;id='.$row['block_id'], array('admin' =&gt; true)),

Modified: cms/trunk/admin/modules.php
===================================================================
--- cms/trunk/admin/modules.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/admin/modules.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -34,7 +34,7 @@
 
 function check_type(&amp;$type, $redirect = true)
 {
-	$appoved_type = array(0);
+	$appoved_type = array(PAGE_MODULE);
 	$type = (int) $type;
 	
 	if (!in_array($type, $appoved_type, true))
@@ -51,7 +51,8 @@
 		
 if (isset($_REQUEST['mode']))
 {
-	if ($_REQUEST['mode'] === 'search') {
+	if ($_REQUEST['mode'] === 'search')
+	{
 		if (isset($_REQUEST['option']) &amp;&amp; isset($_REQUEST['name']) &amp;&amp; display_confirmation())
 		{
 			$name = urldecode($_REQUEST['name']);
@@ -62,12 +63,14 @@
 					{
 						break;
 					}
-					$sql = 'INSERT INTO '.CORE_PAGES_TABLE.' ' . $_CLASS['core_db']-&gt;sql_build_array('INSERT', array(
+
+					$insert_array = array(
 						'page_name'		=&gt; (string) $name,
 						'page_type'		=&gt; PAGE_MODULE,
 						'page_status'	=&gt; STATUS_PENDING,
-					));
-					$_CLASS['core_db']-&gt;query($sql);
+					);
+					$_CLASS['core_db']-&gt;sql_query_build('INSERT', $insert_array, CORE_PAGES_TABLE);
+					unset($insert_array, $name);
 				break;
 			}
 		}
@@ -113,6 +116,64 @@
 				page_change($id);
 			break;
 
+			case 'edit':
+				$result = $_CLASS['core_db']-&gt;query('SELECT * FROM '. CORE_PAGES_TABLE .&quot; WHERE page_id = $id AND page_type = &quot;. PAGE_MODULE);
+				$module = $_CLASS['core_db']-&gt;fetch_row_assoc($result);
+				$_CLASS['core_db']-&gt;free_result($result);
+
+				if (!$module)
+				{
+					trigger_error('MODULE_NOT_FOUND');
+				}
+				
+				check_type($module['page_type']);
+				settype($module['page_status'], 'int');
+
+				$page_blocks_array = array(
+					array(
+						'value' =&gt; BLOCK_RIGHT,
+						'name' =&gt; $_CLASS['core_user']-&gt;get_lang('BLOCK_RIGHT'),
+						'checked' =&gt; ($module['page_blocks'] &amp; (1 &lt;&lt; BLOCK_RIGHT))
+					),
+					array(
+						'value' =&gt; BLOCK_TOP,
+						'name' =&gt; $_CLASS['core_user']-&gt;get_lang('BLOCK_TOP'),
+						'checked' =&gt; ($module['page_blocks'] &amp; (1 &lt;&lt; BLOCK_TOP))
+					),
+					array(
+						'value' =&gt; BLOCK_BOTTOM,
+						'name' =&gt; $_CLASS['core_user']-&gt;get_lang('BLOCK_BOTTOM'),
+						'checked' =&gt; ($module['page_blocks'] &amp; (1 &lt;&lt; BLOCK_BOTTOM))
+					),
+					array(
+						'value' =&gt; BLOCK_LEFT,
+						'name' =&gt; $_CLASS['core_user']-&gt;get_lang('BLOCK_LEFT'),
+						'checked' =&gt; ($module['page_blocks'] &amp; (1 &lt;&lt; BLOCK_LEFT))
+					),
+					array(
+						'value' =&gt; BLOCK_MESSAGE_TOP,
+						'name' =&gt; $_CLASS['core_user']-&gt;get_lang('BLOCK_MESSAGE_TOP'),
+						'checked' =&gt; ($module['page_blocks'] &amp; (1 &lt;&lt; BLOCK_MESSAGE_TOP))
+					),
+					array(
+						'value' =&gt; BLOCK_MESSAGE_BOTTOM,
+						'name' =&gt; $_CLASS['core_user']-&gt;get_lang('BLOCK_MESSAGE_BOTTOM'),
+						'checked' =&gt; ($module['page_blocks'] &amp; (1 &lt;&lt; BLOCK_MESSAGE_BOTTOM))
+					)
+				);
+				
+				$_CLASS['core_template']-&gt;assign_array(array(
+					'ADMIN_PAGE_ACTION'			=&gt; generate_link('modules&amp;mode=edit', array('admin' =&gt; true)),
+					'ADMIN_PAGE_TITLE'			=&gt; $module['page_title'],
+					'ADMIN_PAGE_NAME'			=&gt; mb_convert_case(preg_replace('/_/', ' ', $module['page_name']), MB_CASE_TITLE),
+					'ADMIN_PAGE_BLOCKS_ARRAY'	=&gt; $page_blocks_array,
+					'ADMIN_PAGE_STATUS'			=&gt; $module['page_status'],
+					'ADMIN_PAGE_ERROR'			=&gt; '',
+				));
+			
+				$_CLASS['core_display']-&gt;display(false, 'admin/modules/edit.html');
+			break;
+
 			case 'install':
 				$result = $_CLASS['core_db']-&gt;query('SELECT page_status, page_name, page_type FROM '.CORE_PAGES_TABLE.&quot; WHERE page_id = $id AND page_type = &quot;. PAGE_MODULE);
 				$module = $_CLASS['core_db']-&gt;fetch_row_assoc($result);
@@ -123,6 +184,8 @@
 					trigger_error($module ? 'MODULE_ALREADY_INSTALLED' : 'MODULE_NOT_FOUND');
 				}
 
+				check_type($module['page_type']);
+
 				if (display_confirmation())
 				{
 					$status = true;
@@ -259,7 +322,7 @@
 
 	$_CLASS['core_template']-&gt;assign_vars_array('normal_modules', array(
 			'ACTIVE'		=&gt; ($active),
-			'CHANGE'		=&gt; ($active) ? $_CLASS['core_user']-&gt;lang['DEACTIVATE'] : $_CLASS['core_user']-&gt;lang['ACTIVATE'],
+			'CHANGE'		=&gt; ($active) ? $_CLASS['core_user']-&gt;get_lang('DEACTIVATE') : $_CLASS['core_user']-&gt;get_lang('ACTIVATE'),
 			'ERROR'			=&gt; '',
 			'INSTALLED'		=&gt; $installed,
 			'TITLE'			=&gt; ($module['page_title']) ? $module['page_title'] : mb_convert_case(preg_replace('/_/', ' ', $module['page_name']), MB_CASE_TITLE),

Modified: cms/trunk/core.php
===================================================================
--- cms/trunk/core.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/core.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -159,7 +159,10 @@
 	
 	while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
 	{
-		settype($row['config_value'], $row['config_type']);
+		if ($row['config_type'])
+		{
+			settype($row['config_value'], $row['config_type']);
+		}
 
 		if ($row['config_cache'])
 		{
@@ -190,7 +193,10 @@
 
 	while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
 	{
-		settype($row['config_value'], $row['config_type']);
+		if ($row['config_type'])
+		{
+			settype($row['config_value'], $row['config_type']);
+		}
 
 		$_CORE_CONFIG[$row['config_section']][$row['config_name']] = $row['config_value'];
 	}

Modified: cms/trunk/includes/auth/auth.php
===================================================================
--- cms/trunk/includes/auth/auth.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/auth/auth.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -130,7 +130,7 @@
 		return $this-&gt;_admin_permission[$section]['core']['status'];
 	}
 
-	function do_login($login_options, $template)
+	function auth_login($login_options = array(), $template = false)
 	{
 		global $_CLASS, $_CORE_CONFIG;
 

Modified: cms/trunk/includes/forums/admin/admin_forums.php
===================================================================
--- cms/trunk/includes/forums/admin/admin_forums.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/forums/admin/admin_forums.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -15,6 +15,11 @@
 	die; 
 }
 
+if (!$_CLASS['forums_auth']-&gt;acl_get('a_forum'))
+{
+	trigger_error('NO_ADMIN');
+}
+
 // Get general vars
 $update		= isset($_POST['update']);
 $mode		= request_var('mode', '');
@@ -25,10 +30,7 @@
 $l_title	= '';
 $forum_data = $errors = array();
 
-if (!$_CLASS['forums_auth']-&gt;acl_get('a_forum'))
-{
-	trigger_error('NO_ADMIN');
-}
+$_CLASS['core_user']-&gt;add_lang('admin_forums', 'forums');
 
 switch ($action)
 {
@@ -850,7 +852,7 @@
 				return array($_CLASS['core_user']-&gt;lang['NO_FORUM_ACTION']);
 			}
 
-			$forum_data_sql['forum_posts'] = $forum_data_sql['forum_topics'] = $forum_data_sql['forum_topics_real'] = 0;
+			$forum_data_sql['forum_posts'] = $forum_data_sql['forum_topics'] = $forum_data_sql['forum_topics_real'] = $forum_data_sql['forum_last_post_id'] = $forum_data_sql['forum_last_poster_id'] = $forum_data_sql['forum_last_post_time'] = 0;
 		}
 
 		if (sizeof($errors))
@@ -983,8 +985,8 @@
 {
 	global $_CLASS;
 
-	$table_ary = array(ACL_GROUPS_TABLE, ACL_USERS_TABLE, LOG_TABLE, POSTS_TABLE, TOPICS_TABLE, DRAFTS_TABLE, TOPICS_TRACK_TABLE);
-
+	$table_ary = array(FORUMS_LOG_TABLE, FORUMS_POSTS_TABLE, FORUMS_TOPICS_TABLE, FORUMS_DRAFTS_TABLE, FORUMS_TRACK_TABLE);
+	
 	foreach ($table_ary as $table)
 	{
 		$sql = &quot;UPDATE $table
@@ -994,7 +996,7 @@
 	}
 	unset($table_ary);
 
-	$table_ary = array(FORUMS_ACCESS_TABLE, FORUMS_TRACK_TABLE, FORUMS_WATCH_TABLE, MODERATOR_CACHE_TABLE);
+	$table_ary = array(FORUMS_ACCESS_TABLE, FORUMS_WATCH_TABLE, FORUMS_MODERATOR_CACHE_TABLE);
 
 	foreach ($table_ary as $table)
 	{
@@ -1065,7 +1067,7 @@
 		return $errors;
 	}
 
-	if ($action_subforums == 'delete')
+	if ($action_subforums === 'delete')
 	{
 		$log_action_forums = 'FORUMS';
 		$rows = get_forum_branch($forum_id, 'children', 'descending', false);
@@ -1085,9 +1087,13 @@
 
 		$sql = 'DELETE FROM ' . FORUMS_FORUMS_TABLE . '
 			WHERE forum_id IN (' . implode(', ', $forum_ids) . ')';
+		$_CLASS['core_db']-&gt;query($sql);
+		
+		$sql = 'DELETE FROM ' . FORUMS_ACL_TABLE . '
+			WHERE  forum_id IN (' . implode(', ', $forum_ids) . ')';
 		$_CLASS['core_db']-&gt;query($sql);
 	}
-	else if ($action_subforums == 'move')
+	else if ($action_subforums === 'move')
 	{
 		if (!$subforums_to_id)
 		{
@@ -1131,6 +1137,10 @@
 				$diff = 2;
 				$sql = 'DELETE FROM ' . FORUMS_FORUMS_TABLE . &quot;
 					WHERE forum_id = $forum_id&quot;;
+				$_CLASS['core_db']-&gt;query($sql);
+				
+				$sql = 'DELETE FROM ' . FORUMS_ACL_TABLE . '
+					WHERE forum_id = '.$forum_id;
 				$_CLASS['core_db']-&gt;query($sql);
 			}
 		}
@@ -1145,6 +1155,10 @@
 		$diff = 2;
 		$sql = 'DELETE FROM ' . FORUMS_FORUMS_TABLE . &quot;
 			WHERE forum_id = $forum_id&quot;;
+		$_CLASS['core_db']-&gt;query($sql);
+
+		$sql = 'DELETE FROM ' . FORUMS_ACL_TABLE . '
+			WHERE forum_id = '.$forum_id;
 		$_CLASS['core_db']-&gt;query($sql);
 	}
 
@@ -1254,7 +1268,21 @@
 	$_CLASS['core_db']-&gt;free_result($result);
 
 	delete_attachments('topic', $topic_ids, false);
+
+	// Before we remove anything we make sure we are able to adjust the post counts later. ;)
+	$sql = 'SELECT poster_id
+		FROM ' . FORUMS_POSTS_TABLE . '
+		WHERE forum_id = ' . $forum_id . '
+			AND post_postcount = 1';
+	$result = $_CLASS['core_db']-&gt;query($sql);
 
+	$post_counts = array();
+	while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+	{
+		$post_counts[$row['poster_id']] = (!empty($post_counts[$row['poster_id']])) ? $post_counts[$row['poster_id']] + 1 : 1;
+	}
+	$_CLASS['core_db']-&gt;free_result($result);
+
 	switch ($_CLASS['core_db']-&gt;db_layer)
 	{
 		case 'mysql4':
@@ -1330,24 +1358,36 @@
 
 						foreach ($tables as $table)
 						{
-							$_CLASS['core_db']-&gt;query(&quot;DELETE FROM $table WHERE $field IN (&quot; . implode(', ', $id_list) . ')');
+							$_CLASS['core_db']-&gt;query(&quot;DELETE FROM $table WHERE $field IN (&quot; . implode(', ', $ids) . ')');
 						}
 					}
 				}
 				while ($row);
 			}
-			unset($ids, $id_list);
+			unset($ids);
 
 		break;
 	}
 
-	$table_ary = array(FORUMS_ACL_TABLE, FORUMS_TRACK_TABLE, FORUMS_WATCH_TABLE, FORUMS_LOG_TABLE, FORUMS_MODERATOR_CACHE_TABLE, FORUMS_POSTS_TABLE, FORUMS_TOPICS_TABLE);//, TOPICS_TRACK_TABLE
-
+	$table_ary = array(FORUMS_TRACK_TABLE, FORUMS_WATCH_TABLE, FORUMS_LOG_TABLE, FORUMS_MODERATOR_CACHE_TABLE, FORUMS_POSTS_TABLE, FORUMS_TOPICS_TABLE);//, TOPICS_TRACK_TABLE
+
 	foreach ($table_ary as $table)
 	{
 		$_CLASS['core_db']-&gt;query(&quot;DELETE FROM $table WHERE forum_id = $forum_id&quot;);
-	}
+	}
 
+	// Adjust users post counts
+	if (sizeof($post_counts))
+	{
+		foreach ($post_counts as $poster_id =&gt; $substract)
+		{
+			$sql = 'UPDATE ' . CORE_USERS_TABLE . '
+				SET user_posts = user_posts - ' . $substract . '
+				WHERE user_id = ' . $poster_id;
+			$_CLASS['core_db']-&gt;query($sql);
+		}
+	}
+
 	// Set forum ids to 0
 	$table_ary = array(FORUMS_DRAFTS_TABLE);
 

Modified: cms/trunk/includes/forums/admin/admin_permissions.php
===================================================================
--- cms/trunk/includes/forums/admin/admin_permissions.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/forums/admin/admin_permissions.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -15,1289 +15,1134 @@
 	die; 
 }
 
-// values need checks
+$u_action = '';
+$permission_dropdown = '';
+$mode = request_var('mode', 'view_forum_local');
+
+load_class(SITE_FILE_ROOT.'includes/forums/admin/auth.php', 'forums_auth_admin');
+
+$_CLASS['core_user']-&gt;add_lang('admin_permissions', 'forums');
+$_CLASS['core_user']-&gt;add_lang('admin_permissions_phpbb', 'forums');
+
+
+// Trace has other vars
+if ($mode === 'trace')
+{
+	$user_id = request_var('u', 0);
+	$forum_id = request_var('f', 0);
+	$permission = request_var('auth', '');
+
+	if ($user_id &amp;&amp; isset($_CLASS['forums_auth_admin']-&gt;option_ids[$permission]) &amp;&amp; $_CLASS['forums_auth']-&gt;acl_get('a_viewauth'))
+	{
+		$page_title = sprintf($_CLASS['core_user']-&gt;lang['TRACE_PERMISSION'], $_CLASS['core_user']-&gt;lang['acl_' . $permission]['lang']);
+		permission_trace($user_id, $forum_id, $permission);
 
-
-// Grab and set some basic parameters
-//
-// 'mode' determines what we're altering; administrators, users, deps, etc.
-// 'submit' is used to determine what we're doing ... special format
-$mode		= (isset($_REQUEST['mode'])) ? htmlspecialchars($_REQUEST['mode']) : '';
-
-// What mode are we running? So we can output the correct title, explanation
-// and set the sql_option_mode/acl check
-switch ($mode)
-{
-	case 'forum':
-		$l_title = $_CLASS['core_user']-&gt;lang['PERMISSIONS'];
-		$l_title_explain = $_CLASS['core_user']-&gt;lang['PERMISSIONS_EXPLAIN'];
-		$which_acl = 'a_auth';
-		$sql_option_mode = 'f';
-		break;
-
-	case 'mod':
-		$l_title = $_CLASS['core_user']-&gt;lang['MODERATORS'];
-		$l_title_explain = $_CLASS['core_user']-&gt;lang['MODERATORS_EXPLAIN'];
-		$which_acl = 'a_authmods';
-		$sql_option_mode = 'm';
-		break;
-
-	case 'supermod':
-		$l_title = $_CLASS['core_user']-&gt;lang['SUPER_MODERATORS'];
-		$l_title_explain = $_CLASS['core_user']-&gt;lang['SUPER_MODERATORS_EXPLAIN'];
-		$which_acl = 'a_authmods';
-		$sql_option_mode = 'm';
-		break;
-
-	case 'admin':
-		$l_title = $_CLASS['core_user']-&gt;lang['ADMINISTRATORS'];
-		$l_title_explain = $_CLASS['core_user']-&gt;lang['ADMINISTRATORS_EXPLAIN'];
-		$which_acl = 'a_authadmins';
-		$sql_option_mode = 'a';
-		break;
-
-	case 'user':
-		$l_title = $_CLASS['core_user']-&gt;lang['USER_PERMISSIONS'];
-		$l_title_explain = $_CLASS['core_user']-&gt;lang['USER_PERMISSIONS_EXPLAIN'];
-		$which_acl = 'a_authusers';
-		$sql_option_mode = 'u';
-		break;
-
-	case 'group':
-		$l_title = $_CLASS['core_user']-&gt;lang['GROUP_PERMISSIONS'];
-		$l_title_explain = $_CLASS['core_user']-&gt;lang['GROUP_PERMISSIONS_EXPLAIN'];
-		$which_acl = 'a_authgroups';
-		$sql_option_mode = 'u';
-		break;
-
-	case 'deps':
-		$l_title = $_CLASS['core_user']-&gt;lang['DEPENDENCIES'];
-		$l_title_explain = $_CLASS['core_user']-&gt;lang['DEPENDENCIES_EXPLAIN'];
-		$which_acl = 'a_authdeps';
-		break;
+		$_CLASS['core_display']-&gt;display($page_title, 'modules/forums/admin/permission_trace.html');
+	}
+
+	trigger_error('NO_MODE');
 }
+
+// Set some vars
+$action = get_variable('action', 'REQUEST', false, 'array');
 
-// Permission check
-if (!$_CLASS['auth']-&gt;acl_get($which_acl))
+if ($action)
 {
-	trigger_error($_CLASS['core_user']-&gt;lang['NO_ADMIN']);
+	$action = key($action);
 }
+
+$action = isset($_POST['psubmit']) ? 'apply_permissions' : $action;
+
+$all_forums = request_var('all_forums', 0);
+$subforum_id = request_var('subforum_id', 0);
+$forum_id = request_var('forum_id', array(0));
+
+$username = request_var('username', array(''));
+$usernames = request_var('usernames', '');
+$user_id = request_var('user_id', array(0));
+
+$group_id = request_var('group_id', array(0));
+$select_all_groups = request_var('select_all_groups', 0);
+
+// If select all groups is set, we pre-build the group id array (this option is used for other screens to link to the permission settings screen)
+if ($select_all_groups)
+{
+	// Add default groups to selection
+	$sql_and = (!$config['coppa_enable']) ? &quot; AND group_name NOT IN ('INACTIVE_COPPA', 'REGISTERED_COPPA')&quot; : '';
+
+	$sql = 'SELECT group_id
+		FROM ' . CORE_GROUPS_TABLE . '
+		WHERE group_type = ' . GROUP_SPECIAL . &quot;
+		$sql_and&quot;;
+	$result = $_CLASS['core_db']-&gt;query($sql);
+
+	while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+	{
+		$group_id[] = $row['group_id'];
+	}
+	$_CLASS['core_db']-&gt;free_result($result);
+}
+
+// Map usernames to ids and vice versa
+if ($usernames)
+{
+	$username = explode(&quot;\n&quot;, $usernames);
+}
+unset($usernames);
+
+if (sizeof($username) &amp;&amp; !sizeof($user_id))
+{
+	user_get_id_name($user_id, $username);
+
+	if (!sizeof($user_id))
+	{
+		trigger_error($_CLASS['core_user']-&gt;lang['SELECTED_USER_NOT_EXIST'] . adm_back_link($u_action));
+	}
+}
+unset($username);
+
+// Build forum ids (of all forums are checked or subforum listing used)
+if ($all_forums)
+{
+	$sql = 'SELECT forum_id
+		FROM ' . FORUMS_FORUMS_FORUMS_TABLE . '
+		ORDER BY left_id';
+	$result = $_CLASS['core_db']-&gt;query($sql);
+
+	$forum_id = array();
+	while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+	{
+		$forum_id[] = $row['forum_id'];
+	}
+	$_CLASS['core_db']-&gt;free_result($result);
+}
+else if ($subforum_id)
+{
+	$forum_id = array();
+	foreach (get_forum_branch($subforum_id, 'children') as $row)
+	{
+		$forum_id[] = $row['forum_id'];
+	}
+}
+
+// Define some common variables for every mode
+$error = array();
+
+$permission_scope = (strpos($mode, '_global') !== false) ? 'global' : 'local';
 
-$submode	= (isset($_REQUEST['submode'])) ? htmlspecialchars($_REQUEST['submode']) : '';
-$which_mode = (!empty($submode) &amp;&amp; $submode != $mode) ? $submode : $mode;
-$submit		= array_values(preg_grep('#^submit_(.*)$#i', array_keys($_REQUEST)));
-$submit		= (count($submit)) ? substr($submit[0], strpos($submit[0], '_') + 1) : '';
+$_CLASS['core_template']-&gt;assign_array(array(
+	'S_SELECT_USERGROUP'		=&gt; false,
+	'S_SELECT_USERGROUP_VIEW'	=&gt; false,
+	'S_SETTING_PERMISSIONS'		=&gt; false,
+	'S_VIEWING_PERMISSIONS'		=&gt; false,
+	'S_SELECT_FORUM'			=&gt; false,
+	'S_SELECT_GROUP'			=&gt; false,
+	'S_SELECT_USER'				=&gt; false,
+));
+			
+// Showing introductionary page?
+if ($mode === 'intro')
+{
+	$page_title = 'ACP_PERMISSIONS';
+
+	$_CLASS['core_template']-&gt;assign('S_INTRO', true);
 
-// Submitted setting data
-//
-// 'auth_settings' contains the submitted option settings assigned to options, should be an 
-//   associative array with integer values
-$auth_settings = (isset($_POST['settings'])) ? $_POST['settings'] : '';
-
-
-// Forum, User or Group information
-//
-// 'ug_type' is either user or groups used mainly for forum/admin/mod permissions
-// 'ug_data' contains the list of usernames, user_id's or group_ids for the 'ug_type'
-// 'forum_id' contains the list of forums, 0 is used for &quot;All forums&quot;, can be array or scalar
-$ug_type = (isset($_REQUEST['ug_type'])) ? htmlspecialchars($_REQUEST['ug_type']) : '';
-$ug_data = (isset($_POST['ug_data'])) ? $_POST['ug_data'] : '';
-
-if (isset($_REQUEST['f']))
-{
-	$forum_id = (is_array($_REQUEST['f'])) ? $_REQUEST['f'] : intval($_REQUEST['f']);
+	$_CLASS['core_display']-&gt;display($page_title, 'modules/forums/admin/acp_permissions.html');
+
+	return;
 }
-
-if (!isset($forum_id[$which_mode]))
+else
 {
-	$forum_id[$which_mode][] = 0;
-}
-
-$sql_forum_id = implode(', ', array_map('intval', $forum_id[$which_mode]));
-
-// Generate list of forum id's
-$s_forum_id = '';
-
-foreach ($forum_id as $forum_submode =&gt; $forum_submode_ids)
-{
-	foreach ($forum_submode_ids as $submode_forum_id)
-	{
-		$s_forum_id .= '&lt;input type=&quot;hidden&quot; name=&quot;f[' . $forum_submode . '][]&quot; value=&quot;' . $submode_forum_id . '&quot; /&gt;';
+	$_CLASS['core_template']-&gt;assign('S_INTRO', false);
+}
+
+switch ($mode)
+{
+	case 'setting_user_global':
+	case 'setting_group_global':
+		$permission_dropdown = array('u_', 'm_', 'a_');
+		$permission_victim = ($mode === 'setting_user_global') ? array('user') : array('group');
+		$page_title = ($mode === 'setting_user_global') ? 'ACP_USERS_PERMISSIONS' : 'ACP_GROUPS_PERMISSIONS';
+	break;
+
+	case 'setting_user_local':
+	case 'setting_group_local':
+		$permission_dropdown = array('f_', 'm_');
+		$permission_victim = ($mode === 'setting_user_local') ? array('user', 'forums') : array('group', 'forums');
+		$page_title = ($mode === 'setting_user_local') ? 'ACP_USERS_FORUM_PERMISSIONS' : 'ACP_GROUPS_FORUM_PERMISSIONS';
+	break;
+
+	case 'setting_admin_global':
+	case 'setting_mod_global':
+		$permission_dropdown = (strpos($mode, '_admin_') !== false) ? array('a_') : array('m_');
+		$permission_victim = array('usergroup');
+		$page_title = ($mode === 'setting_admin_global') ? 'ACP_ADMINISTRATORS' : 'ACP_GLOBAL_MODERATORS';
+	break;
+
+	case 'setting_mod_local':
+	case 'setting_forum_local':
+		$permission_dropdown = ($mode === 'setting_mod_local') ? array('m_') : array('f_');
+		$permission_victim = array('forums', 'usergroup');
+		$page_title = ($mode === 'setting_mod_local') ? 'ACP_FORUM_MODERATORS' : 'ACP_FORUM_PERMISSIONS';
+	break;
+
+	case 'view_admin_global':
+	case 'view_user_global':
+	case 'view_mod_global':
+		$permission_dropdown = ($mode === 'view_admin_global') ? array('a_') : (($mode === 'view_user_global') ? array('u_') : array('m_'));
+		$permission_victim = array('usergroup_view');
+		$page_title = ($mode === 'view_admin_global') ? 'ACP_VIEW_ADMIN_PERMISSIONS' : (($mode === 'view_user_global') ? 'ACP_VIEW_USER_PERMISSIONS' : 'ACP_VIEW_GLOBAL_MOD_PERMISSIONS');
+	break;
+
+	case 'view_mod_local':
+	case 'view_forum_local':
+		$permission_dropdown = ($mode === 'view_mod_local') ? array('m_') : array('f_');
+		$permission_victim = array('forums', 'usergroup_view');
+		$page_title = ($mode === 'view_mod_local') ? 'ACP_VIEW_FORUM_MOD_PERMISSIONS' : 'ACP_VIEW_FORUM_PERMISSIONS';
+	break;
+
+	default:
+		trigger_error('INVALID_MODE');
+	break;
+}
+
+$_CLASS['core_template']-&gt;assign_array(array(
+	'L_TITLE'		=&gt; $_CLASS['core_user']-&gt;get_lang($page_title),
+	'L_EXPLAIN'		=&gt; $_CLASS['core_user']-&gt;get_lang($page_title . '_EXPLAIN')
+));
+
+// Get permission type
+$permission_type = request_var('type', $permission_dropdown[0]);
+
+if (!in_array($permission_type, $permission_dropdown))
+{
+	trigger_error($_CLASS['core_user']-&gt;lang['WRONG_PERMISSION_TYPE'] . adm_back_link($u_action));
+}
+
+
+// Handle actions
+if (strpos($mode, 'setting_') === 0 &amp;&amp; $action)
+{
+	switch ($action)
+	{
+		case 'delete':
+			// All users/groups selected?
+			$all_users = (isset($_POST['all_users'])) ? true : false;
+			$all_groups = (isset($_POST['all_groups'])) ? true : false;
+
+			if ($all_users || $all_groups)
+			{
+				$items = retrieve_defined_user_groups($permission_scope, $forum_id, $permission_type);
+
+				if ($all_users &amp;&amp; sizeof($items['user_ids']))
+				{
+					$user_id = $items['user_ids'];
+				}
+				else if ($all_groups &amp;&amp; sizeof($items['group_ids']))
+				{
+					$group_id = $items['group_ids'];
+				}
+			}
+
+			if (sizeof($user_id) || sizeof($group_id))
+			{
+				remove_permissions($mode, $permission_type, $_CLASS['forums_auth_admin'], $user_id, $group_id, $forum_id);
+			}
+			else
+			{
+				trigger_error($_CLASS['core_user']-&gt;lang['NO_USER_GROUP_SELECTED'] . adm_back_link($u_action));
+			}
+		break;
+
+		case 'apply_permissions':
+			if (!isset($_POST['setting']))
+			{
+				trigger_error($_CLASS['core_user']-&gt;lang['NO_AUTH_SETTING_FOUND'] . adm_back_link($u_action));
+			}
+
+			set_permissions($mode, $permission_type, $_CLASS['forums_auth_admin'], $user_id, $group_id);
+		break;
+
+		case 'apply_all_permissions':
+			if (!isset($_POST['setting']))
+			{
+				trigger_error($_CLASS['core_user']-&gt;lang['NO_AUTH_SETTING_FOUND'] . adm_back_link($u_action));
+			}
+
+			set_all_permissions($mode, $permission_type, $_CLASS['forums_auth_admin'], $user_id, $group_id);
+		break;
+	}
+}
+
+
+// Setting permissions screen
+$s_hidden_fields = generate_hidden_fields(array(
+	'user_id'		=&gt; $user_id,
+	'group_id'		=&gt; $group_id,
+	'forum_id'		=&gt; $forum_id,
+	'type'			=&gt; $permission_type
+));
+
+// Go through the screens/options needed and present them in correct order
+foreach ($permission_victim as $victim)
+{
+	switch ($victim)
+	{
+		case 'forum_dropdown':
+
+			if (sizeof($forum_id))
+			{
+				check_existence('forum', $forum_id);
+				continue 2;
+			}
+
+			$_CLASS['core_template']-&gt;assign_array(array(
+				'S_SELECT_FORUM'		=&gt; true,
+				'S_FORUM_OPTIONS'		=&gt; make_forum_select(false, false, true, false, false))
+			);
+
+		break;
+
+		case 'forums':
+
+			if (sizeof($forum_id))
+			{
+				check_existence('forum', $forum_id);
+				continue 2;
+			}
+
+			$forum_list = make_forum_select(false, false, true, false, false, false, true);
+
+			// Build forum options
+			$s_forum_options = '';
+			foreach ($forum_list as $f_id =&gt; $f_row)
+			{
+				$s_forum_options .= '&lt;option value=&quot;' . $f_id . '&quot;' . $f_row['selected'] . '&gt;' . $f_row['padding'] . $f_row['forum_name'] . '&lt;/option&gt;';
+			}
+
+			// Build subforum options
+			$s_subforum_options = build_subforum_options($forum_list);
+
+			$_CLASS['core_template']-&gt;assign_array(array(
+				'S_SELECT_FORUM'		=&gt; true,
+				'S_FORUM_OPTIONS'		=&gt; $s_forum_options,
+				'S_SUBFORUM_OPTIONS'	=&gt; $s_subforum_options,
+				'S_FORUM_ALL'			=&gt; true,
+				'S_FORUM_MULTIPLE'		=&gt; true
+			));
+
+		break;
+
+		case 'user':
+
+			if (sizeof($user_id))
+			{
+				check_existence('user', $user_id);
+				continue 2;
+			}
+
+			$_CLASS['core_template']-&gt;assign_array(array(
+				'S_SELECT_USER'			=&gt; true,
+				'U_FIND_USERNAME'		=&gt; generate_link('members_list&amp;mode=searchuser&amp;form=select_victim&amp;field=username')
+			));
+
+		break;
+
+		case 'group':
+
+			if (sizeof($group_id))
+			{
+				check_existence('group', $group_id);
+				continue 2;
+			}
+
+			$_CLASS['core_template']-&gt;assign_array(array(
+				'S_SELECT_GROUP'		=&gt; true,
+				'S_GROUP_OPTIONS'		=&gt; group_select_options(false)
+			));
+
+		break;
+
+		case 'usergroup':
+		case 'usergroup_view':
+
+			if (sizeof($user_id) || sizeof($group_id))
+			{
+				if (sizeof($user_id))
+				{
+					check_existence('user', $user_id);
+				}
+
+				if (sizeof($group_id))
+				{
+					check_existence('group', $group_id);
+				}
+
+				continue 2;
+			}
+
+			$items = retrieve_defined_user_groups($permission_scope, $forum_id, $permission_type);
+
+			// Now we check the users... because the &quot;all&quot;-selection is different here (all defined users/groups)
+			$all_users = (isset($_POST['all_users'])) ? true : false;
+			$all_groups = (isset($_POST['all_groups'])) ? true : false;
+
+			if ($all_users &amp;&amp; sizeof($items['user_ids']))
+			{
+				$user_id = $items['user_ids'];
+				continue 2;
+			}
+
+			if ($all_groups &amp;&amp; sizeof($items['group_ids']))
+			{
+				$group_id = $items['group_ids'];
+				continue 2;
+			}
+
+			$_CLASS['core_template']-&gt;assign_array(array(
+				'S_SELECT_USERGROUP'		=&gt; ($victim === 'usergroup') ? true : false,
+				'S_SELECT_USERGROUP_VIEW'	=&gt; ($victim == 'usergroup_view') ? true : false,
+				'S_DEFINED_USER_OPTIONS'	=&gt; $items['user_ids_options'],
+				'S_DEFINED_GROUP_OPTIONS'	=&gt; $items['group_ids_options'],
+				'S_ADD_GROUP_OPTIONS'		=&gt; group_select_options(false, $items['group_ids']),
+				'U_FIND_USERNAME'			=&gt; generate_link('members_list&amp;mode=searchuser&amp;form=add_user&amp;field=username')
+			));
+
+		break;
+	}
+
+	$_CLASS['core_template']-&gt;assign_array(array(
+		'U_ACTION'				=&gt; $u_action,
+		'ANONYMOUS_USER_ID'		=&gt; ANONYMOUS,
+
+		'S_SELECT_VICTIM'		=&gt; true,
+		'S_CAN_SELECT_USER'		=&gt; ($_CLASS['forums_auth']-&gt;acl_get('a_authusers')) ? true : false,
+		'S_CAN_SELECT_GROUP'	=&gt; ($_CLASS['forums_auth']-&gt;acl_get('a_authgroups')) ? true : false,
+		'S_HIDDEN_FIELDS'		=&gt; $s_hidden_fields
+	));
+
+	// Let the forum names being displayed
+	if (sizeof($forum_id))
+	{
+		$sql = 'SELECT forum_name
+			FROM ' . FORUMS_FORUMS_TABLE . '
+			WHERE forum_id IN (' . implode(', ', $forum_id) . ')
+			ORDER BY forum_name ASC';
+		$result = $_CLASS['core_db']-&gt;query($sql);
+
+		$forum_names = array();
+		while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+		{
+			$forum_names[] = $row['forum_name'];
+		}
+		$_CLASS['core_db']-&gt;free_result($result);
+
+		$_CLASS['core_template']-&gt;assign_array(array(
+			'S_FORUM_NAMES'		=&gt; (sizeof($forum_names)) ? true : false,
+			'FORUM_NAMES'		=&gt; implode(', ', $forum_names)
+		));
 	}
-}
-unset($forum_submode_ids);
-unset($forum_submode);
-unset($submode_forum_id);
+
+	$_CLASS['core_display']-&gt;display($page_title, 'modules/forums/admin/acp_permissions.html');
+
+	return;
+}
+
+// Do not allow forum_ids being set and no other setting defined (will bog down the server too much)
+if (sizeof($forum_id) &amp;&amp; !sizeof($user_id) &amp;&amp; !sizeof($group_id))
+{
+	trigger_error($_CLASS['core_user']-&gt;lang['ONLY_FORUM_DEFINED'] . adm_back_link($u_action));
+}
+
+$_CLASS['core_template']-&gt;assign_array(array(
+	'S_PERMISSION_DROPDOWN'		=&gt; (sizeof($permission_dropdown) &gt; 1) ? build_permission_dropdown($permission_dropdown, $permission_type) : false,
+	'L_PERMISSION_TYPE'			=&gt; $_CLASS['core_user']-&gt;get_lang('ACL_TYPE_' . strtoupper($permission_type)),
+
+	'U_ACTION'					=&gt; $u_action,
+	'S_HIDDEN_FIELDS'			=&gt; $s_hidden_fields
+));
+
+if (strpos($mode, 'setting_') === 0)
+{
+	$_CLASS['core_template']-&gt;assign_array(array(
+		'S_SETTING_PERMISSIONS'		=&gt; true
+	));
+
+	$hold_ary = $_CLASS['forums_auth_admin']-&gt;get_mask('set', (sizeof($user_id)) ? $user_id : false, (sizeof($group_id)) ? $group_id : false, (sizeof($forum_id)) ? $forum_id : false, $permission_type, $permission_scope, ACL_NO);
+	$_CLASS['forums_auth_admin']-&gt;display_mask('set', $permission_type, $hold_ary, ((sizeof($user_id)) ? 'user' : 'group'), (($permission_scope == 'local') ? true : false));
+}
+else
+{
+	$_CLASS['core_template']-&gt;assign_array(array(
+		'S_VIEWING_PERMISSIONS'		=&gt; true
+	));
+
+	$hold_ary = $_CLASS['forums_auth_admin']-&gt;get_mask('view', (sizeof($user_id)) ? $user_id : false, (sizeof($group_id)) ? $group_id : false, (sizeof($forum_id)) ? $forum_id : false, $permission_type, $permission_scope, ACL_NEVER);
+	$_CLASS['forums_auth_admin']-&gt;display_mask('view', $permission_type, $hold_ary, ((sizeof($user_id)) ? 'user' : 'group'), (($permission_scope == 'local') ? true : false));
+}
 
-
-// Instantiate a new auth admin object in readiness
-$auth_admin = new auth_admin();
-
-// Are we setting deps? If we are we need to re-run the mode match above for the
-// relevant 'new' mode
-if (!empty($submode))
-{
-	switch ($submode)
-	{
-		case 'forum':
-			$l_title_explain = $_CLASS['core_user']-&gt;lang['PERMISSIONS_EXPLAIN'];
-			$which_acl = 'a_auth';
-			$sql_option_mode = 'f';
-			break;
-
-		case 'mod':
-			$l_title_explain = $_CLASS['core_user']-&gt;lang['MODERATORS_EXPLAIN'];
-			$which_acl = 'a_authmods';
-			$sql_option_mode = 'm';
-			break;
-
-		case 'supermod':
-			$l_title_explain = $_CLASS['core_user']-&gt;lang['SUPER_MODERATORS_EXPLAIN'];
-			$which_acl = 'a_authmods';
-			$sql_option_mode = 'm';
-			break;
-	}
-
-	// Permission check
-	if (!$_CLASS['auth']-&gt;acl_get($which_acl))
-	{
-		trigger_error($_CLASS['core_user']-&gt;lang['NO_ADMIN']);
-	}
-}
-
-
-// Does user want to update anything? Check here to find out 
-// and act appropriately
-switch ($submit)
-{
-	case 'update':
-		if (!empty($auth_settings))
-		{
-			// Admin wants subforums to inherit permissions ... so add these
-			// forums to the list ... since inheritance is only available for
-			// forum and moderator primary modes we deal with '$forum_id[$mode]'
-			if (!empty($_POST['inherit']))
-			{
-				$forum_id[$mode] = array_merge($forum_id[$mode], array_map('intval', $_POST['inherit']));
-			}
-
-			// Update the permission set ... we loop through each auth setting array
-			foreach ($auth_settings as $auth_submode =&gt; $auth_setting)
-			{
-				// Are any entries * ? If so we need to remove them since they
-				// are options the user wishes to ignore
-
-				if (in_array('*', $auth_setting))
-				{
-					foreach ($auth_setting as $option =&gt; $setting)
-					{
-						if ($setting == '*')
-						{
-							unset($auth_setting[$option]);
-						}
-					}
-				}
-
-				if (!empty($auth_setting))
-				{
-					// Loop through all user/group ids
-					foreach ($ug_data as $id)
-					{
-						$auth_admin-&gt;acl_set($ug_type, $forum_id[$auth_submode], $id, $auth_setting);
-					}
-				}
-			}
-
-			// Do we need to recache the moderator lists? We do if the mode
-			// was mod or auth_settings['mod'] is a non-zero size array
-			if ($mode == 'mod' || !empty($auth_settings['mod']))
-			{
-				cache_moderators();
-			}
-
-			// Remove users who are now moderators or admins from everyones foes
-			// list
-			if ($mode == 'mod' || !empty($auth_settings['mod']) || $mode == 'admin' || !empty($auth_settings['admin']))
-			{
-				update_foes();
-			}
-
-			// Logging ... first grab user or groupnames ...
-			$sql = ($ug_type == 'group') ? 'SELECT group_name as name, group_type FROM ' . CORE_GROUPS_TABLE . ' WHERE group_id' : 'SELECT username as name FROM ' . CORE_USERS_TABLE . ' WHERE user_id';
-			$sql .=  ' IN (' . implode(', ', array_map('intval', $ug_data)) . ')';
-			$result = $_CLASS['core_db']-&gt;query($sql);
-
-			$l_ug_list = '';
-			while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
-			{
-				$l_ug_list .= (($l_ug_list != '') ? ', ' : '') . (($row['group_type'] == GROUP_SYSTEM) ? '&lt;span class=&quot;blue&quot;&gt;' . $_CLASS['core_user']-&gt;lang['G_' . $row['name']] . '&lt;/span&gt;' : $row['name']);
-			}
-			$_CLASS['core_db']-&gt;free_result($result);
-
-			$auth_submode = array_keys($auth_settings);
-			foreach ($auth_submode as $sub_mode)
-			{
-				if (!in_array(0, $forum_id[$sub_mode]))
-				{
-					// Grab the forum details if non-zero forum_id
-					$sql = 'SELECT forum_name  
-						FROM ' . FORUMS_FORUMS_TABLE . &quot;
-						WHERE forum_id IN ($sql_forum_id)&quot;;
-					$result = $_CLASS['core_db']-&gt;query($sql);
-
-					$l_forum_list = '';
-					while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
-					{
-						$l_forum_list .= (($l_forum_list != '') ? ', ' : '') . $row['forum_name'];
-					}
-					$_CLASS['core_db']-&gt;free_result($result);
-
-					add_log('admin', 'LOG_ACL_' . strtoupper($sub_mode) . '_ADD', $l_forum_list, $l_ug_list);
-				}
-				else
-				{
-					add_log('admin', 'LOG_ACL_' . strtoupper($sub_mode) . '_ADD', $l_ug_list);
-				}
-			}
-			unset($l_ug_list);
-		}
-		unset($auth_submode);
-		unset($auth_setting);
-
-		trigger_error($_CLASS['core_user']-&gt;lang['AUTH_UPDATED']);
-	break;
-
-	case 'delete':
-		$sql = &quot;SELECT auth_option_id
-			FROM &quot; . FORUMS_ACL_OPTIONS_TABLE . &quot;
-			WHERE auth_option LIKE '{$sql_option_mode}_%'&quot;;
-		$result = $_CLASS['core_db']-&gt;query($sql);
-
-		if ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
-		{
-			$option_id_ary = array();
-			do
-			{
-				$option_id_ary[] = $row['auth_option_id'];
-			}
-			while($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result));
-
-			foreach ($ug_data as $id)
-			{
-				$auth_admin-&gt;acl_delete($ug_type, $forum_id[$mode], $id, $option_id_ary);
-			}
-			unset($option_id_ary);
-		}
-		$_CLASS['core_db']-&gt;free_result($result);
-
-
-		// Do we need to recache the moderator lists? We do if the mode
-		// was mod or auth_settings['mod'] is a non-zero size array
-		if ($mode == 'mod' || (isset($auth_settings['mod']) &amp;&amp; !empty($auth_settings['mod'])))
-		{
-			cache_moderators();
-		}
-
-		// Logging ... first grab user or groupnames ...
-		$sql = ($ug_type == 'group') ? 'SELECT group_name as name, group_type FROM ' . CORE_GROUPS_TABLE . ' WHERE group_id' : 'SELECT username as name FROM ' . CORE_USERS_TABLE . ' WHERE user_id';
-		$sql .=  ' IN (' . implode(', ', array_map('intval', $ug_data)) . ')';
-		$result = $_CLASS['core_db']-&gt;query($sql);
-
-		$l_ug_list = '';
-		while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
-		{
-			$l_ug_list .= (($l_ug_list != '') ? ', ' : '') . ((isset($row['group_type']) &amp;&amp; $row['group_type'] == GROUP_SPECIAL) ? '&lt;span class=&quot;blue&quot;&gt;' . $_CLASS['core_user']-&gt;lang['G_' . $row['name']] . '&lt;/span&gt;' : $row['name']);
-		}
-		$_CLASS['core_db']-&gt;free_result($result);
-
-
-		// Grab the forum details if non-zero forum_id
-		if (!in_array(0, $forum_id[$which_mode]))
-		{
-			$sql = 'SELECT forum_name  
-				FROM ' . FORUMS_FORUMS_TABLE . &quot;
-				WHERE forum_id IN ($sql_forum_id)&quot;;
-			$result = $_CLASS['core_db']-&gt;query($sql);
-
-			$l_forum_list = '';
-			while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
-			{
-				$l_forum_list .= (($l_forum_list != '') ? ', ' : '') . $row['forum_name'];
-			}
-			$_CLASS['core_db']-&gt;free_result($result);
-
-			add_log('admin', 'LOG_ACL_' . strtoupper($which_mode) . '_DEL', $l_forum_list, $l_ug_list);
-		}
-		else
-		{
-			add_log('admin', 'LOG_ACL_' . strtoupper($which_mode) . '_DEL', $l_ug_list);
-		}
-
-		trigger_error($_CLASS['core_user']-&gt;lang['AUTH_UPDATED']);
-	break;
-
-	case 'presetsave':
-		$holding_ary = array();
-	
-		$auth_setting = $auth_settings[(!empty($submode) ? $submode : $mode)];
-
-		foreach ($auth_setting as $option =&gt; $setting)
-		{
-			switch ($setting)
-			{
-				case ACL_YES:
-					$holding_ary['yes'][] = $option;
-				break;
-
-				case ACL_NO:
-					$holding_ary['no'][] = $option;
-				break;
-
-				case ACL_UNSET:
-					$holding_ary['unset'][] = $option;
-				break;
-			}
-		}
-
-		$sql = array(
-			'preset_user_id'=&gt; (int) $_CLASS['core_user']-&gt;data['user_id'],
-			'preset_type'	=&gt; $sql_option_mode,
-			'preset_data'	=&gt; serialize($holding_ary)
-		);
-
-		if (!empty($_POST['presetname']))
-		{	
-			$sql['preset_name'] = htmlspecialchars($_POST['presetname'], ENT_QUOTES);
-		}
-		
-		if (!empty($sql['preset_name']) || $_POST['presetoption'] != -1)
-		{
-			$sql = ($_POST['presetoption'] == -1) ? 'INSERT INTO ' . FORUMS_ACL_PRESETS_TABLE . ' ' . $_CLASS['core_db']-&gt;sql_build_array('INSERT', $sql) : 'UPDATE ' . FORUMS_ACL_PRESETS_TABLE . ' SET ' . $_CLASS['core_db']-&gt;sql_build_array('UPDATE', $sql) . ' WHERE preset_id =' . (int) $_POST['presetoption'];
-			$_CLASS['core_db']-&gt;query($sql);
-
-			add_log('admin', 'LOG_ACL_PRESET_ADD', $sql['preset_name']);
-		}
-		unset($sql, $option, $setting, $auth_setting);
-	break;
-
-	case 'presetdel':
-		if (!empty($_POST['presetoption']))
-		{
-			$sql = &quot;SELECT preset_name 
-				FROM &quot; . FORUMS_ACL_PRESETS_TABLE . &quot; 
-				WHERE preset_id = &quot; . (int) $_POST['presetoption'];
-			$result = $_CLASS['core_db']-&gt;query($sql);
-
-			$row = $_CLASS['core_db']-&gt;fetch_row_assoc($result);
-			$_CLASS['core_db']-&gt;free_result($result);
-
-			if ($row)
-			{
-				$sql = &quot;DELETE FROM &quot; . FORUMS_ACL_PRESETS_TABLE . &quot; 
-					WHERE preset_id = &quot; . (int) $_POST['presetoption'];
-				$_CLASS['core_db']-&gt;query($sql);
-	
-				add_log('admin', 'LOG_ACL_PRESET_DEL', $row['preset_name']);
-			}
-			unset($row);
-		}
-	break;
-}
-// End update
-
-
-// Output page header
-adm_page_header($l_title);
-
-
-// First potential form ... this is for selecting forums, users
-// or groups. 
-if (in_array($mode, array('user', 'group', 'forum', 'mod')) &amp;&amp; empty($submit))
-{
-
-?&gt;
-
-&lt;h1&gt;&lt;?php echo $l_title; ?&gt;&lt;/h1&gt;
-
-&lt;p&gt;&lt;?php echo $l_title_explain ?&gt;&lt;/p&gt;
-
-&lt;form method=&quot;post&quot; action=&quot;&lt;?php echo generate_link('forums&amp;file=admin_permissions&amp;mode='.$mode, array('admin' =&gt; true)); ?&gt;&quot;&gt;&lt;table width=&quot;100%&quot; class=&quot;tablebg&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
-&lt;?php
-
-	// Mode specific markup
-	switch ($mode)
-	{
-		case 'forum':
-		case 'mod':
-
-?&gt;
-	&lt;tr&gt;
-		&lt;th align=&quot;center&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['LOOK_UP_FORUM']; ?&gt;&lt;/th&gt;
-	&lt;/tr&gt;
-	&lt;tr&gt;
-		&lt;td class=&quot;row1&quot; align=&quot;center&quot; valign=&quot;middle&quot;&gt;&nbsp;&lt;select style=&quot;width:280px&quot; name=&quot;f[&lt;?php echo $mode; ?&gt;][]&quot; multiple=&quot;true&quot; size=&quot;7&quot;&gt;&lt;?php 
-	
-			echo make_forum_select(false, false, false);
-			
-?&gt;&lt;/select&gt;&nbsp;&lt;/td&gt;
-	&lt;/tr&gt;
-	&lt;tr&gt;
-		&lt;td class=&quot;cat&quot; align=&quot;center&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit_usergroups&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['LOOK_UP_FORUM']; ?&gt;&quot; class=&quot;btnmain&quot; /&gt;&nbsp; &lt;input type=&quot;reset&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['RESET']; ?&gt;&quot; class=&quot;btnlite&quot; /&gt;&lt;input type=&quot;hidden&quot; name=&quot;ug_type&quot; value=&quot;forum&quot; /&gt;&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;usergroups&quot; /&gt;&lt;/td&gt;
-	&lt;/tr&gt;
-&lt;?php
-		
-			break;
-
-		case 'user':
-
-?&gt;
-	&lt;tr&gt;
-		&lt;th align=&quot;center&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['LOOK_UP_USER']; ?&gt;&lt;/th&gt;
-	&lt;/tr&gt;
-	&lt;tr&gt;
-		&lt;td class=&quot;row1&quot; align=&quot;center&quot;&gt;&nbsp;&lt;textarea cols=&quot;40&quot; rows=&quot;4&quot; name=&quot;ug_data[]&quot;&gt;&lt;/textarea&gt;&nbsp;&lt;/td&gt;
-	&lt;/tr&gt;
-	&lt;tr&gt;
-		&lt;td class=&quot;cat&quot; align=&quot;center&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit_add_options&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['SUBMIT']; ?&gt;&quot; class=&quot;btnmain&quot; /&gt;&nbsp; &lt;input type=&quot;reset&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['RESET']; ?&gt;&quot; class=&quot;btnlite&quot; /&gt;&nbsp; &lt;input type=&quot;submit&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['FIND_USERNAME']; ?&gt;&quot; class=&quot;btnlite&quot; onclick=&quot;window.open('&lt;?php echo generate_link('Members_List&amp;mode=searchuser&amp;form=2&amp;field=entries'); ?&gt;', '_phpbbsearch', 'HEIGHT=500,resizable=yes,scrollbars=yes,WIDTH=740');return false;&quot; /&gt;&lt;input type=&quot;hidden&quot; name=&quot;ug_type&quot; value=&quot;user&quot; /&gt;&lt;/td&gt;
-	&lt;/tr&gt;
-&lt;?php
-
-			break;
-
-		case 'group':
-			// Generate list of groups
-
-?&gt;
-	&lt;tr&gt;
-		&lt;th align=&quot;center&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['LOOK_UP_GROUP']; ?&gt;&lt;/th&gt;
-	&lt;/tr&gt;
-	&lt;tr&gt;
-		&lt;td class=&quot;row1&quot; align=&quot;center&quot; valign=&quot;middle&quot;&gt;&nbsp;&lt;select style=&quot;width:280px&quot; name=&quot;ug_data[]&quot; multiple=&quot;true&quot; size=&quot;7&quot;&gt;&lt;?php 
-
-			$sql = &quot;SELECT group_id, group_name, group_type   
-				FROM &quot; . CORE_GROUPS_TABLE . &quot; 
-				ORDER BY group_type DESC&quot;;
-			$result = $_CLASS['core_db']-&gt;query($sql);
-
-			$group_options = '';
-			if ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
-			{
-				do
-				{
-					echo '&lt;option' . (($row['group_type'] == GROUP_SPECIAL) ? ' class=&quot;blue&quot;' : '') . ' value=&quot;' . $row['group_id'] . '&quot;&gt;' . (($row['group_type'] == GROUP_SPECIAL) ? $_CLASS['core_user']-&gt;lang['G_' . $row['group_name']] : $row['group_name']) . '&lt;/option&gt;';
-				}
-				while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result));
-			}
-			$_CLASS['core_db']-&gt;free_result($result);
-			
-?&gt;&lt;/select&gt;&nbsp;&lt;/td&gt;
-	&lt;/tr&gt;
-	&lt;tr&gt;
-		&lt;td class=&quot;cat&quot; align=&quot;center&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit_edit_options&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['LOOK_UP_GROUP']; ?&gt;&quot; class=&quot;btnmain&quot; /&gt;&nbsp; &lt;input type=&quot;reset&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['RESET']; ?&gt;&quot; class=&quot;btnlite&quot; /&gt;&lt;input type=&quot;hidden&quot; name=&quot;ug_type&quot; value=&quot;group&quot; /&gt;&lt;/td&gt;
-	&lt;/tr&gt;
-&lt;?php
-
-		break;
-
-	}
-
-?&gt;
-&lt;/table&gt;&lt;/form&gt;
-
-&lt;?php
-
-}
-// End user, group or forum selection
-
-
-// Second possible form, this lists the currently enabled
-// users/groups for the given mode
-if ((in_array($submit, array('usergroups', 'delete', 'cancel'))) || (!strstr($submit, 'options') &amp;&amp; empty($submode) &amp;&amp; in_array($mode, array('admin', 'supermod'))))
-{
-
-?&gt;
-
-&lt;h1&gt;&lt;?php echo $l_title; ?&gt;&lt;/h1&gt;
-
-&lt;p&gt;&lt;?php echo $l_title_explain; ?&gt;&lt;/p&gt;
-
-&lt;table width=&quot;100%&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot;&gt;
-	&lt;tr&gt;
-		&lt;td&gt;&lt;form method=&quot;post&quot; action=&quot;&lt;?php echo generate_link('forums&amp;file=admin_permissions&amp;mode='.$mode, array('admin' =&gt; true)); ?&gt;&quot;&gt;&lt;table width=&quot;100%&quot; class=&quot;tablebg&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
-			&lt;tr&gt;
-				&lt;th&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['MANAGE_USERS']; ?&gt;&lt;/th&gt;
-			&lt;/tr&gt;
-			&lt;tr&gt;
-				&lt;td class=&quot;row1&quot; align=&quot;center&quot;&gt;&lt;select style=&quot;width:280px&quot; name=&quot;ug_data[]&quot; multiple=&quot;multiple&quot; size=&quot;5&quot;&gt;&lt;?php
-			
-	$sql = &quot;SELECT u.user_id, u.username
-		FROM &quot; . CORE_USERS_TABLE . &quot; u, &quot; . FORUMS_ACL_TABLE . &quot; a, &quot; . FORUMS_ACL_OPTIONS_TABLE . &quot; o
-		WHERE o.auth_option LIKE '&quot; . $sql_option_mode . &quot;_%'
-			AND a.auth_option_id = o.auth_option_id
-			AND a.forum_id IN ($sql_forum_id)
-			AND u.user_id = a.user_id
-		ORDER BY u.username, u.user_reg_date ASC&quot;;
-	$result = $_CLASS['core_db']-&gt;query($sql);
-
-	$users = '';
-	while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
-	{
-		echo '&lt;option value=&quot;' . $row['user_id'] . '&quot;&gt;' . $row['username'] . '&lt;/option&gt;';
-	}
-	$_CLASS['core_db']-&gt;free_result($result);
-		
-?&gt;&lt;/select&gt;&lt;/td&gt;
-			&lt;/tr&gt;
-			&lt;tr&gt;
-				&lt;td class=&quot;cat&quot; align=&quot;center&quot;&gt;&lt;input class=&quot;btnlite&quot; type=&quot;submit&quot; name=&quot;submit_delete&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['DELETE']; ?&gt;&quot; /&gt; &nbsp; &lt;input class=&quot;btnlite&quot; type=&quot;submit&quot; name=&quot;submit_edit_options&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['SET_OPTIONS']; ?&gt;&quot; /&gt;&lt;input type=&quot;hidden&quot; name=&quot;ug_type&quot; value=&quot;user&quot; /&gt;&lt;?php echo $s_forum_id; ?&gt;&lt;/td&gt;
-			&lt;/tr&gt;
-		&lt;/table&gt;&lt;/form&gt;&lt;/td&gt;
-
-		&lt;td align=&quot;center&quot;&gt;&lt;form method=&quot;post&quot; name=&quot;admingroups&quot; action=&quot;&lt;?php echo generate_link('forums&amp;file=admin_permissions&amp;mode='.$mode, array('admin' =&gt; true)); ?&gt;&quot;&gt;&lt;table width=&quot;100%&quot; class=&quot;tablebg&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
-		&lt;tr&gt;
-			&lt;th&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['MANAGE_GROUPS']; ?&gt;&lt;/th&gt;
-		&lt;/tr&gt;
-		&lt;tr&gt;
-			&lt;td class=&quot;row1&quot; align=&quot;center&quot;&gt;&lt;select style=&quot;width:280px&quot; name=&quot;ug_data[]&quot; multiple=&quot;multiple&quot; size=&quot;5&quot;&gt;&lt;?php 
-	
-	$sql = &quot;SELECT DISTINCT g.group_id, g.group_name, g.group_type 
-		FROM &quot; . CORE_GROUPS_TABLE . &quot; g, &quot; . FORUMS_ACL_TABLE . &quot; a, &quot; . FORUMS_ACL_OPTIONS_TABLE . &quot; o
-		WHERE o.auth_option LIKE '&quot; . $sql_option_mode . &quot;_%'
-			AND a.forum_id IN ($sql_forum_id)
-			AND a.auth_option_id = o.auth_option_id
+$_CLASS['core_display']-&gt;display($page_title, 'modules/forums/admin/acp_permissions.html');
+
+/**
+* Build +subforum options
+*/
+function build_subforum_options($forum_list)
+{
+	global $_CLASS;
+
+	$s_options = '';
+
+	$forum_list = array_merge($forum_list);
+
+	foreach ($forum_list as $key =&gt; $row)
+	{
+		$s_options .= '&lt;option value=&quot;' . $row['forum_id'] . '&quot;' . $row['selected'] . '&gt;' . $row['padding'] . $row['forum_name'];
+
+		// We check if a branch is there...
+		$branch_there = false;
+
+		foreach (array_slice($forum_list, $key + 1) as $temp_row)
+		{
+			if ($temp_row['left_id'] &gt; $row['left_id'] &amp;&amp; $temp_row['left_id'] &lt; $row['right_id'])
+			{
+				$branch_there = true;
+
+				break;
+			}
+			continue;
+		}
+		
+		if ($branch_there)
+		{
+			$s_options .= ' [' . $_CLASS['core_user']-&gt;get_lang('PLUS_SUBFORUMS') . ']';
+		}
+
+		$s_options .= '&lt;/option&gt;';
+	}
+
+	return $s_options;
+}
+
+/**
+* Build dropdown field for changing permission types
+*/
+function build_permission_dropdown($options, $default_option)
+{
+	global $_CLASS;
+	
+	$s_dropdown_options = '';
+	foreach ($options as $setting)
+	{
+		if (!$_CLASS['forums_auth']-&gt;acl_get('a_' . str_replace('_', '', $setting) . 'auth'))
+		{
+			continue;
+		}
+		$selected = ($setting == $default_option) ? ' selected=&quot;selected&quot;' : '';
+		$s_dropdown_options .= '&lt;option value=&quot;' . $setting . '&quot;' . $selected . '&gt;' . $_CLASS['core_user']-&gt;lang['permission_type'][$setting] . '&lt;/option&gt;';
+	}
+
+	return $s_dropdown_options;
+}
+
+/**
+* Check if selected items exist. Remove not found ids and if empty return error.
+*/
+function check_existence($mode, &amp;$ids)
+{
+	global $_CLASS;
+
+	switch ($mode)
+	{
+		case 'user':
+			$table = CORE_USERS_TABLE;
+			$sql_id = 'user_id';
+		break;
+
+		case 'group':
+			$table = CORE_GROUPS_TABLE;
+			$sql_id = 'group_id';
+		break;
+
+		case 'forum':
+			$table = FORUMS_FORUMS_TABLE;
+			$sql_id = 'forum_id';
+		break;
+	}
+
+	$sql = &quot;SELECT $sql_id
+		FROM $table
+		WHERE $sql_id IN (&quot; . implode(', ', $ids) . ')';
+	$result = $_CLASS['core_db']-&gt;query($sql);
+
+	$ids = array();
+	while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+	{
+		$ids[] = $row[$sql_id];
+	}
+	$_CLASS['core_db']-&gt;free_result($result);
+
+	if (!sizeof($ids))
+	{
+		trigger_error($_CLASS['core_user']-&gt;lang['SELECTED_' . strtoupper($mode) . '_NOT_EXIST'] . adm_back_link($u_action));
+	}
+}
+
+/** 
+* Apply permissions
+*/
+function set_permissions($mode, $permission_type, &amp;$forums_auth_admin, &amp;$user_id, &amp;$group_id)
+{
+	global $_CLASS;
+
+	$psubmit = request_var('psubmit', array(0));
+
+	// User or group to be set?
+	$ug_type = (sizeof($user_id)) ? 'user' : 'group';
+
+	// Check the permission setting again
+	if (!$_CLASS['forums_auth']-&gt;acl_get('a_' . str_replace('_', '', $permission_type) . 'auth') || !$_CLASS['forums_auth']-&gt;acl_get('a_auth' . $ug_type . 's'))
+	{
+		trigger_error($_CLASS['core_user']-&gt;lang['NO_ADMIN'] . adm_back_link($u_action));
+	}
+	
+	$ug_id = $forum_id = 0;
+
+	// We loop through the auth settings defined in our submit
+	list($ug_id, ) = each($psubmit);
+	list($forum_id, ) = each($psubmit[$ug_id]);
+
+	$auth_settings = array_map('intval', $_POST['setting'][$ug_id][$forum_id]);
+
+	// Do we have a role we want to set?
+	$assigned_role = (isset($_POST['role'][$ug_id][$forum_id])) ? (int) $_POST['role'][$ug_id][$forum_id] : 0;
+
+	// Do the admin want to set these permissions to other items too?
+	$inherit = request_var('inherit', array(0));
+
+	$ug_id = array($ug_id);
+	$forum_id = array($forum_id);
+
+	if (sizeof($inherit))
+	{
+		foreach ($inherit as $_ug_id =&gt; $forum_id_ary)
+		{
+			// Inherit users/groups?
+			if (!in_array($_ug_id, $ug_id))
+			{
+				$ug_id[] = $_ug_id;
+			}
+
+			// Inherit forums?
+			$forum_id = array_merge($forum_id, array_keys($forum_id_ary));
+		}
+	}
+
+	$forum_id = array_unique($forum_id);
+
+	// If the auth settings differ from the assigned role, then do not set a role...
+	if ($assigned_role)
+	{
+		if (!check_assigned_role($assigned_role, $auth_settings))
+		{
+			$assigned_role = 0;
+		}
+	}
+
+	// Update the permission set...
+	$forums_auth_admin-&gt;acl_set($ug_type, $forum_id, $ug_id, $auth_settings, $assigned_role);
+
+	// Do we need to recache the moderator lists?
+	if ($permission_type == 'm_')
+	{
+		cache_moderators();
+	}
+
+	// Remove users who are now moderators or admins from everyones foes list
+	if ($permission_type == 'm_' || $permission_type == 'a_')
+	{
+		update_foes();
+	}
+
+	log_action($mode, 'add', $permission_type, $ug_type, $ug_id, $forum_id);
+
+	trigger_error($_CLASS['core_user']-&gt;lang['AUTH_UPDATED'] . adm_back_link($u_action));
+}
+
+/** 
+* Apply all permissions
+*/
+function set_all_permissions($mode, $permission_type, &amp;$forums_auth_admin, &amp;$user_id, &amp;$group_id)
+{
+	global $_CLASS;
+
+	// User or group to be set?
+	$ug_type = (sizeof($user_id)) ? 'user' : 'group';
+
+	// Check the permission setting again
+	if (!$_CLASS['forums_auth']-&gt;acl_get('a_' . str_replace('_', '', $permission_type) . 'auth') || !$_CLASS['forums_auth']-&gt;acl_get('a_auth' . $ug_type . 's'))
+	{
+		trigger_error($_CLASS['core_user']-&gt;lang['NO_ADMIN'] . adm_back_link($u_action));
+	}
+
+	$auth_settings = (isset($_POST['setting'])) ? $_POST['setting'] : array();
+	$auth_roles = (isset($_POST['role'])) ? $_POST['role'] : array();
+	$ug_ids = $forum_ids = array();
+
+	// We need to go through the auth settings
+	foreach ($auth_settings as $ug_id =&gt; $forum_auth_row)
+	{
+		$ug_id = (int) $ug_id;
+		$ug_ids[] = $ug_id;
+
+		foreach ($forum_auth_row as $forum_id =&gt; $auth_options)
+		{
+			$forum_id = (int) $forum_id;
+			$forum_ids[] = $forum_id;
+
+			// Check role...
+			$assigned_role = (isset($auth_roles[$ug_id][$forum_id])) ? (int) $auth_roles[$ug_id][$forum_id] : 0;
+
+			// If the auth settings differ from the assigned role, then do not set a role...
+			if ($assigned_role)
+			{
+				if (!check_assigned_role($assigned_role, $auth_options))
+				{
+					$assigned_role = 0;
+				}
+			}
+
+			// Update the permission set...
+			$forums_auth_admin-&gt;acl_set($ug_type, $forum_id, $ug_id, $auth_options, $assigned_role, false);
+		}
+	}
+
+	$forums_auth_admin-&gt;acl_clear_prefetch();
+
+	// Do we need to recache the moderator lists?
+	if ($permission_type == 'm_')
+	{
+		cache_moderators();
+	}
+
+	// Remove users who are now moderators or admins from everyones foes list
+	if ($permission_type == 'm_' || $permission_type == 'a_')
+	{
+		update_foes();
+	}
+
+	log_action($mode, 'add', $permission_type, $ug_type, $ug_ids, $forum_ids);
+
+	trigger_error($_CLASS['core_user']-&gt;lang['AUTH_UPDATED'] . adm_back_link($u_action));
+}
+
+/**
+* Compare auth settings with auth settings from role
+* returns false if they differ, true if they are equal
+*/
+function check_assigned_role($role_id, &amp;$auth_settings)
+{
+	global $_CLASS;
+
+	$sql = 'SELECT o.auth_option, r.auth_setting
+		FROM ' . FORUMS_ACL_OPTIONS_TABLE . ' o, ' . FORUMS_ACL_ROLES_DATA_TABLE . ' r
+		WHERE o.auth_option_id = r.auth_option_id
+			AND r.role_id = ' . $role_id;
+	$result = $_CLASS['core_db']-&gt;query($sql);
+
+	$test_auth_settings = array();
+	while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+	{
+		$test_auth_settings[$row['auth_option']] = $row['auth_setting'];
+	}
+	$_CLASS['core_db']-&gt;free_result($result);
+
+	// We need to add any ACL_NO setting from auth_settings to compare correctly
+	foreach ($auth_settings as $option =&gt; $setting)
+	{
+		if ($setting == ACL_NO)
+		{
+			$test_auth_settings[$option] = $setting;
+		}
+	}
+
+	if (sizeof(array_diff_assoc($auth_settings, $test_auth_settings)))
+	{
+		return false;
+	}
+
+	return true;
+}
+
+/**
+* Remove permissions
+*/
+function remove_permissions($mode, $permission_type, &amp;$forums_auth_admin, &amp;$user_id, &amp;$group_id, &amp;$forum_id)
+{
+	global $_CLASS;
+		
+	// User or group to be set?
+	$ug_type = (sizeof($user_id)) ? 'user' : 'group';
+
+	// Check the permission setting again
+	if (!$_CLASS['forums_auth']-&gt;acl_get('a_' . str_replace('_', '', $permission_type) . 'auth') || !$_CLASS['forums_auth']-&gt;acl_get('a_auth' . $ug_type . 's'))
+	{
+		trigger_error($_CLASS['core_user']-&gt;lang['NO_ADMIN'] . adm_back_link($u_action));
+	}
+
+	$forums_auth_admin-&gt;acl_delete($ug_type, (($ug_type == 'user') ? $user_id : $group_id), (sizeof($forum_id) ? $forum_id : false), $permission_type);
+
+	// Do we need to recache the moderator lists?
+	if ($permission_type == 'm_')
+	{
+		cache_moderators();
+	}
+
+	log_action($mode, 'del', $permission_type, $ug_type, (($ug_type == 'user') ? $user_id : $group_id), (sizeof($forum_id) ? $forum_id : array(0 =&gt; 0)));
+
+	trigger_error($_CLASS['core_user']-&gt;lang['AUTH_UPDATED'] . adm_back_link($u_action));
+}
+
+/**
+* Log permission changes
+*/
+function log_action($mode, $action, $permission_type, $ug_type, $ug_id, $forum_id)
+{
+	global $_CLASS;
+
+	if (!is_array($ug_id))
+	{
+		$ug_id = array($ug_id);
+	}
+
+	if (!is_array($forum_id))
+	{
+		$forum_id = array($forum_id);
+	}
+
+	// Logging ... first grab user or groupnames ...
+	$sql = ($ug_type == 'group') ? 'SELECT group_name as name, group_type FROM ' . CORE_GROUPS_TABLE . ' WHERE ' : 'SELECT username as name FROM ' . CORE_USERS_TABLE . ' WHERE ';
+	$sql .=   (($ug_type === 'group') ? 'group_id' : 'user_id').' IN (' . implode(', ', array_map('intval', $ug_id)) . ')';
+	$result = $_CLASS['core_db']-&gt;query($sql);
+
+	$l_ug_list = '';
+	while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+	{
+		$l_ug_list .= (($l_ug_list != '') ? ', ' : '') . ((isset($row['group_type']) &amp;&amp; $row['group_type'] == GROUP_SPECIAL) ? '&lt;span class=&quot;blue&quot;&gt;' . $_CLASS['core_user']-&gt;lang['G_' . $row['name']] . '&lt;/span&gt;' : $row['name']);
+	}
+	$_CLASS['core_db']-&gt;free_result($result);
+
+	$mode = str_replace('setting_', '', $mode);
+
+	if ($forum_id[0] == 0)
+	{
+		add_log('admin', 'LOG_ACL_' . strtoupper($action) . '_' . strtoupper($mode) . '_' . strtoupper($permission_type), $l_ug_list);
+	}
+	else
+	{
+		// Grab the forum details if non-zero forum_id
+		$sql = 'SELECT forum_name  
+			FROM ' . FORUMS_FORUMS_TABLE . '
+			WHERE forum_id IN (' . implode(', ', $forum_id) . ')';
+		$result = $_CLASS['core_db']-&gt;query($sql);
+
+		$l_forum_list = '';
+		while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+		{
+			$l_forum_list .= (($l_forum_list != '') ? ', ' : '') . $row['forum_name'];
+		}
+		$_CLASS['core_db']-&gt;free_result($result);
+
+		add_log('admin', 'LOG_ACL_' . strtoupper($action) . '_' . strtoupper($mode) . '_' . strtoupper($permission_type), $l_forum_list, $l_ug_list);
+	}
+}
+
+/**
+* Update foes - remove moderators and administrators from foe lists...
+*/
+function update_foes()
+{
+	global $_CLASS;
+
+	$perms = array();
+	foreach ($_CLASS['forums_auth']-&gt;acl_get_list(false, array('a_', 'm_'), false) as $forum_id =&gt; $forum_ary)
+	{
+		foreach ($forum_ary as $auth_option =&gt; $user_ary)
+		{
+			$perms = array_merge($perms, $user_ary);
+		}
+	}
+
+	if (sizeof($perms))
+	{
+		$sql = 'DELETE FROM ' . ZEBRA_TABLE . ' 
+			WHERE zebra_id IN (' . implode(', ', array_unique($perms)) . ')
+				AND foe = 1';
+		$_CLASS['core_db']-&gt;query($sql);
+	}
+	unset($perms);
+}
+
+/**
+* Display a complete trace tree for the selected permission to determine where settings are set/unset
+*/
+function permission_trace($user_id, $forum_id, $permission)
+{
+	global $_CLASS;
+
+	if ($user_id != $_CLASS['core_user']-&gt;data['user_id'])
+	{
+		$sql = 'SELECT user_id, username, user_permissions, user_type
+			FROM ' . CORE_USERS_TABLE . '
+			WHERE user_id = ' . $user_id;
+		$result = $_CLASS['core_db']-&gt;query($sql);
+		$userdata = $_CLASS['core_db']-&gt;fetch_row_assoc($result);
+		$_CLASS['core_db']-&gt;free_result($result);
+	}
+	else
+	{
+		$userdata = $_CLASS['core_user']-&gt;data;
+	}
+
+	if (!$userdata)
+	{
+		trigger_error('NO_USERS');
+	}
+
+	$forum_name = false;
+
+	if ($forum_id)
+	{
+		$sql = 'SELECT forum_name
+			FROM ' . FORUMS_FORUMS_TABLE . &quot;
+			WHERE forum_id = $forum_id&quot;;
+		$result = $_CLASS['core_db']-&gt;query($sql, 3600);
+		$forum_name = $db-&gt;sql_fetchfield('forum_name');
+		$_CLASS['core_db']-&gt;free_result($result);
+	}
+
+	$back = request_var('back', 0);
+
+	$_CLASS['core_template']-&gt;assign_array(array(
+		'PERMISSION'			=&gt; $_CLASS['core_user']-&gt;lang['acl_' . $permission]['lang'],
+		'PERMISSION_USERNAME'	=&gt; $userdata['username'],
+		'FORUM_NAME'			=&gt; $forum_name,
+		'U_BACK'				=&gt; ($back) ? build_url(array('f', 'back')) . &quot;&amp;f=$back&quot; : '')
+	);
+
+	$template-&gt;assign_block_vars('trace', array(
+		'WHO'			=&gt; $_CLASS['core_user']-&gt;lang['DEFAULT'],
+		'INFORMATION'	=&gt; $_CLASS['core_user']-&gt;lang['TRACE_DEFAULT'],
+
+		'S_SETTING_NO'		=&gt; true,
+		'S_TOTAL_NO'		=&gt; true
+	));
+
+	$sql = 'SELECT DISTINCT g.group_name, g.group_id, g.group_type
+		FROM ' . CORE_GROUPS_TABLE . ' g
+			LEFT JOIN ' . USER_GROUP_TABLE . ' ug ON (ug.group_id = g.group_id)
+		WHERE ug.user_id = ' . $user_id . '
+			AND ug.user_pending = 0
+		ORDER BY g.group_type DESC, g.group_id DESC';
+	$result = $_CLASS['core_db']-&gt;query($sql);
+
+	$groups = array();
+	while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+	{
+		$groups[$row['group_id']] = array(
+			'auth_setting'		=&gt; ACL_NO,
+			'group_name'		=&gt; ($row['group_type'] == GROUP_SPECIAL) ? $_CLASS['core_user']-&gt;lang['G_' . $row['group_name']] : $row['group_name']
+		);
+	}
+	$_CLASS['core_db']-&gt;free_result($result);
+
+	$total = ACL_NO;
+	if (sizeof($groups))
+	{
+		// Get group auth settings
+		$hold_ary = $_CLASS['forums_auth']-&gt;acl_group_raw_data(array_keys($groups), $permission, $forum_id);
+
+		foreach ($hold_ary as $group_id =&gt; $forum_ary)
+		{
+			$groups[$group_id]['auth_setting'] = $hold_ary[$group_id][$forum_id][$permission];
+		}
+		unset($hold_ary);
+
+		foreach ($groups as $id =&gt; $row)
+		{
+			switch ($row['auth_setting'])
+			{
+				case ACL_NO:
+					$information = $_CLASS['core_user']-&gt;lang['TRACE_GROUP_NO'];
+				break;
+
+				case ACL_YES:
+					$information = ($total == ACL_YES) ? $_CLASS['core_user']-&gt;lang['TRACE_GROUP_YES_TOTAL_YES'] : (($total == ACL_NEVER) ? $_CLASS['core_user']-&gt;lang['TRACE_GROUP_YES_TOTAL_NEVER'] : $_CLASS['core_user']-&gt;lang['TRACE_GROUP_YES_TOTAL_NO']);
+					$total = ($total == ACL_NO) ? ACL_YES : $total;
+				break;
+
+				case ACL_NEVER:
+					$information = ($total == ACL_YES) ? $_CLASS['core_user']-&gt;lang['TRACE_GROUP_NEVER_TOTAL_YES'] : (($total == ACL_NEVER) ? $_CLASS['core_user']-&gt;lang['TRACE_GROUP_NEVER_TOTAL_NEVER'] : $_CLASS['core_user']-&gt;lang['TRACE_GROUP_NEVER_TOTAL_NO']);
+					$total = ACL_NEVER;
+				break;
+			}
+
+			$template-&gt;assign_block_vars('trace', array(
+				'WHO'			=&gt; $row['group_name'],
+				'INFORMATION'	=&gt; $information,
+
+				'S_SETTING_NO'		=&gt; ($row['auth_setting'] == ACL_NO) ? true : false,
+				'S_SETTING_YES'		=&gt; ($row['auth_setting'] == ACL_YES) ? true : false,
+				'S_SETTING_NEVER'	=&gt; ($row['auth_setting'] == ACL_NEVER) ? true : false,
+				'S_TOTAL_NO'		=&gt; ($total == ACL_NO) ? true : false,
+				'S_TOTAL_YES'		=&gt; ($total == ACL_YES) ? true : false,
+				'S_TOTAL_NEVER'		=&gt; ($total == ACL_NEVER) ? true : false)
+			);
+		}
+	}
+
+	// Get user specific permission...
+	$hold_ary = $_CLASS['forums_auth']-&gt;acl_user_raw_data($user_id, $permission, $forum_id);
+	$auth_setting = (!sizeof($hold_ary)) ? ACL_NO : $hold_ary[$user_id][$forum_id][$permission];
+
+	switch ($auth_setting)
+	{
+		case ACL_NO:
+			$information = ($total == ACL_NO) ? $_CLASS['core_user']-&gt;lang['TRACE_USER_NO_TOTAL_NO'] : $_CLASS['core_user']-&gt;lang['TRACE_USER_KEPT'];
+			$total = ($total == ACL_NO) ? ACL_NEVER : $total;
+		break;
+
+		case ACL_YES:
+			$information = ($total == ACL_YES) ? $_CLASS['core_user']-&gt;lang['TRACE_USER_YES_TOTAL_YES'] : (($total == ACL_NEVER) ? $_CLASS['core_user']-&gt;lang['TRACE_USER_YES_TOTAL_NEVER'] : $_CLASS['core_user']-&gt;lang['TRACE_USER_YES_TOTAL_NO']);
+			$total = ($total == ACL_NO) ? ACL_YES : $total;
+		break;
+
+		case ACL_NEVER:
+			$information = ($total == ACL_YES) ? $_CLASS['core_user']-&gt;lang['TRACE_USER_NEVER_TOTAL_YES'] : (($total == ACL_NEVER) ? $_CLASS['core_user']-&gt;lang['TRACE_USER_NEVER_TOTAL_NEVER'] : $_CLASS['core_user']-&gt;lang['TRACE_USER_NEVER_TOTAL_NO']);
+			$total = ACL_NEVER;
+		break;
+	}
+
+	$template-&gt;assign_block_vars('trace', array(
+		'WHO'			=&gt; $userdata['username'],
+		'INFORMATION'	=&gt; $information,
+
+		'S_SETTING_NO'		=&gt; ($auth_setting == ACL_NO) ? true : false,
+		'S_SETTING_YES'		=&gt; ($auth_setting == ACL_YES) ? true : false,
+		'S_SETTING_NEVER'	=&gt; ($auth_setting == ACL_NEVER) ? true : false,
+		'S_TOTAL_NO'		=&gt; false,
+		'S_TOTAL_YES'		=&gt; ($total == ACL_YES) ? true : false,
+		'S_TOTAL_NEVER'		=&gt; ($total == ACL_NEVER) ? true : false)
+	);
+
+	// global permission might overwrite local permission
+	if (($forum_id != 0) &amp;&amp; isset($_CLASS['forums_auth']-&gt;acl_options['global'][$permission]))
+	{
+		if ($user_id != $_CLASS['core_user']-&gt;data['user_id'])
+		{
+			$auth2 = new auth();
+			$auth2-&gt;acl($userdata);
+			$auth_setting = $auth2-&gt;acl_get($permission);
+		}
+		else
+		{
+			$auth_setting = $_CLASS['forums_auth']-&gt;acl_get($permission);
+		}
+
+		if ($auth_setting)
+		{
+			$information = ($total == ACL_YES) ? $_CLASS['core_user']-&gt;lang['TRACE_USER_GLOBAL_YES_TOTAL_YES'] : $_CLASS['core_user']-&gt;lang['TRACE_USER_GLOBAL_YES_TOTAL_NEVER'];
+			$total = ACL_YES;
+		}
+		else
+		{
+			$information = $_CLASS['core_user']-&gt;lang['TRACE_USER_GLOBAL_NEVER_TOTAL_KEPT'];
+		}
+
+		$template-&gt;assign_block_vars('trace', array(
+			'WHO'			=&gt; sprintf($_CLASS['core_user']-&gt;lang['TRACE_GLOBAL_SETTING'], $userdata['username']),
+			'INFORMATION'	=&gt; sprintf($information, '&lt;a href=&quot;' . $u_action . &quot;&amp;u=$user_id&amp;f=0&amp;auth=$permission&amp;back=$forum_id\&quot;&gt;&quot;, '&lt;/a&gt;'),
+
+			'S_SETTING_NO'		=&gt; false,
+			'S_SETTING_YES'		=&gt; $auth_setting,
+			'S_SETTING_NEVER'	=&gt; !$auth_setting,
+			'S_TOTAL_NO'		=&gt; false,
+			'S_TOTAL_YES'		=&gt; ($total == ACL_YES) ? true : false,
+			'S_TOTAL_NEVER'		=&gt; ($total == ACL_NEVER) ? true : false)
+		);
+	}
+
+	// Take founder status into account, overwriting the default values
+	if ($userdata['user_type'] == USER_FOUNDER &amp;&amp; strpos($permission, 'a_') === 0)
+	{
+		$template-&gt;assign_block_vars('trace', array(
+			'WHO'			=&gt; $userdata['username'],
+			'INFORMATION'	=&gt; $_CLASS['core_user']-&gt;lang['TRACE_USER_FOUNDER'],
+
+			'S_SETTING_NO'		=&gt; ($auth_setting == ACL_NO) ? true : false,
+			'S_SETTING_YES'		=&gt; ($auth_setting == ACL_YES) ? true : false,
+			'S_SETTING_NEVER'	=&gt; ($auth_setting == ACL_NEVER) ? true : false,
+			'S_TOTAL_NO'		=&gt; false,
+			'S_TOTAL_YES'		=&gt; true,
+			'S_TOTAL_NEVER'		=&gt; false)
+		);
+	}
+}
+
+/**
+* Get already assigned users/groups
+*/
+function retrieve_defined_user_groups($permission_scope, $forum_id, $permission_type)
+{
+	global $_CLASS;
+
+	$sql_forum_id = ($permission_scope === 'global') ? 'AND a.forum_id = 0' : ((sizeof($forum_id)) ? 'AND a.forum_id IN (' . implode(', ', $forum_id) . ')' : 'AND a.forum_id &lt;&gt; 0');
+	$sql_permission_option = &quot;AND o.auth_option LIKE '&quot; . $_CLASS['core_db']-&gt;escape($permission_type) . &quot;%'&quot;;
+
+	$sql = 'SELECT DISTINCT u.username, u.user_reg_date, u.user_id
+		FROM '. CORE_USERS_TABLE.' u, '. FORUMS_ACL_OPTIONS_TABLE .' o, '. FORUMS_ACL_TABLE .' a
+		LEFT JOIN '. FORUMS_ACL_ROLES_DATA_TABLE.&quot; r ON (a.auth_role_id = r.role_id)
+		WHERE (a.auth_option_id = o.auth_option_id OR r.auth_option_id = o.auth_option_id)
+		$sql_permission_option
+		$sql_forum_id
+		AND u.user_id = a.user_id
+		ORDER BY u.username, u.user_reg_date ASC&quot;;
+	$result = $_CLASS['core_db']-&gt;query($sql);
+
+	$s_defined_user_options = '';
+	$defined_user_ids = array();
+	while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+	{
+		$s_defined_user_options .= '&lt;option value=&quot;' . $row['user_id'] . '&quot;&gt;' . $row['username'] . '&lt;/option&gt;';
+		$defined_user_ids[] = $row['user_id'];
+	}
+	$_CLASS['core_db']-&gt;free_result($result);
+
+	$sql = 'SELECT DISTINCT g.group_type, g.group_name, g.group_id
+			FROM '.CORE_GROUPS_TABLE.' g, '. FORUMS_ACL_OPTIONS_TABLE .' o,
+			'. FORUMS_ACL_TABLE .' a
+			LEFT JOIN '. FORUMS_ACL_ROLES_DATA_TABLE .&quot; r ON (a.auth_role_id = r.role_id)
+			WHERE (a.auth_option_id = o.auth_option_id OR r.auth_option_id = o.auth_option_id)
+			$sql_permission_option
+			$sql_forum_id
 			AND g.group_id = a.group_id
-		ORDER BY g.group_type DESC, g.group_name ASC&quot;;
-	$result = $_CLASS['core_db']-&gt;query($sql);
+			ORDER BY g.group_type DESC, g.group_name ASC&quot;;
+	$result = $_CLASS['core_db']-&gt;query($sql);
+
+	$s_defined_group_options = '';
+	$defined_group_ids = array();
+	while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+	{
+		$s_defined_group_options .= '&lt;option' . (($row['group_type'] == GROUP_SPECIAL) ? ' class=&quot;sep&quot;' : '') . ' value=&quot;' . $row['group_id'] . '&quot;&gt;' . (($row['group_type'] == GROUP_SPECIAL) ? $_CLASS['core_user']-&gt;lang['G_' . $row['group_name']] : $row['group_name']) . '&lt;/option&gt;';
+		$defined_group_ids[] = $row['group_id'];
+	}
+	$_CLASS['core_db']-&gt;free_result($result);
+
+	return array(
+		'group_ids'			=&gt; $defined_group_ids,
+		'group_ids_options'	=&gt; $s_defined_group_options,
+		'user_ids'			=&gt; $defined_user_ids,
+		'user_ids_options'	=&gt; $s_defined_user_options
+	);
+}
 
-	$groups = '';
-	while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
-	{
-		echo '&lt;option' . (($row['group_type'] == GROUP_SYSTEM) ? ' class=&quot;blue&quot;' : '') . ' value=&quot;' . $row['group_id'] . '&quot;&gt;' . (isset($_CLASS['core_user']-&gt;lang['G_' . $row['group_name']]) ? $_CLASS['core_user']-&gt;lang['G_' . $row['group_name']] : $row['group_name']) . '&lt;/option&gt;';
-	}
-	$_CLASS['core_db']-&gt;free_result($result);
-
-?&gt;&lt;/select&gt;&lt;/td&gt;
-		&lt;/tr&gt;
-		&lt;tr&gt;
-			&lt;td class=&quot;cat&quot; align=&quot;center&quot;&gt;&lt;input class=&quot;btnlite&quot; type=&quot;submit&quot; name=&quot;submit_delete&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['DELETE']; ?&gt;&quot; /&gt; &nbsp; &lt;input class=&quot;btnlite&quot; type=&quot;submit&quot; name=&quot;submit_edit_options&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['SET_OPTIONS']; ?&gt;&quot; /&gt;&lt;input type=&quot;hidden&quot; name=&quot;ug_type&quot; value=&quot;group&quot; /&gt;&lt;?php echo $s_forum_id; ?&gt;&lt;/td&gt;
-		&lt;/tr&gt;
-	&lt;/table&gt;&lt;/form&gt;&lt;/td&gt;
-
-	&lt;/tr&gt;
-	&lt;tr&gt;
-
-		&lt;td&gt;&lt;form method=&quot;post&quot; action=&quot;&lt;?php echo generate_link('forums&amp;file=admin_permissions&amp;mode='.$mode, array('admin' =&gt; true)); ?&gt;&quot;&gt;&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
-			&lt;tr&gt;
-				&lt;th&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['ADD_USERS']; ?&gt;&lt;/th&gt;
-			&lt;/tr&gt;
-			&lt;tr&gt;
-				&lt;td class=&quot;row1&quot; align=&quot;center&quot;&gt;&lt;textarea style=&quot;height:60px&quot; cols=&quot;40&quot; rows=&quot;4&quot; name=&quot;ug_data[]&quot;&gt;&lt;/textarea&gt;&lt;/td&gt;
-			&lt;/tr&gt;
-			&lt;tr&gt;
-				&lt;td class=&quot;cat&quot; align=&quot;center&quot;&gt; &lt;input type=&quot;submit&quot; name=&quot;submit_add_options&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['SUBMIT']; ?&gt;&quot; class=&quot;btnmain&quot; /&gt;&nbsp; &lt;input type=&quot;reset&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['RESET']; ?&gt;&quot; class=&quot;btnlite&quot; /&gt;&nbsp; &lt;input type=&quot;submit&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['FIND_USERNAME']; ?&gt;&quot; class=&quot;btnlite&quot; onclick=&quot;window.open('&lt;?php echo generate_link('Members_List&amp;mode=searchuser&amp;form=2&amp;field=entries'); ?&gt;', '_phpbbsearch', 'HEIGHT=500,resizable=yes,scrollbars=yes,WIDTH=740');return false;&quot; /&gt;&lt;input type=&quot;hidden&quot; name=&quot;ug_type&quot; value=&quot;user&quot; /&gt;&lt;?php echo $s_forum_id; ?&gt;&lt;/td&gt;
-			&lt;/tr&gt;
-		&lt;/table&gt;&lt;/form&gt;&lt;/td&gt;
-
-		&lt;td&gt;&lt;form method=&quot;post&quot; action=&quot;&lt;?php echo generate_link('forums&amp;file=admin_permissions&amp;mode='.$mode, array('admin' =&gt; true)); ?&gt;&quot;&gt;&lt;table width=&quot;100%&quot; class=&quot;tablebg&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
-			&lt;tr&gt;
-				&lt;th&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['ADD_GROUPS']; ?&gt;&lt;/th&gt;
-			&lt;/tr&gt;
-			&lt;tr&gt;
-				&lt;td class=&quot;row1&quot; style=&quot;height: 100%&quot; align=&quot;center&quot;&gt;&lt;select style=&quot;width:280px&quot; name=&quot;ug_data[]&quot; multiple=&quot;multiple&quot;  size=&quot;5&quot;&gt;&lt;?php 
-			
-	$sql = &quot;SELECT group_id, group_name, group_type 
-		FROM &quot; . CORE_GROUPS_TABLE . &quot;
-		ORDER BY group_type DESC, group_name&quot;;
-	$result = $_CLASS['core_db']-&gt;query($sql);
-
-	$group_list = '';
-	while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
-	{
-		echo '&lt;option' . (($row['group_type'] == GROUP_SYSTEM) ? ' style=&quot;color: #006699;&quot;' : '') . ' value=&quot;' . $row['group_id'] . '&quot;&gt;' . (isset($_CLASS['core_user']-&gt;lang['G_' . $row['group_name']]) ? $_CLASS['core_user']-&gt;lang['G_' . $row['group_name']] : $row['group_name']) . '&lt;/option&gt;';
-	}
-	$_CLASS['core_db']-&gt;free_result($result);
-		
-?&gt;&lt;/select&gt;&lt;/td&gt;
-			&lt;/tr&gt;
-			&lt;tr&gt;
-				&lt;td class=&quot;cat&quot; align=&quot;center&quot;&gt; &lt;input type=&quot;submit&quot; name=&quot;submit_add_options&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['SUBMIT']; ?&gt;&quot; class=&quot;btnmain&quot; /&gt;&nbsp; &lt;input type=&quot;reset&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['RESET']; ?&gt;&quot; class=&quot;btnlite&quot; /&gt;&lt;input type=&quot;hidden&quot; name=&quot;ug_type&quot; value=&quot;group&quot; /&gt;&lt;?php echo $s_forum_id; ?&gt;&lt;/td&gt;
-			&lt;/tr&gt;
-		&lt;/table&gt;&lt;/form&gt;&lt;/td&gt;
-	&lt;/tr&gt;
-&lt;/table&gt;
-
-&lt;?php
-
-}
-// End user and group acl selections
-
-
-
-
-
-
-// Third possible form, this is the major section of this script. It
-// handles the entry of permission options for all situations
-if (in_array($submit, array('add_options', 'edit_options', 'presetsave', 'presetdel', 'update')) || !empty($submode))
-{
-
-	// Did the user specify any users or groups?
-	if (empty($ug_data))
-	{
-		$l_message = ($ug_type == 'user') ? 'NO_USER' : 'NO_GROUP';
-		trigger_error($_CLASS['core_user']-&gt;lang[$l_message]);
-	}
-
-
-	$forum_list = '';
-	// Grab the forum details if non-zero forum_id
-	if (!in_array(0, $forum_id[$which_mode]))
-	{
-		$sql = 'SELECT forum_id, forum_name, parent_id  
-			FROM ' . FORUMS_FORUMS_TABLE . &quot;
-			WHERE forum_id IN ($sql_forum_id)&quot;;
-		$result = $_CLASS['core_db']-&gt;query($sql);
-
-		if (!($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result)))
-		{
-			trigger_error($_CLASS['core_user']-&gt;lang['NO_FORUM']);
-		}
-
-		// If we have more than one forum we want a list of all their names
-		// so loop through all results. We don't need all the data though 
-		// since cascading/inheritance is only applicable if a single forum
-		// was selected
-		$forum_data = $row;
-
-		do
-		{
-			$forum_list .= (($forum_list != '') ? ', ' : '') . '&lt;b&gt;' . $row['forum_name'] . '&lt;/b&gt;';
-		}
-		while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result));
-		$_CLASS['core_db']-&gt;free_result($result);
-	}
-
-
-	// Grab relevant user or group information
-	$ug_ids = $l_ug_list = $ug_hidden = $l_no_error = '';
-// need some work ( array_mapping()) blaa blaa
-	switch ($ug_type)
-	{
-		case 'user':
-			$l_no_error = $_CLASS['core_user']-&gt;lang['NO_USER'];
-			$sql = 'SELECT user_id AS id, username AS name 
-				FROM ' . CORE_USERS_TABLE . ' 
-				WHERE ';
-			$sql .= ($submit == 'add_options') ? &quot; username IN ('&quot; . implode(&quot;', '&quot;, $_CLASS['core_db']-&gt;escape_array(array_unique(explode(&quot;\n&quot;, modify_lines($ug_data[0], &quot;\n&quot;))))) . &quot;')&quot; : ' user_id ' . ((is_array($ug_data)) ? 'IN (' . implode(', ', array_map('intval', $ug_data)) . ')' : '= ' . (int) $ug_data);
-		break;
-
-		case 'group':
-			$l_no_error = $_CLASS['core_user']-&gt;lang['NO_GROUP'];
-			$sql = 'SELECT group_id AS id, group_name AS name, group_type  
-				FROM ' . CORE_GROUPS_TABLE . '
-				WHERE group_id';
-			$sql .= (is_array($ug_data)) ? ' IN (' . implode(', ', array_map('intval', $ug_data)) . ')' : ' = ' . (int) $ug_data;
-		break;
-	}
-	$result = $_CLASS['core_db']-&gt;query($sql);
-
-	if (!$row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
-	{
-		trigger_error($l_no_error);
-	}
-	unset($l_no_error);
-
-	// Store the user_ids and names for later use
-	do 
-	{
-		$l_ug_list .= (($l_ug_list != '') ? ', ' : '') . ((isset($row['group_type']) &amp;&amp; $row['group_type'] == GROUP_SPECIAL) ? '&lt;b class=&quot;blue&quot;&gt;' . $_CLASS['core_user']-&gt;lang['G_' . $row['name']] : '&lt;b&gt;' . $row['name']) . '&lt;/b&gt;';
-		$ug_ids .= (($ug_ids != '') ? ', ' : '') . $row['id'];
-		$ug_hidden .= '&lt;input type=&quot;hidden&quot; name=&quot;ug_data[]&quot; value=&quot;' . $row['id'] . '&quot; /&gt;';
-	}
-	while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result));
-	$_CLASS['core_db']-&gt;free_result($result);
-
-
-	// Grab the list of options ... if we're in deps mode we want all options, 
-	// else we skip the master options
-	$sql_limit_option = ($mode == 'deps') ? '' : &quot;AND auth_option &lt;&gt; '&quot; . $sql_option_mode . &quot;_'&quot;;
-	$sql = &quot;SELECT auth_option_id, auth_option
-		FROM &quot; . FORUMS_ACL_OPTIONS_TABLE . &quot;
-		WHERE auth_option LIKE '&quot; . $sql_option_mode . &quot;_%' 
-			$sql_limit_option&quot;;
-	$result = $_CLASS['core_db']-&gt;query($sql);
-
-	$auth_options = array();
-	while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
-	{
-		$auth_presets_compare[] = $row['auth_option'];
-		$auth_options[] = $row;
-	}
-	$_CLASS['core_db']-&gt;free_result($result);
-
-	unset($sql_limit_option);
-
-
-	// Now we'll build a list of preset options ...
-	$preset_options = $preset_js = $preset_update_options = '';
-
-	// Do we have a parent forum? If so offer option to inherit from that
-	if ($forum_data['parent_id'] != 0)
-	{
-		$holding['yes'] = $holding['no'] = $holding['unset'] = '';
-
-		 
-		$sql = &quot;SELECT o.auth_option, a.auth_setting
-					FROM &quot; . FORUMS_ACL_TABLE . &quot; a, &quot; . FORUMS_ACL_OPTIONS_TABLE . &quot; o 
-					WHERE o.auth_option LIKE '&quot; . $sql_option_mode . &quot;_%' 
-						AND a.auth_option_id = o.auth_option_id AND a.forum_id = &quot; . $forum_data['parent_id'] . '
-						AND a.'.(($ug_type == 'group') ? 'group_id' : 'user_id').&quot; IN ($ug_ids)&quot;;
-
-		$result = $_CLASS['core_db']-&gt;query($sql);
-
-		if ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
-		{
-			do
-			{
-				switch ($row['auth_setting'])
-				{
-					case ACL_YES:
-						$holding['yes'][] = $row['auth_option'];
-					break;
-
-					case ACL_NO:
-						$holding['no'][] = $row['auth_option'];
-					break;
-				}
-			}
-			while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result));
-
-			$holding['unset'] = array_diff($auth_presets_compare, $holding['yes'], $holding['no']);
-
-			$preset_options .= '&lt;option value=&quot;preset_0&quot;&gt;' . $_CLASS['core_user']-&gt;lang['INHERIT_PARENT'] . '&lt;/option&gt;';
-			$preset_js .= &quot;\tpresets['preset_0'] = new Array();&quot; . &quot;\n&quot;;
-			$preset_js .= &quot;\tpresets['preset_0'] = new preset_obj('&quot; . implode(', ', $holding['yes']) . &quot;', '&quot; . implode(', ', $holding['no']) . &quot;', '&quot; . implode(', ', $holding['unset']) . &quot;');\n&quot;;
-
-		}
-		$_CLASS['core_db']-&gt;free_result($result);
-	}
-
-	$holding['yes'] = $holding['no'] = $holding['unset'] = '';
-
-	// Look for custom presets
-	$sql = &quot;SELECT preset_id, preset_name, preset_data  
-		FROM &quot; . FORUMS_ACL_PRESETS_TABLE . &quot; 
-		WHERE preset_type = '&quot; . (($mode == 'deps') ? 'f' : $sql_option_mode) . &quot;' 
-		ORDER BY preset_id ASC&quot;;
-	$result = $_CLASS['core_db']-&gt;query($sql);
-
-	if ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
-	{
-		do
-		{
-			$preset_update_options .= '&lt;option value=&quot;' . $row['preset_id'] . '&quot;&gt;' . $row['preset_name'] . '&lt;/option&gt;';
-			$preset_options .= '&lt;option value=&quot;preset_' . $row['preset_id'] . '&quot;&gt;' . $row['preset_name'] . '&lt;/option&gt;';
-
-			$holding = unserialize($row['preset_data']);
-			$holding['unset'] = array_diff($auth_presets_compare, $holding['yes'], $holding['no']);
-
-			$preset_js .= &quot;\tpresets['preset_&quot; . $row['preset_id'] . &quot;'] = new Array();&quot; . &quot;\n&quot;;
-			$preset_js .= &quot;\tpresets['preset_&quot; . $row['preset_id'] . &quot;'] = new preset_obj('&quot; . implode(', ', $holding['yes']) . &quot;', '&quot; . implode(', ', $holding['no']) . &quot;', '&quot; . implode(', ', $holding['unset']) . &quot;');\n&quot;;
-		}
-		while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result));
-	}
-	$_CLASS['core_db']-&gt;free_result($result);
-
-	unset($holding, $auth_presets_compare);
-
-
-	// If we aren't looking @ deps then we try and grab existing sessions for
-	// the given forum and user/group
-	if (!is_array($auth_settings) || empty($auth_settings[$which_mode]))
-	{
-		if ($which_mode == $mode)
-		{
-			$sql = 'SELECT o.auth_option, MIN(a.auth_setting) AS min_auth_setting 
-					FROM '. FORUMS_ACL_TABLE .' a, ' . FORUMS_ACL_OPTIONS_TABLE . &quot; o 
-					WHERE o.auth_option LIKE '&quot; . $sql_option_mode . &quot;_%' 
-						AND a.auth_option_id = o.auth_option_id 
-						AND a.forum_id IN ($sql_forum_id) 
-						AND a.&quot;.(($ug_type == 'group') ? 'group_id' : 'user_id').&quot; IN ($ug_ids)
-					GROUP BY o.auth_option&quot;;
-			$result = $_CLASS['core_db']-&gt;query($sql);
-
-			$auth_settings[$which_mode] = array();
-			while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
-			{
-				$auth_settings[$which_mode][$row['auth_option']] = $row['min_auth_setting'];
-			}
-			$_CLASS['core_db']-&gt;free_result($result);
-		}
-		else
-		{
-			// We're looking at a view ... so we'll set all options to unset
-			// We could be a little more clever here but the &quot;safe side&quot; looks
-			// better right now
-			$auth_settings[$which_mode] = array();
-			foreach ($auth_options as $option)
-			{
-				$auth_settings[$which_mode][$option['auth_option']] = '*';
-			}
-			unset($option);
-		}
-	}
-
-	$view_options = '';
-	// Should we display a dropdown for views?
-	if (in_array($mode, array('admin', 'supermod', 'mod')))
-	{
-		$view_options .= '&lt;option value=&quot;&quot;&gt;' . $_CLASS['core_user']-&gt;lang['SELECT_VIEW'] . '&lt;/option&gt;';
-		$view_ary = array(
-			'admin'		=&gt; array('admin' =&gt; 'a_', 'forum' =&gt; 'a_auth', 'supermod' =&gt; 'a_authmods', 'mod' =&gt; 'a_authmods'),
-			'supermod'	=&gt; array('supermod' =&gt; 'a_authmods', 'mod' =&gt; 'a_authmods', 'forum' =&gt; 'a_auth'), 
-			'mod'		=&gt; array('mod' =&gt; 'a_authmods', 'forum' =&gt; 'a_auth')
-		);
-
-		foreach ($view_ary[$mode] as $which_submode =&gt; $which_acl)
-		{
-			if ($_CLASS['auth']-&gt;acl_get($which_acl))
-			{
-				$view_options .= '&lt;option value=&quot;' . $which_submode . '&quot;' . (($which_submode == $which_mode) ? ' selected=&quot;selected&quot;' : '') . '&gt;' . $_CLASS['core_user']-&gt;lang['ACL_VIEW_' . strtoupper($which_submode)] . '&lt;/option&gt;';
-			}
-
-		}
-		unset($view_ary);
-	}
-
-	$settings_hidden = '';
-	// Output original settings ... needed when we jump views
-	foreach ($auth_settings as $auth_submode =&gt; $auth_submode_settings)
-	{
-		if ($auth_submode != $which_mode)
-		{
-			foreach ($auth_submode_settings as $submode_option =&gt; $submode_setting)
-			{
-				$settings_hidden .= ($submode_setting != '*') ? '&lt;input type=&quot;hidden&quot; name=&quot;settings[' . $auth_submode . '][' . $submode_option . ']&quot; value=&quot;' . $submode_setting . '&quot; /&gt;' : '';
-			}
-		}
-	}
-	unset($auth_submode, $auth_submode_settings, $auth_submode_option, $auth_submode_setting);
-
-?&gt;
-
-&lt;script language=&quot;Javascript&quot; type=&quot;text/javascript&quot;&gt;
-&lt;!--
-
-	var presets = new Array();
-&lt;?php
-
-	echo $preset_js;
-
-?&gt;
-
-	function preset_obj(yes, no, unset)
-	{
-		this.yes = yes;
-		this.no = no;
-		this.unset = unset;
-	}
-
-	function use_preset(option)
-	{
-		if (option)
-		{
-			document.acl.set.selectedIndex = 0;
-			for (i = 0; i &lt; document.acl.length; i++)
-			{
-				var elem = document.acl.elements[i];
-				if (elem.name.indexOf('settings') == 0)
-				{
-					switch (option)
-					{
-						case 'all_yes':
-							if (elem.value == &lt;?php echo ACL_YES; ?&gt;)
-								elem.checked = true;
-							break;
-
-						case 'all_no':
-							if (elem.value == &lt;?php echo ACL_NO; ?&gt;)
-								elem.checked = true;
-							break;
-
-						case 'all_unset':
-							if (elem.value == &lt;?php echo ACL_UNSET; ?&gt;)
-								elem.checked = true;
-							break;
-
-						case 'all_ignore':
-							if (elem.value == '*')
-								elem.checked = true;
-							break;
-
-						default:
-							option_start = elem.name.search(/\[(\w+?)\]$/);
-							option_name = elem.name.substr(option_start + 1, elem.name.length - option_start - 2);
-
-							if (presets[option].yes.indexOf(option_name + ',') != -1 &amp;&amp; elem.value == &lt;?php echo ACL_YES; ?&gt;)
-								elem.checked = true;
-							else if (presets[option].no.indexOf(option_name + ',') != -1 &amp;&amp; elem.value == &lt;?php echo ACL_NO; ?&gt;)
-								elem.checked = true;
-							else if (presets[option].unset.indexOf(option_name + ',') != -1 &amp;&amp; elem.value == &lt;?php echo ACL_UNSET; ?&gt;)
-								elem.checked = true;
-							break;
-					}
-				}
-			}
-		}
-	}
-
-	function marklist(match, status)
-	{
-		for (i = 0; i &lt; document.acl.length; i++)
-		{
-			if (document.acl.elements[i].name.indexOf(match) == 0)
-				document.acl.elements[i].checked = status;
-		}
-	}
-
-	function open_win(url, width, height)
-	{
-		aclwin = window.open(url, '_phpbbacl', 'HEIGHT=' + height + ',resizable=yes, scrollbars=yes,WIDTH=' + width);
-		if (window.focus)
-			aclwin.focus();
-	}
-//--&gt;
-&lt;/script&gt;
-
-&lt;p&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['ACL_EXPLAIN']; ?&gt;&lt;/p&gt;
-
-&lt;h1&gt;&lt;?php echo $l_title; ?&gt;&lt;/h1&gt;
-
-&lt;?php
-
-	// Do we have a list of forums? If so, output them ... but only
-	// if we're looking at the primary view or mode ... submodes
-	// output their own list of forums as and where applicable so this
-	// is unnecessary
-	if ($forum_list != '' &amp;&amp; $which_mode == $mode)
-	{
-		$l_selected_forums = (count($forum_id[$which_mode]) === 1) ? 'SELECTED_FORUM' : 'SELECTED_FORUMS';
-
-		echo '&lt;p&gt;' . $_CLASS['core_user']-&gt;lang[$l_selected_forums] . ': ' . $forum_list . '&lt;/p&gt;';
-
-		unset($forum_list);
-		unset($l_selected_forums);
-	}
-
-	// Now output the list of users or groups ... these will always exist
-	$l_selected_users = ($ug_type == 'user') ? ((count($ug_data) === 1) ? 'SELECTED_USER' : 'SELECTED_USERS') : ((count($ug_data) === 1) ? 'SELECTED_GROUP' : 'SELECTED_GROUPS'); 
-
-	echo '&lt;p&gt;' . $_CLASS['core_user']-&gt;lang[$l_selected_users] . ': ' . $l_ug_list . '&lt;/p&gt;';
-
-	unset($l_selected_users);
-	unset($ug_data);
-
-?&gt;
-
-&lt;p&gt;&lt;?php echo $l_title_explain; ?&gt;&lt;/p&gt;
-
-&lt;?php
-
-	if ($settings_hidden != '')
-	{
-
-?&gt;
-
-&lt;h2 style=&quot;color:red&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['WARNING']; ?&gt;&lt;/h2&gt;
-
-&lt;p&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['WARNING_EXPLAIN']; ?&gt;&lt;/p&gt;
-
-&lt;?php
-
-	}
-
-?&gt;
-
-&lt;form method=&quot;post&quot; name=&quot;acl&quot; action=&quot;&lt;?php echo generate_link('forums&amp;file=admin_permissions&amp;mode='.$mode.'&amp;submode='.$submode, array('admin' =&gt; true)); ?&gt;&quot;&gt;&lt;table cellspacing=&quot;2&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
-&lt;?php
-
-	// This is the main listing of options
-
-	// We output this for both deps and when update is requested where
-	// deps exist
-	if (($mode == 'admin' || $mode == 'supermod') &amp;&amp; in_array($submode, array('forum', 'mod')))
-	{
-
-?&gt;
-	&lt;tr&gt;
-		&lt;td colspan=&quot;2&quot; align=&quot;right&quot;&gt;&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot;&gt;
-			&lt;tr&gt;
-				&lt;th colspan=&quot;2&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['SELECT_FORUM']; ?&gt;&lt;/th&gt;
-			&lt;/tr&gt;
-			&lt;tr&gt;
-				&lt;td class=&quot;row1&quot; colspan=&quot;2&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['WILL_SET_OPTIONS']; ?&gt;:&lt;/th&gt;
-			&lt;/tr&gt;
-			&lt;tr&gt;
-				&lt;td class=&quot;row2&quot;&gt;&lt;select style=&quot;width:100%&quot; name=&quot;f[&lt;?php echo $which_mode; ?&gt;][]&quot; multiple=&quot;7&quot;&gt;&lt;?php 
-		
-		echo make_forum_select($forum_id[$which_mode], false, true); 
-		
-?&gt;&lt;/select&gt;&lt;/td&gt;
-			&lt;/tr&gt;
-		&lt;/table&gt;&lt;br /&gt;&lt;/td&gt;
-	&lt;/tr&gt;
-&lt;?php
-
-	}
-	// End deps output
-
-?&gt;
-	&lt;tr&gt;
-		&lt;td align=&quot;left&quot;&gt;&lt;?php
-	
-	if ($view_options != '')
-	{
-	
-?&gt;&lt;select name=&quot;submode&quot; onchange=&quot;if (this.options[this.selectedIndex].value != '') this.form.submit();&quot;&gt;&lt;?php echo $view_options; ?&gt;&lt;/select&gt;&lt;?php
-	
-	}
-	
-?&gt;&lt;/td&gt;
-		&lt;td align=&quot;right&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['PRESETS']; ?&gt;: &lt;select name=&quot;set&quot; onchange=&quot;use_preset(this.options[this.selectedIndex].value);&quot;&gt;&lt;option class=&quot;sep&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['SELECT'] . ' -&gt;'; ?&gt;&lt;/option&gt;&lt;option value=&quot;all_yes&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['ALL_YES']; ?&gt;&lt;/option&gt;&lt;option value=&quot;all_no&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['ALL_NO']; ?&gt;&lt;/option&gt;&lt;option value=&quot;all_unset&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['ALL_UNSET']; ?&gt;&lt;/option&gt;&lt;?php 
-
-	$colspan = 4;
-	if ($which_mode != $mode)
-	{
-		$colspan = 5;
-		echo '&lt;option value=&quot;all_ignore&quot;&gt;' . $_CLASS['core_user']-&gt;lang['ALL_IGNORE'] . '&lt;/option&gt;';
-	}
-
-	// Output user preset options ... if any
-	echo ($preset_options) ? '&lt;option class=&quot;sep&quot;&gt;' . $_CLASS['core_user']-&gt;lang['USER_PRESETS'] . ' -&gt;' . '&lt;/option&gt;' . $preset_options : ''; 
-
-?&gt;&lt;/select&gt;&lt;/td&gt;
-	&lt;/tr&gt;
-	&lt;tr&gt;
-		&lt;td colspan=&quot;2&quot;&gt;&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
-			&lt;tr&gt;
-				&lt;th&gt;&nbsp;&lt;?php echo $_CLASS['core_user']-&gt;lang['OPTION']; ?&gt;&nbsp;&lt;/th&gt;
-				&lt;th width=&quot;50&quot;&gt;&nbsp;&lt;?php echo $_CLASS['core_user']-&gt;lang['YES']; ?&gt;&nbsp;&lt;/th&gt;
-				&lt;th width=&quot;50&quot;&gt;&nbsp;&lt;?php echo $_CLASS['core_user']-&gt;lang['UNSET']; ?&gt;&nbsp;&lt;/th&gt;
-				&lt;th width=&quot;50&quot;&gt;&nbsp;&lt;?php echo $_CLASS['core_user']-&gt;lang['NO']; ?&gt;&nbsp;&lt;/th&gt;
-&lt;?php
-
-	if ($which_mode != $mode)
-	{
-
-?&gt;
-				&lt;th width=&quot;50&quot;&gt;&nbsp;&lt;?php echo $_CLASS['core_user']-&gt;lang['IGNORE']; ?&gt;&nbsp;&lt;/th&gt;
-&lt;?php
-
-	}
-
-?&gt;
-			&lt;/tr&gt;
-&lt;?php
-
-	$row_class = 'row2';
-
-	$count = count($auth_options);
-	for ($i = 0; $i &lt; $count; $i++)
-	{
-		$row_class = ($row_class == 'row1') ? 'row2' : 'row1';
-
-		// Try and output correct language strings, else output prettyfied auth_option
-		$l_auth_option = (!empty($_CLASS['core_user']-&gt;lang['acl_' . $auth_options[$i]['auth_option']])) ? $_CLASS['core_user']-&gt;lang['acl_' . $auth_options[$i]['auth_option']] : ucfirst(preg_replace('#.*?_#', '', $auth_options[$i]['auth_option']));
-		$s_auth_option = '[' . $which_mode . '][' . $auth_options[$i]['auth_option'] . ']';
-		
-		// Which option should we select?
-		$selected_yes = (isset($auth_settings[$which_mode][$auth_options[$i]['auth_option']]) &amp;&amp; $auth_settings[$which_mode][$auth_options[$i]['auth_option']] == ACL_YES) ? ' checked=&quot;checked&quot;' : '';
-		$selected_no = (isset($auth_settings[$which_mode][$auth_options[$i]['auth_option']]) &amp;&amp; $auth_settings[$which_mode][$auth_options[$i]['auth_option']] == ACL_NO) ? ' checked=&quot;checked&quot;' : '';
-		$selected_unset = (!isset($auth_settings[$which_mode][$auth_options[$i]['auth_option']]) || $auth_settings[$which_mode][$auth_options[$i]['auth_option']] == ACL_UNSET) ? ' checked=&quot;checked&quot;' : '';
-
-?&gt;
-			&lt;tr&gt;
-				&lt;td class=&quot;&lt;?php echo $row_class; ?&gt;&quot; nowrap=&quot;nowrap&quot;&gt;&lt;?php echo $l_auth_option; ?&gt;&nbsp;&lt;/td&gt;
-				&lt;td class=&quot;&lt;?php echo $row_class; ?&gt;&quot; align=&quot;center&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;settings&lt;?php echo $s_auth_option ;?&gt;&quot; value=&quot;&lt;?php echo ACL_YES; ?&gt;&quot;&lt;?php echo $selected_yes; ?&gt; /&gt;&lt;/td&gt;
-				&lt;td class=&quot;&lt;?php echo $row_class; ?&gt;&quot; align=&quot;center&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;settings&lt;?php echo $s_auth_option ;?&gt;&quot; value=&quot;&lt;?php echo ACL_UNSET; ?&gt;&quot;&lt;?php echo $selected_unset; ?&gt; /&gt;&lt;/td&gt;
-				&lt;td class=&quot;&lt;?php echo $row_class; ?&gt;&quot; align=&quot;center&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;settings&lt;?php echo $s_auth_option ;?&gt;&quot; value=&quot;&lt;?php echo ACL_NO; ?&gt;&quot;&lt;?php echo $selected_no; ?&gt; /&gt;&lt;/td&gt;
-&lt;?php
-
-		if ($which_mode != $mode)
-		{
-			$selected_ignore = (isset($auth_settings[$which_mode][$auth_options[$i]['auth_option']]) &amp;&amp; $auth_settings[$which_mode][$auth_options[$i]['auth_option']] == '*') ? ' checked=&quot;checked&quot;' : '';
-
-?&gt;
-				&lt;td class=&quot;&lt;?php echo $row_class; ?&gt;&quot; align=&quot;center&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;settings&lt;?php echo $s_auth_option ;?&gt;&quot; value=&quot;*&quot;&lt;?php echo $selected_ignore; ?&gt; /&gt;&lt;/td&gt;
-&lt;?php
-
-		}
-
-?&gt;
-			&lt;/tr&gt;
-&lt;?php
-
-	}
-
-
-	// If we're setting forum or moderator options and a single forum has
-	// been selected then look to see if any subforums exist. If they do
-	// give user the option of cascading permissions to them
-	if (($mode == 'forum' || $mode == 'mod') &amp;&amp; empty($submode) &amp;&amp; count($forum_id[$which_mode]) === 1)
-	{
-		$children = get_forum_branch($forum_id[$which_mode][0], 'children', 'descending', false);
-
-		if (!empty($children))
-		{
-
-?&gt;
-			&lt;tr&gt;
-				&lt;th colspan=&quot;&lt;?php echo $colspan; ?&gt;&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['ACL_SUBFORUMS']; ?&gt;&lt;/th&gt;
-			&lt;/tr&gt;
-			&lt;tr&gt;
-				&lt;td class=&quot;row1&quot; colspan=&quot;&lt;?php echo $colspan; ?&gt;&quot;&gt;&lt;table width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;0&quot; border=&quot;0&quot;&gt;
-					&lt;tr&gt;
-						&lt;td class=&quot;gensmall&quot; colspan=&quot;4&quot; height=&quot;16&quot; align=&quot;center&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['ACL_SUBFORUMS_EXPLAIN']; ?&gt;&lt;/td&gt;
-					&lt;/tr&gt;
-&lt;?php
-
-			foreach ($children as $row)
-			{
-
-?&gt;
-					&lt;tr&gt;
-						&lt;td&gt;&lt;input type=&quot;checkbox&quot; name=&quot;inherit[]&quot; value=&quot;&lt;?php echo $row['forum_id']; ?&gt;&quot; /&gt; &lt;?php echo $row['forum_name']; ?&gt;&lt;/td&gt;
-					&lt;/tr&gt;
-&lt;?php
-
-			}
-
-?&gt;
-					&lt;tr&gt;
-						&lt;td height=&quot;16&quot; align=&quot;center&quot;&gt;&lt;a class=&quot;gensmall&quot; href=&quot;javascript:marklist('inherit', true);&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['MARK_ALL']; ?&gt;&lt;/a&gt; :: &lt;a href=&quot;javascript:marklist('inherit', false);&quot; class=&quot;gensmall&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['UNMARK_ALL']; ?&gt;&lt;/a&gt;&lt;/td&gt;
-					&lt;/tr&gt;
-				&lt;/table&gt;&lt;/td&gt;
-			&lt;/tr&gt;
-&lt;?php
-
-		}
-	}
-
-	// Display event/cron radio buttons
-	if ($_CLASS['auth']-&gt;acl_gets('a_events', 'a_cron') &amp;&amp; $mode != 'deps' &amp;&amp; $submit != 'update')
-	{
-		$row_class = ($row_class == 'row1') ? 'row2' : 'row1';
-
-?&gt;
-			&lt;!-- tr&gt;
-				&lt;th colspan=&quot;&lt;?php echo $colspan; ?&gt;&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['RUN_HOW']; ?&gt;&lt;/th&gt;
-			&lt;/tr&gt;
-			&lt;tr&gt;
-				&lt;td class=&quot;&lt;?php echo $row_class; ?&gt;&quot; colspan=&quot;4&quot; align=&quot;center&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;runas&quot; value=&quot;now&quot; checked=&quot;checked&quot; /&gt; &lt;?php echo $_CLASS['core_user']-&gt;lang['RUN_AS_NOW']; ?&gt;&lt;?php 
-	
-			if ($_CLASS['auth']-&gt;acl_get('a_events'))
-			{ 
-
-?&gt; &nbsp;&lt;input type=&quot;radio&quot; name=&quot;runas&quot; value=&quot;evt&quot; /&gt; &lt;?php 
-	
-				echo $_CLASS['core_user']-&gt;lang['RUN_AS_EVT'];  
-			}
-			
-			if ($_CLASS['auth']-&gt;acl_get('a_cron'))
-			{
-
-?&gt; &nbsp;&lt;input type=&quot;radio&quot; name=&quot;runas&quot; value=&quot;crn&quot; /&gt; &lt;?php 
-	
-				echo $_CLASS['core_user']-&gt;lang['RUN_AS_CRN']; 
-				
-			}
-
-?&gt;&lt;/td&gt;
-			&lt;/tr --&gt;
-&lt;?php
-
-	}
-
-?&gt;
-			&lt;tr&gt;
-				&lt;td class=&quot;cat&quot; colspan=&quot;&lt;?php echo $colspan; ?&gt;&quot; align=&quot;center&quot;&gt;&lt;input class=&quot;btnmain&quot; type=&quot;submit&quot; name=&quot;submit_update&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['UPDATE']; ?&gt;&quot; /&gt;&nbsp;&nbsp;&lt;input class=&quot;btnlite&quot; type=&quot;submit&quot; name=&quot;submit_cancel&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['CANCEL']; ?&gt;&quot; /&gt;&lt;input type=&quot;hidden&quot; name=&quot;ug_type&quot; value=&quot;&lt;?php echo $ug_type; ?&gt;&quot; /&gt;&lt;?php echo $ug_hidden; ?&gt;&lt;?php 
-
-	// Output forum id data
-	echo $s_forum_id;
-
-	// Output settings generated from other views
-	echo $settings_hidden;
-	unset($settings_hidden);
-	
-?&gt;&lt;/td&gt;
-			&lt;/tr&gt;
-		&lt;/table&gt;
-
-		&lt;br clear=&quot;all&quot; /&gt;
-
-		&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
-			&lt;tr&gt;
-				&lt;th colspan=&quot;4&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['PRESETS']; ?&gt;&lt;/th&gt;
-			&lt;/tr&gt;
-			&lt;tr&gt;
-				&lt;td class=&quot;row1&quot; colspan=&quot;4&quot;&gt;&lt;table width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;0&quot; border=&quot;0&quot;&gt;
-					&lt;tr&gt;
-						&lt;td colspan=&quot;2&quot; height=&quot;16&quot;&gt;&lt;span class=&quot;gensmall&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['PRESETS_EXPLAIN']; ?&gt;&lt;/span&gt;&lt;/td&gt;
-					&lt;/tr&gt;
-					&lt;tr&gt;
-						&lt;td nowrap=&quot;nowrap&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['SELECT_PRESET']; ?&gt;: &lt;/td&gt;
-						&lt;td&gt;&lt;select name=&quot;presetoption&quot;&gt;&lt;option class=&quot;sep&quot; value=&quot;-1&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['SELECT'] . ' -&gt;'; ?&gt;&lt;/option&gt;&lt;?php 
-
-	echo $preset_update_options;
-			
-		?&gt;&lt;/select&gt;&lt;/td&gt;
-					&lt;/tr&gt;
-					&lt;tr&gt;
-						&lt;td nowrap=&quot;nowrap&quot;&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['PRESET_NAME']; ?&gt;: &lt;/td&gt;
-						&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;presetname&quot; maxlength=&quot;25&quot; /&gt; &lt;/td&gt;
-					&lt;/tr&gt;
-				&lt;/table&gt;&lt;/td&gt;
-			&lt;/tr&gt;
-			&lt;tr&gt;
-				&lt;td class=&quot;cat&quot; colspan=&quot;4&quot; align=&quot;center&quot;&gt;&lt;input class=&quot;btnlite&quot; type=&quot;submit&quot; name=&quot;submit_presetsave&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['SAVE']; ?&gt;&quot; /&gt; &nbsp;&lt;input class=&quot;btnlite&quot; type=&quot;submit&quot; name=&quot;submit_presetdel&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['DELETE']; ?&gt;&quot; /&gt;&lt;/td&gt;
-			&lt;/tr&gt;
-		&lt;/table&gt;&lt;/td&gt;
-	&lt;/tr&gt;
-&lt;/table&gt;&lt;/form&gt;
-
-&lt;?php
-
-}
-
-// Output page footer
-adm_page_footer();
-
-// ---------
-// FUNCTIONS
-//
-function update_foes()
-{
-	global $_CLASS;
-
-	$perms = array();
-	foreach ($_CLASS['auth']-&gt;acl_get_list(false, array('a_', 'm_'), false) as $forum_id =&gt; $forum_ary)
-	{
-		foreach ($forum_ary as $auth_option =&gt; $user_ary)
-		{
-			$perms += $user_ary;
-		}
-	}
-
-	if (!empty($perms))
-	{
-		$sql = 'DELETE FROM ' . ZEBRA_TABLE . ' 
-			WHERE zebra_id IN (' . implode(', ', $perms) . ')';
-		$_CLASS['core_db']-&gt;query($sql);
-	}
-	unset($perms);
-}
-//
-// FUNCTIONS
-// ---------
-
 ?&gt;
\ No newline at end of file

Added: cms/trunk/includes/forums/admin/auth.php
===================================================================
--- cms/trunk/includes/forums/admin/auth.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/forums/admin/auth.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,1224 @@
+&lt;?php
+/** 
+*
+* @package phpBB3
+* @version $Id: auth.php,v 1.26 2006/08/12 19:06:09 grahamje Exp $ 
+* @copyright (c) 2005 phpBB Group 
+* @license <A HREF="http://opensource.org/licenses/gpl-license.php">http://opensource.org/licenses/gpl-license.php</A> GNU Public License 
+*
+*/
+
+/**
+*/
+
+/**
+* ACP Permission/Auth class
+* @package phpBB3
+*/
+class forums_auth_admin extends forums_auth
+{
+	var $option_ids = array();
+
+	/**
+	* Init auth settings
+	*/
+	function forums_auth_admin()
+	{
+		global $_CLASS;
+
+		$this-&gt;acl_options = $_CLASS['core_cache']-&gt;get('acl_options');
+
+		if (is_null($this-&gt;acl_options))
+		{
+			$sql = 'SELECT auth_option, auth_option_id, is_global, is_local
+				FROM ' . FORUMS_ACL_OPTIONS_TABLE . '
+				ORDER BY auth_option_id';
+			$result = $_CLASS['core_db']-&gt;query($sql);
+
+			$global = $local = 0;
+			$this-&gt;acl_options = array();
+			while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+			{
+				if ($row['is_global'])
+				{
+					$this-&gt;acl_options['global'][$row['auth_option']] = $global++;
+				}
+
+				if ($row['is_local'])
+				{
+					$this-&gt;acl_options['local'][$row['auth_option']] = $local++;
+				}
+				
+				$this-&gt;option_ids[$row['auth_option']] = $row['auth_option_id'];
+			}
+			$_CLASS['core_db']-&gt;free_result($result);
+
+			$_CLASS['core_cache']-&gt;put('acl_options', $this-&gt;acl_options);
+			$_CLASS['core_cache']-&gt;put('acl_option_ids', $this-&gt;option_ids);
+		}
+		else
+		{
+			$this-&gt;option_ids = $_CLASS['core_cache']-&gt;get('acl_option_ids');
+
+			if (is_null($this-&gt;option_ids))
+			{
+				$sql = 'SELECT auth_option_id, auth_option
+					FROM ' . FORUMS_ACL_OPTIONS_TABLE;
+				$result = $_CLASS['core_db']-&gt;query($sql);
+	
+				$this-&gt;option_ids = array();
+				while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+				{
+					$this-&gt;option_ids[$row['auth_option']] = $row['auth_option_id'];
+				}
+				$_CLASS['core_db']-&gt;free_result($result);
+
+				$_CLASS['core_cache']-&gt;put('acl_option_ids', $this-&gt;option_ids);
+			}
+		}
+	}
+	
+	/**
+	* Get permission mask
+	* This function only supports getting permissions of one type (for example a_)
+	*
+	* @param set|view $mode defines the permissions we get, view gets effective permissions (checking user AND group permissions), set only gets the user or group permission set alone
+	* @param mixed $user_id user ids to search for (a user_id or a group_id has to be specified at least)
+	* @param mixed $group_id group ids to search for, return group related settings (a user_id or a group_id has to be specified at least)
+	* @param mixed $forum_id forum_ids to search for. Defining a forum id also means getting local settings
+	* @param string $auth_option the auth_option defines the permission setting to look for (a_ for example)
+	* @param local|global $scope the scope defines the permission scope. If local, a forum_id is additionally required
+	* @param ACL_NEVER|ACL_NO|ACL_YES $acl_fill defines the mode those permissions not set are getting filled with
+	*/
+	function get_mask($mode, $user_id = false, $group_id = false, $forum_id = false, $auth_option = false, $scope = false, $acl_fill = ACL_NEVER)
+	{
+		global $_CLASS;
+
+		$hold_ary = array();
+		$view_user_mask = ($mode == 'view' &amp;&amp; $group_id === false) ? true : false;
+
+		if ($auth_option === false || $scope === false)
+		{
+			return array();
+		}
+
+		$acl_user_function = ($mode == 'set') ? 'acl_user_raw_data' : 'acl_raw_data';
+
+		if (!$view_user_mask)
+		{
+			if ($forum_id !== false)
+			{
+				$hold_ary = ($group_id !== false) ? $this-&gt;acl_group_raw_data($group_id, $auth_option . '%', $forum_id) : $this-&gt;$acl_user_function($user_id, $auth_option . '%', $forum_id);
+			}
+			else
+			{
+				$hold_ary = ($group_id !== false) ? $this-&gt;acl_group_raw_data($group_id, $auth_option . '%', ($scope == 'global') ? 0 : false) : $this-&gt;$acl_user_function($user_id, $auth_option . '%', ($scope == 'global') ? 0 : false);
+			}
+		}
+
+		// Make sure hold_ary is filled with every setting (prevents missing forums/users/groups)
+		$ug_id = ($group_id !== false) ? ((!is_array($group_id)) ? array($group_id) : $group_id) : ((!is_array($user_id)) ? array($user_id) : $user_id);
+		$forum_ids = ($forum_id !== false) ? ((!is_array($forum_id)) ? array($forum_id) : $forum_id) : (($scope == 'global') ? array(0) : array());
+
+		// Only those options we need
+		$compare_options = array_diff(preg_replace('/^((?!' . $auth_option . ').+)|(' . $auth_option . ')$/', '', array_keys($this-&gt;acl_options[$scope])), array(''));
+
+		// If forum_ids is false and the scope is local we actually want to have all forums within the array
+		if ($scope == 'local' &amp;&amp; !sizeof($forum_ids))
+		{
+			$sql = 'SELECT forum_id 
+				FROM ' . FORUMS_FORUMS_TABLE;
+			$result = $_CLASS['core_db']-&gt;query($sql, 120);
+
+			while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+			{
+				$forum_ids[] = $row['forum_id'];
+			}
+			$_CLASS['core_db']-&gt;free_result($result);
+		}
+
+		if ($view_user_mask)
+		{
+			$auth2 = null;
+
+			$sql = 'SELECT user_id, user_permissions, user_type
+				FROM ' . CORE_USERS_TABLE . '
+				WHERE user_id IN ('.implode(', ',$ug_id).')';
+			$result = $_CLASS['core_db']-&gt;query($sql);
+
+			while ($userdata = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+			{
+				if ($_CLASS['core_user']-&gt;data['user_id'] != $userdata['user_id'])
+				{
+					$auth2 = new auth();
+					$auth2-&gt;acl($userdata);
+				}
+				else
+				{
+					global $auth;
+					$auth2 = &amp;$auth;
+				}
+
+				
+				$hold_ary[$userdata['user_id']] = array();
+				foreach ($forum_ids as $f_id)
+				{
+					$hold_ary[$userdata['user_id']][$f_id] = array();
+					foreach ($compare_options as $option)
+					{
+						$hold_ary[$userdata['user_id']][$f_id][$option] = $auth2-&gt;acl_get($option, $f_id);
+					}
+				}
+			}
+			$_CLASS['core_db']-&gt;free_result($result);
+
+			unset($userdata);
+			unset($auth2);
+		}
+
+		foreach ($ug_id as $_id)
+		{
+			if (!isset($hold_ary[$_id]))
+			{
+				$hold_ary[$_id] = array();
+			}
+
+			foreach ($forum_ids as $f_id)
+			{
+				if (!isset($hold_ary[$_id][$f_id]))
+				{
+					$hold_ary[$_id][$f_id] = array();
+				}
+			}
+		}
+
+		// Now, we need to fill the gaps with $acl_fill. ;)
+
+		// Now switch back to keys
+		if (sizeof($compare_options))
+		{
+			$compare_options = array_combine($compare_options, array_fill(1, sizeof($compare_options), $acl_fill));
+		}
+
+		// Defining the user-function here to save some memory
+		$return_acl_fill = create_function('$value', 'return ' . $acl_fill . ';');
+
+		// Actually fill the gaps
+		if (sizeof($hold_ary))
+		{
+			foreach ($hold_ary as $ug_id =&gt; $row)
+			{
+				foreach ($row as $id =&gt; $options)
+				{
+					// Do not include the global auth_option
+					unset($options[$auth_option]);
+
+					// Not a &quot;fine&quot; solution, but at all it's a 1-dimensional 
+					// array_diff_key function filling the resulting array values with zeros
+					// The differences get merged into $hold_ary (all permissions having $acl_fill set)
+					$hold_ary[$ug_id][$id] = array_merge($options, 
+
+						array_map($return_acl_fill,
+							array_flip(
+								array_diff(
+									array_keys($compare_options), array_keys($options)
+								)
+							)
+						)
+					);
+				}
+			}
+		}
+		else
+		{
+			$hold_ary[($group_id !== false) ? $group_id : $user_id][(int) $forum_id] = $compare_options;
+		}
+
+		return $hold_ary;
+	}
+
+	/**
+	* Get permission mask for roles
+	* This function only supports getting masks for one role
+	*/
+	function get_role_mask($role_id)
+	{
+		global $_CLASS;
+
+		$hold_ary = array();
+
+		$sql = 'SELECT group_id, user_id, forum_id
+			FROM ' . FORUMS_ACL_TABLE . '
+			WHERE auth_role_id = ' . $role_id . '
+			ORDER BY forum_id';
+		$result = $_CLASS['core_db']-&gt;query($sql);
+
+		while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+		{
+			if ($row['user_id'])
+			{
+				$hold_ary[$row['forum_id']]['users'][] = $row['user_id'];
+			}
+
+			if ($row['group_id'])
+			{
+				$hold_ary[$row['forum_id']]['groups'][] = $row['group_id'];
+			}
+		}
+		$_CLASS['core_db']-&gt;free_result($result);
+
+		return $hold_ary;
+	}
+
+	/**
+	* Display permission mask (assign to template)
+	*/
+	function display_mask($mode, $permission_type, &amp;$hold_ary, $user_mode = 'user', $local = false, $group_display = true)
+	{
+		global $_CLASS;
+
+		// Define names for template loops, might be able to be set
+		$tpl_pmask = 'p_mask';
+		$tpl_fmask = 'f_mask';
+		$tpl_category = 'category';
+		$tpl_mask = 'mask';
+
+		$l_acl_type = (isset($_CLASS['core_user']-&gt;lang['ACL_TYPE_' . (($local) ? 'LOCAL' : 'GLOBAL') . '_' . strtoupper($permission_type)])) ? $_CLASS['core_user']-&gt;lang['ACL_TYPE_' . (($local) ? 'LOCAL' : 'GLOBAL') . '_' . strtoupper($permission_type)] : 'ACL_TYPE_' . (($local) ? 'LOCAL' : 'GLOBAL') . '_' . strtoupper($permission_type);
+
+		// Allow trace for viewing permissions and in user mode
+		$show_trace = ($mode == 'view' &amp;&amp; $user_mode == 'user') ? true : false;
+
+		// Get names
+		if ($user_mode === 'user')
+		{
+			$sql = 'SELECT user_id as ug_id, username as ug_name
+				FROM ' . CORE_USERS_TABLE . '
+				WHERE user_id IN ('.implode(', ', array_keys($hold_ary)) . ')
+				ORDER BY username ASC';
+		}
+		else
+		{
+			$sql = 'SELECT group_id as ug_id, group_name as ug_name, group_type
+				FROM ' . CORE_GROUPS_TABLE . '
+				WHERE group_id IN ('.implode(', ', array_keys($hold_ary)) . ')
+				ORDER BY group_type DESC, group_name ASC';
+		}
+		$result = $_CLASS['core_db']-&gt;query($sql);
+
+		$ug_names_ary = array();
+		while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+		{
+			$ug_names_ary[$row['ug_id']] = ($user_mode == 'user') ? $row['ug_name'] : (($row['group_type'] == GROUP_SPECIAL) ? $_CLASS['core_user']-&gt;lang['G_' . $row['ug_name']] : $row['ug_name']);
+		}
+		$_CLASS['core_db']-&gt;free_result($result);
+
+		// Get used forums
+		$forum_ids = array();
+		foreach ($hold_ary as $ug_id =&gt; $row)
+		{
+			$forum_ids = array_merge($forum_ids, array_keys($row));
+		}
+		$forum_ids = array_unique($forum_ids);
+
+		$forum_names_ary = array();
+		if ($local)
+		{
+			$forum_names_ary = make_forum_select(false, false, true, false, false, false, true);
+		}
+		else
+		{
+			$forum_names_ary[0] = $l_acl_type;
+		}
+
+		// Get available roles
+		$sql = 'SELECT *
+			FROM ' . FORUMS_ACL_ROLES_TABLE . &quot;
+			WHERE role_type = '&quot; . $_CLASS['core_db']-&gt;escape($permission_type) . &quot;'
+			ORDER BY role_order ASC&quot;;
+		$result = $_CLASS['core_db']-&gt;query($sql);
+
+		$roles = array();
+		while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+		{
+			$roles[$row['role_id']] = $row;
+		}
+		$_CLASS['core_db']-&gt;free_result($result);
+
+		$cur_roles = $this-&gt;acl_role_data($user_mode, $permission_type, array_keys($hold_ary));
+
+		// Build js roles array (role data assignments)
+		$s_role_js_array = '';
+		
+		if (sizeof($roles))
+		{
+			$s_role_js_array = array();
+
+			// Make sure every role (even if empty) has its array defined
+			foreach ($roles as $_role_id =&gt; $null)
+			{
+				$s_role_js_array[$_role_id] = &quot;\n&quot; . 'role_options[' . $_role_id . '] = new Array();' . &quot;\n&quot;;
+			}
+
+			$sql = 'SELECT r.role_id, o.auth_option, r.auth_setting
+				FROM ' . FORUMS_ACL_ROLES_DATA_TABLE . ' r, ' . FORUMS_ACL_OPTIONS_TABLE . ' o
+				WHERE o.auth_option_id = r.auth_option_id
+					AND r.role_id IN ('.implode(', ', array_keys($roles)).')';
+			$result = $_CLASS['core_db']-&gt;query($sql);
+
+			while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+			{
+				$flag = substr($row['auth_option'], 0, strpos($row['auth_option'], '_') + 1);
+				if ($flag == $row['auth_option'])
+				{
+					continue;
+				}
+
+				$s_role_js_array[$row['role_id']] .= 'role_options[' . $row['role_id'] . '][\'' . $row['auth_option'] . '\'] = ' . $row['auth_setting'] . '; ';
+			}
+			$_CLASS['core_db']-&gt;free_result($result);
+
+			$s_role_js_array = implode('', $s_role_js_array);
+		}
+
+		$_CLASS['core_template']-&gt;assign('S_ROLE_JS_ARRAY', $s_role_js_array);
+
+		// Now obtain memberships
+		$user_groups_default = $user_groups_custom = array();
+		if ($user_mode == 'user' &amp;&amp; $group_display)
+		{
+			$sql = 'SELECT group_id, group_name, group_type
+				FROM ' . CORE_GROUPS_TABLE . '
+				ORDER BY group_type DESC, group_name ASC';
+			$result = $_CLASS['core_db']-&gt;query($sql);
+
+			$groups = array();
+			while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+			{
+				$groups[$row['group_id']] = $row;
+			}
+			$_CLASS['core_db']-&gt;free_result($result);
+
+			$memberships = group_memberships(false, array_keys($hold_ary), false);
+
+			// User is not a member of any group? Bad admin, bad bad admin...
+			if ($memberships)
+			{
+				foreach ($memberships as $row)
+				{
+					if ($groups[$row['group_id']]['group_type'] == GROUP_SPECIAL)
+					{
+						$user_groups_default[$row['user_id']][] = $_CLASS['core_user']-&gt;lang['G_' . $groups[$row['group_id']]['group_name']];
+					}
+					else
+					{
+						$user_groups_custom[$row['user_id']][] = $groups[$row['group_id']]['group_name'];
+					}
+				}
+			}
+			unset($memberships, $groups);
+		}
+
+		// If we only have one forum id to display or being in local mode and more than one user/group to display, 
+		// we switch the complete interface to group by user/usergroup instead of grouping by forum
+		// To achive this, we need to switch the array a bit
+		if (sizeof($forum_ids) == 1 || ($local &amp;&amp; sizeof($ug_names_ary) &gt; 1))
+		{
+			$hold_ary_temp = $hold_ary;
+			$hold_ary = array();
+			foreach ($hold_ary_temp as $ug_id =&gt; $row)
+			{
+				foreach ($row as $forum_id =&gt; $auth_row)
+				{
+					$hold_ary[$forum_id][$ug_id] = $auth_row;
+				}
+			}
+			unset($hold_ary_temp);
+
+			$count_pmask = 0;
+
+			foreach ($hold_ary as $forum_id =&gt; $forum_array)
+			{
+				$content_array = $categories = array();
+				$this-&gt;build_permission_array($hold_ary[$forum_id], $content_array, $categories, array_keys($ug_names_ary));
+
+				$pmask_array[$count_pmask] = array(
+					'NAME'			=&gt; ($forum_id == 0) ? $forum_names_ary[0] : $forum_names_ary[$forum_id]['forum_name'],
+					'CATEGORIES'	=&gt; implode('&lt;/th&gt;&lt;th&gt;', $categories),
+
+					'USER_GROUPS_DEFAULT'	=&gt; '',
+					'USER_GROUPS_CUSTOM'	=&gt; '',
+	
+					'L_ACL_TYPE'	=&gt; $l_acl_type,
+
+					'S_LOCAL'		=&gt; ($local) ? true : false,
+					'S_GLOBAL'		=&gt; (!$local) ? true : false,
+					'S_NUM_CATS'	=&gt; sizeof($categories),
+					'S_VIEW'		=&gt; ($mode === 'view') ? true : false,
+					'S_NUM_OBJECTS'	=&gt; sizeof($content_array),
+					'S_USER_MODE'	=&gt; ($user_mode === 'user') ? true : false,
+					'S_GROUP_MODE'	=&gt; ($user_mode === 'group') ? true : false
+				);
+
+				$count_fmask = 0;
+
+				foreach ($content_array as $ug_id =&gt; $ug_array)
+				{
+					// Build role dropdown options
+					$current_role_id = (isset($cur_roles[$ug_id][$forum_id])) ? $cur_roles[$ug_id][$forum_id] : 0;
+
+					$s_role_options = '';
+					foreach ($roles as $role_id =&gt; $role_row)
+					{
+						$role_description = (!empty($_CLASS['core_user']-&gt;lang[$role_row['role_description']])) ? $_CLASS['core_user']-&gt;lang[$role_row['role_description']] : nl2br($role_row['role_description']);
+						$title = ($role_description) ? ' title=&quot;' . $role_description . '&quot;' : '';
+						$s_role_options .= '&lt;option value=&quot;' . $role_id . '&quot;' . (($role_id == $current_role_id) ? ' selected=&quot;selected&quot;' : '') . $title . '&gt;' . $role_row['role_name'] . '&lt;/option&gt;';
+					}
+
+					if ($s_role_options)
+					{
+						$s_role_options = '&lt;option value=&quot;0&quot;' . ((!$current_role_id) ? ' selected=&quot;selected&quot;' : '') . ' title=&quot;' . htmlspecialchars($_CLASS['core_user']-&gt;lang['NO_ROLE_ASSIGNED_EXPLAIN']) . '&quot;&gt;' . $_CLASS['core_user']-&gt;lang['NO_ROLE_ASSIGNED'] . '&lt;/option&gt;' . $s_role_options;
+					}
+
+					$pmask_array[$count_pmask][$tpl_fmask][$count_fmask] = array(
+						'NAME'				=&gt; $ug_names_ary[$ug_id],
+						'FOLDER_IMAGE'		=&gt; false,
+						'PADDING'			=&gt; false,
+						'S_ROLE_OPTIONS'	=&gt; $s_role_options,
+						'UG_ID'				=&gt; $ug_id,
+						'FORUM_ID'			=&gt; $forum_id
+					);
+					
+					$pmask_array[$count_pmask][$tpl_fmask][$count_fmask][$tpl_category] = $this-&gt;assign_cat_array($ug_array, $tpl_category, $tpl_mask, $ug_id, $forum_id, $show_trace);
+
+					$count_fmask++;
+				}
+				$count_pmask++;
+			}
+		}
+		else
+		{
+			$count_pmask = 0;
+
+			foreach ($ug_names_ary as $ug_id =&gt; $ug_name)
+			{
+				if (!isset($hold_ary[$ug_id]))
+				{
+					continue;
+				}
+
+				$content_array = $categories = array();
+				$this-&gt;build_permission_array($hold_ary[$ug_id], $content_array, $categories, array_keys($forum_names_ary));
+
+				$pmask_array[$count_pmask] = array(
+					'NAME'			=&gt; $ug_name,
+					'CATEGORIES'	=&gt; implode('&lt;/th&gt;&lt;th&gt;', $categories),
+
+					'USER_GROUPS_DEFAULT'	=&gt; ($user_mode === 'user' &amp;&amp; isset($user_groups_default[$ug_id]) &amp;&amp; sizeof($user_groups_default[$ug_id])) ? implode(', ', $user_groups_default[$ug_id]) : '',
+					'USER_GROUPS_CUSTOM'	=&gt; ($user_mode === 'user' &amp;&amp; isset($user_groups_custom[$ug_id]) &amp;&amp; sizeof($user_groups_custom[$ug_id])) ? implode(', ', $user_groups_custom[$ug_id]) : '',
+					'L_ACL_TYPE'			=&gt; $l_acl_type,
+
+					'S_LOCAL'		=&gt; ($local) ? true : false,
+					'S_GLOBAL'		=&gt; (!$local) ? true : false,
+					'S_NUM_CATS'	=&gt; sizeof($categories),
+					'S_VIEW'		=&gt; ($mode === 'view') ? true : false,
+					'S_NUM_OBJECTS'	=&gt; sizeof($content_array),
+					'S_USER_MODE'	=&gt; ($user_mode === 'user') ? true : false,
+					'S_GROUP_MODE'	=&gt; ($user_mode === 'group') ? true : false
+				);
+
+				$count_fmask = 0;
+
+				foreach ($content_array as $forum_id =&gt; $forum_array)
+				{
+					// Build role dropdown options
+					$current_role_id = isset($cur_roles[$ug_id][$forum_id]) ? $cur_roles[$ug_id][$forum_id] : 0;
+
+					$s_role_options = '';
+					foreach ($roles as $role_id =&gt; $role_row)
+					{
+						$role_description = (!empty($_CLASS['core_user']-&gt;lang[$role_row['role_description']])) ? $_CLASS['core_user']-&gt;lang[$role_row['role_description']] : nl2br($role_row['role_description']);
+						$title = ($role_description) ? ' title=&quot;' . $role_description . '&quot;' : '';
+						$s_role_options .= '&lt;option value=&quot;' . $role_id . '&quot;' . (($role_id == $current_role_id) ? ' selected=&quot;selected&quot;' : '') . $title . '&gt;' . $role_row['role_name'] . '&lt;/option&gt;';
+					}
+
+					if ($s_role_options)
+					{
+						$s_role_options = '&lt;option value=&quot;0&quot;' . ((!$current_role_id) ? ' selected=&quot;selected&quot;' : '') . ' title=&quot;' . htmlspecialchars($_CLASS['core_user']-&gt;lang['NO_ROLE_ASSIGNED_EXPLAIN']) . '&quot;&gt;' . $_CLASS['core_user']-&gt;lang['NO_ROLE_ASSIGNED'] . '&lt;/option&gt;' . $s_role_options;
+					}
+
+					if (!$forum_id)
+					{
+						$folder_image = '';
+					}
+					else
+					{
+						if ($forum_names_ary[$forum_id]['forum_status'] == ITEM_LOCKED)
+						{
+							$folder_image = '&lt;img src=&quot;images/icon_folder_lock_small.gif&quot; width=&quot;19&quot; height=&quot;18&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['FORUM_LOCKED'] . '&quot; /&gt;';
+						}
+						else
+						{
+							switch ($forum_names_ary[$forum_id]['forum_type'])
+							{
+								case FORUM_LINK:
+									$folder_image = '&lt;img src=&quot;images/icon_folder_link_small.gif&quot; width=&quot;22&quot; height=&quot;18&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['FORUM_LINK'] . '&quot; /&gt;';
+								break;
+
+								default:
+									$folder_image = ($forum_names_ary[$forum_id]['left_id'] + 1 != $forum_names_ary[$forum_id]['right_id']) ? '&lt;img src=&quot;images/icon_folder_sub_small.gif&quot; width=&quot;22&quot; height=&quot;18&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['SUBFORUM'] . '&quot; /&gt;' : '&lt;img src=&quot;images/icon_folder_small.gif&quot; width=&quot;19&quot; height=&quot;18&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['FOLDER'] . '&quot; /&gt;';
+								break;
+							}
+						}
+					}
+
+					$pmask_array[$count_pmask][$tpl_fmask][$count_fmask] = array(
+						'NAME'				=&gt; ($forum_id == 0) ? $forum_names_ary[0] : $forum_names_ary[$forum_id]['forum_name'],
+						'PADDING'			=&gt; ($forum_id == 0) ? '' : $forum_names_ary[$forum_id]['padding'],
+						'FOLDER_IMAGE'		=&gt; $folder_image,
+						'S_ROLE_OPTIONS'	=&gt; $s_role_options,
+						'UG_ID'				=&gt; $ug_id,
+						'FORUM_ID'			=&gt; $forum_id
+					);
+
+					$pmask_array[$count_pmask][$tpl_fmask][$count_fmask][$tpl_category] = $this-&gt;assign_cat_array($forum_array, $tpl_category, $tpl_mask, $ug_id, $forum_id, $show_trace);
+					$count_fmask++;
+				}
+				$count_pmask++;
+			}
+		}
+
+		$_CLASS['core_template']-&gt;assign($tpl_pmask, $pmask_array);
+	}
+
+	/**
+	* Display permission mask for roles
+	*/
+	function display_role_mask(&amp;$hold_ary)
+	{
+		global $_CLASS;
+
+		if (!sizeof($hold_ary))
+		{
+			return;
+		}
+
+		// Get forum names
+		$sql = 'SELECT forum_id, forum_name
+			FROM ' . FORUMS_FORUMS_TABLE . '
+			WHERE forum_id IN ('.implode(', ', array_keys($hold_ary)).')';
+		$result = $_CLASS['core_db']-&gt;query($sql);
+
+		$forum_names = array();
+		while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+		{
+			$forum_names[$row['forum_id']] = $row['forum_name'];
+		}
+		$_CLASS['core_db']-&gt;free_result($result);
+
+		foreach ($hold_ary as $forum_id =&gt; $auth_ary)
+		{
+			$_CLASS['core_template']-&gt;assign_vars_array('role_mask', array(
+				'NAME'				=&gt; ($forum_id == 0) ? $_CLASS['core_user']-&gt;lang['GLOBAL_MASK'] : $forum_names[$forum_id],
+				'FORUM_ID'			=&gt; $forum_id)
+			);
+
+			if (isset($auth_ary['users']) &amp;&amp; sizeof($auth_ary['users']))
+			{
+				$sql = 'SELECT user_id, username
+					FROM ' . CORE_USERS_TABLE . '
+					WHERE user_id IN ('.implode(', ', $auth_ary['users']) . ')
+					ORDER BY username';
+				$result = $_CLASS['core_db']-&gt;query($sql);
+
+				while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+				{
+					$_CLASS['core_template']-&gt;assign_vars_array('role_mask.users', array(
+						'USER_ID'		=&gt; $row['user_id'],
+						'USERNAME'		=&gt; $row['username'],
+						'U_PROFILE'		=&gt; append_sid(&quot;{$phpbb_root_path}memberlist.$phpEx&quot;, &quot;mode=viewprofile&amp;u={$row['user_id']}&quot;))
+					);
+				}
+				$_CLASS['core_db']-&gt;free_result($result);
+			}
+
+			if (isset($auth_ary['groups']) &amp;&amp; sizeof($auth_ary['groups']))
+			{
+				$sql = 'SELECT group_id, group_name, group_type
+					FROM ' . CORE_GROUPS_TABLE . '
+					WHERE group_id IN ('.implode(', ', $auth_ary['groups']) . ')
+					ORDER BY group_type ASC, group_name';
+				$result = $_CLASS['core_db']-&gt;query($sql);
+
+				while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+				{
+					$_CLASS['core_template']-&gt;assign_vars_array('role_mask.groups', array(
+						'GROUP_ID'		=&gt; $row['group_id'],
+						'GROUP_NAME'	=&gt; ($row['group_type'] == GROUP_SPECIAL) ? $_CLASS['core_user']-&gt;lang['G_' . $row['group_name']] : $row['group_name'],
+						'U_PROFILE'		=&gt; append_sid(&quot;{$phpbb_root_path}memberlist.$phpEx&quot;, &quot;mode=group&amp;g={$row['group_id']}&quot;))
+					);
+				}
+				$_CLASS['core_db']-&gt;free_result($result);
+			}
+		}
+	}
+
+	/**
+	* NOTE: this function is not in use atm
+	* Add a new option to the list ... $options is a hash of form -&gt;
+	* $options = array(
+	*	'local'		=&gt; array('option1', 'option2', ...),
+	*	'global'	=&gt; array('optionA', 'optionB', ...)
+	* );
+	*/
+	function acl_add_option($options)
+	{
+		global $_CLASS;
+
+		if (!is_array($options))
+		{
+			return false;
+		}
+
+		$cur_options = array();
+
+		$sql = 'SELECT auth_option, is_global, is_local
+			FROM ' . FORUMS_ACL_OPTIONS_TABLE . '
+			ORDER BY auth_option_id';
+		$result = $_CLASS['core_db']-&gt;query($sql);
+
+		while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+		{
+			if ($row['is_global'])
+			{
+				$cur_options['global'][] = $row['auth_option'];
+			}
+
+			if ($row['is_local'])
+			{
+				$cur_options['local'][] = $row['auth_option'];
+			}
+		}
+		$_CLASS['core_db']-&gt;free_result($result);
+
+		// Here we need to insert new options ... this requires discovering whether
+		// an options is global, local or both and whether we need to add an permission
+		// set flag (x_)
+		$new_options = array('local' =&gt; array(), 'global' =&gt; array());
+
+		foreach ($options as $type =&gt; $option_ary)
+		{
+			$option_ary = array_unique($option_ary);
+
+			foreach ($option_ary as $option_value)
+			{
+				if (!in_array($option_value, $cur_options[$type]))
+				{
+					$new_options[$type][] = $option_value;
+				}
+
+				$flag = substr($option_value, 0, strpos($option_value, '_') + 1);
+
+				if (!in_array($flag, $cur_options[$type]) &amp;&amp; !in_array($flag, $new_options[$type]))
+				{
+					$new_options[$type][] = $flag;
+				}
+			}
+		}
+		unset($options);
+
+		$options = array();
+		$options['local'] = array_diff($new_options['local'], $new_options['global']);
+		$options['global'] = array_diff($new_options['global'], $new_options['local']);
+		$options['local_global'] = array_intersect($new_options['local'], $new_options['global']);
+
+		$sql_ary = array();
+
+		foreach ($options as $type =&gt; $option_ary)
+		{
+			foreach ($option_ary as $option)
+			{
+				$sql_ary[] = array(
+					'auth_option'	=&gt; $option,
+					'is_global'		=&gt; ($type == 'global' || $type == 'local_global') ? 1 : 0,
+					'is_local'		=&gt; ($type == 'local' || $type == 'local_global') ? 1 : 0
+				);
+			}
+		}
+
+		if (sizeof($sql_ary))
+		{
+			$_CLASS['core_db']-&gt;sql_query_build('MULTI_INSERT', $sql_ary, FORUMS_ACL_OPTIONS_TABLE);
+		}
+
+		$cache-&gt;destroy('acl_options');
+		$this-&gt;acl_clear_prefetch();
+
+		return true;
+	}
+
+	/**
+	* Set a user or group ACL record
+	*/
+	function acl_set($ug_type, $forum_id, $ug_id, $auth, $role_id = 0, $clear_prefetch = true)
+	{
+		global $_CLASS;
+
+		// One or more forums
+		if (!is_array($forum_id))
+		{
+			$forum_id = array($forum_id);
+		}
+
+		// One or more users
+		if (!is_array($ug_id))
+		{
+			$ug_id = array($ug_id);
+		}
+
+		$ug_id_sql =  $ug_type . '_id IN ('.implode(', ', array_map('intval', $ug_id)).')';
+		$forum_sql =  'forum_id IN ('.implode(', ', array_map('intval', $forum_id)).')';
+
+		// Instead of updating, inserting, removing we just remove all current settings and re-set everything...
+		$id_field = $ug_type . '_id';
+
+		// Get any flags as required
+		reset($auth);
+		$flag = key($auth);
+		$flag = substr($flag, 0, strpos($flag, '_') + 1);
+
+		// This ID (the any-flag) is set if one or more permissions are true...
+		$any_option_id = (int) $this-&gt;option_ids[$flag];
+
+		// Remove any-flag from auth ary
+		if (isset($auth[$flag]))
+		{
+			unset($auth[$flag]);
+		}
+
+		// Remove current auth options...
+		$auth_option_ids = array();
+		foreach ($auth as $auth_option =&gt; $auth_setting)
+		{
+			$auth_option_ids[] = (int) $this-&gt;option_ids[$auth_option];
+		}
+
+		$sql = 'DELETE FROM '.FORUMS_ACL_TABLE.&quot;
+			WHERE $forum_sql
+				AND $ug_id_sql
+				AND auth_option_id IN ($any_option_id, &quot; . implode(', ', $auth_option_ids) . ')';
+		$_CLASS['core_db']-&gt;query($sql);
+
+		// Remove those having a role assigned... the correct type of course...
+		$sql = 'SELECT role_id
+			FROM ' . FORUMS_ACL_ROLES_TABLE . &quot;
+			WHERE role_type = '&quot; . $_CLASS['core_db']-&gt;escape($flag) . &quot;'&quot;;
+		$result = $_CLASS['core_db']-&gt;query($sql);
+
+		$role_ids = array();
+		while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+		{
+			$role_ids[] = $row['role_id'];
+		}
+		$_CLASS['core_db']-&gt;free_result($result);
+
+		if (sizeof($role_ids))
+		{
+			$sql = 'DELETE FROM '.FORUMS_ACL_TABLE.&quot;
+				WHERE $forum_sql
+					AND $ug_id_sql
+					AND auth_option_id = 0
+					AND auth_role_id IN (&quot;.implode(', ', $role_ids).')';
+			$_CLASS['core_db']-&gt;query($sql);
+		}
+
+		// Ok, include the any-flag if one or more auth options are set to yes...
+		foreach ($auth as $auth_option =&gt; $setting)
+		{
+			if ($setting == ACL_YES &amp;&amp; (!isset($auth[$flag]) || $auth[$flag] == ACL_NEVER))
+			{
+				$auth[$flag] = ACL_YES;
+			}
+		}
+
+		$sql_ary = array();
+		foreach ($forum_id as $forum)
+		{
+			$forum = (int) $forum;
+
+			if ($role_id)
+			{
+				foreach ($ug_id as $id)
+				{
+					$sql_ary[] = array(
+						$id_field			=&gt; (int) $id,
+						'forum_id'			=&gt; (int) $forum,
+						'auth_option_id'	=&gt; 0,
+						'auth_setting'		=&gt; 0,
+						'auth_role_id'		=&gt; $role_id
+					);
+				}
+			}
+			else
+			{
+				foreach ($auth as $auth_option =&gt; $setting)
+				{
+					$auth_option_id = (int) $this-&gt;option_ids[$auth_option];
+
+					if ($setting != ACL_NO)
+					{
+						foreach ($ug_id as $id)
+						{
+							$sql_ary[] = array(
+								$id_field			=&gt; (int) $id,
+								'forum_id'			=&gt; (int) $forum,
+								'auth_option_id'	=&gt; (int) $auth_option_id,
+								'auth_setting'		=&gt; (int) $setting
+							);
+						}
+					}
+				}
+			}
+		}
+
+		if (sizeof($sql_ary))
+		{
+			$_CLASS['core_db']-&gt;sql_query_build('MULTI_INSERT', $sql_ary, FORUMS_ACL_TABLE);
+		}
+
+		if ($clear_prefetch)
+		{
+			$this-&gt;acl_clear_prefetch();
+		}
+	}
+
+	/**
+	* Set a role-specific ACL record
+	*/
+	function acl_set_role($role_id, $auth)
+	{
+		global $_CLASS;
+
+		// Get any-flag as required
+		reset($auth);
+		$flag = key($auth);
+		$flag = substr($flag, 0, strpos($flag, '_') + 1);
+		
+		// Remove any-flag from auth ary
+		if (isset($auth[$flag]))
+		{
+			unset($auth[$flag]);
+		}
+
+		// Re-set any flag...
+		foreach ($auth as $auth_option =&gt; $setting)
+		{
+			if ($setting == ACL_YES &amp;&amp; (!isset($auth[$flag]) || $auth[$flag] == ACL_NEVER))
+			{
+				$auth[$flag] = ACL_YES;
+			}
+		}
+
+		$sql_ary = array();
+		foreach ($auth as $auth_option =&gt; $setting)
+		{
+			$auth_option_id = (int) $this-&gt;option_ids[$auth_option];
+
+			if ($setting != ACL_NO)
+			{
+				$sql_ary[] = array(
+					'role_id'			=&gt; (int) $role_id,
+					'auth_option_id'	=&gt; (int) $auth_option_id,
+					'auth_setting'		=&gt; (int) $setting
+				);
+			}
+		}
+
+		// If no data is there, we set the any-flag to ACL_NEVER...
+		if (!sizeof($sql_ary))
+		{
+			$sql_ary[] = array(
+				'role_id'			=&gt; (int) $role_id,
+				'auth_option_id'	=&gt; $this-&gt;option_ids[$flag],
+				'auth_setting'		=&gt; ACL_NEVER
+			);
+		}
+
+		// Remove current auth options...
+		$sql = 'DELETE FROM ' . FORUMS_ACL_ROLES_DATA_TABLE . '
+			WHERE role_id = ' . $role_id;
+		$_CLASS['core_db']-&gt;query($sql);
+
+		$_CLASS['core_db']-&gt;sql_query_build('MULTI_INSERT', $sql_ary, FORUMS_ACL_ROLES_DATA_TABLE);
+
+		$this-&gt;acl_clear_prefetch();
+	}
+
+	/**
+	* Remove local permission
+	*/
+	function acl_delete($mode, $ug_id = false, $forum_id = false, $permission_type = false)
+	{
+		global $_CLASS;
+
+		if ($ug_id === false &amp;&amp; $forum_id === false)
+		{
+			return;
+		}
+
+		$option_id_ary = array();
+		$id_field  = $mode . '_id';
+
+		$where_sql = array();
+
+		if ($forum_id !== false)
+		{
+			$where_sql[] = !is_array($forum_id) ? 'forum_id = ' . (int) $forum_id : 'forum_id IN ('.implode(', ', array_map('intval', $forum_id)).')';
+		}
+
+		if ($ug_id !== false)
+		{
+			$where_sql[] = !is_array($ug_id) ? $id_field . ' = ' . (int) $ug_id : $id_field.' IN ('.implode(', ', array_map('intval', $ug_id)).')';
+		}
+
+		// There seem to be auth options involved, therefore we need to go through the list and make sure we capture roles correctly
+		if ($permission_type !== false)
+		{
+			// Get permission type
+			$sql = 'SELECT auth_option, auth_option_id
+				FROM ' . FORUMS_ACL_OPTIONS_TABLE . &quot;
+				WHERE auth_option LIKE '&quot; . $_CLASS['core_db']-&gt;escape($permission_type) . &quot;%'&quot;;
+			$result = $_CLASS['core_db']-&gt;query($sql);
+
+			$auth_id_ary = array();
+			while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+			{
+				$option_id_ary[] = $row['auth_option_id'];
+				$auth_id_ary[$row['auth_option']] = ACL_NO;
+			}
+			$_CLASS['core_db']-&gt;free_result($result);
+
+			// First of all, lets grab the items having roles with the specified auth options assigned
+			$sql = &quot;SELECT auth_role_id, $id_field, forum_id
+				FROM &quot;.FORUMS_ACL_TABLE.', ' . FORUMS_ACL_ROLES_TABLE . &quot; r
+				WHERE auth_role_id &lt;&gt; 0
+					AND auth_role_id = r.role_id
+					AND r.role_type = '{$permission_type}'
+					AND &quot; . implode(' AND ', $where_sql) . '
+				ORDER BY auth_role_id';
+			$result = $_CLASS['core_db']-&gt;query($sql);
+
+			$cur_role_auth = array();
+			while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+			{
+				$cur_role_auth[$row['auth_role_id']][$row['forum_id']][] = $row[$id_field];
+			}
+			$_CLASS['core_db']-&gt;free_result($result);
+
+			// Get role data for resetting data
+			if (sizeof($cur_role_auth))
+			{
+				$sql = 'SELECT ao.auth_option, rd.role_id, rd.auth_setting
+					FROM ' . FORUMS_ACL_OPTIONS_TABLE . ' ao, ' . FORUMS_ACL_ROLES_DATA_TABLE . ' rd
+					WHERE ao.auth_option_id = rd.auth_option_id
+						AND rd.role_id IN ('.implode(', ', array_keys($cur_role_auth)).')';
+				$result = $_CLASS['core_db']-&gt;query($sql);
+
+				$auth_settings = array();
+				while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+				{
+					// We need to fill all auth_options, else setting it will fail...
+					if (!isset($auth_settings[$row['role_id']]))
+					{
+						$auth_settings[$row['role_id']] = $auth_id_ary;
+					}
+					$auth_settings[$row['role_id']][$row['auth_option']] = $row['auth_setting'];
+				}
+				$_CLASS['core_db']-&gt;free_result($result);
+
+				// Set the options
+				foreach ($cur_role_auth as $role_id =&gt; $auth_row)
+				{
+					foreach ($auth_row as $f_id =&gt; $ug_row)
+					{
+						$this-&gt;acl_set($mode, $f_id, $ug_row, $auth_settings[$role_id], 0, false);
+					}
+				}
+			}
+		}
+
+		// Now, normally remove permissions...
+		if ($permission_type !== false)
+		{
+			$where_sql[] = 'auth_option_id IN ('.implode(', ', array_map('intval', $option_id_ary)).')';
+		}
+		
+		$sql = 'DELETE FROM '. FORUMS_ACL_TABLE .'
+			WHERE ' . implode(' AND ', $where_sql);
+		$_CLASS['core_db']-&gt;query($sql);
+
+		$this-&gt;acl_clear_prefetch();
+	}
+
+	/**
+	* Assign category to template
+	* used by display_mask()
+	*/
+	function assign_cat_array(&amp;$category_array, $tpl_category, $tpl_mask, $ug_id, $forum_id, $show_trace = false)
+	{
+		global $_CLASS;
+
+		$count_category = 0;
+
+		foreach ($category_array as $cat =&gt; $cat_array)
+		{
+			//$_CLASS['core_template']-&gt;assign_vars_array($tpl_cat, array(
+			$return_array[$count_category] = array(
+				'S_YES'		=&gt; ($cat_array['S_YES'] &amp;&amp; !$cat_array['S_NEVER'] &amp;&amp; !$cat_array['S_NO']) ? true : false,
+				'S_NEVER'	=&gt; ($cat_array['S_NEVER'] &amp;&amp; !$cat_array['S_YES'] &amp;&amp; !$cat_array['S_NO']) ? true : false,
+				'S_NO'		=&gt; ($cat_array['S_NO'] &amp;&amp; !$cat_array['S_NEVER'] &amp;&amp; !$cat_array['S_YES']) ? true : false,
+							
+				'CAT_NAME'	=&gt; $_CLASS['core_user']-&gt;lang['permission_cat'][$cat]
+			);
+
+			$count_mask = 0;
+
+			foreach ($cat_array['permissions'] as $permission =&gt; $allowed)
+			{
+				//$_CLASS['core_template']-&gt;assign_vars_array($tpl_cat . '.' . $tpl_mask, array(
+				$return_array[$count_category][$tpl_mask][$count_mask] = array(
+					'S_YES'		=&gt; ($allowed == ACL_YES) ? true : false,
+					'S_NEVER'	=&gt; ($allowed == ACL_NEVER) ? true : false,
+					'S_NO'		=&gt; ($allowed == ACL_NO) ? true : false,
+
+					'UG_ID'			=&gt; $ug_id,
+					'FORUM_ID'		=&gt; $forum_id,
+					'FIELD_NAME'	=&gt; $permission,
+					'S_FIELD_NAME'	=&gt; 'setting[' . $ug_id . '][' . $forum_id . '][' . $permission . ']',
+
+					'U_TRACE'		=&gt; ($show_trace) ? append_sid(&quot;{$phpbb_admin_path}index.$phpEx&quot;, &quot;i=permissions&amp;mode=trace&amp;u=$ug_id&amp;f=$forum_id&amp;auth=$permission&quot;) : '',
+
+					'PERMISSION'	=&gt; $_CLASS['core_user']-&gt;lang['acl_' . $permission]['lang']
+				);
+				$count_mask++;
+			}
+			$count_category++;
+		}
+		return $return_array;
+	}
+
+	/**
+	* Building content array from permission rows with explicit key ordering
+	* used by display_mask()
+	*/
+	function build_permission_array(&amp;$permission_row, &amp;$content_array, &amp;$categories, $key_sort_array)
+	{
+		global $_CLASS;
+
+		foreach ($key_sort_array as $forum_id)
+		{
+			if (!isset($permission_row[$forum_id]))
+			{
+				continue;
+			}
+
+			$permissions = $permission_row[$forum_id];
+			ksort($permissions);
+
+			foreach ($permissions as $permission =&gt; $auth_setting)
+			{
+				if (!isset($_CLASS['core_user']-&gt;lang['acl_' . $permission]))
+				{
+					$_CLASS['core_user']-&gt;lang['acl_' . $permission] = array(
+						'cat'	=&gt; 'misc',
+						'lang'	=&gt; '{ acl_' . $permission . ' }'
+					);
+				}
+			
+				$cat = $_CLASS['core_user']-&gt;lang['acl_' . $permission]['cat'];
+			
+				// Build our categories array
+				if (!isset($categories[$cat]))
+				{
+					$categories[$cat] = $_CLASS['core_user']-&gt;lang['permission_cat'][$cat];
+				}
+
+				// Build our content array
+				if (!isset($content_array[$forum_id]))
+				{
+					$content_array[$forum_id] = array();
+				}
+
+				if (!isset($content_array[$forum_id][$cat]))
+				{
+					$content_array[$forum_id][$cat] = array(
+						'S_YES'			=&gt; false,
+						'S_NEVER'		=&gt; false,
+						'S_NO'			=&gt; false,
+						'permissions'	=&gt; array(),
+					);
+				}
+
+				$content_array[$forum_id][$cat]['S_YES'] |= ($auth_setting == ACL_YES) ? true : false;
+				$content_array[$forum_id][$cat]['S_NEVER'] |= ($auth_setting == ACL_NEVER) ? true : false;
+				$content_array[$forum_id][$cat]['S_NO'] |= ($auth_setting == ACL_NO) ? true : false;
+
+				$content_array[$forum_id][$cat]['permissions'][$permission] = $auth_setting;
+			}
+		}
+	}
+
+	/**
+	* Use permissions from another user. This transferes a permission set from one user to another.
+	* The other user is always able to revert back to his permission set.
+	* This function does not check for lower/higher permissions, it is possible for the user to gain 
+	* &quot;more&quot; permissions by this.
+	* Admin permissions will not be copied.
+	*/
+	function ghost_permissions($from_user_id, $to_user_id)
+	{
+		global $_CLASS;
+
+		if ($to_user_id == ANONYMOUS)
+		{
+			return false;
+		}
+
+		$hold_ary = $this-&gt;acl_raw_data($from_user_id, false, false);
+
+		if (isset($hold_ary[$from_user_id]))
+		{
+			$hold_ary = $hold_ary[$from_user_id];
+		}
+		
+		// Key 0 in $hold_ary are global options, all others are forum_ids
+
+		// We disallow copying admin permissions
+		foreach ($this-&gt;acl_options['global'] as $opt =&gt; $id)
+		{
+			if (strpos($opt, 'a_') === 0)
+			{
+				$hold_ary[0][$opt] = ACL_NEVER;
+			}
+		}
+
+		// Force a_switchperm to be allowed
+		$hold_ary[0]['a_switchperm'] = ACL_YES;
+
+		$user_permissions = $this-&gt;build_bitstring($hold_ary);
+
+		if (!$user_permissions)
+		{
+			return false;
+		}
+
+		$sql = 'UPDATE ' . CORE_USERS_TABLE . &quot;
+			SET user_permissions = '&quot; . $_CLASS['core_db']-&gt;escape($user_permissions) . &quot;',
+				user_perm_from = $from_user_id
+			WHERE user_id = &quot; . $to_user_id;
+		$_CLASS['core_db']-&gt;query($sql);
+
+		return true;
+	}
+}
+
+?&gt;
\ No newline at end of file

Modified: cms/trunk/includes/forums/admin/links.php
===================================================================
--- cms/trunk/includes/forums/admin/links.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/forums/admin/links.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -5,46 +5,46 @@
 }
 
 //Need to be in the admin menu look into making a new one or using this one :-)
-/*if ($_CLASS['auth']-&gt;acl_get('a_ban'))
+/*if ($_CLASS['forums_auth']-&gt;acl_get('a_ban'))
 {
 	$module['USER']['BAN_USERS'] = generate_link('forums&amp;file=admin_ban'..'&amp;mode=user');
 	$module['USER']['BAN_EMAILS'] = generate_link('forums&amp;file=admin_ban'..'&amp;mode=email');
 	$module['USER']['BAN_IPS'] = generate_link('forums&amp;file=admin_ban'..'&amp;mode=ip');
 }*/
 
-$module['LOG']['ADMIN_LOGS']			 =  ($_CLASS['auth']-&gt;acl_get('a_')) ? generate_link('forums&amp;file=admin_viewlogs&amp;mode=admin', array('admin' =&gt; true)) : false;
-$module['LOG']['MOD_LOGS']				 = ($_CLASS['auth']-&gt;acl_get('a_')) ? generate_link('forums&amp;file=admin_viewlogs&amp;mode=mod', array('admin' =&gt; true)) : false;
-$module['LOG']['CRITICAL_LOGS']			 = ($_CLASS['auth']-&gt;acl_get('a_')) ? generate_link('forums&amp;file=admin_viewlogs&amp;mode=critical', array('admin' =&gt; true)) : false;
+$module['LOG']['ADMIN_LOGS']			 =  ($_CLASS['forums_auth']-&gt;acl_get('a_')) ? generate_link('forums&amp;file=admin_viewlogs&amp;mode=admin', array('admin' =&gt; true)) : false;
+$module['LOG']['MOD_LOGS']				 = ($_CLASS['forums_auth']-&gt;acl_get('a_')) ? generate_link('forums&amp;file=admin_viewlogs&amp;mode=mod', array('admin' =&gt; true)) : false;
+$module['LOG']['CRITICAL_LOGS']			 = ($_CLASS['forums_auth']-&gt;acl_get('a_')) ? generate_link('forums&amp;file=admin_viewlogs&amp;mode=critical', array('admin' =&gt; true)) : false;
 	
-$module['DB']['SEARCH_INDEX'] 				= ($_CLASS['auth']-&gt;acl_get('a_search')) ? generate_link('forums&amp;file=admin_search', array('admin' =&gt; true)) : false;
+$module['DB']['SEARCH_INDEX'] 				= ($_CLASS['forums_auth']-&gt;acl_get('a_search')) ? generate_link('forums&amp;file=admin_search', array('admin' =&gt; true)) : false;
 
-$module['USER']['RANKS']					= ($_CLASS['auth']-&gt;acl_get('a_ranks')) ? generate_link('forums&amp;file=admin_ranks', array('admin' =&gt; true)) : '';
-$module['USER']['DISALLOW']					= ($_CLASS['auth']-&gt;acl_get('a_names')) ? generate_link('forums&amp;file=admin_disallow', array('admin' =&gt; true)) : '';
+$module['USER']['RANKS']					= ($_CLASS['forums_auth']-&gt;acl_get('a_ranks')) ? generate_link('forums&amp;file=admin_ranks', array('admin' =&gt; true)) : '';
+$module['USER']['DISALLOW']					= ($_CLASS['forums_auth']-&gt;acl_get('a_names')) ? generate_link('forums&amp;file=admin_disallow', array('admin' =&gt; true)) : '';
 
-$module['FORUM']['MANAGE']					= ($_CLASS['auth']-&gt;acl_gets('a_forum', 'a_forumadd', 'a_forumdel')) ? generate_link('forums&amp;file=admin_forums', array('admin' =&gt; true)) : false;
-$module['FORUM']['PRUNE']   				= ($_CLASS['auth']-&gt;acl_get('a_prune')) ? generate_link('forums&amp;file=admin_prune&amp;mode=forums', array('admin' =&gt; true)) : false;
+$module['FORUM']['MANAGE']					= ($_CLASS['forums_auth']-&gt;acl_gets('a_forum', 'a_forumadd', 'a_forumdel')) ? generate_link('forums&amp;file=admin_forums', array('admin' =&gt; true)) : false;
+$module['FORUM']['PRUNE']   				= ($_CLASS['forums_auth']-&gt;acl_get('a_prune')) ? generate_link('forums&amp;file=admin_prune&amp;mode=forums', array('admin' =&gt; true)) : false;
 
-$module['PERM']['PERMISSIONS']				= ($_CLASS['auth']-&gt;acl_get('a_auth')) ? generate_link('forums&amp;file=admin_permissions&amp;mode=forum', array('admin' =&gt; true)) : '';
-$module['PERM']['MODERATORS'] 				= ($_CLASS['auth']-&gt;acl_get('a_authmods')) ? generate_link('forums&amp;file=admin_permissions&amp;mode=mod', array('admin' =&gt; true)) : '';
-$module['PERM']['SUPER_MODERATORS']			= ($_CLASS['auth']-&gt;acl_get('a_authmods')) ? generate_link('forums&amp;file=admin_permissions&amp;mode=supermod', array('admin' =&gt; true)) : '';
-$module['PERM']['ADMINISTRATORS']			= ($_CLASS['auth']-&gt;acl_get('a_authadmins')) ? generate_link('forums&amp;file=admin_permissions&amp;mode=admin', array('admin' =&gt; true)) : '';
-$module['PERM']['USER_PERMS']				= ($_CLASS['auth']-&gt;acl_get('a_authusers')) ? generate_link('forums&amp;file=admin_permissions&amp;mode=user', array('admin' =&gt; true)) : '';
-$module['PERM']['GROUP_PERMS']				= ($_CLASS['auth']-&gt;acl_get('a_authgroups')) ? generate_link('forums&amp;file=admin_permissions&amp;mode=group', array('admin' =&gt; true)) : '';
+$module['PERM']['ACP_FORUM_PERMISSIONS']		= ($_CLASS['forums_auth']-&gt;acl_get('a_authusers') || $_CLASS['forums_auth']-&gt;acl_get('a_authgroups') || $_CLASS['forums_auth']-&gt;acl_get('a_viewauth')) ? generate_link('forums&amp;file=admin_permissions&amp;mode=setting_forum_local', array('admin' =&gt; true)) : '';
+$module['PERM']['ACP_FORUM_MODERATORS'] 		= ($_CLASS['forums_auth']-&gt;acl_get('a_mauth') &amp;&amp; ($_CLASS['forums_auth']-&gt;acl_get('a_authusers') || $_CLASS['forums_auth']-&gt;acl_get('a_authgroups'))) ? generate_link('forums&amp;file=admin_permissions&amp;mode=setting_mod_local', array('admin' =&gt; true)) : '';
+$module['PERM']['ACP_USERS_FORUM_PERMISSIONS']	= ($_CLASS['forums_auth']-&gt;acl_get('a_authusers') &amp;&amp; ($_CLASS['forums_auth']-&gt;acl_get('a_mauth') || $_CLASS['forums_auth']-&gt;acl_get('a_fauth'))) ? generate_link('forums&amp;file=admin_permissions&amp;mode=setting_user_local', array('admin' =&gt; true)) : '';
+$module['PERM']['ACP_GROUPS_FORUM_PERMISSIONS']	= ($_CLASS['forums_auth']-&gt;acl_get('a_authgroups') &amp;&amp; ($_CLASS['forums_auth']-&gt;acl_get('a_mauth') || $_CLASS['forums_auth']-&gt;acl_get('a_fauth'))) ? generate_link('forums&amp;file=admin_permissions&amp;mode=setting_group_local', array('admin' =&gt; true)) : '';
+$module['PERM']['ACP_ADMINISTRATORS']			= ($_CLASS['forums_auth']-&gt;acl_get('a_aauth') &amp;&amp; ($_CLASS['forums_auth']-&gt;acl_get('a_authusers') || $_CLASS['forums_auth']-&gt;acl_get('a_authgroups'))) ? generate_link('forums&amp;file=admin_permissions&amp;mode=setting_admin_global', array('admin' =&gt; true)) : '';
+$module['PERM']['ACP_GLOBAL_MODERATORS']		= ($_CLASS['forums_auth']-&gt;acl_get('a_mauth') &amp;&amp; ($_CLASS['forums_auth']-&gt;acl_get('a_authusers') || $_CLASS['forums_auth']-&gt;acl_get('a_authgroups'))) ? generate_link('forums&amp;file=admin_permissions&amp;mode=setting_mod_global', array('admin' =&gt; true)) : '';
 
-$module['GENERAL']['AVATAR_SETTINGS']		= ($_CLASS['auth']-&gt;acl_get('a_board')) ? generate_link('forums&amp;file=admin_board&amp;mode=avatar', array('admin' =&gt; true)) : '';
-$module['GENERAL']['BOARD_DEFAULTS']		= ($_CLASS['auth']-&gt;acl_get('a_defaults')) ? generate_link('forums&amp;file=admin_board&amp;mode=default', array('admin' =&gt; true)) : '';
-$module['GENERAL']['BOARD_SETTINGS']		= ($_CLASS['auth']-&gt;acl_get('a_board')) ? generate_link('forums&amp;file=admin_board&amp;mode=setting', array('admin' =&gt; true)) : '';
-$module['GENERAL']['EMAIL_SETTINGS']		= ($_CLASS['auth']-&gt;acl_get('a_server')) ? generate_link('forums&amp;file=admin_board&amp;mode=email', array('admin' =&gt; true)) : '';
-$module['GENERAL']['LOAD_SETTINGS']			= ($_CLASS['auth']-&gt;acl_get('a_server')) ? generate_link('forums&amp;file=admin_board&amp;mode=load', array('admin' =&gt; true)) : '';
-$module['GENERAL']['SERVER_SETTINGS']		= ($_CLASS['auth']-&gt;acl_get('a_server')) ? generate_link('forums&amp;file=admin_board&amp;mode=server', array('admin' =&gt; true)) : '';
-$module['GENERAL']['MESSAGE_SETTINGS']		= ($_CLASS['auth']-&gt;acl_get('a_defaults')) ? generate_link('forums&amp;file=admin_board&amp;mode=message', array('admin' =&gt; true)) : '';
-$module['GENERAL']['ATTACHMENT_SETTINGS'] 	= ($_CLASS['auth']-&gt;acl_get('a_attach')) ? generate_link('forums&amp;file=admin_attachments&amp;mode=attach', array('admin' =&gt; true)) : '';
-$module['GENERAL']['IM'] 					= ($_CLASS['auth']-&gt;acl_get('a_server')) ? generate_link('forums&amp;file=admin_jabber', array('admin' =&gt; true)) : '';
-$module['GENERAL']['PHP_INFO'] 				= ($_CLASS['auth']-&gt;acl_get('a_server')) ? generate_link('forums&amp;file=admin_phpinfo', array('admin' =&gt; true)) : '';
-$module['GENERAL']['MASS_EMAIL']			= ($_CLASS['auth']-&gt;acl_get('a_email')) ? generate_link('forums&amp;file=admin_email', array('admin' =&gt; true)) : '';
+$module['GENERAL']['AVATAR_SETTINGS']		= ($_CLASS['forums_auth']-&gt;acl_get('a_board')) ? generate_link('forums&amp;file=admin_board&amp;mode=avatar', array('admin' =&gt; true)) : '';
+$module['GENERAL']['BOARD_DEFAULTS']		= ($_CLASS['forums_auth']-&gt;acl_get('a_defaults')) ? generate_link('forums&amp;file=admin_board&amp;mode=default', array('admin' =&gt; true)) : '';
+$module['GENERAL']['BOARD_SETTINGS']		= ($_CLASS['forums_auth']-&gt;acl_get('a_board')) ? generate_link('forums&amp;file=admin_board&amp;mode=setting', array('admin' =&gt; true)) : '';
+$module['GENERAL']['EMAIL_SETTINGS']		= ($_CLASS['forums_auth']-&gt;acl_get('a_server')) ? generate_link('forums&amp;file=admin_board&amp;mode=email', array('admin' =&gt; true)) : '';
+$module['GENERAL']['LOAD_SETTINGS']			= ($_CLASS['forums_auth']-&gt;acl_get('a_server')) ? generate_link('forums&amp;file=admin_board&amp;mode=load', array('admin' =&gt; true)) : '';
+$module['GENERAL']['SERVER_SETTINGS']		= ($_CLASS['forums_auth']-&gt;acl_get('a_server')) ? generate_link('forums&amp;file=admin_board&amp;mode=server', array('admin' =&gt; true)) : '';
+$module['GENERAL']['MESSAGE_SETTINGS']		= ($_CLASS['forums_auth']-&gt;acl_get('a_defaults')) ? generate_link('forums&amp;file=admin_board&amp;mode=message', array('admin' =&gt; true)) : '';
+$module['GENERAL']['ATTACHMENT_SETTINGS'] 	= ($_CLASS['forums_auth']-&gt;acl_get('a_attach')) ? generate_link('forums&amp;file=admin_attachments&amp;mode=attach', array('admin' =&gt; true)) : '';
+$module['GENERAL']['IM'] 					= ($_CLASS['forums_auth']-&gt;acl_get('a_server')) ? generate_link('forums&amp;file=admin_jabber', array('admin' =&gt; true)) : '';
+$module['GENERAL']['PHP_INFO'] 				= ($_CLASS['forums_auth']-&gt;acl_get('a_server')) ? generate_link('forums&amp;file=admin_phpinfo', array('admin' =&gt; true)) : '';
+$module['GENERAL']['MASS_EMAIL']			= ($_CLASS['forums_auth']-&gt;acl_get('a_email')) ? generate_link('forums&amp;file=admin_email', array('admin' =&gt; true)) : '';
 
-$module['POST']['ATTACHMENTS'] 				= ($_CLASS['auth']-&gt;acl_get('a_attach')) ? generate_link('forums&amp;file=admin_attachments&amp;mode=ext_groups', array('admin' =&gt; true)) : '';
-$module['POST']['BBCODES']					= ($_CLASS['auth']-&gt;acl_get('a_bbcode')) ? generate_link('forums&amp;file=admin_bbcodes', array('admin' =&gt; true)) : '';
-$module['POST']['ICONS']					= ($_CLASS['auth']-&gt;acl_get('a_icons')) ? generate_link('forums&amp;file=admin_icons&amp;mode=icons', array('admin' =&gt; true)) : '';
+$module['POST']['ATTACHMENTS'] 				= ($_CLASS['forums_auth']-&gt;acl_get('a_attach')) ? generate_link('forums&amp;file=admin_attachments&amp;mode=ext_groups', array('admin' =&gt; true)) : '';
+$module['POST']['BBCODES']					= ($_CLASS['forums_auth']-&gt;acl_get('a_bbcode')) ? generate_link('forums&amp;file=admin_bbcodes', array('admin' =&gt; true)) : '';
+$module['POST']['ICONS']					= ($_CLASS['forums_auth']-&gt;acl_get('a_icons')) ? generate_link('forums&amp;file=admin_icons&amp;mode=icons', array('admin' =&gt; true)) : '';
 
 ?&gt;
\ No newline at end of file

Modified: cms/trunk/includes/forums/admin/main.php
===================================================================
--- cms/trunk/includes/forums/admin/main.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/forums/admin/main.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -16,18 +16,49 @@
 }
 
 // Do we have any admin permissions at all?
-if (!$_CLASS['auth']-&gt;acl_get('a_'))
+if (!$_CLASS['forums_auth']-&gt;acl_get('a_'))
 {
 	trigger_error($_CLASS['core_user']-&gt;lang['NO_ADMIN']);
 }
 
+/*
+// Show restore permissions notice
+if ($user-&gt;data['user_perm_from'] &amp;&amp; $auth-&gt;acl_get('a_switchperm'))
+{
+	$this-&gt;tpl_name = 'acp_main';
+	$this-&gt;page_title = 'ACP_MAIN';
+
+	$sql = 'SELECT user_id, username, user_colour
+		FROM ' . USERS_TABLE . '
+		WHERE user_id = ' . $user-&gt;data['user_perm_from'];
+	$result = $db-&gt;sql_query($sql);
+	$user_row = $db-&gt;sql_fetchrow($result);
+	$db-&gt;sql_freeresult($result);
+
+	$perm_from = '&lt;strong' . (($user_row['user_colour']) ? ' style=&quot;color: #' . $user_row['user_colour'] . '&quot;&gt;' : '&gt;');
+	$perm_from .= ($user_row['user_id'] != ANONYMOUS) ? '&lt;a href=&quot;' . append_sid(&quot;{$phpbb_root_path}memberlist.$phpEx&quot;, 'mode=viewprofile&amp;u=' . $user_row['user_id']) . '&quot;&gt;' : '';
+	$perm_from .= $user_row['username'];
+	$perm_from .= ($user_row['user_id'] != ANONYMOUS) ? '&lt;/a&gt;' : '';
+	$perm_from .= '&lt;/strong&gt;';
+
+	$template-&gt;assign_vars(array(
+		'S_RESTORE_PERMISSIONS'		=&gt; true,
+		'U_RESTORE_PERMISSIONS'		=&gt; append_sid(&quot;{$phpbb_root_path}ucp.$phpEx&quot;, 'mode=restore_perm'),
+		'PERM_FROM'					=&gt; $perm_from,
+		'L_PERMISSIONS_TRANSFERED_EXPLAIN'	=&gt; sprintf($user-&gt;lang['PERMISSIONS_TRANSFERED_EXPLAIN'], $perm_from, append_sid(&quot;{$phpbb_root_path}ucp.$phpEx&quot;, 'mode=restore_perm')),
+	));
+
+	return;
+}
+*/
+
 // Define some vars
 $action = request_var('action', '');
 
 switch ($action)
 {
 	case 'stats':
-		if (!$_CLASS['auth']-&gt;acl_get('a_board'))
+		if (!$_CLASS['forums_auth']-&gt;acl_get('a_board'))
 		{
 			trigger_error($_CLASS['core_user']-&gt;lang['NO_ADMIN']);
 		}
@@ -70,7 +101,7 @@
 	break;
 		
 	case 'user':
-		if (!$_CLASS['auth']-&gt;acl_get('a_defaults'))
+		if (!$_CLASS['forums_auth']-&gt;acl_get('a_defaults'))
 		{
 			trigger_error($_CLASS['core_user']-&gt;lang['NO_ADMIN']);
 		}

Modified: cms/trunk/includes/forums/auth.php
===================================================================
--- cms/trunk/includes/forums/auth.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/forums/auth.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -429,8 +429,8 @@
 
 		$sql_id = ($user_type == 'user') ? 'user_id' : 'group_id';
 
-		$sql_ug = ($ug_id !== false) ? ((!is_array($ug_id)) ? &quot;AND a.$sql_id = $ug_id&quot; : 'AND ' . $db-&gt;sql_in_set(&quot;a.$sql_id&quot;, $ug_id)) : '';
-		$sql_forum = ($forum_id !== false) ? ((!is_array($forum_id)) ? &quot;AND a.forum_id = $forum_id&quot; : 'AND ' . $db-&gt;sql_in_set('a.forum_id', $forum_id)) : '';
+		$sql_ug = ($ug_id !== false) ? (!is_array($ug_id) ? &quot;AND a.$sql_id = $ug_id&quot; : &quot;AND a.$sql_id IN (&quot; . implode(', ', $ug_id).')') : '';
+		$sql_forum = ($forum_id !== false) ? (!is_array($forum_id) ? &quot;AND a.forum_id = $forum_id&quot; : 'AND a.forum_id IN ('. implode(', ', $forum_id).')') : '';
 
 		// Grab assigned roles...
 		$sql = 'SELECT a.auth_role_id, a.' . $sql_id . ', a.forum_id
@@ -619,8 +619,9 @@
 
 		// Grab group settings ... ACL_NO overrides ACL_YES so act appropriatley
 		$sql = 'SELECT a.group_id, ao.auth_option, a.forum_id, a.auth_setting
-			FROM ' . FORUMS_ACL_OPTIONS_TABLE . ' ao, ' . FORUMS_ACL_GROUPS_TABLE . ' a
+			FROM ' . FORUMS_ACL_OPTIONS_TABLE . ' ao, ' . FORUMS_ACL_TABLE . ' a
 			WHERE ao.auth_option_id = a.auth_option_id
+				AND a.group_id IS NOT NULL AND a.group_id &lt;&gt; 0
 				' . (($sql_group) ? 'AND a.' . $sql_group : '') . &quot;
 				$sql_forum
 				$sql_opts

Modified: cms/trunk/includes/forums/functions_admin.php
===================================================================
--- cms/trunk/includes/forums/functions_admin.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/forums/functions_admin.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -24,11 +24,12 @@
 // -------------------------------------------------------------
 // Fix links &quot;defined('IN_ADMIN')&quot;
 // Simple version of jumpbox, just lists authed forums
-function make_forum_select($select_id = false, $ignore_id = false, $ignore_acl = false, $ignore_nonpost = false, $ignore_emptycat = true, $return_array = false)
+
+function make_forum_select($select_id = false, $ignore_id = false, $ignore_acl = false, $ignore_nonpost = false, $ignore_emptycat = true, $only_acl_post = false, $return_array = false)
 {
 	global $_CLASS;
 
-	$acl = ($ignore_acl) ? '' : array('f_list', 'a_forum', 'a_forumadd', 'a_forumdel');
+	$acl = ($ignore_acl) ? '' : (($only_acl_post) ? 'f_post' : array('f_list', 'a_forum', 'a_forumadd', 'a_forumdel'));
 
 	// This query is identical to the jumpbox one
 	$sql = 'SELECT forum_id, parent_id, forum_name, forum_type, forum_status, left_id, right_id
@@ -1334,7 +1335,7 @@
 				{
 					if ($row['forum_' . $fieldname] != $row[$fieldname])
 					{
-						if (preg_match('#name$#', $fieldname))
+						if (preg_match('#(name|colour)$#', $fieldname))
 						{
 							$sql['forum_' . $fieldname] = (string) $row[$fieldname];
 						}
@@ -1542,7 +1543,7 @@
 
 				foreach ($fieldnames as $fieldname)
 				{
-					if ($row['topic_' . $fieldname] != $row[$fieldname])
+					if (isset($row[$fieldname]) &amp;&amp; isset($row['topic_' . $fieldname]) &amp;&amp; $row['topic_' . $fieldname] != $row[$fieldname])
 					{
 						$sql['topic_' . $fieldname] = $row[$fieldname];
 					}
@@ -2332,7 +2333,7 @@
 				}
 				else if (strpos($line, '404 Not Found') !== false)
 				{
-					$errstr = $_CLASS['core_user']-&gt;lang['FILE_NOT_FOUND'];
+					$errstr = $_CLASS['core_user']-&gt;lang['FILE_NOT_FOUND'] . ': ' . $filename;
 					return false;
 				}
 			}

Modified: cms/trunk/includes/forums/functions_posting.php
===================================================================
--- cms/trunk/includes/forums/functions_posting.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/forums/functions_posting.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -303,8 +303,10 @@
 // Calculate the needed size for Thumbnail
 function get_img_size_format($width, $height)
 {
+	global $config;
+
 	// Maximum Width the Image can take
-	$max_width = 400;
+	$max_width = ($config['img_max_thumb_width']) ? $config['img_max_thumb_width'] : 400;
 
 	if ($width &gt; $height)
 	{
@@ -408,7 +410,7 @@
 
 	if (file_exists($destination) &amp;&amp; function_exists('passthru'))
 	{
-		passthru(escapeshellcmd($config['img_imagick']) . 'convert' . ((defined('PHP_OS') &amp;&amp; preg_match('#^win#i', PHP_OS)) ? '.exe' : '') . ' -quality 85 -antialias -sample ' . $new_width . 'x' . $new_height . ' &quot;' . str_replace('\\', '/', $source) . '&quot; +profile &quot;*&quot; &quot;' . str_replace('\\', '/', $destination) . '&quot;');
+		@passthru(escapeshellcmd($config['img_imagick']) . 'convert' . ((defined('PHP_OS') &amp;&amp; preg_match('#^win#i', PHP_OS)) ? '.exe' : '') . ' -quality 85 -antialias -sample ' . $new_width . 'x' . $new_height . ' &quot;' . str_replace('\\', '/', $source) . '&quot; +profile &quot;*&quot; &quot;' . str_replace('\\', '/', $destination) . '&quot;');
 		if (file_exists($new_file))
 		{
 			$used_imagick = true;
@@ -795,6 +797,9 @@
 
 		$post_subject = $row['post_subject'];
 		$message = $row['post_text'];
+		$message = censor_text($message);
+		$message = str_replace(&quot;\n&quot;, '&lt;br /&gt;', $message);
+
 		$decoded_message = false;
 
 		if ($show_quote_button &amp;&amp; $_CLASS['forums_auth']-&gt;acl_get('f_reply', $forum_id))
@@ -802,7 +807,6 @@
 			$decoded_message = $message;
 			decode_message($decoded_message, $row['bbcode_uid']);
 
-			$decoded_message = censor_text($decoded_message);
 			$decoded_message = str_replace(&quot;\n&quot;, &quot;&lt;br /&gt;&quot;, $decoded_message);
 		}
 
@@ -821,7 +825,7 @@
 			'POST_SUBJECT' 	=&gt; $post_subject,
 			'MINI_POST_IMG' =&gt; $_CLASS['core_user']-&gt;img('icon_post', $_CLASS['core_user']-&gt;lang['POST']),
 			'POST_DATE' 	=&gt; $_CLASS['core_user']-&gt;format_date($row['post_time']),
-			'MESSAGE' 		=&gt; str_replace(&quot;\n&quot;, '&lt;br /&gt;', $message), 
+			'MESSAGE' 		=&gt; $message, 
 			'DECODED_MESSAGE'	=&gt; $decoded_message,
 
 			'U_POST_ID'		=&gt; $row['post_id'],

Modified: cms/trunk/includes/forums/functions_privmsgs.php
===================================================================
--- cms/trunk/includes/forums/functions_privmsgs.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/forums/functions_privmsgs.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -297,6 +297,9 @@
 
 		case ACTION_MARK_AS_READ:
 		case ACTION_MARK_AS_IMPORTANT:
+			return array('action' =&gt; $rule_row['rule_action'], 'pm_unread' =&gt; $message_row['pm_unread'], 'pm_marked' =&gt; $message_row['pm_marked']);
+		break;
+
 		case ACTION_DELETE_MESSAGE:
 			return array('action' =&gt; $rule_row['rule_action'], 'pm_unread' =&gt; $message_row['pm_unread'], 'pm_marked' =&gt; $message_row['pm_marked']);
 		break;
@@ -510,8 +513,8 @@
 		}
 	}
 
-	$num_new += count(array_unique($delete_ids));
-	$num_unread += count(array_unique($delete_ids));
+//	$num_new += count(array_unique($delete_ids));
+//	$num_unread += count(array_unique($delete_ids));
 	$num_unread += count(array_unique($unread_ids));
 
 	// Do not change the order of processing
@@ -791,8 +794,13 @@
 			SET user_unread_privmsg = user_unread_privmsg '.(($read) ? '+ ' : '- '). &quot; $count
 			WHERE user_id = $user_id&quot;;
 		$_CLASS['core_db']-&gt;query($sql);
+		
+		if ($_CLASS['core_user']-&gt;data['user_id'] == $user_id)
+		{
+			$_CLASS['core_user']-&gt;data['user_unread_privmsg'] = $_CLASS['core_user']-&gt;data['user_unread_privmsg'] + (($read) ? $count : -$count));
+		}
 	}
-	
+
 	$_CLASS['core_db']-&gt;transaction('commit');
 }
 
@@ -995,8 +1003,11 @@
 			$set_sql .= ($set_sql != '') ? ', ' : '';
 			$set_sql .= 'user_new_privmsg = user_new_privmsg - ' . $num_new;
 		}
-		
+
 		$_CLASS['core_db']-&gt;query('UPDATE ' . CORE_USERS_TABLE . &quot; SET $set_sql WHERE user_id = $user_id&quot;);
+
+		$_CLASS['core_user']-&gt;data['user_new_privmsg'] -= $num_new;
+		$_CLASS['core_user']-&gt;data['user_unread_privmsg'] -= $num_unread;
 	}
 	
 	// Now we have to check which messages we can delete completely	
@@ -1170,7 +1181,7 @@
 						'IS_USER'	=&gt; ($type === 'user'),
 						'COLOUR'	=&gt; ($row['colour']) ? $row['colour'] : '',
 						'UG_ID'		=&gt; $id,
-						'U_VIEW'	=&gt; ($type === 'user') ? generate_link('members_list&amp;mode=viewprofile&amp;u=' . $id) : generate_link('members_list&amp;mode=group&amp;g=' . $id))
+						'U_VIEW'	=&gt; ($type === 'user') ? (($id != ANONYMOUS) ? generate_link('members_list&amp;mode=viewprofile&amp;u=' . $id) ? '') : generate_link('members_list&amp;mode=group&amp;g=' . $id))
 					);
 				}
 			}
@@ -1251,7 +1262,7 @@
 					$id = (int) $id;
 
 					// Do not rely on the address list being &quot;valid&quot;
-					if (!$id)
+					if (!$id || ($ug_type === 'u' &amp;&amp; $id == ANONYMOUS))
 					{
 						continue;
 					}

Modified: cms/trunk/includes/forums/functions_upload.php
===================================================================
--- cms/trunk/includes/forums/functions_upload.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/forums/functions_upload.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -305,7 +305,26 @@
 				{
 					$this-&gt;mimetype = $this-&gt;image_info['mime'];
 				}
+
+				// Check image type
+				$types = $this-&gt;upload-&gt;image_types();
+
+				if (!isset($types[$this-&gt;image_info[2]]) || !in_array($this-&gt;extension, $types[$this-&gt;image_info[2]]))
+				{
+					if (!isset($types[$this-&gt;image_info[2]]))
+					{
+						$this-&gt;error[] = sprintf($user-&gt;lang['IMAGE_FILETYPE_INVALID'], $this-&gt;image_info[2], $this-&gt;mimetype);
+					}
+					else
+					{
+						$this-&gt;error[] = sprintf($user-&gt;lang['IMAGE_FILETYPE_MISMATCH'], $types[$this-&gt;image_info[2]][0], $this-&gt;extension);
+					}
+				}
 			}
+			else
+			{
+				$this-&gt;error[] = $user-&gt;lang['UNABLE_GET_IMAGE_SIZE'];
+			}
 		}
 
 		$this-&gt;file_moved = true;
@@ -790,6 +809,31 @@
 	{
 		return (isset($_FILES[$form_name]) &amp;&amp; $_FILES[$form_name]['name'] != 'none') ? true : false;
 	}
+
+	/**
+	* Return image type/extension mapping 
+	*/
+	function image_types()
+	{
+		return array(
+			1 =&gt; array('gif'),
+			2 =&gt; array('jpg', 'jpeg'),
+			3 =&gt; array('png'),
+			4 =&gt; array('swf'),
+			5 =&gt; array('psd'),
+			6 =&gt; array('bmp'),
+			7 =&gt; array('tif', 'tiff'),
+			8 =&gt; array('tif', 'tiff'),
+			9 =&gt; array('jpg', 'jpeg'),
+			10 =&gt; array('jpg', 'jpeg'),
+			11 =&gt; array('jpg', 'jpeg'),
+			12 =&gt; array('jpg', 'jpeg'),
+			13 =&gt; array('swc'),
+			14 =&gt; array('iff'),
+			15 =&gt; array('wbmp'),
+			16 =&gt; array('xbm'),
+		);
+	}
 }
 
 ?&gt;
\ No newline at end of file

Modified: cms/trunk/includes/forums/mcp/mcp_forum.php
===================================================================
--- cms/trunk/includes/forums/mcp/mcp_forum.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/forums/mcp/mcp_forum.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -220,8 +220,8 @@
 
 	$topic_title = censor_text($row['topic_title']);
 
-	$topic_unapproved = (!$row['topic_approved'] &amp;&amp; $_CLASS['forums_auth']-&gt;acl_gets('m_approve', $row['forum_id']));
-	$posts_unapproved = ($row['topic_approved'] &amp;&amp; $row['topic_replies'] &lt; $row['topic_replies_real'] &amp;&amp; $_CLASS['forums_auth']-&gt;acl_gets('m_approve', $row['forum_id']));
+	$topic_unapproved = (!$row['topic_approved'] &amp;&amp; $_CLASS['forums_auth']-&gt;acl_get('m_approve', $row['forum_id']));
+	$posts_unapproved = ($row['topic_approved'] &amp;&amp; $row['topic_replies'] &lt; $row['topic_replies_real'] &amp;&amp; $_CLASS['forums_auth']-&gt;acl_get('m_approve', $row['forum_id']));
 	$u_mcp_queue = ($topic_unapproved || $posts_unapproved) ? generate_link($url . '&amp;i=queue&amp;mode='.(($topic_unapproved) ? 'approve_details' : 'unapproved_posts') .'&amp;t=' . $row['topic_id'], false, false) : false;
 
 	$_CLASS['core_template']-&gt;assign_vars_array('topicrow', array(
@@ -232,7 +232,7 @@
 		'U_MCP_QUEUE'		=&gt; $u_mcp_queue,
 		'U_MCP_REPORT'		=&gt; generate_link(&quot;forums&amp;file=mcp&amp;i=main&amp;mode=topic_view&amp;t={$row['topic_id']}&amp;action=reports&quot;),
 
-		'ATTACH_ICON_IMG'	=&gt; ($_CLASS['forums_auth']-&gt;acl_gets('f_download', 'u_download', $row['forum_id']) &amp;&amp; $row['topic_attachment']) ? $_CLASS['core_user']-&gt;img('icon_attach', $_CLASS['core_user']-&gt;lang['TOTAL_ATTACHMENTS']) : '',
+		'ATTACH_ICON_IMG'	=&gt; ($_CLASS['forums_auth']-&gt;acl_get('u_download') &amp;&amp; $_CLASS['forums_auth']-&gt;acl_get('f_download', $row['forum_id']) &amp;&amp; $row['topic_attachment']) ? $_CLASS['core_user']-&gt;img('icon_attach', $_CLASS['core_user']-&gt;lang['TOTAL_ATTACHMENTS']) : '',
 		'TOPIC_FOLDER_IMG' 	=&gt; $_CLASS['core_user']-&gt;img($folder_img, $folder_alt),
 		//'TOPIC_FOLDER_IMG_SRC'	=&gt; $user-&gt;img($folder_img, $folder_alt, false, '', 'src'),
 
@@ -248,7 +248,7 @@
 		'TOPIC_ID'			=&gt; $row['topic_id'],
 		'S_TOPIC_CHECKED'	=&gt; ($topic_id_list &amp;&amp; in_array($row['topic_id'], $topic_id_list)) ? 'checked=&quot;checked&quot; ' : '',
 
-		'S_TOPIC_REPORTED'	=&gt; (!empty($row['topic_reported']) &amp;&amp; $_CLASS['forums_auth']-&gt;acl_gets('m_report', $row['forum_id'])),
+		'S_TOPIC_REPORTED'	=&gt; (!empty($row['topic_reported']) &amp;&amp; $_CLASS['forums_auth']-&gt;acl_get('m_report', $row['forum_id'])),
 		'S_TOPIC_UNAPPROVED'=&gt; $topic_unapproved,
 		'S_POSTS_UNAPPROVED'=&gt; $posts_unapproved,
 		'NEWEST_POST_IMG' =&gt; false

Modified: cms/trunk/includes/functions.php
===================================================================
--- cms/trunk/includes/functions.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/functions.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -317,8 +317,8 @@
 		{
 			$bots[] = $row;
 		}
+		$_CLASS['core_db']-&gt;free_result($result);
 
-		$_CLASS['core_db']-&gt;free_result($result);
 		$_CLASS['core_cache']-&gt;put('bots', $bots);
 	}
 
@@ -342,7 +342,6 @@
 			$censors['word_match'][] = '#\b(' . str_replace('\*', '\w*?', preg_quote($row['word_match'], '#')) . ')\b#i';
 			$censors['word_replace'][] = $row['word_replacement'];
 		}
-
 		$_CLASS['core_db']-&gt;free_result($result);
 
 		$_CLASS['core_cache']-&gt;put('word_censors', $censors);
@@ -690,7 +689,7 @@
 {
 	global $_CLASS;
 
-	$_CLASS['core_auth']-&gt;do_login($login_options, $template);
+	$_CLASS['core_auth']-&gt;auth_login($login_options, $template);
 }
 
 function set_core_config($section, $name, $value, $clear_cache = true, $auto_add = false, $type = 'string', $cache = true)
@@ -1068,6 +1067,30 @@
 	}
 }
 
+function group_select_options($group_id, $exclude_ids = false)
+{
+	global $_CLASS, $CORE_CONFIG;
+
+	$exclude_sql = ($exclude_ids !== false &amp;&amp; sizeof($exclude_ids)) ? 'WHERE group_id NOT IN ('. implode(', ', array_map('intval', $exclude_ids)) .')' : '';
+	$sql_and = (!$CORE_CONFIG['user']['coppa_enable']) ? (($exclude_sql) ? ' AND ' : ' WHERE ') . &quot;group_name NOT IN ('INACTIVE_COPPA', 'REGISTERED_COPPA')&quot; : '';
+
+	$sql = 'SELECT group_id, group_name, group_type 
+		FROM ' . CORE_GROUPS_TABLE . &quot;
+		$exclude_sql
+		$sql_and
+		ORDER BY group_type DESC, group_name ASC&quot;;
+	$result = $_CLASS['core_db']-&gt;query($sql);
+
+	$s_group_options = '';
+	while ($row = $_CLASS['core_db']-&gt;fetch_row_assoc($result))
+	{
+		$selected = ($row['group_id'] == $group_id) ? ' selected=&quot;selected&quot;' : '';
+		$s_group_options .= '&lt;option' . (($row['group_type'] == GROUP_SPECIAL) ? ' class=&quot;sep&quot;' : '') . ' value=&quot;' . $row['group_id'] . '&quot;' . $selected . '&gt;' . (($row['group_type'] == GROUP_SPECIAL) ? $_CLASS['core_user']-&gt;lang['G_' . $row['group_name']] : $row['group_name']) . '&lt;/option&gt;';
+	}
+	$_CLASS['core_db']-&gt;free_result($result);
+
+	return $s_group_options;
+}
 
 // FROM PHPBB
 

Modified: cms/trunk/includes/session.php
===================================================================
--- cms/trunk/includes/session.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/session.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -313,8 +313,10 @@
 		$sql = 'DELETE FROM ' . CORE_SESSIONS_AUTOLOGIN_TABLE . ' 
 			WHERE user_id = '.(INT) $user_id.&quot;
 			AND auto_login_code = '&quot; . $_CLASS['core_db']-&gt;escape($code) . &quot;'&quot;;
-				
+
 		$_CLASS['core_db']-&gt;query($sql);
+
+		$_CLASS['core_db']-&gt;optimize_tables(CORE_SESSIONS_AUTOLOGIN_TABLE);
 	}
 
 	function session_destroy($session_id = false, $logout = true)

Modified: cms/trunk/includes/templates/admin/modules/edit.html
===================================================================
--- cms/trunk/includes/templates/admin/modules/edit.html	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/templates/admin/modules/edit.html	2006-09-12 14:55:25 UTC (rev 187)
@@ -1,103 +1,56 @@
-&lt;style type=&quot;text/css&quot;&gt;@import url(java/jscalendar/skins/aqua/theme.css);&lt;/style&gt;
-&lt;script type=&quot;text/javascript&quot; src=&quot;java/jscalendar/calendar_stripped.js&quot;&gt;&lt;/script&gt;
-&lt;script type=&quot;text/javascript&quot; src=&quot;java/jscalendar/lang/calendar-en.js&quot;&gt;&lt;/script&gt;
-&lt;script type=&quot;text/javascript&quot; src=&quot;java/jscalendar/calendar-setup.js&quot;&gt;&lt;/script&gt;
+&lt;!-- DISPLAY_HEADER --&gt;
 
-{ $THEME_TABLE_OPEN }
+{ $THEME_TABLE_OPEN }
 
 &lt;form action=&quot;{ $B_ACTION }&quot; method=&quot;post&quot;&gt;
 	&lt;table class=&quot;tablebg&quot; align=&quot;center&quot; border=&quot;0&quot; cellpadding=&quot;4&quot; cellspacing=&quot;1&quot; width=&quot;100%&quot;&gt;
 		&lt;tbody&gt;
-		{ if $B_ERROR }
+			&lt;!-- IF { $ADMIN_PAGE_ERROR } --&gt;
 			&lt;tr&gt; 
 				&lt;td class=&quot;row2&quot; align=&quot;center&quot; colspan=&quot;3&quot;&gt;
-					&lt;font color=&quot;#990000&quot;&gt;{ $B_ERROR }&lt;/font&gt;
+					&lt;font class=&quot;error&quot;&gt;{ $ADMIN_PAGE_ERROR }&lt;/font&gt;
 				&lt;/td&gt;
 			&lt;/tr&gt;
-		{ /if }
+			&lt;!-- ENDIF --&gt;
 			&lt;tr&gt; 
-				&lt;th colspan=&quot;3&quot; height=&quot;28&quot; valign=&quot;middle&quot;&gt;{ $B_HEADER }&lt;/th&gt;
+				&lt;th colspan=&quot;3&quot; height=&quot;28&quot; valign=&quot;middle&quot;&gt;{ $ADMIN_PAGE_NAME }&lt;/th&gt;
 			&lt;/tr&gt;
-		
 			&lt;tr&gt; 
 				&lt;td class=&quot;row1&quot; width=&quot;20%&quot;&gt;&lt;b class=&quot;genmed&quot;&gt;{ $L_TITLE }: &lt;/b&gt;&lt;/td&gt;
-		
-				&lt;td class=&quot;row2&quot; colspan=&quot;2&quot;&gt;&lt;input class=&quot;post&quot; name=&quot;b_title&quot; size=&quot;40&quot; maxlength=&quot;100&quot; value=&quot;{ $B_TITLE }&quot; type=&quot;text&quot;&gt;&lt;/td&gt;
+				&lt;td class=&quot;row2&quot; colspan=&quot;2&quot;&gt;&lt;input class=&quot;post&quot; name=&quot;b_title&quot; size=&quot;40&quot; maxlength=&quot;100&quot; value=&quot;{ $ADMIN_PAGE_TITLE }&quot; type=&quot;text&quot;&gt;&lt;/td&gt;
 			&lt;/tr&gt;
 			&lt;tr&gt; 
 				&lt;td class=&quot;row1&quot;&gt;&lt;b class=&quot;genmed&quot;&gt;{ $L_ACTIVE }: &lt;/b&gt;&lt;/td&gt;
-				&lt;td class=&quot;row2&quot; colspan=&quot;2&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;b_active&quot; value=&quot;1&quot;{ if $B_ACTIVE } checked=&quot;checked&quot; { /if }/&gt;&lt;span class=&quot;genmed&quot;&gt;{$L_YES}&lt;/span&gt;&nbsp;&nbsp;&lt;input type=&quot;radio&quot; name=&quot;b_active&quot; value=&quot;0&quot;{ if !$B_ACTIVE } checked=&quot;checked&quot; { /if }/&gt;&lt;span class=&quot;genmed&quot;&gt;{$L_NO}&lt;/span&gt;&lt;/td&gt;
-			&lt;/tr&gt;
-			&lt;tr&gt; 
-				&lt;td class=&quot;row1&quot;&gt;&lt;b class=&quot;genmed&quot;&gt;{ $L_STARTS }: &lt;/b&gt;&lt;/td&gt;
-				&lt;td class=&quot;row2&quot; &gt;
-					&lt;input class=&quot;post&quot; id=&quot;b_time&quot; name=&quot;b_time&quot; size=&quot;35&quot; maxlength=&quot;100&quot; value=&quot;{ $B_STARTS }&quot; type=&quot;text&quot; /&gt;
-					&lt;img src=&quot;java/jscalendar/calendar.png&quot; style=&quot;cursor: pointer;&quot; id=&quot;time_trigger&quot; /&gt;
-					{ if $B_STARTS }   Currently Set:  { $B_STARTS }{ /if }
+				&lt;td class=&quot;row2&quot; colspan=&quot;2&quot;&gt;&lt;/td&gt;
+			&lt;/tr&gt;
+		&lt;/tbody&gt;
+	&lt;/table&gt;
+&lt;br /&gt;
+	&lt;table class=&quot;tablebg&quot; align=&quot;center&quot; border=&quot;0&quot; cellpadding=&quot;4&quot; cellspacing=&quot;1&quot; width=&quot;100%&quot;&gt;
+		&lt;tbody&gt;
+			&lt;tr&gt;
+		&lt;!-- LOOP $ADMIN_PAGE_BLOCKS_ARRAY --&gt;
+
+			&lt;!-- IF { $ADMIN_PAGE_BLOCKS_ARRAY:#LOOP_NUMBER } % 2 --&gt;
+			&lt;/tr&gt;&lt;tr&gt;
+			&lt;!-- ENDIF --&gt;
+				&lt;td class=&quot;row1&quot; width=&quot;20%&quot;&gt;&lt;b class=&quot;genmed&quot;&gt;{ $ADMIN_PAGE_BLOCKS_ARRAY:name }: &lt;/b&gt;&lt;/td&gt;
+				&lt;td class=&quot;row2&quot; colspan=&quot;2&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;checkbox&quot; name=&quot;blocks_array[]&quot; value=&quot;{ $ADMIN_PAGE_BLOCKS_ARRAY:value }&quot;&lt;!-- IF { $ADMIN_PAGE_BLOCKS_ARRAY:checked } --&gt; checked=&quot;checked&quot;&gt;&lt;!-- ENDIF --&gt;&lt;/td&gt;
+		&lt;!-- ENDLOOP $ADMIN_PAGE_BLOCKS_ARRAY --&gt;
+			&lt;/tr&gt;
+		&lt;/tbody&gt;
+	&lt;/table&gt;
+	&lt;table class=&quot;tablebg&quot; align=&quot;center&quot; border=&quot;0&quot; cellpadding=&quot;4&quot; cellspacing=&quot;1&quot; width=&quot;100%&quot;&gt;
+		&lt;tbody&gt;
+			&lt;tr&gt;
+				&lt;td class=&quot;cat&quot; colspan=&quot;3&quot; align=&quot;center&quot; height=&quot;28&quot;&gt;
+					&lt;input class=&quot;button&quot; name=&quot;submit&quot; value=&quot;Submit&quot; type=&quot;submit&quot; /&gt;&nbsp;&nbsp;&lt;input class=&quot;button&quot; value=&quot;Reset&quot; name=&quot;reset&quot; type=&quot;reset&quot; /&gt;
 				&lt;/td&gt;
-				&lt;td class=&quot;row1&quot; align=&quot;center&quot; rowspan=&quot;2&quot;&gt;&lt;b class=&quot;genmed&quot;&gt;Current Server Time:&lt;/b&gt;&lt;br/&gt;{ $B_CURRENT_TIME } &lt;/td&gt;
 			&lt;/tr&gt;
-			&lt;tr&gt; 
-				&lt;td class=&quot;row1&quot;&gt;&lt;b class=&quot;genmed&quot;&gt;{ $L_EXPIRES }: &lt;/b&gt;&lt;/td&gt;
-				&lt;td class=&quot;row2&quot;&gt;
-					&lt;input class=&quot;post&quot; id=&quot;b_expires&quot; name=&quot;b_expires&quot; size=&quot;35&quot; maxlength=&quot;100&quot; value=&quot;{ $B_EXPIRES }&quot; type=&quot;text&quot; /&gt;
-					&lt;img src=&quot;java/jscalendar/calendar.png&quot; style=&quot;cursor: pointer;&quot;  id=&quot;expires_trigger&quot; /&gt;
-					{ if $B_EXPIRES }    Currently Set:  { $B_EXPIRES }{ /if }
-				&lt;/td&gt;
-			&lt;/tr&gt;
-			{ if $B_POSITION }
-			&lt;tr&gt; 
-				&lt;td class=&quot;row1&quot;&gt;&lt;b class=&quot;genmed&quot;&gt;{ $L_POSITION }: &lt;/b&gt;&lt;/td&gt;
-				&lt;td class=&quot;row2&quot; colspan=&quot;2&quot;&gt;&lt;select name=&quot;b_position&quot;&gt;{ $B_POSITION }&lt;/select&gt;&lt;/td&gt;
-			&lt;/tr&gt;
-			{ /if }
-			{ if $B_RSS_SHOW }
-				&lt;tr&gt; 
-				&lt;td class=&quot;row1&quot;&gt;&lt;b class=&quot;genmed&quot;&gt;{ $L_RSS_URL }: &lt;/b&gt;&lt;/td&gt;
-				&lt;td class=&quot;row2&quot; colspan=&quot;2&quot;&gt;&lt;input class=&quot;post&quot; name=&quot;b_url&quot; size=&quot;35&quot; maxlength=&quot;100&quot; value=&quot;{ $B_RSS_URL }&quot; type=&quot;text&quot;&gt;&lt;/td&gt;
-			&lt;/tr&gt;
-			&lt;tr&gt; 
-				&lt;td class=&quot;row1&quot;&gt;&lt;b class=&quot;genmed&quot;&gt;{ $L_RSS_REFRESH }: &lt;/b&gt;&lt;/td&gt;
-				&lt;td class=&quot;row2&quot; colspan=&quot;2&quot;&gt;&lt;input class=&quot;post&quot; name=&quot;b_refresh&quot; size=&quot;35&quot; maxlength=&quot;100&quot; value=&quot;{ $B_RSS_REFRESH }&quot; type=&quot;text&quot;&gt;{ if $B_EXPIRES }    Currently Set:  { $B_EXPIRES }{ /if }&lt;/td&gt;
-			&lt;/tr&gt;
-			{ /if }
-			{ if $B_FILE }
-			&lt;tr&gt; 
-				&lt;td class=&quot;row1&quot;&gt;&lt;b class=&quot;genmed&quot;&gt;{ $L_FILE }: &lt;/b&gt;&lt;/td&gt;
-				&lt;td class=&quot;row2&quot; colspan=&quot;2&quot;&gt;&lt;select name=&quot;b_file&quot;&gt;{ $B_FILE }&lt;/select&gt; &lt;/td&gt;
-		
-			&lt;/tr&gt;
-			{ /if }
-			{ if $B_SHOW_CONTENT }
-			&lt;tr&gt; 
-				&lt;td class=&quot;row1&quot; valign=&quot;top&quot;&gt;&lt;b class=&quot;genmed&quot;&gt;{ $L_HTML_CONTENT }: &lt;/b&gt;&lt;/td&gt;
-				&lt;td class=&quot;row2&quot; colspan=&quot;2&quot;&gt;&lt;textarea name=&quot;b_content&quot; id=&quot;b_content&quot; editor_enabled=&quot;true&quot; style=&quot;width:300px; height:200px&quot; cols=&quot;63&quot; rows=&quot;15&quot;&gt;{ $B_CONTENT }&lt;/textarea&gt;&lt;br /&gt;&lt;/td&gt;
-			&lt;/tr&gt;
-			{ /if }
-			&lt;tr&gt;
-				&lt;td class=&quot;cat&quot; colspan=&quot;3&quot; align=&quot;center&quot; height=&quot;28&quot;&gt;
-				&lt;input class=&quot;btnmain&quot; name=&quot;submit&quot; value=&quot;Submit&quot; type=&quot;submit&quot;&gt;&nbsp;&nbsp;&lt;input class=&quot;btnlite&quot; value=&quot;Reset&quot; name=&quot;reset&quot; type=&quot;reset&quot;&gt;&lt;/td&gt;
-			&lt;/tr&gt;
 		&lt;/tbody&gt;
 	&lt;/table&gt;
 &lt;/form&gt;
-{literal}
-&lt;script type=&quot;text/javascript&quot;&gt;
-  Calendar.setup(
-    {
-      inputField  : &quot;b_time&quot;,
-      button      : &quot;time_trigger&quot;
-    }
-  );
-&lt;/script&gt;
-&lt;script type=&quot;text/javascript&quot;&gt;
-  Calendar.setup(
-    {
-      inputField  : &quot;b_expires&quot;,
-      button      : &quot;expires_trigger&quot;
-    }
-  );
-&lt;/script&gt;
-{/literal}
 
-{ $THEME_TABLE_CLOSE }
\ No newline at end of file
+{ $THEME_TABLE_CLOSE }
+
+&lt;!-- DISPLAY_FOOTER --&gt;
\ No newline at end of file

Modified: cms/trunk/includes/templates/modules/control_panel/ucp_pm_viewfolder.html
===================================================================
--- cms/trunk/includes/templates/modules/control_panel/ucp_pm_viewfolder.html	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/templates/modules/control_panel/ucp_pm_viewfolder.html	2006-09-12 14:55:25 UTC (rev 187)
@@ -49,14 +49,15 @@
 			&lt;!-- ENDIF --&gt;
 			&lt;p class=&quot;topictitle&quot;&gt;
 				{ $messagerow:ATTACH_ICON_IMG } 
-				
 				&lt;!-- IF { $messagerow:S_PM_DELETED } --&gt;
 					{ $L_MESSAGE_REMOVED_FROM_OUTBOX }&lt;br /&gt;
 					&lt;a href=&quot;{ $messagerow:U_REMOVE_PM}&quot; style=&quot;float:right;&quot;&gt;{ $L_DELETE_MESSAGE }&lt;/a&gt;
 				&lt;!-- ELSE --&gt;
 					&lt;a href=&quot;{ $messagerow:U_VIEW_PM }&quot;&gt;{ $messagerow:SUBJECT }&lt;/a&gt;
 				&lt;!-- ENDIF --&gt;
-				
+				&lt;!-- IF messagerow.S_AUTHOR_DELETED --&gt;
+					&lt;br /&gt;&lt;em class=&quot;gensmall&quot;&gt;{ $L_PM_FROM_REMOVED_AUTHOR }&lt;/em&gt;
+				&lt;!-- ENDIF --&gt;
 			&lt;/p&gt;&lt;/td&gt;
 		&lt;td class=&quot;row1&quot; width=&quot;100&quot; align=&quot;center&quot;&gt;&lt;p class=&quot;topicauthor&quot;&gt;&lt;!-- IF { $S_SHOW_RECIPIENTS } --&gt;{ $messagerow:RECIPIENTS }&lt;!-- ELSE --&gt;{$messagerow:MESSAGE_AUTHOR}&lt;!-- ENDIF --&gt;&lt;/p&gt;&lt;/td&gt;
 		&lt;!-- IF { $S_UNREAD } --&gt;

Modified: cms/trunk/includes/templates/modules/control_panel/ucp_pm_viewmessage.html
===================================================================
--- cms/trunk/includes/templates/modules/control_panel/ucp_pm_viewmessage.html	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/templates/modules/control_panel/ucp_pm_viewmessage.html	2006-09-12 14:55:25 UTC (rev 187)
@@ -12,7 +12,7 @@
 
 	&lt;tr class=&quot;row1&quot;&gt;
 		&lt;td class=&quot;genmed&quot; nowrap=&quot;nowrap&quot; width=&quot;150&quot;&gt;&lt;b&gt;{ $L_PM_FROM }:&lt;/b&gt;&lt;/td&gt;
-		&lt;td class=&quot;gen&quot;&gt;&lt;a href=&quot;{$U_AUTHOR_PROFILE}&quot;&gt;{ $AUTHOR_NAME }&lt;/a&gt;&lt;/td&gt;
+		&lt;td class=&quot;gen&quot;&gt;&lt;!-- IF { $U_AUTHOR_PROFILE } --&gt;&lt;a href=&quot;{ $U_AUTHOR_PROFILE }&quot;&gt;{ $AUTHOR_NAME }&lt;/a&gt;&lt;!-- ELSE --&gt;{ $AUTHOR_NAME }&lt;!-- ENDIF --&gt;&lt;/td&gt;
 	&lt;/tr&gt;
 
 	&lt;tr class=&quot;row1&quot;&gt;
@@ -25,7 +25,11 @@
 		&lt;td class=&quot;genmed&quot; nowrap=&quot;nowrap&quot; width=&quot;150&quot;&gt;&lt;b&gt;{ $L_TO }:&lt;/b&gt;&lt;/td&gt;
 		&lt;td class=&quot;gen&quot;&gt;
 		&lt;!-- LOOP $to_recipient --&gt;
-			&lt;a href=&quot;{ $to_recipient:U_VIEW }&quot;&gt;&lt;!-- IF { $to_recipient:COLOUR } --&gt;&lt;span style=&quot;color:#{ $to_recipient:COLOUR }&quot;&gt;&lt;!-- ELSE --&gt;&lt;span&lt;!-- IF { $to_recipient:IS_GROUP} --&gt; class=&quot;blue&quot;&lt;!-- ENDIF --&gt;&gt;&lt;!-- ENDIF --&gt;{ $to_recipient:NAME }&lt;/span&gt;&lt;/a&gt;&nbsp;
+			&lt;!-- IF !{ $to_recipient:U_VIEW } --&gt;
+				&lt;span&lt;!-- IF { $to_recipient:COLOUR } --&gt; style=&quot;color:#{ $to_recipient:COLOUR }&quot;&lt;!-- ELSEIF { $to_recipient:IS_GROUP } --&gt; class=&quot;blue&quot;&lt;!-- ENDIF --&gt;{ $to_recipient:NAME }&lt;/span&gt;&nbsp;
+			&lt;!-- ELSE --&gt;
+				&lt;a href=&quot;{ $to_recipient:U_VIEW }&quot;&gt;&lt;!-- IF { $to_recipient:COLOUR } --&gt;&lt;span style=&quot;color:#{ $to_recipient:COLOUR }&quot;&gt;&lt;!-- ELSE --&gt;&lt;span&lt;!-- IF { $to_recipient:IS_GROUP} --&gt; class=&quot;blue&quot;&lt;!-- ENDIF --&gt;&gt;&lt;!-- ENDIF --&gt;{ $to_recipient:NAME }&lt;/span&gt;&lt;/a&gt;&nbsp;
+			&lt;!-- ENDIF --&gt;
 		&lt;!-- ENDLOOP $to_recipient --&gt;
 		&lt;/td&gt;
 	&lt;/tr&gt;
@@ -36,7 +40,11 @@
 		&lt;td class=&quot;genmed&quot; nowrap=&quot;nowrap&quot; width=&quot;150&quot;&gt;&lt;b&gt;{ $L_BCC }:&lt;/b&gt;&lt;/td&gt;
 		&lt;td class=&quot;gen&quot;&gt;
 		&lt;!-- LOOP $bcc_recipient --&gt;
-			&lt;a href=&quot;{ $bcc_recipient:U_VIEW }&quot;&gt;&lt;!-- IF { $bcc_recipient:COLOUR } --&gt;&lt;span style=&quot;color:#{ $bcc_recipient:COLOUR }&quot;&gt;&lt;!-- ELSE --&gt;&lt;span&lt;!-- IF { $bcc_recipient:IS_GROUP } --&gt; class=&quot;blue&quot;&lt;!-- ENDIF --&gt;&gt;&lt;!-- ENDIF --&gt;{ $bcc_recipient:NAME }&lt;/span&gt;&lt;/a&gt;&nbsp;
+			&lt;!-- IF !{ $bcc_recipient:U_VIEW } --&gt;
+				&lt;span&lt;!-- IF { $bcc_recipient:COLOUR } --&gt; style=&quot;color:#{ $bcc_recipient:COLOUR }&quot;&lt;!-- ELSEIF { $bcc_recipient:IS_GROUP } --&gt; class=&quot;blue&quot;&lt;!-- ENDIF --&gt;{ $bcc_recipient:NAME }&lt;/span&gt;&nbsp;
+			&lt;!-- ELSE --&gt;
+				&lt;a href=&quot;{ $bcc_recipient:U_VIEW }&quot;&gt;&lt;!-- IF { $bcc_recipient:COLOUR } --&gt;&lt;span style=&quot;color:#{ $bcc_recipient:COLOUR }&quot;&gt;&lt;!-- ELSE --&gt;&lt;span&lt;!-- IF { $bcc_recipient:IS_GROUP } --&gt; class=&quot;blue&quot;&lt;!-- ENDIF --&gt;&gt;&lt;!-- ENDIF --&gt;{ $bcc_recipient:NAME }&lt;/span&gt;&lt;/a&gt;&nbsp;
+			&lt;!-- ENDIF --&gt;
 		&lt;!-- ENDLOOP $bcc_recipient --&gt;
 		&lt;/td&gt;
 	&lt;/tr&gt;

Modified: cms/trunk/includes/templates/modules/forums/admin/acp_forums.html
===================================================================
--- cms/trunk/includes/templates/modules/forums/admin/acp_forums.html	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/templates/modules/forums/admin/acp_forums.html	2006-09-12 14:55:25 UTC (rev 187)
@@ -67,7 +67,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_FORUM_TYPE }:
+			&lt;strong&gt;{ $L_FORUM_TYPE }:&lt;/strong&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;select id=&quot;forum_type&quot; name=&quot;forum_type&quot; onchange=&quot;display_options(this.options[this.selectedIndex].value);&quot;&gt;{ $S_FORUM_TYPE_OPTIONS }&lt;/select&gt;
@@ -77,7 +77,7 @@
 	&lt;!-- IF !{ $S_ADD_ACTION } &amp;&amp; { $S_FORUM_ORIG_POST } --&gt;
 	&lt;tr id=&quot;type_actions&quot;&lt;!-- IF { $S_FORUM_POST } --&gt; style=&quot;display: none;&quot;&lt;!-- ENDIF --&gt;&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_DECIDE_MOVE_DELETE_CONTENT }:
+			&lt;strong&gt;{ $L_DECIDE_MOVE_DELETE_CONTENT }:&lt;/strong&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;radio&quot; class=&quot;radio&quot; id=&quot;type_action&quot; name=&quot;type_action&quot; value=&quot;delete&quot; checked=&quot;checked&quot; /&gt; { $L_DELETE_ALL_POSTS }
@@ -87,7 +87,7 @@
 	&lt;!-- ENDIF --&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_FORUM_PARENT }:
+			&lt;strong&gt;{ $L_FORUM_PARENT }:&lt;/strong&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;select id=&quot;parent&quot; name=&quot;forum_parent_id&quot;&gt;&lt;option value=&quot;0&quot;&lt;!-- IF !{ $S_FORUM_PARENT_ID } --&gt; selected=&quot;selected&quot;&lt;!-- ENDIF --&gt;&gt;{ $L_NO_PARENT }&lt;/option&gt;{ $S_PARENT_OPTIONS }&lt;/select&gt;
@@ -95,15 +95,15 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_FORUM_NAME }:
+			&lt;strong&gt;{ $L_FORUM_NAME }:&lt;/strong&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input class=&quot;medium&quot; type=&quot;text&quot; id=&quot;forum_name&quot; name=&quot;forum_name&quot; value=&quot;{ $FORUM_NAME }&quot; /&gt;
 		&lt;/td&gt;
 	&lt;/tr&gt;
 	&lt;tr&gt;
-		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_FORUM_DESC }:&lt;br /&gt;&lt;span&gt;{ $L_FORUM_DESC_EXPLAIN }&lt;/span&gt;
+		&lt;td valign=&quot;top&quot; width=&quot;40%&quot; class=&quot;row1&quot;&gt;
+			&lt;strong&gt;{ $L_FORUM_DESC }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_FORUM_DESC_EXPLAIN }&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;textarea id=&quot;forum_desc&quot; name=&quot;forum_desc&quot; rows=&quot;5&quot; cols=&quot;45&quot;&gt;{ $FORUM_DESC }&lt;/textarea&gt;
@@ -113,7 +113,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_FORUM_IMAGE }:&lt;br /&gt;&lt;span&gt;{ $L_FORUM_IMAGE_EXPLAIN }&lt;/span&gt;&lt;/dt&gt;
+			&lt;strong&gt;{ $L_FORUM_IMAGE }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_FORUM_IMAGE_EXPLAIN }&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input class=&quot;medium&quot; type=&quot;text&quot; id=&quot;forum_image&quot; name=&quot;forum_image&quot; value=&quot;{ $FORUM_IMAGE }&quot; /&gt;
@@ -124,7 +124,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_FORUM_STYLE }:&lt;/dt&gt;
+			&lt;strong&gt;{ $L_FORUM_STYLE }:&lt;/strong&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;select id=&quot;forum_style&quot; name=&quot;forum_style&quot;&gt;&lt;option value=&quot;0&quot;&gt;{ $L_DEFAULT_STYLE }&lt;/option&gt;{ $S_STYLES_OPTIONS }&lt;/select&gt;
@@ -132,7 +132,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_COPY_PERMISSIONS }:&lt;br /&gt;&lt;span&gt;{ $L_COPY_PERMISSIONS_EXPLAIN }&lt;/span&gt;
+			&lt;strong&gt;{ $L_COPY_PERMISSIONS }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_COPY_PERMISSIONS_EXPLAIN }&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;select id=&quot;forum_perm_from&quot; name=&quot;forum_perm_from&quot;&gt;&lt;option value=&quot;0&quot;&gt;{ $L_NO_PERMISSIONS }&lt;/option&gt;{ $S_FORUM_OPTIONS }&lt;/select&gt;
@@ -150,7 +150,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_DISPLAY_ACTIVE_TOPICS }:&lt;br /&gt;&lt;span&gt;{ $L_DISPLAY_ACTIVE_TOPICS_EXPLAIN }&lt;/span&gt;
+			&lt;strong&gt;{ $L_DISPLAY_ACTIVE_TOPICS }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_DISPLAY_ACTIVE_TOPICS_EXPLAIN }&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;display_active&quot; value=&quot;1&quot;&lt;!-- IF { $S_DISPLAY_ACTIVE_TOPICS } --&gt; id=&quot;display_active&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_YES } &nbsp; &lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;display_active&quot; value=&quot;0&quot;&lt;!-- IF !{ $S_DISPLAY_ACTIVE_TOPICS } --&gt; id=&quot;display_active&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_NO }
@@ -165,12 +165,12 @@
 &lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
 	&lt;tr&gt;
 		&lt;th colspan=&quot;2&quot;&gt;
-			{ $L_GENERAL_FORUM_SETTINGS }&lt;/legend&gt;
+			{ $L_GENERAL_FORUM_SETTINGS }
 		&lt;/th&gt;
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			&lt;label for=&quot;forum_status&quot;&gt;{ $L_FORUM_STATUS }:
+			&lt;strong&gt;{ $L_FORUM_STATUS }:&lt;/strong&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;select id=&quot;forum_status&quot; name=&quot;forum_status&quot;&gt;{ $S_STATUS_OPTIONS }&lt;/select&gt;
@@ -179,7 +179,7 @@
 	&lt;!-- IF { $S_SHOW_DISPLAY_ON_INDEX } --&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_LIST_INDEX }:&lt;br /&gt;&lt;span&gt;{ $L_LIST_INDEX_EXPLAIN }&lt;/span&gt;
+			&lt;strong&gt;{ $L_LIST_INDEX }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_LIST_INDEX_EXPLAIN }&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;display_on_index&quot; value=&quot;1&quot;&lt;!-- IF { $S_DISPLAY_ON_INDEX } --&gt; id=&quot;display_on_index&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_YES } &nbsp; &lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;display_on_index&quot; value=&quot;0&quot;&lt;!-- IF !{ $S_DISPLAY_ON_INDEX } --&gt; id=&quot;display_on_index&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_NO }
@@ -188,7 +188,7 @@
 	&lt;!-- ENDIF --&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_ENABLE_POST_REVIEW }:&lt;br /&gt;&lt;span&gt;{ $L_ENABLE_POST_REVIEW_EXPLAIN }&lt;/span&gt;
+			&lt;strong&gt;{ $L_ENABLE_POST_REVIEW }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_ENABLE_POST_REVIEW_EXPLAIN }&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;enable_post_review&quot; value=&quot;1&quot;&lt;!-- IF { $S_ENABLE_POST_REVIEW } --&gt; id=&quot;enable_post_review&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_YES } &nbsp; &lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;enable_post_review&quot; value=&quot;0&quot;&lt;!-- IF !{ $S_ENABLE_POST_REVIEW } --&gt; id=&quot;enable_post_review&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_NO }
@@ -196,7 +196,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_ENABLE_INDEXING }:&lt;br /&gt;&lt;span&gt;{ $L_ENABLE_INDEXING_EXPLAIN}&lt;/span&gt;
+			&lt;strong&gt;{ $L_ENABLE_INDEXING }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_ENABLE_INDEXING_EXPLAIN}&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;enable_indexing&quot; value=&quot;1&quot;&lt;!-- IF { $S_ENABLE_INDEXING } --&gt; id=&quot;enable_indexing&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_YES} &nbsp; &lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;enable_indexing&quot; value=&quot;0&quot;&lt;!-- IF !{ $S_ENABLE_INDEXING } --&gt; id=&quot;enable_indexing&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_NO }
@@ -204,7 +204,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_ENABLE_TOPIC_ICONS }:
+			&lt;strong&gt;{ $L_ENABLE_TOPIC_ICONS }:&lt;/strong&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;enable_icons&quot; value=&quot;1&quot;&lt;!-- IF { $S_TOPIC_ICONS } --&gt; id=&quot;enable_icons&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_YES} &nbsp; &lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;enable_icons&quot; value=&quot;0&quot;&lt;!-- IF !{ $S_TOPIC_ICONS } --&gt; id=&quot;enable_icons&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_NO }
@@ -212,7 +212,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_ENABLE_RECENT }:&lt;br /&gt;&lt;span&gt;{ $L_ENABLE_RECENT_EXPLAIN}&lt;/span&gt;
+			&lt;strong&gt;{ $L_ENABLE_RECENT }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_ENABLE_RECENT_EXPLAIN}&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;display_recent&quot; value=&quot;1&quot;&lt;!-- IF { $S_DISPLAY_ACTIVE_TOPICS } --&gt; id=&quot;display_recent&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_YES} &nbsp; &lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;display_recent&quot; value=&quot;0&quot;&lt;!-- IF !{ $S_DISPLAY_ACTIVE_TOPICS } --&gt; id=&quot;display_recent&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_NO }
@@ -220,7 +220,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_FORUM_TOPICS_PAGE }:&lt;br /&gt;&lt;span&gt;{ $L_FORUM_TOPICS_PAGE_EXPLAIN}&lt;/span&gt;
+			&lt;strong&gt;{ $L_FORUM_TOPICS_PAGE }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_FORUM_TOPICS_PAGE_EXPLAIN}&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;text&quot; id=&quot;topics_per_page&quot; name=&quot;topics_per_page&quot; value=&quot;{ $TOPICS_PER_PAGE }&quot; /&gt;
@@ -228,7 +228,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_FORUM_PASSWORD }:&lt;br /&gt;&lt;span&gt;{ $L_FORUM_PASSWORD_EXPLAIN}&lt;/span&gt;
+			&lt;strong&gt;{ $L_FORUM_PASSWORD }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_FORUM_PASSWORD_EXPLAIN}&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;password&quot; id=&quot;forum_password&quot; name=&quot;forum_password&quot; value=&quot;{ $FORUM_PASSWORD }&quot; /&gt;
@@ -236,7 +236,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_FORUM_PASSWORD_CONFIRM }:&lt;br /&gt;&lt;span&gt;{ $L_FORUM_PASSWORD_CONFIRM_EXPLAIN}&lt;/span&gt;
+			&lt;strong&gt;{ $L_FORUM_PASSWORD_CONFIRM }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_FORUM_PASSWORD_CONFIRM_EXPLAIN}&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;password&quot; id=&quot;forum_password_confirm&quot; name=&quot;forum_password_confirm&quot; value=&quot;{ $FORUM_PASSWORD_CONFIRM }&quot; /&gt;
@@ -252,7 +252,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_FORUM_AUTO_PRUNE }:&lt;br /&gt;&lt;span&gt;{ $L_FORUM_AUTO_PRUNE_EXPLAIN}&lt;/span&gt;
+			&lt;strong&gt;{ $L_FORUM_AUTO_PRUNE }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_FORUM_AUTO_PRUNE_EXPLAIN}&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;enable_prune&quot; value=&quot;1&quot;&lt;!-- IF { $S_PRUNE_ENABLE } --&gt; id=&quot;enable_prune&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_YES } &nbsp; &lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;enable_prune&quot; value=&quot;0&quot;&lt;!-- IF !{ $S_PRUNE_ENABLE } --&gt; id=&quot;enable_prune&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_NO }
@@ -260,7 +260,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_AUTO_PRUNE_FREQ }:&lt;br /&gt;&lt;span&gt;{ $L_AUTO_PRUNE_FREQ_EXPLAIN }&lt;/span&gt;
+			&lt;strong&gt;{ $L_AUTO_PRUNE_FREQ }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_AUTO_PRUNE_FREQ_EXPLAIN }&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;text&quot; id=&quot;prune_freq&quot; name=&quot;prune_freq&quot; value=&quot;{ $PRUNE_FREQ }&quot; /&gt; { $L_DAYS }
@@ -268,7 +268,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_AUTO_PRUNE_DAYS }:&lt;br /&gt;&lt;span&gt;{ $L_AUTO_PRUNE_DAYS_EXPLAIN }&lt;/span&gt;
+			&lt;strong&gt;{ $L_AUTO_PRUNE_DAYS }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_AUTO_PRUNE_DAYS_EXPLAIN }&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;text&quot; id=&quot;prune_days&quot; name=&quot;prune_days&quot; value=&quot;{ $PRUNE_DAYS }&quot; /&gt; { $L_DAYS }
@@ -276,7 +276,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_AUTO_PRUNE_VIEWED }:&lt;br /&gt;&lt;span&gt;{ $L_AUTO_PRUNE_VIEWED_EXPLAIN }&lt;/span&gt;
+			&lt;strong&gt;{ $L_AUTO_PRUNE_VIEWED }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_AUTO_PRUNE_VIEWED_EXPLAIN }&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;text&quot; id=&quot;prune_viewed&quot; name=&quot;prune_viewed&quot; value=&quot;{ $PRUNE_VIEWED }&quot; /&gt; { $L_DAYS }
@@ -284,7 +284,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_PRUNE_OLD_POLLS }:&lt;br /&gt;&lt;span&gt;{ $L_PRUNE_OLD_POLLS_EXPLAIN }&lt;/span&gt;
+			&lt;strong&gt;{ $L_PRUNE_OLD_POLLS }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_PRUNE_OLD_POLLS_EXPLAIN }&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;prune_old_polls&quot; value=&quot;1&quot;&lt;!-- IF { $S_PRUNE_OLD_POLLS } --&gt; id=&quot;prune_old_polls&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_YES } &nbsp; &lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;prune_old_polls&quot; value=&quot;0&quot;&lt;!-- IF !{ $S_PRUNE_OLD_POLLS } --&gt; id=&quot;prune_old_polls&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_NO }
@@ -292,7 +292,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_PRUNE_ANNOUNCEMENTS}:
+			&lt;strong&gt;{ $L_PRUNE_ANNOUNCEMENTS}:&lt;/strong&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;prune_announce&quot; value=&quot;1&quot;&lt;!-- IF { $S_PRUNE_ANNOUNCE } --&gt; id=&quot;prune_announce&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_YES } &nbsp; &lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;prune_announce&quot; value=&quot;0&quot;&lt;!-- IF !{ $S_PRUNE_ANNOUNCE } --&gt; id=&quot;prune_announce&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_NO }
@@ -300,7 +300,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_PRUNE_STICKY}:
+			&lt;strong&gt;{ $L_PRUNE_STICKY}:&lt;/strong&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;prune_sticky&quot; value=&quot;1&quot;&lt;!-- IF { $S_PRUNE_STICKY } --&gt; id=&quot;prune_sticky&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_YES} &nbsp; &lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;prune_sticky&quot; value=&quot;0&quot;&lt;!-- IF !{ $S_PRUNE_STICKY } --&gt; id=&quot;prune_sticky&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_NO}
@@ -320,7 +320,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_FORUM_LINK }:&lt;br /&gt;&lt;span&gt;{ $L_FORUM_LINK_EXPLAIN }&lt;/span&gt;
+			&lt;strong&gt;{ $L_FORUM_LINK }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_FORUM_LINK_EXPLAIN }&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input class=&quot;medium&quot; type=&quot;text&quot; id=&quot;forum_link&quot; name=&quot;forum_link&quot; value=&quot;{ $FORUM_DATA_LINK }&quot; /&gt;
@@ -328,7 +328,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_FORUM_LINK_TRACK }:&lt;br /&gt;&lt;span&gt;{ $L_FORUM_LINK_TRACK_EXPLAIN }&lt;/span&gt;
+			&lt;strong&gt;{ $L_FORUM_LINK_TRACK }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_FORUM_LINK_TRACK_EXPLAIN }&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;forum_link_track&quot; value=&quot;1&quot;&lt;!-- IF { $S_FORUM_LINK_TRACK } --&gt; id=&quot;forum_link_track&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_YES } &nbsp; &lt;input type=&quot;radio&quot; class=&quot;radio&quot; name=&quot;forum_link_track&quot; value=&quot;0&quot;&lt;!-- IF !{ $S_FORUM_LINK_TRACK } --&gt; id=&quot;forum_link_track&quot; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; /&gt; { $L_NO }
@@ -347,8 +347,8 @@
 		&lt;/th&gt;
 	&lt;/tr&gt;
 	&lt;tr&gt;
-		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_FORUM_RULES_LINK }:&lt;br /&gt;&lt;span&gt;{ $L_FORUM_RULES_LINK_EXPLAIN }&lt;/span&gt;
+		&lt;td width=&quot;40%&quot; class=&quot;row1&quot;&gt;
+			&lt;strong&gt;{ $L_FORUM_RULES_LINK }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_FORUM_RULES_LINK_EXPLAIN }&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input class=&quot;medium&quot; type=&quot;text&quot; id=&quot;forum_rules_link&quot; name=&quot;forum_rules_link&quot; value=&quot;{ $FORUM_RULES_LINK }&quot; /&gt;
@@ -357,7 +357,7 @@
 	&lt;!-- IF { $FORUM_RULES_PREVIEW } --&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_FORUM_RULES_PREVIEW }:
+			&lt;strong&gt;{ $L_FORUM_RULES_PREVIEW }:&lt;/strong&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			{ $FORUM_RULES_PREVIEW }
@@ -365,8 +365,8 @@
 	&lt;/tr&gt;
 	&lt;!-- ENDIF --&gt;
 	&lt;tr&gt;
-		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_FORUM_RULES }:&lt;br /&gt;&lt;span&gt;{ $L_FORUM_RULES_EXPLAIN }&lt;/span&gt;
+		&lt;td valign=&quot;top&quot; width=&quot;40%&quot; class=&quot;row1&quot;&gt;
+			&lt;strong&gt;{ $L_FORUM_RULES }:&lt;/strong&gt;&lt;br /&gt;&lt;span&gt;{ $L_FORUM_RULES_EXPLAIN }&lt;/span&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;textarea id=&quot;forum_rules&quot; name=&quot;forum_rules&quot; rows=&quot;4&quot; cols=&quot;70&quot;&gt;{ $FORUM_RULES_PLAIN }&lt;/textarea&gt;
@@ -413,7 +413,7 @@
 	&lt;/tr&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_FORUM_NAME }:
+			&lt;strong&gt;{ $L_FORUM_NAME }:&lt;/strong&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;b&gt;{ $FORUM_NAME }&lt;/b&gt;
@@ -422,7 +422,7 @@
 	&lt;!-- IF { $S_FORUM_POST } --&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_ACTION }:
+			&lt;strong&gt;{ $L_ACTION }:&lt;/strong&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;radio&quot; class=&quot;radio&quot; id=&quot;delete_action&quot; name=&quot;action_posts&quot; value=&quot;delete&quot; checked=&quot;checked&quot; /&gt; { $L_DELETE_ALL_POSTS}
@@ -434,7 +434,7 @@
 	&lt;!-- IF { $S_HAS_SUBFORUMS } --&gt;
 	&lt;tr&gt;
 		&lt;td  width=&quot;40%&quot; class=&quot;row1&quot;&gt;
-			{ $L_ACTION }:
+			&lt;strong&gt;{ $L_ACTION }:&lt;/strong&gt;
 		&lt;/td&gt;
 		&lt;td class=&quot;row2&quot;&gt;
 			&lt;input type=&quot;radio&quot; class=&quot;radio&quot; id=&quot;sub_delete_action&quot; name=&quot;action_subforums&quot; value=&quot;delete&quot; checked=&quot;checked&quot; /&gt; { $L_DELETE_SUBFORUMS }
@@ -477,40 +477,59 @@
 			&lt;p&gt;{ $L_FORUM_RESYNCED }&lt;/p&gt;
 		&lt;/div&gt;
 	&lt;!-- ENDIF --&gt;
-	
-	&lt;p&gt;&lt;strong&gt;{ $NAVIGATION }&lt;!-- IF { $S_NO_FORUMS } --&gt; [&lt;a href=&quot;{ $U_EDIT }&quot;&gt;{ $L_EDIT }&lt;/a&gt; | &lt;a href=&quot;{ $U_DELETE }&quot;&gt;{ $L_DELETE }&lt;/a&gt;&lt;!-- IF !{ $S_LINK } --&gt; | &lt;a href=&quot;{ $U_SYNC }&quot;&gt;{ $L_RESYNC }&lt;/a&gt;&lt;!-- ENDIF ---&gt;]&lt;!-- ENDIF --&gt;&lt;/strong&gt;&lt;/p&gt;
-
-	&lt;!-- IF !empty({ $forums }) --&gt;
-		&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
-			&lt;col class=&quot;row1&quot; /&gt;&lt;col class=&quot;row1&quot; /&gt;&lt;col class=&quot;row2&quot; /&gt;
+	&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
 		&lt;tbody&gt;
+			&lt;tr&gt;
+				&lt;td colspan=&quot;3&quot; class=&quot;cat&quot;&gt;
+					&lt;strong&gt;
+					{ $NAVIGATION }
+					&lt;!-- IF { $S_NO_FORUMS } --&gt;
+						[ &lt;a href=&quot;{ $U_EDIT }&quot;&gt;{ $L_EDIT }&lt;/a&gt; | &lt;a href=&quot;{ $U_DELETE }&quot;&gt;{ $L_DELETE }&lt;/a&gt;&lt;!-- IF !isset({ $S_LINK }) || !{ $S_LINK } --&gt; | &lt;a href=&quot;{ $U_SYNC }&quot;&gt;{ $L_RESYNC }&lt;/a&gt;&lt;!-- ENDIF ---&gt; ]
+					&lt;!-- ENDIF --&gt;
+					&lt;/strong&gt;
+				 &lt;/td&gt;
+			&lt;/tr&gt;
 		&lt;!-- LOOP $forums --&gt;
 			&lt;tr&gt;
-				&lt;td style=&quot;width: 5%;&quot;&gt;{ $forums:FOLDER_IMAGE }&lt;/td&gt;
-				&lt;td&gt;
-					&lt;strong&gt;&lt;!-- IF isset({ $forums:S_LINK }) &amp;&amp; { $forums:S_LINK } --&gt;{ $forums:FORUM_NAME }&lt;!-- ELSE --&gt;&lt;a href=&quot;{ $forums:U_FORUM }&quot;&gt;{ $forums:FORUM_NAME }&lt;/a&gt;&lt;!-- ENDIF --&gt;&lt;/strong&gt;
+				&lt;td class=&quot;row1&quot; style=&quot;width: 5%;&quot;&gt;{ $forums:FOLDER_IMAGE }&lt;/td&gt;
+				&lt;td class=&quot;row1&quot;&gt;
+					&lt;strong&gt;&lt;!-- IF { $forums:S_FORUM_LINK } --&gt;{ $forums:FORUM_NAME }&lt;!-- ELSE --&gt;&lt;a href=&quot;{ $forums:U_FORUM }&quot;&gt;{ $forums:FORUM_NAME }&lt;/a&gt;&lt;!-- ENDIF --&gt;&lt;/strong&gt;
 					&lt;!-- IF { $forums:FORUM_DESCRIPTION } --&gt;&lt;br /&gt;&lt;span&gt;{ $forums:FORUM_DESCRIPTION }&lt;/span&gt;&lt;!-- ENDIF --&gt;
-					&lt;!-- IF { $forums:S_FORUM_POST } --&gt;&lt;br /&gt;&lt;br /&gt;&lt;span&gt;{ $L_TOPICS }: &lt;b&gt;{ $forums:FORUM_TOPICS }&lt;/b&gt; / { $L_POSTS }: &lt;b&gt;{ $forums:FORUM_POSTS }&lt;/b&gt;&lt;/span&gt;&lt;!-- ENDIF --&gt;
+					&lt;!-- IF { $forums:S_FORUM_POST } --&gt;&lt;br /&gt;&lt;br /&gt;&lt;span&gt;{ $L_TOPICS }:&lt;/strong&gt; &lt;b&gt;{ $forums:FORUM_TOPICS }&lt;/b&gt; / { $L_POSTS }:&lt;/strong&gt; &lt;b&gt;{ $forums:FORUM_POSTS }&lt;/b&gt;&lt;/span&gt;&lt;!-- ENDIF --&gt;
 				&lt;/td&gt;
-				&lt;td style=&quot;width: 15%; text-align: right; white-space: nowrap;&quot;&gt;
-					&lt;!-- IF !{ $forums:#LOOP_START } --&gt;&lt;a href=&quot;{ $forums:U_MOVE_UP }&quot;&gt;{ $ICON_MOVE_UP }&lt;/a&gt; &lt;!-- ENDIF --&gt;
-					&lt;!-- IF !{ $forums:#LOOP_END } --&gt;&lt;a href=&quot;{ $forums:U_MOVE_DOWN }&quot;&gt;{ $ICON_MOVE_DOWN }&lt;/a&gt; &lt;!-- ENDIF --&gt;
+				&lt;td class=&quot;row2&quot; style=&quot;vertical-align: top; width: 100px; text-align: right; white-space: nowrap;&quot;&gt;
+					&lt;!-- IF !{ $forums:#LOOP_START } &amp;&amp; !{ $forums:#LOOP_END } --&gt;
+						{ $ICON_MOVE_UP_DISABLED }
+						&lt;a href=&quot;{ $forums:U_MOVE_UP }&quot;&gt;{ $ICON_MOVE_DOWN }&lt;/a&gt;
+					&lt;!-- ELSEIF !{ $forums:#LOOP_START } &amp;&amp; !{ $forums:#LOOP_END }--&gt;
+						&lt;a href=&quot;{ $forums:U_MOVE_UP }&quot;&gt;{ $ICON_MOVE_UP }&lt;/a&gt; 
+						&lt;a href=&quot;{ $forums:U_MOVE_DOWN }&quot;&gt;{ $ICON_MOVE_DOWN }&lt;/a&gt; 
+					&lt;!-- ELSEIF  { $forums:#LOOP_END } &amp;&amp; !{ $forums:#LOOP_START } --&gt;						
+						&lt;a href=&quot;{ $forums:U_MOVE_UP }&quot;&gt;{ $ICON_MOVE_UP }&lt;/a&gt;	
+						{ $ICON_MOVE_DOWN_DISABLED }
+					&lt;!-- ELSE --&gt;
+						{ $ICON_MOVE_UP_DISABLED }
+						{ $ICON_MOVE_DOWN_DISABLED }			
+					&lt;!-- ENDIF --&gt;					
 					&lt;a href=&quot;{ $forums:U_EDIT }&quot;&gt;{ $ICON_EDIT }&lt;/a&gt; 
-					&lt;!-- IF !isset({ $forums:S_LINK }) || !{ $forums:S_LINK } --&gt;&lt;a href=&quot;{ $forums:U_SYNC }&quot;&gt;{ $ICON_SYNC }&lt;/a&gt; &lt;!-- ENDIF --&gt;
+					&lt;!-- IF !{ $forums:S_FORUM_LINK } --&gt;
+						&lt;a href=&quot;{ $forums:U_SYNC }&quot;&gt;{ $ICON_SYNC }&lt;/a&gt; 
+					&lt;!-- ELSE --&gt;
+						{ $ICON_SYNC_DISABLED }
+					&lt;!-- ENDIF --&gt;
 					&lt;a href=&quot;{ $forums:U_DELETE }&quot;&gt;{ $ICON_DELETE }&lt;/a&gt;
 				&lt;/td&gt;
 			&lt;/tr&gt;
 		&lt;!-- ENDLOOP $forums --&gt;
 		&lt;/tbody&gt;
-	&lt;/table&gt;
-	&lt;!-- ENDIF --&gt;
+	&lt;/table&gt;
 
 	&lt;form id=&quot;fselect&quot; method=&quot;post&quot; action=&quot;{ $U_SEL_ACTION }&quot;&gt;
 
 	&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
 		&lt;tr&gt;
 			&lt;td align=&quot;right&quot; class=&quot;row1&quot;&gt;
-				{ $L_SELECT_FORUM }: &lt;select name=&quot;parent_id&quot; onchange=&quot;if(this.options[this.selectedIndex].value != -1){ this.form.submit(); }&quot;&gt;{ $FORUM_BOX }&lt;/select&gt; 
+				&lt;strong&gt;{ $L_SELECT_FORUM }:&lt;/strong&gt; &lt;select name=&quot;parent_id&quot; onchange=&quot;if(this.options[this.selectedIndex].value != -1){ this.form.submit(); }&quot;&gt;{ $FORUM_BOX }&lt;/select&gt; 
 				&lt;input class=&quot;button&quot; type=&quot;submit&quot; value=&quot;{ $L_GO }&quot; /&gt;
 			&lt;/td&gt;
 		&lt;/tr&gt;

Modified: cms/trunk/includes/templates/modules/forums/admin/acp_main.html
===================================================================
--- cms/trunk/includes/templates/modules/forums/admin/acp_main.html	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/templates/modules/forums/admin/acp_main.html	2006-09-12 14:55:25 UTC (rev 187)
@@ -1,100 +1,107 @@
 &lt;!-- INCLUDE modules/forums/admin/overall_header.html --&gt;
 
-&lt;a name=&quot;maincontent&quot;&gt;&lt;/a&gt;&lt;h1&gt;{ $L_WELCOME_PHPBB }&lt;/h1&gt;
+&lt;a name=&quot;maincontent&quot;&gt;&lt;/a&gt;
 
-&lt;p&gt;{ $L_ADMIN_INTRO }&lt;/p&gt;
-
-&lt;form id=&quot;stats&quot; method=&quot;post&quot; action=&quot;{ $U_ACTION }&quot;&gt;
-
-&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot;&gt;
-	&lt;caption&gt;{ $L_FORUM_STATS }&lt;/caption&gt;
-&lt;thead&gt;
-	&lt;tr&gt;
-		&lt;th&gt;{ $L_STATISTIC }&lt;/th&gt;
-		&lt;th&gt;{ $L_VALUE }&lt;/th&gt;
-		&lt;th&gt;{ $L_STATISTIC }&lt;/th&gt;
-		&lt;th&gt;{ $L_VALUE }&lt;/th&gt;
-	&lt;/tr&gt;
-&lt;/thead&gt;
-&lt;tbody&gt;
-	&lt;tr&gt;
-		&lt;td class=&quot;row1&quot;&gt;{ $L_NUMBER_POSTS }: &lt;/td&gt;
-		&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $TOTAL_POSTS }&lt;/b&gt;&lt;/td&gt;
-		&lt;td class=&quot;row1&quot;&gt;{ $L_POSTS_PER_DAY }: &lt;/td&gt;
-		&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $POSTS_PER_DAY }&lt;/b&gt;&lt;/td&gt;
-	&lt;/tr&gt;
-	&lt;tr&gt;
-		&lt;td class=&quot;row1&quot;&gt;{ $L_NUMBER_TOPICS }: &lt;/td&gt;
-		&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $TOTAL_TOPICS }&lt;/b&gt;&lt;/td&gt;
-		&lt;td class=&quot;row1&quot;&gt;{ $L_TOPICS_PER_DAY }: &lt;/td&gt;
-		&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $TOPICS_PER_DAY }&lt;/b&gt;&lt;/td&gt;
-	&lt;/tr&gt;
-	&lt;tr&gt;
-		&lt;td class=&quot;row1&quot;&gt;{ $L_NUMBER_USERS }: &lt;/td&gt;
-		&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $TOTAL_USERS }&lt;/b&gt;&lt;/td&gt;
-		&lt;td class=&quot;row1&quot;&gt;{ $L_USERS_PER_DAY }: &lt;/td&gt;
-		&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $USERS_PER_DAY }&lt;/b&gt;&lt;/td&gt;
-	&lt;/tr&gt;
-	&lt;tr&gt;
-		&lt;td class=&quot;row1&quot;&gt;{ $L_NUMBER_FILES }: &lt;/td&gt;
-		&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $TOTAL_FILES }&lt;/b&gt;&lt;/td&gt;
-		&lt;td class=&quot;row1&quot;&gt;{ $L_FILES_PER_DAY }: &lt;/td&gt;
-		&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $FILES_PER_DAY }&lt;/b&gt;&lt;/td&gt;
-	&lt;/tr&gt;
-	&lt;tr&gt;
-		&lt;td class=&quot;row1&quot;&gt;{ $L_BOARD_STARTED }: &lt;/td&gt;
-		&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $START_DATE }&lt;/b&gt;&lt;/td&gt;
-		&lt;td class=&quot;row1&quot;&gt;{ $L_AVATAR_DIR_SIZE }: &lt;/td&gt;
-		&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $AVATAR_DIR_SIZE }&lt;/b&gt;&lt;/td&gt;
-	&lt;/tr&gt;
-	&lt;tr&gt;
-		&lt;td class=&quot;row1&quot;&gt;{ $L_UPLOAD_DIR_SIZE }: &lt;/td&gt;
-		&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $UPLOAD_DIR_SIZE }&lt;/b&gt;&lt;/td&gt;
-	&lt;/tr&gt;
-&lt;!-- IF { $S_ACTION_OPTIONS } --&gt;
-	&lt;tr&gt;
-		&lt;td class=&quot;cat&quot; colspan=&quot;4&quot; align=&quot;right&quot;&gt;
+&lt;!-- IF { $S_RESTORE_PERMISSIONS } --&gt;
+	&lt;h1&gt;{ $L_PERMISSIONS_TRANSFERED }&lt;/h1&gt;
+	&lt;p&gt;{ $L_PERMISSIONS_TRANSFERED_EXPLAIN }&lt;/p&gt;
+&lt;!-- ELSE --&gt;
+	&lt;h1&gt;{ $L_WELCOME_PHPBB }&lt;/h1&gt;
 	
-		&lt;select name=&quot;action&quot;&gt;{ $S_ACTION_OPTIONS }&lt;/select&gt;
-		&lt;input class=&quot;button&quot; type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;{ $L_SUBMIT }&quot; /&gt;
-	&lt;/tr&gt;
-&lt;!-- ENDIF --&gt;
-&lt;/tbody&gt;
-&lt;/table&gt;
-
-&lt;/form&gt;
-
-
-&lt;!-- IF !empty({ $log }) --&gt;
-	&lt;h2&gt;{ $L_ADMIN_LOG }&lt;/h2&gt;
-
-	&lt;p&gt;{ $L_ADMIN_LOG_INDEX_EXPLAIN }&lt;/p&gt;
-
+	&lt;p&gt;{ $L_ADMIN_INTRO }&lt;/p&gt;
+	
+	&lt;form id=&quot;stats&quot; method=&quot;post&quot; action=&quot;{ $U_ACTION }&quot;&gt;
+	
 	&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot;&gt;
+		&lt;caption&gt;{ $L_FORUM_STATS }&lt;/caption&gt;
 	&lt;thead&gt;
-	&lt;tr&gt;
-		&lt;th&gt;{ $L_USERNAME }&lt;/th&gt;
-		&lt;th&gt;{ $L_IP }&lt;/th&gt;
-		&lt;th&gt;{ $L_TIME }&lt;/th&gt;
-		&lt;th&gt;{ $L_ACTION }&lt;/th&gt;
-	&lt;/tr&gt;
+		&lt;tr&gt;
+			&lt;th&gt;{ $L_STATISTIC }&lt;/th&gt;
+			&lt;th&gt;{ $L_VALUE }&lt;/th&gt;
+			&lt;th&gt;{ $L_STATISTIC }&lt;/th&gt;
+			&lt;th&gt;{ $L_VALUE }&lt;/th&gt;
+		&lt;/tr&gt;
 	&lt;/thead&gt;
 	&lt;tbody&gt;
-	&lt;!-- LOOP $log --&gt;
-		&lt;!-- IF { $log:#LOOP_INDEX } % 2 --&gt;&lt;tr class=&quot;row1&quot;&gt;&lt;!-- ELSE --&gt;&lt;tr class=&quot;row2&quot;&gt;&lt;!-- ENDIF --&gt;
-
-			&lt;td class=&quot;row1&quot;&gt;{ $log:USERNAME }&lt;/td&gt;
-			&lt;td style=&quot;text-align: center;&quot;&gt;{ $log:IP }&lt;/td&gt;
-			&lt;td style=&quot;text-align: center;&quot;&gt;{ $log:DATE }&lt;/td&gt;
-			&lt;td class=&quot;row1&quot;&gt;{ $log:ACTION }&lt;/td&gt;
+		&lt;tr&gt;
+			&lt;td class=&quot;row1&quot;&gt;{ $L_NUMBER_POSTS }: &lt;/td&gt;
+			&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $TOTAL_POSTS }&lt;/b&gt;&lt;/td&gt;
+			&lt;td class=&quot;row1&quot;&gt;{ $L_POSTS_PER_DAY }: &lt;/td&gt;
+			&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $POSTS_PER_DAY }&lt;/b&gt;&lt;/td&gt;
 		&lt;/tr&gt;
-	&lt;!-- ENDLOOP $log --&gt;
+		&lt;tr&gt;
+			&lt;td class=&quot;row1&quot;&gt;{ $L_NUMBER_TOPICS }: &lt;/td&gt;
+			&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $TOTAL_TOPICS }&lt;/b&gt;&lt;/td&gt;
+			&lt;td class=&quot;row1&quot;&gt;{ $L_TOPICS_PER_DAY }: &lt;/td&gt;
+			&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $TOPICS_PER_DAY }&lt;/b&gt;&lt;/td&gt;
+		&lt;/tr&gt;
+		&lt;tr&gt;
+			&lt;td class=&quot;row1&quot;&gt;{ $L_NUMBER_USERS }: &lt;/td&gt;
+			&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $TOTAL_USERS }&lt;/b&gt;&lt;/td&gt;
+			&lt;td class=&quot;row1&quot;&gt;{ $L_USERS_PER_DAY }: &lt;/td&gt;
+			&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $USERS_PER_DAY }&lt;/b&gt;&lt;/td&gt;
+		&lt;/tr&gt;
+		&lt;tr&gt;
+			&lt;td class=&quot;row1&quot;&gt;{ $L_NUMBER_FILES }: &lt;/td&gt;
+			&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $TOTAL_FILES }&lt;/b&gt;&lt;/td&gt;
+			&lt;td class=&quot;row1&quot;&gt;{ $L_FILES_PER_DAY }: &lt;/td&gt;
+			&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $FILES_PER_DAY }&lt;/b&gt;&lt;/td&gt;
+		&lt;/tr&gt;
+		&lt;tr&gt;
+			&lt;td class=&quot;row1&quot;&gt;{ $L_BOARD_STARTED }: &lt;/td&gt;
+			&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $START_DATE }&lt;/b&gt;&lt;/td&gt;
+			&lt;td class=&quot;row1&quot;&gt;{ $L_AVATAR_DIR_SIZE }: &lt;/td&gt;
+			&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $AVATAR_DIR_SIZE }&lt;/b&gt;&lt;/td&gt;
+		&lt;/tr&gt;
+		&lt;tr&gt;
+			&lt;td class=&quot;row1&quot;&gt;{ $L_UPLOAD_DIR_SIZE }: &lt;/td&gt;
+			&lt;td class=&quot;row2&quot;&gt;&lt;b&gt;{ $UPLOAD_DIR_SIZE }&lt;/b&gt;&lt;/td&gt;
+		&lt;/tr&gt;
+	&lt;!-- IF { $S_ACTION_OPTIONS } --&gt;
+		&lt;tr&gt;
+			&lt;td class=&quot;cat&quot; colspan=&quot;4&quot; align=&quot;right&quot;&gt;
+		
+			&lt;select name=&quot;action&quot;&gt;{ $S_ACTION_OPTIONS }&lt;/select&gt;
+			&lt;input class=&quot;button&quot; type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;{ $L_SUBMIT }&quot; /&gt;
+		&lt;/tr&gt;
+	&lt;!-- ENDIF --&gt;
 	&lt;/tbody&gt;
-	&lt;/table&gt;
+	&lt;/table&gt;
+	
+	&lt;/form&gt;
+	
+	
+	&lt;!-- IF !empty({ $log }) --&gt;
+		&lt;h2&gt;{ $L_ADMIN_LOG }&lt;/h2&gt;
+	
+		&lt;p&gt;{ $L_ADMIN_LOG_INDEX_EXPLAIN }&lt;/p&gt;
+	
+		&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot;&gt;
+		&lt;thead&gt;
+		&lt;tr&gt;
+			&lt;th&gt;{ $L_USERNAME }&lt;/th&gt;
+			&lt;th&gt;{ $L_IP }&lt;/th&gt;
+			&lt;th&gt;{ $L_TIME }&lt;/th&gt;
+			&lt;th&gt;{ $L_ACTION }&lt;/th&gt;
+		&lt;/tr&gt;
+		&lt;/thead&gt;
+		&lt;tbody&gt;
+		&lt;!-- LOOP $log --&gt;
+			&lt;!-- IF { $log:#LOOP_INDEX } % 2 --&gt;&lt;tr class=&quot;row1&quot;&gt;&lt;!-- ELSE --&gt;&lt;tr class=&quot;row2&quot;&gt;&lt;!-- ENDIF --&gt;
+	
+				&lt;td class=&quot;row1&quot;&gt;{ $log:USERNAME }&lt;/td&gt;
+				&lt;td style=&quot;text-align: center;&quot;&gt;{ $log:IP }&lt;/td&gt;
+				&lt;td style=&quot;text-align: center;&quot;&gt;{ $log:DATE }&lt;/td&gt;
+				&lt;td class=&quot;row1&quot;&gt;{ $log:ACTION }&lt;/td&gt;
+			&lt;/tr&gt;
+		&lt;!-- ENDLOOP $log --&gt;
+		&lt;/tbody&gt;
+		&lt;/table&gt;
+	
+		&lt;br /&gt;
+		&lt;div style=&quot;text-align: right;&quot;&gt;&lt;a href=&quot;{ $U_ADMIN_LOG}&quot;&gt;&raquo; { $L_VIEW_ADMIN_LOG }&lt;/a&gt;&lt;/div&gt;
+	
+	&lt;!-- ENDIF --&gt;
+&lt;!-- ENDIF --&gt;
 
-	&lt;br /&gt;
-	&lt;div style=&quot;text-align: right;&quot;&gt;&lt;a href=&quot;{ $U_ADMIN_LOG}&quot;&gt;&raquo; { $L_VIEW_ADMIN_LOG }&lt;/a&gt;&lt;/div&gt;
-
-&lt;!-- ENDIF --&gt;
-
 &lt;!-- INCLUDE modules/forums/admin/overall_footer.html --&gt;
\ No newline at end of file

Added: cms/trunk/includes/templates/modules/forums/admin/acp_permissions.html
===================================================================
--- cms/trunk/includes/templates/modules/forums/admin/acp_permissions.html	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/templates/modules/forums/admin/acp_permissions.html	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,500 @@
+&lt;!-- INCLUDE modules/forums/admin/overall_header.html --&gt;
+
+&lt;a name=&quot;maincontent&quot;&gt;&lt;/a&gt;
+
+&lt;!-- IF { $S_INTRO } --&gt;
+	
+	&lt;h1&gt;{ $L_ACP_PERMISSIONS }&lt;/h1&gt;
+
+	{ $L_ACP_PERMISSIONS_EXPLAIN }
+
+&lt;!-- ENDIF --&gt;
+
+&lt;!-- IF { $S_SELECT_VICTIM } --&gt;
+
+	&lt;h1&gt;{ $L_TITLE }&lt;/h1&gt;
+
+	&lt;p&gt;{ $L_EXPLAIN }&lt;/p&gt;
+	
+	&lt;!-- IF { $S_FORUM_NAMES } --&gt;
+		&lt;p&gt;&lt;b&gt;{ $L_FORUMS }:&lt;/b&gt; { $FORUM_NAMES }&lt;/p&gt;
+	&lt;!-- ENDIF --&gt;
+
+	&lt;!-- IF { $S_SELECT_FORUM } --&gt;
+
+		&lt;form id=&quot;select_victim&quot; method=&quot;post&quot; action=&quot;{ $U_ACTION }&quot;&gt;
+
+		&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
+			&lt;tr&gt;
+				&lt;th colspan=&quot;2&quot;&gt;
+					{ $L_LOOK_UP_FORUM }
+				&lt;/th&gt;
+			&lt;/tr&gt;
+			&lt;!-- IF { $S_FORUM_MULTIPLE } --&gt;
+			&lt;tr&gt;
+				&lt;td  class=&quot;row1&quot; colspan=&quot;2&quot;&gt;
+					{ $L_LOOK_UP_FORUMS_EXPLAIN }
+				&lt;/td&gt;
+			&lt;/tr&gt;
+			&lt;!-- ENDIF --&gt;
+			&lt;tr&gt;
+				&lt;td width=&quot;40%&quot; class=&quot;row1&quot;&gt;
+					{ $L_LOOK_UP_FORUM }:
+				&lt;/td&gt;
+				&lt;td class=&quot;row2&quot;&gt;
+					&lt;select id=&quot;forum&quot; name=&quot;forum_id[]&quot;&lt;!-- IF { $S_FORUM_MULTIPLE } --&gt; multiple=&quot;multiple&quot;&lt;!-- ENDIF --&gt; size=&quot;10&quot;&gt;{ $S_FORUM_OPTIONS }&lt;/select&gt;
+					&lt;!-- IF { $S_FORUM_ALL } --&gt;
+						&lt;br/&gt;&lt;input type=&quot;checkbox&quot; class=&quot;radio&quot; name=&quot;all_forums&quot; value=&quot;1&quot; /&gt;&nbsp; { $L_ALL_FORUMS }
+					&lt;!-- ENDIF --&gt;
+				&lt;/td&gt;
+			&lt;/tr&gt;
+			&lt;tr&gt;
+				&lt;td colspan=&quot;2&quot; class=&quot;row1&quot;&gt;
+					{ $S_HIDDEN_FIELDS }
+					&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;{ $L_SUBMIT }&quot; class=&quot;button&quot; /&gt;
+				&lt;/td&gt;
+			&lt;/tr&gt;
+		&lt;/table&gt;
+
+		&lt;/form&gt;
+
+		&lt;!-- IF { $S_FORUM_MULTIPLE } --&gt;
+
+			&lt;form id=&quot;select_subforum&quot; method=&quot;post&quot; action=&quot;{ $U_ACTION }&quot;&gt;
+	
+			&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
+				&lt;tr&gt;
+					&lt;th colspan=&quot;2&quot;&gt;
+						{ $L_LOOK_UP_FORUM }
+					&lt;/th&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td class=&quot;row1&quot; colspan=&quot;2&quot;&gt;
+						{ $L_SELECT_FORUM_SUBFORUM_EXPLAIN }
+					&lt;/td&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td width=&quot;40%&quot; class=&quot;row1&quot;&gt;
+						{ $L_LOOK_UP_FORUM }:
+					&lt;/td&gt;
+					&lt;td class=&quot;row2&quot;&gt;
+						&lt;select id=&quot;sforum&quot; name=&quot;subforum_id&quot;&gt;{ $S_SUBFORUM_OPTIONS }&lt;/select&gt;
+					&lt;/td&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td colspan=&quot;2&quot; class=&quot;row1&quot;&gt;
+						{ $S_HIDDEN_FIELDS }
+						&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;{ $L_SUBMIT }&quot; class=&quot;button&quot; /&gt;
+					&lt;/td&gt;
+				&lt;/tr&gt;
+			&lt;/table&gt;
+	
+			&lt;/form&gt;
+				
+			&lt;form id=&quot;select_single_forum&quot; method=&quot;post&quot; action=&quot;{ $U_ACTION }&quot;&gt;
+	
+			&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
+				&lt;tr&gt;
+					&lt;th colspan=&quot;2&quot;&gt;
+						{ $L_LOOK_UP_FORUM }
+					&lt;/th&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td width=&quot;40%&quot; class=&quot;row1&quot;&gt;
+						{ $L_LOOK_UP_FORUM }:
+					&lt;/td&gt;
+					&lt;td class=&quot;row2&quot;&gt;
+						&lt;select id=&quot;forum&quot; name=&quot;forum_id[]&quot;&gt;{ $S_FORUM_OPTIONS }&lt;/select&gt;
+					&lt;/td&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td colspan=&quot;2&quot; class=&quot;row1&quot;&gt;
+						{ $S_HIDDEN_FIELDS }
+						&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;{ $L_SUBMIT }&quot; class=&quot;button&quot; /&gt;
+					&lt;/td&gt;
+				&lt;/tr&gt;
+			&lt;/table&gt;
+	
+			&lt;/form&gt;
+
+		&lt;!-- ENDIF --&gt;
+
+	&lt;!-- ELSEIF { $S_SELECT_USER } &amp;&amp; { $S_CAN_SELECT_USER } --&gt;
+
+		&lt;form id=&quot;select_victim&quot; method=&quot;post&quot; action=&quot;{ $U_ACTION }&quot;&gt;
+
+		&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
+			&lt;tr&gt;
+				&lt;th colspan=&quot;2&quot;&gt;
+					{ $L_LOOK_UP_USER }
+				&lt;/th&gt;
+			&lt;/tr&gt;
+			&lt;tr&gt;
+				&lt;td width=&quot;40%&quot; class=&quot;row1&quot;&gt;
+					{ $L_FIND_USERNAME }:
+				&lt;/td&gt;
+				&lt;td class=&quot;row2&quot;&gt;
+					&lt;input class=&quot;medium&quot; type=&quot;text&quot; id=&quot;username&quot; name=&quot;username[]&quot; /&gt;
+					[ &lt;a href=&quot;#&quot; onclick=&quot;window.open('{ $U_FIND_USERNAME }', '_phpbbsearch', 'height=500, resizable=yes, scrollbars=yes, width=740'); return false;&quot;&gt;{ $L_FIND_USERNAME }&lt;/a&gt; ]
+					&lt;br/&gt;&lt;input type=&quot;checkbox&quot; class=&quot;radio&quot; id=&quot;anonymous&quot; name=&quot;user_id[]&quot; value=&quot;{ $ANONYMOUS_USER_ID }&quot; /&gt; &nbsp;{ $L_SELECT_ANONYMOUS }
+				&lt;/td&gt;
+			&lt;/tr&gt;
+			&lt;tr&gt;
+				&lt;td colspan=&quot;2&quot; class=&quot;row1&quot;&gt;
+					{ $S_HIDDEN_FIELDS }
+					&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;{ $L_SUBMIT }&quot; class=&quot;button&quot; /&gt;
+				&lt;/td&gt;
+			&lt;/tr&gt;
+		&lt;/table&gt;
+
+		&lt;/form&gt;
+
+	&lt;!-- ELSEIF { $S_SELECT_GROUP } &amp;&amp; { $S_CAN_SELECT_GROUP } --&gt;
+
+		&lt;form id=&quot;select_victim&quot; method=&quot;post&quot; action=&quot;{ $U_ACTION }&quot;&gt;
+
+		&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
+			&lt;tr&gt;
+				&lt;th colspan=&quot;2&quot;&gt;
+					{ $L_LOOK_UP_GROUP }
+				&lt;/th&gt;
+			&lt;/tr&gt;
+			&lt;tr&gt;
+				&lt;td width=&quot;40%&quot; class=&quot;row1&quot;&gt;
+					{ $L_LOOK_UP_GROUP}:
+				&lt;/td&gt;
+				&lt;td class=&quot;row2&quot;&gt;
+					&lt;select name=&quot;group_id[]&quot; id=&quot;group&quot;&gt;{ $S_GROUP_OPTIONS }&lt;/select&gt;
+				&lt;/td&gt;
+			&lt;/tr&gt;
+			&lt;tr&gt;
+				&lt;td colspan=&quot;2&quot; class=&quot;row1&quot;&gt;
+					{ $S_HIDDEN_FIELDS }
+					&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;{ $L_SUBMIT }&quot; class=&quot;button&quot; /&gt;
+				&lt;/td&gt;
+			&lt;/tr&gt;
+		&lt;/table&gt;
+
+		&lt;/form&gt;
+
+	&lt;!-- ELSEIF { $S_SELECT_USERGROUP } --&gt;
+
+		&lt;div style=&quot;float: left; width: 48%;&quot;&gt;
+		
+		&lt;!-- IF { $S_CAN_SELECT_USER } --&gt;
+
+			&lt;h1&gt;{ $L_USERS }&lt;/h1&gt;
+
+			&lt;form id=&quot;users&quot; method=&quot;post&quot; action=&quot;{ $U_ACTION }&quot;&gt;
+
+			&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
+				&lt;tr&gt;
+					&lt;th colspan=&quot;2&quot;&gt;
+						{ $L_MANAGE_USERS }
+					&lt;/th&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td width=&quot;40%&quot; class=&quot;row1&quot;&gt;
+						&lt;select style=&quot;width: 100%;&quot; name=&quot;user_id[]&quot; multiple=&quot;multiple&quot; size=&quot;5&quot;&gt;{ $S_DEFINED_USER_OPTIONS }&lt;/select&gt;
+						&lt;br/&gt;&lt;input type=&quot;checkbox&quot; class=&quot;radio&quot; name=&quot;all_users&quot; value=&quot;1&quot; /&gt;&nbsp; { $L_ALL_USERS }
+					&lt;/td&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td colspan=&quot;2&quot; class=&quot;row1&quot;&gt;
+						{ $S_HIDDEN_FIELDS }
+						&lt;input type=&quot;submit&quot; class=&quot;button&quot; name=&quot;action[delete]&quot; value=&quot;{ $L_REMOVE_PERMISSIONS }&quot; style=&quot;width: 46% !important;&quot; /&gt; &nbsp; &lt;input class=&quot;button&quot; type=&quot;submit&quot; name=&quot;submit_edit_options&quot; value=&quot;{ $L_EDIT_PERMISSIONS }&quot; style=&quot;width: 46% !important;&quot; /&gt;
+					&lt;/td&gt;
+				&lt;/tr&gt;
+			&lt;/table&gt;
+
+			&lt;/form&gt;
+
+			&lt;form id=&quot;add_user&quot; method=&quot;post&quot; action=&quot;{ $U_ACTION }&quot;&gt;
+			
+			&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
+				&lt;tr&gt;
+					&lt;th colspan=&quot;2&quot;&gt;
+						{ $L_ADD_USERS }
+					&lt;/th&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td colspan=&quot;2&quot; class=&quot;row1&quot;&gt;
+						{ $L_USERNAMES_EXPLAIN }
+					&lt;/td&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td colspan=&quot;2&quot; class=&quot;row1&quot;&gt;
+						&lt;textarea id=&quot;username&quot; name=&quot;usernames&quot; rows=&quot;5&quot; cols=&quot;5&quot; style=&quot;width: 98%; height: 60px;&quot;&gt;&lt;/textarea&gt;
+						&lt;div style=&quot;float: right;&quot;&gt;[ &lt;a href=&quot;#&quot; onclick=&quot;window.open('{ $U_FIND_USERNAME }', '_phpbbsearch', 'height=500, resizable=yes, scrollbars=yes, width=740'); return false;&quot;&gt;{ $L_FIND_USERNAME }&lt;/a&gt; ]&lt;/div&gt;&lt;input type=&quot;checkbox&quot; class=&quot;radio&quot; id=&quot;anonymous&quot; name=&quot;user_id[]&quot; value=&quot;{ $ANONYMOUS_USER_ID }&quot; /&gt; &nbsp;{ $L_SELECT_ANONYMOUS }
+					&lt;/td&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td colspan=&quot;2&quot; class=&quot;row1&quot;&gt;
+						{ $S_HIDDEN_FIELDS }
+						&lt;input class=&quot;button&quot; type=&quot;submit&quot; name=&quot;submit_add_options&quot; value=&quot;{ $L_ADD_PERMISSIONS }&quot; /&gt;
+					&lt;/td&gt;
+				&lt;/tr&gt;
+			&lt;/table&gt;
+			
+			&lt;/form&gt;
+
+		&lt;!-- ENDIF --&gt;
+
+		&lt;/div&gt;
+
+		&lt;div style=&quot;float: right; width: 48%&quot;&gt;
+			
+		&lt;!-- IF { $S_CAN_SELECT_GROUP } --&gt;
+
+			&lt;h1&gt;{ $L_USERGROUPS }&lt;/h1&gt;
+
+			&lt;form id=&quot;groups&quot; method=&quot;post&quot; action=&quot;{ $U_ACTION }&quot;&gt;
+
+			&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
+				&lt;tr&gt;
+					&lt;th&gt;
+						{ $L_MANAGE_GROUPS }
+					&lt;/th&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td class=&quot;row1&quot;&gt;
+						&lt;select style=&quot;width: 100%;&quot; name=&quot;group_id[]&quot; multiple=&quot;multiple&quot; size=&quot;5&quot;&gt;{ $S_DEFINED_GROUP_OPTIONS }&lt;/select&gt;
+						&lt;input type=&quot;checkbox&quot; class=&quot;radio&quot; name=&quot;all_groups&quot; value=&quot;1&quot; /&gt;&nbsp; { $L_ALL_GROUPS }
+					&lt;/td&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td class=&quot;row1&quot;&gt;
+						{ $S_HIDDEN_FIELDS }
+						&lt;input class=&quot;button&quot; type=&quot;submit&quot; name=&quot;action[delete]&quot; value=&quot;{ $L_REMOVE_PERMISSIONS }&quot; style=&quot;width: 46% !important;&quot; /&gt; &nbsp; &lt;input class=&quot;button&quot; type=&quot;submit&quot; name=&quot;submit_edit_options&quot; value=&quot;{ $L_EDIT_PERMISSIONS }&quot; style=&quot;width: 46% !important;&quot; /&gt;
+					&lt;/td&gt;
+				&lt;/tr&gt;
+			&lt;/table&gt;
+			
+			&lt;/form&gt;
+
+			&lt;form id=&quot;add_groups&quot; method=&quot;post&quot; action=&quot;{ $U_ACTION }&quot;&gt;
+			
+			&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
+				&lt;tr&gt;
+					&lt;th&gt;
+						{ $L_ADD_GROUPS }
+					&lt;/th&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td class=&quot;row2&quot;&gt;
+						&lt;select name=&quot;group_id[]&quot; style=&quot;width: 100%; height: 107px;&quot; multiple=&quot;multiple&quot;&gt;{ $S_ADD_GROUP_OPTIONS }&lt;/select&gt;
+					&lt;/td&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td class=&quot;row1&quot;&gt;
+						{ $S_HIDDEN_FIELDS }
+						&lt;input type=&quot;submit&quot; class=&quot;button&quot; name=&quot;submit_add_options&quot; value=&quot;{ $L_ADD_PERMISSIONS }&quot; /&gt;
+					&lt;/td&gt;
+				&lt;/tr&gt;
+			&lt;/table&gt;
+
+			&lt;/form&gt;
+
+		&lt;!-- ENDIF --&gt;
+
+		&lt;/div&gt;
+
+	&lt;!-- ELSEIF { $S_SELECT_USERGROUP_VIEW } --&gt;
+
+		&lt;div style=&quot;float: left; width: 48%;&quot;&gt;
+
+			&lt;h1&gt;{ $L_USERS }&lt;/h1&gt;
+
+			&lt;form id=&quot;users&quot; method=&quot;post&quot; action=&quot;{ $U_ACTION }&quot;&gt;
+
+			&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
+				&lt;tr&gt;
+					&lt;th colspan=&quot;2&quot;&gt;
+						{ $L_MANAGE_USERS }
+					&lt;/th&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td width=&quot;40%&quot; class=&quot;row1&quot;&gt;
+						&lt;select style=&quot;width: 100%;&quot; name=&quot;user_id[]&quot; multiple=&quot;multiple&quot; size=&quot;5&quot;&gt;{ $S_DEFINED_USER_OPTIONS }&lt;/select&gt;
+					&lt;/td&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td colspan=&quot;2&quot; class=&quot;row1&quot;&gt;
+						{ $S_HIDDEN_FIELDS }
+						&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;{ $L_SUBMIT }&quot; class=&quot;button&quot; /&gt;
+					&lt;/td&gt;
+				&lt;/tr&gt;
+			&lt;/table&gt;
+
+			&lt;/form&gt;
+
+			&lt;form id=&quot;add_user&quot; method=&quot;post&quot; action=&quot;{ $U_ACTION }&quot;&gt;
+
+			&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
+				&lt;tr&gt;
+					&lt;th colspan=&quot;2&quot;&gt;
+						{ $L_LOOK_UP_USER }
+					&lt;/th&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td width=&quot;40%&quot; class=&quot;row1&quot;&gt;
+						{ $L_FIND_USERNAME }:
+					&lt;/td&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td colspan=&quot;2&quot; class=&quot;row1&quot;&gt;
+						&lt;input type=&quot;text&quot; id=&quot;username&quot; name=&quot;username[]&quot;/&gt;
+						[ &lt;a href=&quot;#&quot; onclick=&quot;window.open('{ $U_FIND_USERNAME }', '_phpbbsearch', 'height=500, resizable=yes, scrollbars=yes, width=740'); return false;&quot;&gt;{ $L_FIND_USERNAME }&lt;/a&gt; ]
+						&lt;input type=&quot;checkbox&quot; class=&quot;radio&quot; id=&quot;anonymous&quot; name=&quot;user_id[]&quot; value=&quot;{ $ANONYMOUS_USER_ID }&quot; /&gt; &nbsp;{ $L_SELECT_ANONYMOUS }
+					&lt;/td&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td colspan=&quot;2&quot; class=&quot;row1&quot;&gt;
+						{ $S_HIDDEN_FIELDS }
+						&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;{ $L_SUBMIT }&quot; class=&quot;button&quot; /&gt;
+					&lt;/td&gt;
+				&lt;/tr&gt;
+			&lt;/table&gt;
+
+			&lt;/form&gt;
+
+		&lt;/div&gt;
+
+		&lt;div style=&quot;float: right; width: 48%&quot;&gt;
+			
+			&lt;h1&gt;{ $L_USERGROUPS }&lt;/h1&gt;
+
+			&lt;form id=&quot;groups&quot; method=&quot;post&quot; action=&quot;{ $U_ACTION }&quot;&gt;
+
+			&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
+				&lt;tr&gt;
+					&lt;th colspan=&quot;2&quot;&gt;
+						{ $L_MANAGE_GROUPS }
+					&lt;/th&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td width=&quot;40%&quot; class=&quot;row1&quot;&gt;
+						&lt;select style=&quot;width: 100%;&quot; name=&quot;group_id[]&quot; multiple=&quot;multiple&quot; size=&quot;5&quot;&gt;{ $S_DEFINED_GROUP_OPTIONS }&lt;/select&gt;
+					&lt;/td&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td colspan=&quot;2&quot; class=&quot;row1&quot;&gt;
+						{ $S_HIDDEN_FIELDS }
+						&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;{ $L_SUBMIT }&quot; class=&quot;button&quot; /&gt;
+					&lt;/td&gt;
+				&lt;/tr&gt;
+			&lt;/table&gt;
+
+			&lt;/form&gt;
+
+			&lt;form id=&quot;group&quot; method=&quot;post&quot; action=&quot;{ $U_ACTION }&quot;&gt;
+
+			&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
+				&lt;tr&gt;
+					&lt;th colspan=&quot;2&quot;&gt;
+						{ $L_LOOK_UP_GROUP }
+					&lt;/th&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td width=&quot;40%&quot; class=&quot;row1&quot;&gt;
+						{ $L_LOOK_UP_GROUP }:
+					&lt;/td&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td colspan=&quot;2&quot; class=&quot;row1&quot;&gt;
+						&lt;select name=&quot;group_id[]&quot; id=&quot;group&quot;&gt;{ $S_ADD_GROUP_OPTIONS }&lt;/select&gt;
+					&lt;/td&gt;
+				&lt;/tr&gt;
+				&lt;tr&gt;
+					&lt;td colspan=&quot;2&quot; class=&quot;row1&quot;&gt;
+						{ $S_HIDDEN_FIELDS }
+						&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;{ $L_SUBMIT }&quot; class=&quot;button&quot; /&gt;
+					&lt;/td&gt;
+				&lt;/tr&gt;
+			&lt;/table&gt;
+
+			&lt;/form&gt;
+
+		&lt;/div&gt;
+
+	&lt;!-- ENDIF --&gt;
+
+&lt;!-- ENDIF --&gt;
+
+&lt;!-- IF { $S_VIEWING_PERMISSIONS } --&gt;
+
+	&lt;h1&gt;{ $L_ACL_VIEW }&lt;/h1&gt;
+
+	&lt;p&gt;{ $L_ACL_VIEW_EXPLAIN }&lt;/p&gt;
+
+	&lt;fieldset class=&quot;quick&quot;&gt;
+		&lt;b&gt;&raquo; { $L_PERMISSION_TYPE }&lt;/b&gt;
+	&lt;/fieldset&gt;
+
+	&lt;!-- INCLUDE modules/forums/admin/permission_mask.html --&gt;
+
+&lt;!-- ENDIF --&gt;
+
+&lt;!-- IF { $S_SETTING_PERMISSIONS } --&gt;
+
+	&lt;h1&gt;{ $L_ACL_SET }&lt;/h1&gt;
+
+	&lt;p&gt;{ $L_ACL_SET_EXPLAIN }&lt;/p&gt;
+
+	&lt;br /&gt;
+
+	&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
+		&lt;tr&gt;
+			&lt;td class=&quot;row1&quot;&gt;
+		&lt;b&gt;&raquo; { $L_PERMISSION_TYPE }&lt;/b&gt;
+		&lt;/td&gt;
+	&lt;/tr&gt;
+&lt;/table&gt;
+	&lt;!-- IF { $S_PERMISSION_DROPDOWN } --&gt;
+		&lt;form id=&quot;pselect&quot; method=&quot;post&quot; action=&quot;{ $U_ACTION }&quot;&gt;
+	
+		&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
+			&lt;tr&gt;
+				&lt;td class=&quot;row1&quot;&gt;
+2		
+		&lt;/form&gt;
+	&lt;!-- ENDIF --&gt;
+
+	&lt;br /&gt;&lt;br /&gt;
+
+	&lt;!-- include tooltip file --&gt;
+	&lt;script type=&quot;text/javascript&quot; src=&quot;javascript/forums/tooltip.js&quot;&gt;&lt;/script&gt;
+	&lt;script type=&quot;text/javascript&quot;&gt;
+	&lt;!--
+		window.onload = function(){enable_tooltips_select('set_permissions', '{ $LA_ROLE_DESCRIPTION }', 'role')};
+	//--&gt;
+	&lt;/script&gt;
+
+	&lt;form id=&quot;set_permissions&quot; method=&quot;post&quot; action=&quot;{ $U_ACTION }&quot;&gt;
+
+	{ $S_HIDDEN_FIELDS }
+
+	&lt;!-- INCLUDE modules/forums/admin/permission_mask.html --&gt;
+
+	&lt;br /&gt;&lt;br /&gt;
+&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
+	&lt;tr&gt;
+		&lt;td class=&quot;row1&quot;&gt;
+		{ $L_PERMISSION_APPLIED_TO_ALL }&lt;br /&gt;
+		&lt;a href=&quot;javascript:marklist('set_permissions', 'inherit', true);&quot;&gt;{ $L_MARK_ALL }&lt;/a&gt; &bull; &lt;a href=&quot;javascript:marklist('set_permissions', 'inherit', false);&quot;&gt;{ $L_UNMARK_ALL }&lt;/a&gt;
+		&lt;/td&gt;
+	&lt;/tr&gt;
+	&lt;tr&gt;
+		&lt;td class=&quot;row1&quot;&gt;
+			&lt;input class=&quot;button&quot; type=&quot;submit&quot; name=&quot;action[apply_all_permissions]&quot; value=&quot;{ $L_APPLY_ALL_PERMISSIONS }&quot; /&gt;
+			&lt;input class=&quot;button&quot; type=&quot;reset&quot; name=&quot;cancel&quot; value=&quot;{ $L_RESET }&quot; /&gt;
+		&lt;/td&gt;
+	&lt;/tr&gt;
+&lt;/table&gt;
+	&lt;br /&gt;&lt;br /&gt;
+
+	&lt;/form&gt;
+
+&lt;!-- ENDIF --&gt;
+
+&lt;!-- INCLUDE modules/forums/admin/overall_footer.html --&gt;
\ No newline at end of file

Added: cms/trunk/includes/templates/modules/forums/admin/overall_footer.html
===================================================================
--- cms/trunk/includes/templates/modules/forums/admin/overall_footer.html	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/templates/modules/forums/admin/overall_footer.html	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,18 @@
+&lt;!--
+	We request you retain the full copyright notice below including the link to www.phpbb.com.
+	This not only gives respect to the large amount of time given freely by the developers
+	but also helps build interest, traffic and use of phpBB2. If you (honestly) cannot retain
+	the full copyright we ask you at least leave in place the &quot;Powered by phpBB&quot; line, with
+	&quot;phpBB&quot; linked to www.phpbb.com. If you refuse to include even this then support on our 
+	forums may be affected.
+
+	The phpBB Group : 2003
+--&gt;
+
+&lt;br /&gt;
+&lt;div style=&quot;text-align: center;&quot; class=&quot;copyright&quot;&gt;
+Based on &lt;a href=&quot;<A HREF="http://www.phpbb.com/">http://www.phpbb.com/</A>&quot; target=&quot;phpbb&quot;&gt;phpBB&lt;/a&gt;&lt;/div&gt;
+
+{ $THEME_TABLE_CLOSE }
+
+&lt;!-- DISPLAY_FOOTER --&gt;
\ No newline at end of file

Added: cms/trunk/includes/templates/modules/forums/admin/overall_header.html
===================================================================
--- cms/trunk/includes/templates/modules/forums/admin/overall_header.html	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/templates/modules/forums/admin/overall_header.html	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,93 @@
+&lt;!-- DISPLAY_HEADER --&gt;
+
+{ $THEME_TABLE_OPEN }
+
+&lt;script type=&quot;text/javascript&quot;&gt;
+&lt;!--
+var jump_page = '{ $L_JUMP_PAGE }:';
+var on_page = '&lt;!-- IF isset({ $ON_PAGE }) --&gt;{ $ON_PAGE }&lt;!-- ENDIF --&gt;';
+var per_page = '&lt;!-- IF isset({ $PER_PAGE }) --&gt;{ $PER_PAGE }&lt;!-- ENDIF --&gt;';
+var base_url = '&lt;!-- IF isset({ $BASE_URL }) --&gt;{ $BASE_URL }&lt;!-- ENDIF --&gt;';
+
+/**
+* Jump to page
+*/
+function jumpto()
+{
+	var page = prompt(jump_page, on_page);
+
+	if (page !== null &amp;&amp; !isNaN(page) &amp;&amp; page &gt; 0)	
+	{
+		document.location.href = base_url.replace(/&amp;/g, '&amp;') + '&amp;start=' + ((page - 1) * per_page);
+	}
+}
+
+/**
+* Set display of page element
+* s[-1,0,1] = hide,toggle display,show
+*/
+function dE(n, s, type)
+{
+	if (!type)
+	{
+		type = 'block';
+	}
+
+	var e = document.getElementById(n);
+	if (!s)
+	{
+		s = (e.style.display == '') ? -1 : 1;
+	}
+	e.style.display = (s == 1) ? type : 'none';
+}
+
+/**
+* Mark/unmark checkboxes
+* id = ID of parent container, name = name prefix, state = state [true/false]
+*/
+function marklist(id, name, state)
+{
+	var parent = document.getElementById(id);
+	if (!parent)
+	{
+		eval('parent = document.' + id);
+	}
+
+	if (!parent)
+	{
+		return;
+	}
+
+	var rb = parent.getElementsByTagName('input');
+	
+	for (var r = 0; r &lt; rb.length; r++)
+	{
+		if (rb[r].name.substr(0, name.length) == name)
+		{
+			rb[r].checked = state;
+		}
+	}
+}
+
+/**
+* Open trace popup
+*/
+function trace(link)
+{
+	window.open(link, '_trace', 'height=515, resizable=yes, scrollbars=yes, width=680');
+	return false;
+}
+
+&lt;!-- IF isset({ $S_INCLUDE_SWATCH }) &amp;&amp; { $S_INCLUDE_SWATCH } --&gt;
+	/**
+	* Color swatch
+	*/
+	function swatch()
+	{
+		window.open('{ $UA_SWATCH }', '_swatch', 'height=150, resizable=yes, scrollbars=no, width=636');
+		return false;
+	}
+&lt;!-- ENDIF --&gt;
+
+//--&gt;
+&lt;/script&gt;
\ No newline at end of file

Added: cms/trunk/includes/templates/modules/forums/admin/permission_mask.html
===================================================================
--- cms/trunk/includes/templates/modules/forums/admin/permission_mask.html	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/templates/modules/forums/admin/permission_mask.html	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,249 @@
+
+&lt;script type=&quot;text/javascript&quot;&gt;
+&lt;!--
+	var active_pmask = '0';
+	var active_fmask = '0';
+	var active_cat = '0';
+
+	var role_options = new Array();
+
+	&lt;!-- IF isset({ $S_ROLE_JS_ARRAY }) --&gt;
+		{ $S_ROLE_JS_ARRAY }
+	&lt;!-- ENDIF --&gt;
+
+	/**
+	* Show/hide option panels
+	* value = suffix for ID to show
+	*/
+	function swap_options(pmask, fmask, cat)
+	{
+		id = pmask + fmask + cat;
+		active_option = active_pmask + active_fmask + active_cat;
+
+		if (id == active_option)
+		{
+			return;
+		}
+		
+		// Hide active options
+		dE('options' + active_option, -1);
+		dE('head' + active_pmask + active_fmask, 1, 'inline');
+		dE('apply' + active_pmask + active_fmask, -1);
+
+		// Display container
+		dE('options' + id, 1);
+		dE('head' + pmask + fmask, -1, 'inline');
+		dE('apply' + pmask + fmask, 1);
+
+		active_pmask = pmask;
+		active_fmask = fmask;
+		active_cat = cat;
+	}
+
+	/**
+	* Mark all radio buttons in one panel
+	* id = table ID container, s = status ['y'/'u'/'n']
+	*/
+	function mark_options(id, s)
+	{
+		var t = document.getElementById(id);
+
+		if (!t)
+		{
+			return;
+		}
+
+		var rb = t.getElementsByTagName('input');
+
+		for (var r = 0; r &lt; rb.length; r++ )
+		{
+			if (rb[r].id.substr(rb[r].id.length-1) == s)
+			{
+				rb[r].checked = true;
+			}
+		}
+	}
+
+	/**
+	* Mark one radio button in one panel
+	* id = table ID container, field_name = the auth option, s = status ['y'/'u'/'n']
+	*/
+	function mark_one_option(id, field_name, s)
+	{
+		var t = document.getElementById(id);
+
+		if (!t)
+		{
+			return;
+		}
+
+		var rb = t.getElementsByTagName('input');
+
+		for (var r = 0; r &lt; rb.length; r++ )
+		{
+			if (rb[r].id.substr(rb[r].id.length-field_name.length-3, field_name.length) == field_name &amp;&amp; rb[r].id.substr(rb[r].id.length-1) == s)
+			{
+				rb[r].checked = true;
+			}
+		}
+	}
+
+	/**
+	* Reset role dropdown field to Select role... if an option gets changed
+	*/
+	function reset_role(id)
+	{
+		var t = document.getElementById(id);
+
+		if (!t)
+		{
+			return;
+		}
+
+		t.options[0].selected = true;
+	}
+
+	/**
+	* Load role and set options accordingly
+	*/
+	function set_role_settings(role_id, target_id)
+	{
+		settings = role_options[role_id];
+
+		if (!settings)
+		{
+			return;
+		}
+
+		// Mark all options to no (unset) first...
+		mark_options(target_id, 'u');
+
+		for (var r in settings)
+		{
+			mark_one_option(target_id, r, (settings[r] == 1) ? 'y' : 'n');
+		}
+	}
+
+//--&gt;
+&lt;/script&gt;
+
+&lt;!-- LOOP $p_mask --&gt;
+
+&lt;div class=&quot;clearfix&quot;&gt;&lt;/div&gt;
+
+&lt;table class=&quot;tablebg&quot; width=&quot;100%&quot; cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot;&gt;
+	&lt;!-- IF { $p_mask:USER_GROUPS_DEFAULT } || { $p_mask:USER_GROUPS_CUSTOM } --&gt;
+	&lt;tr&gt;
+		&lt;td class=&quot;row1&quot;&gt;
+		&lt;!-- IF { $p_mask:USER_GROUPS_DEFAULT } --&gt;&lt;b&gt;{ $p_mask:NAME }&lt;/b&gt; { $L_USER_IS_MEMBER_OF_DEFAULT }: &lt;b&gt;{ $p_mask:USER_GROUPS_DEFAULT }&lt;/b&gt;&lt;br /&gt;&lt;!-- ENDIF --&gt;
+		&lt;!-- IF { $p_mask:USER_GROUPS_CUSTOM } --&gt;&lt;b&gt;{ $p_mask:NAME }&lt;/b&gt; { $L_USER_IS_MEMBER_OF_CUSTOM }: &lt;b&gt;{ $p_mask:USER_GROUPS_CUSTOM }&lt;/b&gt;&lt;!-- ENDIF --&gt;
+		&lt;/td&gt;
+	&lt;/tr&gt;
+	&lt;!-- ENDIF --&gt;
+			&lt;tr&gt;
+				&lt;th style=&quot;text-align: left; width: 70%&quot;&gt;{ $p_mask:NAME }&lt;!-- IF { $p_mask:S_LOCAL } --&gt;&lt;span class=&quot;small&quot; style=&quot;text-transform: none;&quot;&gt; [{ $p_mask:L_ACL_TYPE }]&lt;/span&gt;&lt;!-- ENDIF --&gt;&lt;/th&gt;
+				&lt;th&gt;{ $p_mask:CATEGORIES }&lt;/th&gt;
+			&lt;/tr&gt;
+
+	&lt;!-- LOOP $p_mask:f_mask --&gt;
+		&lt;!-- IF { $p_mask:f_mask:#LOOP_NUMBER } % 2 --&gt;&lt;tr class=&quot;row1&quot;&gt;&lt;!-- ELSE --&gt;&lt;tr class=&quot;row2&quot;&gt;&lt;!-- ENDIF --&gt;
+		&lt;td class=&quot;name&quot;&gt;
+			&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; class=&quot;type2&quot; style=&quot;background-color: transparent; border: 0;&quot;&gt;
+				&lt;tbody&gt;
+					&lt;tr&gt;
+						&lt;td width=&quot;16&quot;&gt;
+							&lt;span id=&quot;head{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }&quot;&lt;!-- IF { $p_mask:#LOOP_START } &amp;&amp; { $p_mask:f_mask:#LOOP_START } --&gt; style=&quot;display: none;&quot;&lt;!-- ENDIF --&gt;&gt;
+								&lt;!-- IF !{ $p_mask:S_VIEW } --&gt;&lt;input type=&quot;checkbox&quot; class=&quot;radio&quot; name=&quot;inherit[{ $p_mask:f_mask:UG_ID }][{ $p_mask:f_mask:FORUM_ID }]&quot; value=&quot;1&quot; /&gt;&lt;!-- ELSE --&gt;&nbsp;&lt;!-- ENDIF --&gt;
+							&lt;/span&gt;
+						&lt;/td&gt;
+						&lt;td&gt;{ $p_mask:f_mask:PADDING }&lt;!-- IF { $p_mask:f_mask:FOLDER_IMAGE } --&gt; { $p_mask:f_mask:FOLDER_IMAGE } &lt;!-- ENDIF --&gt;&lt;a href=&quot;javascript:swap_options('{ $p_mask:#LOOP_NUMBER }', '{ $p_mask:f_mask:#LOOP_NUMBER }', '0');&quot;&gt;{ $p_mask:f_mask:NAME }&lt;/a&gt;&lt;/span&gt;&lt;/td&gt;
+						&lt;td align=&quot;right&quot; style=&quot;text-align: right;&quot;&gt;
+						&lt;!-- IF { $p_mask:S_VIEW } --&gt;
+							&nbsp;
+						&lt;!-- ELSE --&gt;
+							&lt;!-- IF { $p_mask:f_mask:S_ROLE_OPTIONS } --&gt;
+								&lt;b&gt;{ $L_ROLE }:&lt;/b&gt;&nbsp; &nbsp;&lt;select id=&quot;role{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }&quot; name=&quot;role[{ $p_mask:f_mask:UG_ID }][{ $p_mask:f_mask:FORUM_ID }]&quot; onchange=&quot;set_role_settings(this.options[selectedIndex].value, 'a_options{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }')&quot;&gt;{ $p_mask:f_mask:S_ROLE_OPTIONS }&lt;/select&gt;
+							&lt;!-- ELSE --&gt;
+								&lt;b&gt;{ $L_ROLE }:&lt;/b&gt; { $L_NO_ROLE_AVAILABLE }
+							&lt;!-- ENDIF --&gt;
+						&lt;!-- ENDIF --&gt;
+						&lt;/td&gt;
+					&lt;/tr&gt;
+				&lt;/tbody&gt;
+			&lt;/table&gt;
+		&lt;/td&gt;
+		&lt;!-- loop $p_mask:f_mask:category --&gt;
+			&lt;!-- IF { $p_mask:f_mask:category:S_YES } --&gt;
+				&lt;td class=&quot;preset preset_yes&quot;&gt;
+			&lt;!-- ELSEIF { $p_mask:f_mask:category:S_NEVER }--&gt;
+				&lt;td class=&quot;preset preset_never&quot;&gt;
+			&lt;!-- ELSEIF { $p_mask:f_mask:category:S_NO } --&gt;
+				&lt;td class=&quot;preset preset_no&quot;&gt;
+			&lt;!-- ELSE --&gt;
+				&lt;td class=&quot;preset preset_custom&quot;&gt;
+			&lt;!-- ENDIF --&gt;
+				&lt;a href=&quot;javascript:swap_options('{ $p_mask:#LOOP_NUMBER }', '{ $p_mask:f_mask:#LOOP_NUMBER }', '{ $p_mask:f_mask:category:#LOOP_NUMBER }');&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
+		&lt;!-- ENDLOOP --&gt;
+	&lt;/tr&gt;
+	&lt;tr&gt;
+		&lt;td style=&quot;vertical-align: top;&quot;&gt;
+			&lt;div id=&quot;apply{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }&quot; style=&quot;text-align: left; width: 98%; margin: 5px;&lt;!-- IF { $p_mask:#LOOP_START } &amp;&amp; { $p_mask:f_mask:#LOOP_START } --&gt;&lt;!-- ELSE --&gt; display: none;&lt;!-- ENDIF --&gt;&quot;&gt;
+			&lt;!-- IF { $p_mask:S_VIEW } --&gt;
+				&lt;div style=&quot;float: left; width: 60%;&quot;&gt;
+					&lt;p class=&quot;small&quot;&gt;{ $L_APPLY_PERMISSIONS_EXPLAIN }&lt;/p&gt;
+					&lt;input class=&quot;button&quot; type=&quot;submit&quot; name=&quot;psubmit[{ $p_mask:f_mask:UG_ID }][{ $p_mask:f_mask:FORUM_ID }]&quot; value=&quot;{ L_APPLY_PERMISSIONS }&quot; /&gt;
+				&lt;/div&gt;
+				&lt;div style=&quot;float: right; text-align: right; width: 35%;&quot;&gt;
+					&lt;p class=&quot;small&quot;&gt;
+						[&lt;a href=&quot;javascript: mark_options('a_options{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }', 'y'); reset_role('role{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }');&quot;&gt;{ $L_ALL_YES }&lt;/a&gt;]&lt;br /&gt;
+						[&lt;a href=&quot;javascript: mark_options('a_options{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }', 'n'); reset_role('role{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }');&quot;&gt;{ $L_ALL_NEVER }&lt;/a&gt;]&lt;br /&gt;
+						[&lt;a href=&quot;javascript: mark_options('a_options{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }', 'u'); reset_role('role{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }');&quot;&gt;{ $L_ALL_NO }&lt;/a&gt;]
+					&lt;/p&gt;
+				&lt;/div&gt;
+			&lt;!-- ELSE --&gt;
+				&nbsp;
+			&lt;!-- ENDIF --&gt;
+			&lt;/div&gt;
+		&lt;/td&gt;
+		&lt;td colspan=&quot;{ $p_mask:S_NUM_CATS }&quot; id=&quot;a_options{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }&quot; style=&quot;vertical-align: top; text-align: left;&quot;&gt;
+			&lt;div style=&quot;width: 350px; height: 0; line-height: 0;&quot;&gt;&nbsp;&lt;/div&gt;
+			&lt;!-- LOOP $p_mask:f_mask:category --&gt;
+				&lt;table cellspacing=&quot;1&quot; id=&quot;options{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }{ $p_mask:f_mask:category:#LOOP_NUMBER }&quot; class=&quot;type3&quot;&lt;!-- IF { $p_mask:#LOOP_START } &amp;&amp; { $p_mask:f_mask:#LOOP_START } &amp;&amp; { $p_mask:f_mask:category:#LOOP_START } --&gt;&lt;!-- ELSE --&gt; style=&quot;display: none;&quot;&lt;!-- ENDIF --&gt;&gt;
+				&lt;thead&gt;
+				&lt;tr&gt;
+					&lt;td scope=&quot;col&quot; style=&quot;text-align: left; padding-left: 0;&quot;&gt;&lt;strong&gt;{ $L_ACL_SETTING } [{ $p_mask:f_mask:category:CAT_NAME }]&lt;/strong&gt;&lt;/th&gt;
+				&lt;!-- IF { $p_mask:S_VIEW } --&gt;
+					&lt;td scope=&quot;col&quot;&gt;{ $L_ACL_YES }&lt;/td&gt;
+					&lt;td scope=&quot;col&quot;&gt;{ $L_ACL_NEVER }&lt;/td&gt;
+				&lt;!-- ELSE --&gt;
+					&lt;td class=&quot;row2&quot;&gt;&lt;a href=&quot;javascript: mark_options('options{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }{ $p_mask:f_mask:category:#LOOP_NUMBER }', 'y'); reset_role('role{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }');&quot;&gt;{ $L_ACL_YES }&lt;/a&gt;&lt;/td&gt;
+					&lt;td class=&quot;row2&quot;&gt;&lt;a href=&quot;javascript: mark_options('options{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }{ $p_mask:f_mask:category:#LOOP_NUMBER }', 'u'); reset_role('role{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }');&quot;&gt;{ $L_ACL_NO }&lt;/a&gt;&lt;/td&gt;
+					&lt;td class=&quot;row2&quot;&gt;&lt;a href=&quot;javascript: mark_options('options{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }{ $p_mask:f_mask:category:#LOOP_NUMBER }', 'n'); reset_role('role{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }');&quot;&gt;{ $L_ACL_NEVER }&lt;/a&gt;&lt;/td&gt;
+				&lt;!-- ENDIF --&gt;
+				&lt;/tr&gt;
+				&lt;/thead&gt;
+				&lt;tbody&gt;
+				&lt;!-- LOOP $p_mask:f_mask:category:mask --&gt;
+					&lt;!-- IF { $p_mask:f_mask:category:mask:#LOOP_NUMBER } % 2 --&gt;&lt;tr class=&quot;row4&quot;&gt;&lt;!-- ELSE --&gt;&lt;tr class=&quot;row3&quot;&gt;&lt;!-- ENDIF --&gt;
+					&lt;td &gt;&lt;!-- IF { $p_mask:f_mask:category:mask:U_TRACE } --&gt;&lt;a href=&quot;#&quot; onclick=&quot;javascript:trace('{ $p_mask:f_mask:category:mask:U_TRACE }')&quot; title=&quot;{L_TRACE_SETTING}&quot;&gt;&lt;img src=&quot;images/icon_trace.gif&quot; alt=&quot;{ $L_TRACE_SETTING }&quot; /&gt;&lt;/a&gt; &lt;!-- ENDIF --&gt;{ $p_mask:f_mask:category:mask:PERMISSION }&lt;/th&gt;
+					&lt;!-- IF { $p_mask:S_VIEW } --&gt;
+						&lt;td&lt;!-- IF { $p_mask:f_mask:category:mask:S_YES } --&gt; class=&quot;yes&quot;&lt;!-- ELSE --&gt; class=&quot;no&quot;&lt;!-- ENDIF --&gt;&gt;&nbsp;&lt;/td&gt;
+						&lt;td&lt;!-- IF { $p_mask:f_mask:category:mask:S_NEVER } --&gt; class=&quot;never&quot;&lt;!-- ELSE --&gt; class=&quot;no&quot;&lt;!-- ENDIF --&gt;&gt;&nbsp;&lt;/td&gt;
+					&lt;!-- ELSE --&gt;
+						&lt;td class=&quot;row2&quot;&gt;&lt;input onchange=&quot;reset_role('role{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }')&quot; id=&quot;{ $p_mask:f_mask:category:mask:S_FIELD_NAME }_y&quot; name=&quot;{ $p_mask:f_mask:category:mask:S_FIELD_NAME }&quot; class=&quot;radio&quot; type=&quot;radio&quot;&lt;!-- IF { $p_mask:f_mask:category:mask:S_YES } --&gt; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; value=&quot;1&quot; /&gt;&lt;/td&gt;
+						&lt;td class=&quot;row2&quot;&gt;&lt;input onchange=&quot;reset_role('role{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }')&quot; id=&quot;{ $p_mask:f_mask:category:mask:S_FIELD_NAME }_u&quot; name=&quot;{ $p_mask:f_mask:category:mask:S_FIELD_NAME }&quot; class=&quot;radio&quot; type=&quot;radio&quot;&lt;!-- IF { $p_mask:f_mask:category:mask:S_NO } --&gt; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; value=&quot;-1&quot; /&gt;&lt;/td&gt;
+						&lt;td class=&quot;row2&quot;&gt;&lt;input onchange=&quot;reset_role('role{ $p_mask:#LOOP_NUMBER }{ $p_mask:f_mask:#LOOP_NUMBER }')&quot; id=&quot;{ $p_mask:f_mask:category:mask:S_FIELD_NAME }_n&quot; name=&quot;{ $p_mask:f_mask:category:mask:S_FIELD_NAME }&quot; class=&quot;radio&quot; type=&quot;radio&quot;&lt;!-- IF { $p_mask:f_mask:category:mask:S_NEVER } --&gt; checked=&quot;checked&quot;&lt;!-- ENDIF --&gt; value=&quot;0&quot; /&gt;&lt;/td&gt;
+					&lt;!-- ENDIF --&gt;
+				&lt;/tr&gt;
+				&lt;!-- ENDLOOP $p_mask:f_mask:category:mask --&gt;
+				&lt;/tbody&gt;
+				&lt;/table&gt;
+			&lt;!-- ENDLOOP $p_mask:f_mask:category --&gt;
+		&lt;/td&gt;
+	&lt;/tr&gt;
+	&lt;!-- ENDLOOP $f_mask --&gt;
+	
+	&lt;/tbody&gt;
+&lt;/table&gt;
+
+&lt;!-- ENDLOOP $p_mask --&gt;
\ No newline at end of file

Modified: cms/trunk/includes/templates/modules/forums/mcp_viewlogs.html
===================================================================
--- cms/trunk/includes/templates/modules/forums/mcp_viewlogs.html	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/templates/modules/forums/mcp_viewlogs.html	2006-09-12 14:55:25 UTC (rev 187)
@@ -20,7 +20,7 @@
 	&lt;/tr&gt;
 	&lt;!-- IF S_TOPIC_ID --&gt;
 	&lt;tr&gt;
-		&lt;td class=&quot;row3&quot; colspan=&quot;5&quot;&gt;&lt;span class=&quot;gensmall&quot;&gt;{L_LOGS_CURRENT_TOPIC} &lt;a href=&quot;{U_VIEWTOPIC}&quot;&gt;&lt;b&gt;{TOPIC_NAME}&lt;/b&gt;&lt;/a&gt;&lt;/td&gt;
+		&lt;td class=&quot;row3&quot; colspan=&quot;5&quot;&gt;&lt;span class=&quot;gensmall&quot;&gt;{L_LOGS_CURRENT_TOPIC} &lt;a href=&quot;{U_VIEWTOPIC}&quot;&gt;&lt;b&gt;{TOPIC_NAME}&lt;/b&gt;&lt;/a&gt;&lt;/span&gt;&lt;/td&gt;
 	&lt;/tr&gt;
 	&lt;!-- ENDIF --&gt;
 	&lt;!-- BEGIN log --&gt;

Modified: cms/trunk/includes/user.php
===================================================================
--- cms/trunk/includes/user.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/includes/user.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -105,7 +105,7 @@
 	function time_convert($time, $conversion = 'user')
 	{
 		// user and gmt
-		if ($conversion == 'gmt')
+		if ($conversion === 'gmt')
 		{
 			return ($time - $this-&gt;time_offset);
 		}
@@ -118,6 +118,7 @@
 		global $_CLASS;
 
 		settype($id, 'int');
+		$admin_login = true;
 
 		if ($bot = check_bot_status($this-&gt;browser, $this-&gt;ip))
 		{
@@ -358,10 +359,10 @@
 		return $this-&gt;img[$img];
 	}
 		
-	function add_lang($lang_file = false, $module = false)
+	function add_lang($lang_file = false, $module = false, $direct_path = false)
 	{
-//Need a check for if the lang file exsists
-	
+		global $_CLASS;
+
 		//print_r(debug_backtrace());
 		if (is_array($lang_file))
 		{
@@ -369,37 +370,68 @@
 			{
 				$this-&gt;add_lang($lang, $module);
 			}
-			
+
 			unset($lang);
 			return;
 		}
-		
-		if ($lang_file)
+
+		if ($direct_path)
 		{
-			if (mb_strpos($lang_file, '/') !== false)
+			if (file_exists(SITE_FILE_ROOT.$lang_file))
 			{
-				include SITE_FILE_ROOT.&quot;language/{$this-&gt;lang_name}/$lang_file&quot;;
+				require_once SITE_FILE_ROOT.$lang_file;
 
-				return;
+				return true;
 			}
 
+			return false;
+		}
+
+		if ($lang_file)
+		{
 			$lang_file = $lang_file.'.php';
 		}
 		else
 		{
 			$lang_file = 'index.php';
 		}
+		
+		if (!$module &amp;&amp; !is_null($module) &amp;&amp; isset($_CLASS['core_display']-&gt;page['page_name']))
+		{
+			$module = $_CLASS['core_display']-&gt;page['page_name'];
+		}
 
-		if (!$module)
+		if ($module)
 		{
-			global $_CLASS;
+			$module .= '/';
+		}
 
-			include SITE_FILE_ROOT.'modules/'.$_CLASS['core_display']-&gt;page['page_name'].&quot;/language/$this-&gt;lang_name/$lang_file&quot;;
+		if (file_exists(SITE_FILE_ROOT.&quot;modules/{$module}language/{$this-&gt;lang_name}/$lang_file&quot;))
+		{
+			require_once SITE_FILE_ROOT.&quot;modules/{$module}language/{$this-&gt;lang_name}/$lang_file&quot;;
+			
+			return true;
+		}
+		elseif (file_exists(SITE_FILE_ROOT.&quot;modules/{$module}language/$lang_file&quot;))
+		{
+			require_once SITE_FILE_ROOT.&quot;modules/{$module}language/$lang_file&quot;;
 
-			return;
+			return true;
 		}
-		
-		include SITE_FILE_ROOT.&quot;modules/$module/language/$this-&gt;lang_name/$lang_file&quot;;		
+		elseif (file_exists(SITE_FILE_ROOT.&quot;language/{$module}{$this-&gt;lang_name}/$lang_file&quot;))
+		{
+			require_once SITE_FILE_ROOT.&quot;language/{$module}{$this-&gt;lang_name}/$lang_file&quot;;
+			
+			return true;
+		}
+		elseif (file_exists(SITE_FILE_ROOT.&quot;language/{$module}$lang_file&quot;))
+		{
+			require_once SITE_FILE_ROOT.&quot;language/{$module}$lang_file&quot;;
+			
+			return true;
+		}
+
+		return false;
 	}
 
 	function user_data_get($name, $default = false)

Modified: cms/trunk/install/build_data.php
===================================================================
--- cms/trunk/install/build_data.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/install/build_data.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -268,6 +268,8 @@
 $_CLASS['core_db']-&gt;query('INSERT INTO '. FORUMS_ACL_OPTIONS_TABLE  .&quot; (auth_option, is_global) VALUES ('a_', 1)&quot;);
 $_CLASS['core_db']-&gt;query('INSERT INTO '. FORUMS_ACL_OPTIONS_TABLE  .&quot; (auth_option, is_global) VALUES ('a_aauth', 1)&quot;);
 $_CLASS['core_db']-&gt;query('INSERT INTO '. FORUMS_ACL_OPTIONS_TABLE  .&quot; (auth_option, is_global) VALUES ('a_attach', 1)&quot;);
+$_CLASS['core_db']-&gt;query('INSERT INTO '. FORUMS_ACL_OPTIONS_TABLE  .&quot; (auth_option, is_global) VALUES ('a_authgroups', 1)&quot;);
+$_CLASS['core_db']-&gt;query('INSERT INTO '. FORUMS_ACL_OPTIONS_TABLE  .&quot; (auth_option, is_global) VALUES ('a_authusers', 1)&quot;);
 $_CLASS['core_db']-&gt;query('INSERT INTO '. FORUMS_ACL_OPTIONS_TABLE  .&quot; (auth_option, is_global) VALUES ('a_backup', 1)&quot;);
 $_CLASS['core_db']-&gt;query('INSERT INTO '. FORUMS_ACL_OPTIONS_TABLE  .&quot; (auth_option, is_global) VALUES ('a_bbcode', 1)&quot;);
 $_CLASS['core_db']-&gt;query('INSERT INTO '. FORUMS_ACL_OPTIONS_TABLE  .&quot; (auth_option, is_global) VALUES ('a_board', 1)&quot;);

Modified: cms/trunk/installer.php
===================================================================
--- cms/trunk/installer.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/installer.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -487,7 +487,26 @@
 
 if ($stage === 1)
 {
-	$gd_info = gd_info();
+	$gd_info = false;
+
+	if (!extension_loaded('gd'))
+	{
+		if (function_exists('dl'))
+		{
+			$prefix = (PHP_SHLIB_SUFFIX === 'dll') ? 'php_' : '';
+			dl($prefix . 'gd2.' . PHP_SHLIB_SUFFIX);
+
+			if (extension_loaded('gd'))
+			{
+				$gd_info = gd_info();
+			}
+		}
+	}
+	else
+	{
+		$gd_info = gd_info();
+	}
+
 	$continue = true;
 
 	if (!$compatible = version_compare(PHP_VERSION, '4.2.0', '&gt;='))
@@ -508,8 +527,8 @@
 		
 		'mbstring'	=&gt; extension_loaded('mbstring'),
 		'zlib'		=&gt; extension_loaded('zlib'),
-		'gd'		=&gt; extension_loaded('gd'),
-		'gd_version'=&gt; $gd_info['GD Version'],
+		'gd'		=&gt; $gd_info,
+		'gd_version'=&gt; ($gd_info) ? $gd_info['GD Version'] : '',
 
 		'continue'	=&gt; $continue,
 	));

Added: cms/trunk/javascript/forums/tooltip.js
===================================================================
--- cms/trunk/javascript/forums/tooltip.js	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/javascript/forums/tooltip.js	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,251 @@
+/*
+javascript for Bubble Tooltips by Alessandro Fulciniti
+- <A HREF="http://pro.html.it">http://pro.html.it</A> - <A HREF="http://web-graphics.com">http://web-graphics.com</A> 
+obtained from: <A HREF="http://web-graphics.com/mtarchive/001717.php">http://web-graphics.com/mtarchive/001717.php</A>
+
+phpBB Development Team:
+	- modified to adhere to our coding guidelines
+	- integration into our design
+	- added ability to perform tooltips on select elements
+	- further adjustements
+*/
+
+var head_text, tooltip_mode;
+
+/**
+* Enable tooltip replacements for links
+*/
+function enable_tooltips_link(id, headline, sub_id)
+{
+	var links, i, hold;
+	
+	head_text = headline;
+
+	if (!document.getElementById || !document.getElementsByTagName)
+	{
+		return;
+	}
+
+	hold = document.createElement('span');
+	hold.id = '_tooltip_container';
+	hold.setAttribute('id', '_tooltip_container');
+	hold.style.position = 'absolute';
+
+	document.getElementsByTagName('body')[0].appendChild(hold);
+
+	if (id == null)
+	{
+		links = document.getElementsByTagName('a');
+	}
+	else
+	{
+		links = document.getElementById(id).getElementsByTagName('a');
+	}
+
+	for (i = 0; i &lt; links.length; i++)
+	{
+		if (sub_id)
+		{
+			if (links[i].id.substr(0, sub_id.length) == sub_id)
+			{
+				prepare(links[i]);
+			}
+		}
+		else
+		{
+			prepare(links[i]);
+		}
+	}
+
+	tooltip_mode = 'link';
+}
+
+/**
+* Enable tooltip replacements for selects
+*/
+function enable_tooltips_select(id, headline, sub_id)
+{
+	var links, i, hold;
+	
+	head_text = headline;
+
+	if (!document.getElementById || !document.getElementsByTagName)
+	{
+		return;
+	}
+
+	hold = document.createElement('span');
+	hold.id = '_tooltip_container';
+	hold.setAttribute('id', '_tooltip_container');
+	hold.style.position = 'absolute';
+
+	document.getElementsByTagName('body')[0].appendChild(hold);
+
+	if (id == null)
+	{
+		links = document.getElementsByTagName('option');
+	}
+	else
+	{
+		links = document.getElementById(id).getElementsByTagName('option');
+	}
+
+	for (i = 0; i &lt; links.length; i++)
+	{
+		if (sub_id)
+		{
+			if (links[i].parentNode.id.substr(0, sub_id.length) == sub_id)
+			{
+				prepare(links[i]);
+			}
+		}
+		else
+		{
+			prepare(links[i]);
+		}
+	}
+
+	tooltip_mode = 'select';
+}
+
+/**
+* Prepare elements to replace
+*/
+function prepare(element)
+{
+	var tooltip, text, desc, title;
+
+	text = element.getAttribute('title');
+
+	if (text == null || text.length == 0)
+	{
+		return;
+	}
+
+	element.removeAttribute('title');
+	tooltip = create_element('span', 'tooltip');
+
+	title = create_element('span', 'top');
+	title.appendChild(document.createTextNode(head_text));
+	tooltip.appendChild(title);
+
+	desc = create_element('span', 'bottom');
+	desc.innerHTML = text;
+	tooltip.appendChild(desc);
+
+	set_opacity(tooltip);
+
+	element.tooltip = tooltip;
+	element.onmouseover = show_tooltip;
+	element.onmouseout = hide_tooltip;
+
+	if (tooltip_mode == 'link')
+	{
+		element.onmousemove = locate;
+	}
+}
+
+/**
+* Show tooltip
+*/
+function show_tooltip(e)
+{
+	document.getElementById('_tooltip_container').appendChild(this.tooltip);
+	locate(this);
+}
+
+/**
+* Hide tooltip
+*/
+function hide_tooltip(e)
+{
+	var d = document.getElementById('_tooltip_container');
+	if (d.childNodes.length &gt; 0)
+	{
+		d.removeChild(d.firstChild);
+	}
+}
+
+/**
+* Set opacity on tooltip element
+*/
+function set_opacity(element)
+{
+	element.style.filter = 'alpha(opacity:95)';
+	element.style.KHTMLOpacity = '0.95';
+	element.style.MozOpacity = '0.95';
+	element.style.opacity = '0.95';
+}
+
+/**
+* Create new element
+*/
+function create_element(tag, c)
+{
+	var x = document.createElement(tag);
+	x.className = c;
+	x.style.display = 'block';
+	return x;
+}
+
+/**
+* Correct positioning of tooltip container
+*/
+function locate(e)
+{
+	var posx = 0;
+	var posy = 0;
+
+	e = e.parentNode;
+
+	if (e.offsetParent)
+	{
+		for (var posx = 0, posy = 0; e.offsetParent; e = e.offsetParent)
+		{
+			posx += e.offsetLeft;
+			posy += e.offsetTop;
+		}
+	}
+	else
+	{
+		posx = e.offsetLeft;
+		posy = e.offsetTop;
+	}
+
+	if (tooltip_mode == 'link')
+	{
+		document.getElementById('_tooltip_container').style.top=(posy+20) + 'px';
+		document.getElementById('_tooltip_container').style.left=(posx-20) + 'px';
+	}
+	else
+	{
+		document.getElementById('_tooltip_container').style.top=(posy+30) + 'px';
+		document.getElementById('_tooltip_container').style.left=(posx-205) + 'px';
+	}
+
+/*
+	if (e == null)
+	{
+		e = window.event;
+	}
+
+	if (e.pageX || e.pageY)
+	{
+		posx = e.pageX;
+		posy = e.pageY;
+	}
+	else if (e.clientX || e.clientY)
+	{
+		if (document.documentElement.scrollTop)
+		{
+			posx = e.clientX+document.documentElement.scrollLeft;
+			posy = e.clientY+document.documentElement.scrollTop;
+		}
+		else
+		{
+			posx = e.clientX+document.body.scrollLeft;
+			posy = e.clientY+document.body.scrollTop;
+		}
+	}
+*/
+}

Modified: cms/trunk/modules/control_panel/index.php
===================================================================
--- cms/trunk/modules/control_panel/index.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/control_panel/index.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -190,7 +190,7 @@
 						redirect();
 					}
 			
-					login_box();
+					$_CLASS['core_auth']-&gt;auth_login();
 				break;
 			
 				case 'logout':

Modified: cms/trunk/modules/control_panel/modules/ucp_pm.php
===================================================================
--- cms/trunk/modules/control_panel/modules/ucp_pm.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/control_panel/modules/ucp_pm.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -233,6 +233,17 @@
 		{
 			place_pm_into_folder($global_privmsgs_rules, get_variable('release', 'POST', 0));
 			$num_not_moved = $_CLASS['core_user']-&gt;data['user_new_privmsg'];
+
+			// Make sure num_not_moved is valid.
+			if ($num_not_moved &lt; 0)
+			{
+				$sql = 'UPDATE ' . CORE_USERS_TABLE . '
+					SET user_new_privmsg = 0, user_unread_privmsg = 0
+					WHERE user_id = ' . $_CLASS['core_user']-&gt;data['user_id'];
+				$_CLASS['core_db']-&gt;query($sql);
+
+				$num_not_moved = $_CLASS['core_user']-&gt;data['user_new_privmsg'] = $_CLASS['core_user']-&gt;data['user_unread_privmsg'] = 0;
+			}
 		}
 
 		if (!$msg_id &amp;&amp; $folder_id == PRIVMSGS_NO_BOX)

Modified: cms/trunk/modules/control_panel/modules/ucp_pm_compose.php
===================================================================
--- cms/trunk/modules/control_panel/modules/ucp_pm_compose.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/control_panel/modules/ucp_pm_compose.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -192,7 +192,7 @@
 		$folder_id		= isset($post['folder_id']) ? $post['folder_id'] : 0;
 		$message_text	= isset($post['message_text']) ? $post['message_text'] : '';
 
-		if (!$post['author_id'] &amp;&amp; $msg_id)
+		if ((!$post['author_id'] || ($post['author_id'] == ANONYMOUS &amp;&amp; $action !== 'delete')) &amp;&amp; $msg_id)
 		{
 			trigger_error('NO_AUTHOR');
 		}

Modified: cms/trunk/modules/control_panel/modules/ucp_pm_viewfolder.php
===================================================================
--- cms/trunk/modules/control_panel/modules/ucp_pm_viewfolder.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/control_panel/modules/ucp_pm_viewfolder.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -129,7 +129,18 @@
 				{
 					foreach ($id_ary as $ug_id =&gt; $_id)
 					{
-						$address_list[$message_id][] = (($type === 'u') ? '&lt;a href=&quot;'.generate_link('members_list&amp;mode=viewprofile&amp;u='.$ug_id).'&quot;&gt;' : '&lt;a href=&quot;'.generate_link('members_list&amp;mode=group&amp;g='.$ug_id).'&quot;&gt;') . (($recipient_list[$type][$ug_id]['colour']) ? '&lt;span style=&quot;color:#' . $recipient_list[$type][$ug_id]['colour'] . '&quot;&gt;' : '&lt;span&gt;') . $recipient_list[$type][$ug_id]['name'] . '&lt;/span&gt;&lt;/a&gt;';
+						$user_colour = ($recipient_list[$type][$ug_id]['colour']) ? ' style=&quot;color:#' . $recipient_list[$type][$ug_id]['colour'] . '&quot;' : '';
+
+						if ($type === 'u')
+						{
+							$link = ($ug_id != ANONYMOUS) ? '&lt;a href=&quot;' . generate_link('members_list&amp;mode=viewprofile&amp;u='.$ug_id) . '&quot;' . $user_colour . '&gt;' : '';
+						}
+						else
+						{
+							$link = '&lt;a href=&quot;' . generate_link('members_list&amp;mode=group&amp;g='.$ug_id) . '&quot;' . $user_colour . '&gt;';
+						}
+
+						$address_list[$message_id][] = $link . $recipient_list[$type][$ug_id]['name'] . (($link) ? '&lt;/a&gt;' : '');
 					}
 				}
 			}
@@ -144,7 +155,7 @@
 			$folder_alt = ($row['pm_unread']) ? 'NEW_MESSAGES' : 'NO_NEW_MESSAGES';
 
 			// Generate all URIs ...
-			$message_author = '&lt;a href=&quot;'.generate_link('members_list&amp;mode=viewprofile&amp;u=' . $row['author_id']) . '&quot;&gt;' . $row['username'] . '&lt;/a&gt;';
+			$message_author = ($row['author_id'] != ANONYMOUS) ? '&lt;a href=&quot;' . generate_link('members_list&amp;mode=viewprofile&amp;u=' . $row['author_id']) . '&quot;&gt;' . $row['username'] . '&lt;/a&gt;' : $row['username'];
 			$view_message_url = generate_link($parent_class-&gt;link_parent.&quot;&amp;f=$folder_id&amp;p=$message_id&quot;);
 			$remove_message_url = generate_link($parent_class-&gt;link_parent.'&amp;mode=compose&amp;action=delete&amp;p='.$message_id);
 			
@@ -168,16 +179,16 @@
 				'MESSAGE_AUTHOR'	=&gt; $message_author,
 				'SENT_TIME'		 	=&gt; $_CLASS['core_user']-&gt;format_date($row['message_time']),
 				'SUBJECT'			=&gt; censor_text($row['message_subject']),
-				'FOLDER'			=&gt; (isset($folder[$row['folder_id']])) ? $folder[$row['folder_id']]['folder_name'] : '',
-				'U_FOLDER'			=&gt; (isset($folder[$row['folder_id']])) ? generate_link($parent_class-&gt;link_parent.'&amp;folder=' . $row['folder_id']) : '',
+				'FOLDER'			=&gt; isset($folder[$row['folder_id']]) ? $folder[$row['folder_id']]['folder_name'] : '',
+				'U_FOLDER'			=&gt; isset($folder[$row['folder_id']]) ? generate_link($parent_class-&gt;link_parent.'&amp;folder=' . $row['folder_id']) : '',
 				'PM_ICON_IMG'		=&gt; (!empty($icons[$row['icon_id']])) ? '&lt;img src=&quot;' . $config['icons_path'] . '/' . $icons[$row['icon_id']]['img'] . '&quot; width=&quot;' . $icons[$row['icon_id']]['width'] . '&quot; height=&quot;' . $icons[$row['icon_id']]['height'] . '&quot; alt=&quot;&quot; title=&quot;&quot; /&gt;' : '',
 				'FOLDER_IMG'		=&gt; $_CLASS['core_user']-&gt;img($folder_img, $folder_alt),
 				'PM_IMG'			=&gt; ($row_indicator) ? $_CLASS['core_user']-&gt;img('pm_' . $row_indicator, '') : '',
 				'ATTACH_ICON_IMG'	=&gt; ($row['message_attachment']) ? $_CLASS['core_user']-&gt;img('icon_attach', $_CLASS['core_user']-&gt;lang['TOTAL_ATTACHMENTS']) : '',
 				//'S_PM_REPORTED'		=&gt; (!empty($row['message_reported'])) ? true : false,
 				'S_PM_REPORTED'		=&gt; '',
-				'S_PM_DELETED'		=&gt; ($row['pm_deleted']),
-				
+				'S_PM_DELETED'		=&gt; ($row['pm_deleted']) ? true : false,
+				'S_AUTHOR_DELETED'	=&gt; ($row['author_id'] == ANONYMOUS) ? true : false,
 				'U_VIEW_PM'			=&gt; ($row['pm_deleted']) ? '' : $view_message_url,
 				'U_REMOVE_PM'		=&gt; ($row['pm_deleted']) ? $remove_message_url : '',
 				

Modified: cms/trunk/modules/control_panel/modules/ucp_pm_viewmessage.php
===================================================================
--- cms/trunk/modules/control_panel/modules/ucp_pm_viewmessage.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/control_panel/modules/ucp_pm_viewmessage.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -58,8 +58,8 @@
 	// Parse the message and subject
 
 	// Replace naughty words such as farty pants
-	$message_row['message_subject'] = censor_text($message_row['message_subject']);
-	$message_row['message_text'] = censor_text($message_row['message_text']);
+	$message_row['message_subject'] = censor_text($message_row['message_subject']);
+	$message_row['message_text'] = str_replace(&quot;\n&quot;, '&lt;br /&gt;', censor_text($message_row['message_text']));
 
 	// If the board has HTML off but the message has HTML on then we process it, else leave it alone
 	if ($message_row['enable_html'] &amp;&amp; !$config['auth_html_pm'])
@@ -74,7 +74,7 @@
 	}
 
 	// Always process smilies after parsing bbcodes
-	$message_row['message_text'] = str_replace(&quot;\n&quot;, '&lt;br /&gt;', smiley_text($message_row['message_text']));
+	$message_row['message_text'] = smiley_text($message_row['message_text']);
 
 	// Editing information
 	if ($message_row['message_edit_count'] &amp;&amp; $config['display_last_edited'])
@@ -163,6 +163,9 @@
 	// End signature parsing, only if needed
 	if ($signature)
 	{
+		$signature = censor_text($signature);
+		$signature = str_replace(&quot;\n&quot;, '&lt;br /&gt;', censor_text($signature));
+
 		if ($user_info['user_sig_bbcode_bitfield'])
 		{
 			if ($bbcode === false)
@@ -175,7 +178,6 @@
 		}
 
 		$signature = smiley_text($signature);
-		$signature = str_replace(&quot;\n&quot;, '&lt;br /&gt;', censor_text($signature));
 	}
 
 	$url = 'Control_Panel&amp;i=pm';
@@ -212,16 +214,17 @@
 		'U_REPORT'			=&gt; (false) ? generate_link('Forums&amp;file=report&amp;pm=' . $message_row['msg_id']) : '',
 		'U_INFO'			=&gt; ($_CLASS['forums_auth']-&gt;acl_get('m_') &amp;&amp; ($message_row['message_reported'] || $message_row['pm_forwarded'])) ? generate_link('Forums&amp;file=mcp&amp;mode=pm_details&amp;p=' . $message_row['msg_id']) : '',
 		'U_DELETE' 			=&gt; generate_link(&quot;$url&amp;mode=compose&amp;action=delete&amp;f=$folder_id&amp;p=&quot; . $message_row['msg_id']),
-		'U_AUTHOR_PROFILE' 	=&gt; generate_link('members_list&amp;mode=viewprofile&amp;u=' . $author_id),
+		'U_AUTHOR_PROFILE' 	=&gt; ($author_id != ANONYMOUS) ? generate_link('members_list&amp;mode=viewprofile&amp;u=' . $author_id) : '',
 		'U_EMAIL' 			=&gt; $user_info['email'],
 		'U_QUOTE'			=&gt; ($author_id != $_CLASS['core_user']-&gt;data['user_id']) ? generate_link(&quot;$url&amp;mode=compose&amp;action=quote&amp;f=$folder_id&amp;p=&quot; . $message_row['msg_id']) : '',
-		'U_EDIT' 			=&gt; (($message_row['message_time'] &gt; time() - $config['pm_edit_time'] || !$config['pm_edit_time']) &amp;&amp; $folder_id == PRIVMSGS_OUTBOX) ? generate_link(&quot;$url&amp;mode=compose&amp;action=edit&amp;f=$folder_id&amp;p=&quot; . $message_row['msg_id']) : '', 
-		'U_POST_REPLY_PM' 	=&gt; ($author_id != $_CLASS['core_user']-&gt;data['user_id']) ? generate_link(&quot;$url&amp;mode=compose&amp;action=reply&amp;f=$folder_id&amp;p=&quot; . $message_row['msg_id']) : '',
+		'U_EDIT' 			=&gt; (($message_row['message_time'] &gt; $_CLASS['core_user']-&gt;time - $config['pm_edit_time'] || !$config['pm_edit_time']) &amp;&amp; $folder_id == PRIVMSGS_OUTBOX) ? generate_link(&quot;$url&amp;mode=compose&amp;action=edit&amp;f=$folder_id&amp;p=&quot; . $message_row['msg_id']) : '', 
+		'U_POST_REPLY_PM' 	=&gt; ($author_id != $_CLASS['core_user']-&gt;data['user_id'] &amp;&amp; $author_id != ANONYMOUS) ? generate_link(&quot;$url&amp;mode=compose&amp;action=reply&amp;f=$folder_id&amp;p=&quot; . $message_row['msg_id']) : '',
 		'U_PREVIOUS_PM'		=&gt; generate_link(&quot;$url&amp;f=$folder_id&amp;p=&quot; . $message_row['msg_id'] . &quot;&amp;view=previous&quot;),
 		'U_NEXT_PM'			=&gt; generate_link(&quot;$url&amp;f=$folder_id&amp;p=&quot; . $message_row['msg_id'] . &quot;&amp;view=next&quot;),
 
 		'S_MESSAGE_REPORTED'=&gt; ($message_row['message_reported'] &amp;&amp; $_CLASS['forums_auth']-&gt;acl_get('m_')) ? true : false,
 		'S_DISPLAY_NOTICE'	=&gt; $display_notice &amp;&amp; $message_row['message_attachment'],
+		'S_AUTHOR_DELETED'	=&gt; ($author_id == ANONYMOUS) ? true : false,
 
 		'U_PRINT_PM'		=&gt; generate_link(&quot;$url&amp;f=$folder_id&amp;p=&quot; . $message_row['msg_id'] . &quot;&amp;view=print&quot;),
 		'U_EMAIL_PM'		=&gt; ($_CORE_CONFIG['email']['email_enable']) ? 'Email' : '',
@@ -325,6 +328,11 @@
 		$subject	= $row['message_subject'];
 		$message	= $row['message_text'];
 
+		$subject = censor_text($subject);
+		$message = censor_text($message);
+
+		$message = str_replace(&quot;\n&quot;, '&lt;br /&gt;', $message);
+
 		if ($row['bbcode_bitfield'])
 		{
 			$bbcode-&gt;bbcode_second_pass($message, $row['bbcode_uid'], $row['bbcode_bitfield']);
@@ -332,9 +340,6 @@
 
 		$message = smiley_text($message, !$row['enable_smilies']);
 
-		$subject = censor_text($subject);
-		$message = censor_text($message);
-
 		if ($id == $msg_id)
 		{
 			$next_history_pm = next($rowset);
@@ -346,16 +351,16 @@
 			'AUTHOR_NAME' 		=&gt; $author,
 			'SUBJECT'	 		=&gt; $subject,
 			'SENT_DATE' 		=&gt; $_CLASS['core_user']-&gt;format_date($row['message_time']),
-			'MESSAGE' 			=&gt; str_replace(&quot;\n&quot;, '&lt;br /&gt;', $message), 
+			'MESSAGE' 			=&gt; $message, 
 			'FOLDER'			=&gt; implode(', ', $row['folder']),
 
 			'S_CURRENT_MSG'		=&gt; ($row['msg_id'] == $msg_id),
 
 			'U_MSG_ID'			=&gt; $row['msg_id'],
 			'U_VIEW_MESSAGE'	=&gt; generate_link(&quot;$url&amp;f=$folder_id&amp;p=&quot; . $row['msg_id']),
-			'U_AUTHOR_PROFILE' 	=&gt; generate_link('members_list&amp;mode=viewprofile&amp;u='.$author_id),
+			'U_AUTHOR_PROFILE' 	=&gt; ($author_id != ANONYMOUS) ? generate_link('members_list&amp;mode=viewprofile&amp;u='.$author_id) : '',
 			'U_QUOTE'			=&gt; ($author_id != $_CLASS['core_user']-&gt;data['user_id']) ? generate_link(&quot;$url&amp;mode=compose&amp;action=quote&amp;f=&quot; . $folder_id . &quot;&amp;p=&quot; . $row['msg_id']) : '',
-			'U_POST_REPLY_PM' 	=&gt; ($author_id != $_CLASS['core_user']-&gt;data['user_id']) ? generate_link(&quot;$url&amp;mode=compose&amp;action=reply&amp;f=$folder_id&amp;p=&quot; . $row['msg_id']) : '')
+			'U_POST_REPLY_PM' 	=&gt; ($author_id != $_CLASS['core_user']-&gt;data['user_id'] &amp;&amp; $author_id != ANONYMOUS) ? generate_link(&quot;$url&amp;mode=compose&amp;action=reply&amp;f=$folder_id&amp;p=&quot; . $row['msg_id']) : '')
 		);
 		unset($rowset[$id]);
 		$prev_id = $id;

Modified: cms/trunk/modules/forums/admin/index.php
===================================================================
--- cms/trunk/modules/forums/admin/index.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/admin/index.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -37,7 +37,9 @@
 	die; 
 }
 
-global $_CLASS, $_CORE_CONFIG;
+global $_CLASS, $_CORE_CONFIG;
+
+$_CLASS['core_user']-&gt;add_lang('admin_common', 'forums');
 
 // Some often used variables
 $safe_mode	= (@ini_get('safe_mode') || @strtolower(ini_get('safe_mode')) == 'on') ? true : false;
@@ -52,14 +54,11 @@
 $_CLASS['core_blocks']-&gt;add_block($data);
 
 load_class(SITE_FILE_ROOT.'includes/forums/auth.php', 'forums_auth');
-$_CLASS['auth'] =&amp; $_CLASS['forums_auth'];
 
 require_once(SITE_FILE_ROOT.'includes/forums/functions.php');
 require_once(SITE_FILE_ROOT.'includes/forums/functions_admin.php');
 
-$_CLASS['core_user']-&gt;add_lang('admin', 'forums');
-//$_CLASS['core_user']-&gt;add_img(false, 'Forums');
-$_CLASS['auth']-&gt;acl($_CLASS['core_user']-&gt;data);
+$_CLASS['forums_auth']-&gt;acl($_CLASS['core_user']-&gt;data);
 
 $file = get_variable('file', 'REQUEST', 'main');
 
@@ -77,11 +76,16 @@
 	'T_RANKS_PATH'			=&gt; &quot;{$config['ranks_path']}/&quot;,
 	'T_UPLOAD_PATH'			=&gt; &quot;{$config['upload_path']}/&quot;,
 
-	'ICON_MOVE_UP'		=&gt; '&lt;img src=&quot;modules/forums/images/admin/icon_up.gif&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['MOVE_UP'] . '&quot; title=&quot;' . $_CLASS['core_user']-&gt;lang['MOVE_UP'] . '&quot; /&gt;',
-	'ICON_MOVE_DOWN'	=&gt; '&lt;img src=&quot;modules/forums/images/admin/icon_down.gif&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['MOVE_DOWN'] . '&quot; title=&quot;' . $_CLASS['core_user']-&gt;lang['MOVE_DOWN'] . '&quot; /&gt;',
-	'ICON_EDIT'			=&gt; '&lt;img src=&quot;modules/forums/images/admin/icon_edit.gif&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['EDIT'] . '&quot; title=&quot;' . $_CLASS['core_user']-&gt;lang['EDIT'] . '&quot; /&gt;',
-	'ICON_DELETE'		=&gt; '&lt;img src=&quot;modules/forums/images/admin/icon_delete.gif&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['DELETE'] . '&quot; title=&quot;' . $_CLASS['core_user']-&gt;lang['DELETE'] . '&quot; /&gt;',
-	'ICON_SYNC'			=&gt; '&lt;img src=&quot;modules/forums/images/admin/icon_sync.gif&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['RESYNC'] . '&quot; title=&quot;' . $_CLASS['core_user']-&gt;lang['RESYNC'] . '&quot; /&gt;',
+	'ICON_MOVE_UP'				=&gt; '&lt;img src=&quot;modules/forums/images/admin/icon_up.gif&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['MOVE_UP'] . '&quot; title=&quot;' . $_CLASS['core_user']-&gt;lang['MOVE_UP'] . '&quot; /&gt;',
+	'ICON_MOVE_UP_DISABLED'		=&gt; '&lt;img src=&quot;modules/forums/images/admin/icon_up_disabled.gif&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['MOVE_UP'] . '&quot; title=&quot;' . $_CLASS['core_user']-&gt;lang['MOVE_UP'] . '&quot; /&gt;',
+	'ICON_MOVE_DOWN'			=&gt; '&lt;img src=&quot;modules/forums/images/admin/icon_down.gif&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['MOVE_DOWN'] . '&quot; title=&quot;' . $_CLASS['core_user']-&gt;lang['MOVE_DOWN'] . '&quot; /&gt;',
+	'ICON_MOVE_DOWN_DISABLED'	=&gt; '&lt;img src=&quot;modules/forums/images/admin/icon_down_disabled.gif&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['MOVE_DOWN'] . '&quot; title=&quot;' . $_CLASS['core_user']-&gt;lang['MOVE_DOWN'] . '&quot; /&gt;',
+	'ICON_EDIT'					=&gt; '&lt;img src=&quot;modules/forums/images/admin/icon_edit.gif&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['EDIT'] . '&quot; title=&quot;' . $_CLASS['core_user']-&gt;lang['EDIT'] . '&quot; /&gt;',
+	'ICON_EDIT_DISABLED'		=&gt; '&lt;img src=&quot;modules/forums/images/admin/icon_edit_disabled.gif&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['EDIT'] . '&quot; title=&quot;' . $_CLASS['core_user']-&gt;lang['EDIT'] . '&quot; /&gt;',
+	'ICON_DELETE'				=&gt; '&lt;img src=&quot;modules/forums/images/admin/icon_delete.gif&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['DELETE'] . '&quot; title=&quot;' . $_CLASS['core_user']-&gt;lang['DELETE'] . '&quot; /&gt;',
+	'ICON_DELETE_DISABLED'		=&gt; '&lt;img src=&quot;modules/forums/images/admin/icon_delete_disabled.gif&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['DELETE'] . '&quot; title=&quot;' . $_CLASS['core_user']-&gt;lang['DELETE'] . '&quot; /&gt;',
+	'ICON_SYNC'					=&gt; '&lt;img src=&quot;modules/forums/images/admin/icon_sync.gif&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['RESYNC'] . '&quot; title=&quot;' . $_CLASS['core_user']-&gt;lang['RESYNC'] . '&quot; /&gt;',
+	'ICON_SYNC_DISABLED'		=&gt; '&lt;img src=&quot;modules/forums/images/admin/icon_sync_disabled.gif&quot; alt=&quot;' . $_CLASS['core_user']-&gt;lang['RESYNC'] . '&quot; title=&quot;' . $_CLASS['core_user']-&gt;lang['RESYNC'] . '&quot; /&gt;',
 ));
 	
 if (file_exists(SITE_FILE_ROOT.'includes/forums/admin/'.$file.'.php'))

Modified: cms/trunk/modules/forums/download.php
===================================================================
--- cms/trunk/modules/forums/download.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/download.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -49,12 +49,13 @@
 	FROM ' . FORUMS_ATTACHMENTS_TABLE . &quot;
 	WHERE attach_id = $download_id&quot;;
 $result = $_CLASS['core_db']-&gt;query_limit($sql, 1);
+$attachment = $_CLASS['core_db']-&gt;fetch_row_assoc($result);
+$_CLASS['core_db']-&gt;free_result($result);
 
-if (!($attachment = $_CLASS['core_db']-&gt;fetch_row_assoc($result)))
+if (!$attachment)
 {
 	trigger_error('ERROR_NO_ATTACHMENT');
 }
-$_CLASS['core_db']-&gt;free_result($result);
 
 if ((!$attachment['in_message'] &amp;&amp; !$config['allow_attachments']) || ($attachment['in_message'] &amp;&amp; !$config['allow_pm_attach']))
 {
@@ -74,7 +75,7 @@
 	$row = $_CLASS['core_db']-&gt;fetch_row_assoc($result);
 	$_CLASS['core_db']-&gt;free_result($result);
 
-	if ($_CLASS['auth']-&gt;acl_gets(array('f_download', 'u_download'), $row['forum_id']))
+	if ($_CLASS['auth']-&gt;acl_get('u_download') &amp;&amp; $_CLASS['auth']-&gt;acl_get('f_download', $row['forum_id']))
 	{
 		if ($row['forum_password'])
 		{
@@ -117,21 +118,22 @@
 	FROM ' . FORUMS_ATTACHMENTS_TABLE . &quot;
 	WHERE attach_id = $download_id&quot;;
 $result = $_CLASS['core_db']-&gt;query_limit($sql, 1);
+$attachment = $_CLASS['core_db']-&gt;fetch_row_assoc($result);
+$_CLASS['core_db']-&gt;free_result($result);
 
-if (!($attachment = $_CLASS['core_db']-&gt;fetch_row_assoc($result)))
+if (!$attachment)
 {
 	trigger_error('ERROR_NO_ATTACHMENT');
 }
-$_CLASS['core_db']-&gt;free_result($result);
 
 $attachment['physical_filename'] = basename($attachment['physical_filename']);
+$display_cat = $extensions[$attachment['extension']]['display_cat'];
 
-
 if ($thumbnail)
 {
 	$attachment['physical_filename'] = 'thumb_' . $attachment['physical_filename'];
 }
-else
+elseif ($display_cat == ATTACHMENT_CATEGORY_NONE || $display_cat == ATTACHMENT_CATEGORY_IMAGE)
 {
 	// Update download count
 	$sql = 'UPDATE ' . FORUMS_ATTACHMENTS_TABLE . ' 
@@ -172,64 +174,38 @@
 		trigger_error($_CLASS['core_user']-&gt;lang['ERROR_NO_ATTACHMENT'] . '&lt;br /&gt;&lt;br /&gt;' . sprintf($_CLASS['core_user']-&gt;lang['FILE_NOT_FOUND_404'], $filename));
 	}
 
-	// Determine the Browser the User is using, because of some nasty incompatibilities.
-	// borrowed from phpMyAdmin. :)
-	$user_agent = (!empty($_SERVER['HTTP_USER_AGENT'])) ? $_SERVER['HTTP_USER_AGENT'] : '';
-
-	if (ereg('Opera(/| )([0-9].[0-9]{1,2})', $user_agent, $log_version))
-	{
-		$browser_version = $log_version[2];
-		$browser_agent = 'opera';
+	// Check if headers already sent or not able to get the file contents.
+	if (headers_sent() || !@is_readable($filename))
+	{
+		trigger_error('UNABLE_TO_DELIVER_FILE');
 	}
-	else if (ereg('MSIE ([0-9].[0-9]{1,2})', $user_agent, $log_version))
-	{
-		$browser_version = $log_version[1];
-		$browser_agent = 'ie';
-	}
-	else if (ereg('OmniWeb/([0-9].[0-9]{1,2})', $user_agent, $log_version))
-	{
-		$browser_version = $log_version[1];
-		$browser_agent = 'omniweb';
-    }
-	else if (ereg('(Konqueror/)(.*)(;)', $user_agent, $log_version))
-	{
-		$browser_version = $log_version[2];
-		$browser_agent = 'konqueror';
-    }
-	else if (ereg('Mozilla/([0-9].[0-9]{1,2})', $user_agent, $log_version) &amp;&amp; ereg('Safari/([0-9]*)', $user_agent, $log_version2))
-	{
-		$browser_version = $log_version[1] . '.' . $log_version2[1];
-		$browser_agent = 'safari';
-    }
-	else if (ereg('Mozilla/([0-9].[0-9]{1,2})', $user_agent, $log_version))
-	{
-		$browser_version = $log_version[1];
-		$browser_agent = 'mozilla';
-    }
-	else
-	{
-		$browser_version = 0;
-		$browser_agent = 'other';
-    }
 
 	/*
 		Correct the mime type - we force application/octetstream for all files, except images
 		Please do not change this, it is a security precaution
 	*/
+	if ($category == ATTACHMENT_CATEGORY_NONE &amp;&amp; strpos($attachment['mimetype'], 'image') === false)
+	{
+		$attachment['mimetype'] = (strpos(strtolower($user-&gt;browser), 'msie') !== false || strpos(strtolower($user-&gt;browser), 'opera') !== false) ? 'application/octetstream' : 'application/octet-stream';
+	}
 
-	if ($category == ATTACHMENT_CATEGORY_NONE &amp;&amp; strpos($attachment['mimetype'], 'image') === false)
+	/* Clean all output buffers */
+	if (@ob_get_length())
 	{
-		$attachment['mimetype'] = ($browser_agent === 'ie' || $browser_agent === 'opera') ? 'application/octetstream' : 'application/octet-stream';
+		while (@ob_end_clean());
 	}
 
-	/* Clean all output buffers */
-	while (@ob_end_clean());
 	header('Content-Encoding: ');
 
 	/* Send out required headers */
 	header('Pragma: public');
+	
+	// Try X-Sendfile since it is much more server friendly.
+	// lighttpd has core support for it. An apache2 module is available at <A HREF="http://celebnamer.celebworld.ws/stuff/mod_xsendfile/">http://celebnamer.celebworld.ws/stuff/mod_xsendfile/</A>
+	header('X-Sendfile: ' . $filename);
+
 	header('Content-Type: ' . $attachment['mimetype'] . '; name=&quot;' . $attachment['real_filename'] . '&quot;');
-	header('Content-Disposition: inline; filename=&quot;' . $attachment['real_filename'] . '&quot;');
+	header('Content-Disposition: attachment; filename=&quot;' . $attachment['real_filename'] . '&quot;');
 
 	/* Now send the File Contents to the Browser */
 	$size = @filesize($filename);
@@ -258,7 +234,7 @@
 		return true;
 	}
 
-	$url = (getenv('HTTP_REFERER')) ? trim(getenv('HTTP_REFERER')) : trim($_SERVER['HTTP_REFERER']);
+	$url = getenv('HTTP_REFERER') ? trim(getenv('HTTP_REFERER')) : trim($_SERVER['HTTP_REFERER']);
 
 	if (!$url)
 	{
@@ -266,25 +242,34 @@
 	}
 
 	// Split URL into domain and script part
-	$url = explode('?', str_replace(array('<A HREF="http://">http://</A>', '<A HREF="https://">https://</A>'), array('', ''), $url));
-	$hostname = trim($url[0]);
+	$url = @parse_url($url);
+	
+	if ($url === false)
+	{
+		return ($config['secure_allow_empty_referer']) ? true : false;
+	}
+
+	$hostname = $url['host'];
 	unset($url);
 
 	$allowed = ($config['secure_allow_deny']) ? false : true;
 	$iplist = array();
 
-	$ip_ary = gethostbynamel($hostname);
-
-	foreach ($ip_ary as $ip)
-	{
-		if ($ip)
-		{
-			$iplist[] = $ip;
-		}
+	if (($ip_ary = @gethostbynamel($hostname)) !== false)
+	{
+		foreach ($ip_ary as $ip)
+		{
+			if ($ip)
+			{
+				$iplist[] = $ip;
+			}
+		}
 	}
 	
 	// Check for own server...
-	if (preg_match('#^.*?' . $config['server_name'] . '.*?$#i', $hostname))
+	$server_name = (!empty($_SERVER['SERVER_NAME'])) ? $_SERVER['SERVER_NAME'] : getenv('SERVER_NAME');
+
+	if (preg_match('#^.*?' . preg_quote($server_name, '#') . '.*?$#i', $hostname))
 	{
 		$allowed = true;
 	}
@@ -305,7 +290,7 @@
 			{
 				foreach ($iplist as $ip)
 				{
-					if (preg_match('#^' . str_replace('*', '.*?', $site_ip) . '$#i', $ip))
+					if (preg_match('#^' . str_replace('*', '.*?', preg_quote($site_ip, '#')) . '$#i', $ip))
 					{
 						if ($row['ip_exclude'])
 						{
@@ -322,7 +307,7 @@
 
 			if ($site_hostname)
 			{
-				if (preg_match('#^' . str_replace('*', '.*?', $site_hostname) . '$#i', $hostname))
+				if (preg_match('#^' . str_replace('*', '.*?', preg_quote($site_hostname, '#')) . '$#i', $hostname))
 				{
 					if ($row['ip_exclude'])
 					{

Added: cms/trunk/modules/forums/images/Thumbs.db
===================================================================
(Binary files differ)


Property changes on: cms/trunk/modules/forums/images/Thumbs.db
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/modules/forums/images/admin/Thumbs.db
===================================================================
(Binary files differ)


Property changes on: cms/trunk/modules/forums/images/admin/Thumbs.db
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/modules/forums/images/en/Thumbs.db
===================================================================
(Binary files differ)


Property changes on: cms/trunk/modules/forums/images/en/Thumbs.db
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/modules/forums/language/admin.php
===================================================================
--- cms/trunk/modules/forums/language/admin.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/language/admin.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,2216 @@
+&lt;?php
+/** 
+*
+* admin [English]
+*
+* @package phpBB3
+* @version $Id: admin.php,v 1.27 2005/05/15 20:17:34 acydburn Exp $
+* @copyright (c) 2005 phpBB Group 
+* @license <A HREF="http://opensource.org/licenses/gpl-license.php">http://opensource.org/licenses/gpl-license.php</A> GNU Public License 
+*
+*/
+
+// DEVELOPERS PLEASE NOTE
+//
+// Placeholders can now contain order information, e.g. instead of
+// 'Page %s of %s' you can (and should) write 'Page %1$s of %2$s', this allows
+// translators to re-order the output of data while ensuring it remains correct
+//
+// You do not need this where single placeholders are used, e.g. 'Message %d' is fine
+// equally where a string contains only two placeholders which are used to wrap text
+// in a url you again do not need to specify an order e.g., 'Click %sHERE%s' is fine
+
+$this-&gt;lang += array(
+	'LOGIN_ADMIN'			=&gt; 'To administer the board you must be an authenticated user.',
+	'LOGIN_ADMIN_CONFIRM'	=&gt; 'To administer the board you must re-authenticate yourself.',
+	'LOGIN_ADMIN_SUCCESS'	=&gt; 'You have successfully authenticated and will now be redirected to the Administration Control Panel',
+	'NO_ADMIN'				=&gt; 'You are not authorised to administer this board.',
+	'NO_FRAMES'				=&gt; 'Sorry, your browser does not support frames.',
+
+	'ADMIN_TITLE'	=&gt; 'Administration Panel',
+	'ADMIN'			=&gt; 'Administration',
+
+	'RETURN_TO'		=&gt; 'Return to ...',
+	'FORUM_INDEX'	=&gt; 'Forum Index',
+	'ADMIN_INDEX'	=&gt; 'Admin Index',
+
+	'ACP_INDEX'				=&gt; 'Admin index',
+
+	'ACP_CAT_GENERAL'		=&gt; 'General',
+	'ACP_CAT_FORUM'			=&gt; 'Forum',
+	'ACP_BOARD_SETTINGS'	=&gt; 'Board settings',
+	'ACP_BOARD_DEFAULTS'	=&gt; 'Board defaults',
+	'ACP_CAT_SERVER'		=&gt; 'Server',
+	'ACP_BOARD_SERVER'		=&gt; 'Server settings',
+
+	'ACP_CAT_USERGROUP'		=&gt; 'Users &amp; Groups',
+	'ACP_USERS_MANAGE'		=&gt; 'Edit user data',
+	
+
+
+	'DB_CAT'		=&gt; 'Database',
+	'DB_BACKUP'		=&gt; 'Backup Database',
+	'DB_RESTORE'	=&gt; 'Restore Database',
+	'SEARCH_INDEX'	=&gt; 'Search Indexing',
+	'DB_UTILS'		=&gt; 'Database Utilities',
+
+	'FORUM_CAT'	=&gt; 'Forums',
+	'PRUNE'		=&gt; 'Pruning',
+
+	'GENERAL_CAT'		=&gt; 'General',
+	'AUTH_SETTINGS'		=&gt; 'Authentication',
+	'AVATAR_SETTINGS'	=&gt; 'Avatar Settings',
+	'BASIC_CONFIG'		=&gt; 'Basic Configuration',
+	'BOARD_DEFAULTS'	=&gt; 'Board Defaults',
+	'BOARD_SETTINGS'	=&gt; 'Board Settings',
+	'COOKIE_SETTINGS'	=&gt; 'Cookie Settings',
+	'MESSAGE_SETTINGS'	=&gt; 'Message Settings',
+	'EMAIL_SETTINGS'	=&gt; 'Email Settings',
+	'MASS_EMAIL'		=&gt; 'Mass Email',
+	'SERVER_SETTINGS'	=&gt; 'Server Settings',
+	'LOAD_SETTINGS'		=&gt; 'Load Settings',
+	'EVENTS'			=&gt; 'Events',
+	'CRON'				=&gt; 'Cronjobs',
+	'PHP_INFO'			=&gt; 'PHP Information',
+	'IM'				=&gt; 'Jabber Settings',
+
+	'LOG_CAT'		=&gt; 'Logging',
+	'ADMIN_LOGS'	=&gt; 'Admin Log',
+	'MOD_LOGS'		=&gt; 'Moderator Log',
+	'CRITICAL_LOGS'	=&gt; 'Error Log',
+
+	'PERM_CAT'		=&gt; 'Permissions',
+	'USER_PERMS'	=&gt; 'User permissions',
+	'GROUP_PERMS'	=&gt; 'Group permissions',
+
+	'POST_CAT'		=&gt; 'Posting',
+	'SMILIES'		=&gt; 'Smilies',
+	'ICONS'			=&gt; 'Icons',
+	'WORD_CENSOR'	=&gt; 'Word Censors',
+
+	'STYLE_CAT'			=&gt; 'Styles',
+	'MANAGE_STYLE'		=&gt; 'Styles',
+	'MANAGE_TEMPLATE'	=&gt; 'Templates',
+	'MANAGE_THEME'		=&gt; 'Themes',
+	'MANAGE_IMAGESET'	=&gt; 'Imagesets',
+
+	'USER_CAT'		=&gt; 'Users / Groups',
+	'MANAGE_USERS'	=&gt; 'Manage Users',
+	'BAN_EMAILS'	=&gt; 'Ban Emails',
+	'BAN_IPS'		=&gt; 'Ban IPs',
+	'BAN_USERS'		=&gt; 'Ban Usernames',
+	'DISALLOW'		=&gt; 'Disallow names',
+	'RANKS'			=&gt; 'Ranks',
+	'PRUNE_USERS'	=&gt; 'Prune users',
+	'BOTS'			=&gt; 'Manage Bots',
+	'GROUP_MANAGE'	=&gt; 'Manage groups',
+	'CUSTOM_PROFILE_FIELDS'	=&gt; 'Profile fields',
+
+	'LANGUAGE_CAT'		=&gt; 'Language',
+	'LANGUAGE_PACKS'	=&gt; 'Language Packs',
+
+	
+	'ADMINISTRATORS'	=&gt; 'Administrators',
+	'USERNAMES_EXPLAIN'	=&gt; 'Place each username on a seperate line',
+	'LOOK_UP_FORUM'		=&gt; 'Select a Forum',
+	'MANAGE'			=&gt; 'Manage',
+	'ADD'				=&gt; 'Add',
+	'PERMISSIONS'		=&gt; 'Permissions',
+	'UPDATE'			=&gt; 'Update',
+	'EXPORT_STORE'		=&gt; 'Store',
+	'EXPORT_DOWNLOAD'	=&gt; 'Download',
+	'CONFIG_UPDATED'	=&gt; 'Configuration updated successfully',
+	'DOWNLOAD_STORE'		=&gt; 'Download or Store file',
+	'DOWNLOAD_STORE_EXPLAIN'=&gt; 'You may directly download the file or save it in your store/ folder.',
+	'COLOUR_SWATCH'		=&gt; 'Web-safe colour swatch',
+	'UPDATE_MARKED'		=&gt; 'Update Marked',
+	'UPDATE_ALL'		=&gt; 'Update All',
+
+	'CONFIRM_OPERATION'	=&gt; 'Are you sure you wish to carry out this operation?',
+
+	'LOG_INDEX_ACTIVATE'	=&gt; '&lt;b&gt;Activated inactive users&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_INDEX_DELETE'		=&gt; '&lt;b&gt;Deleted inactive users&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_INDEX_REMIND'		=&gt; '&lt;b&gt;Sent reminder emails to inactive users&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_USER_INACTIVE'		=&gt; '&lt;b&gt;User deactivated&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_USER_ACTIVE'		=&gt; '&lt;b&gt;User activated&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_MASS_EMAIL'		=&gt; '&lt;b&gt;Sent mass email&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_DELETE_WORD'		=&gt; '&lt;b&gt;Deleted word censor&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_EDIT_WORD'			=&gt; '&lt;b&gt;Edited word censor&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ADD_WORD'			=&gt; '&lt;b&gt;Added word censor&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'log_db_backup'			=&gt; '&lt;b&gt;Database backup&lt;/b&gt;',
+	'log_db_restore'		=&gt; '&lt;b&gt;Database restore&lt;/b&gt;',
+	'log_search_index'		=&gt; '&lt;b&gt;Re-indexed search system&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'log_disallow_add'		=&gt; '&lt;b&gt;Added disallowed username&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'log_disallow_delete'	=&gt; '&lt;b&gt;Deleted disallowed username&lt;/b&gt;',
+
+	'LOG_ADMIN_CLEAR'		=&gt; '&lt;b&gt;Cleared admin log&lt;/b&gt;',
+	'LOG_MOD_CLEAR'			=&gt; '&lt;b&gt;Cleared moderator log&lt;/b&gt;',
+	'LOG_CRITICAL_CLEAR'	=&gt; '&lt;b&gt;Cleared error log&lt;/b&gt;',
+
+	'LOG_PRUNE'				=&gt; '&lt;b&gt;Pruned forums&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_AUTO_PRUNE'		=&gt; '&lt;b&gt;Auto-pruned forums&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_BAN_EXCLUDE_USER'	=&gt; '&lt;b&gt;Excluded user from ban&lt;/b&gt; for reason &quot;&lt;i&gt;%s&lt;/i&gt;&quot;&lt;br /&gt;&#187; %s ',
+	'LOG_BAN_EXCLUDE_IP'	=&gt; '&lt;b&gt;Excluded ip from ban&lt;/b&gt; for reason &quot;&lt;i&gt;%s&lt;/i&gt;&quot;&lt;br /&gt;&#187; %s ',
+	'LOG_BAN_EXCLUDE_EMAIL' =&gt; '&lt;b&gt;Excluded email from ban&lt;/b&gt; for reason &quot;&lt;i&gt;%s&lt;/i&gt;&quot;&lt;br /&gt;&#187; %s ',
+	'LOG_BAN_USER'			=&gt; '&lt;b&gt;Banned User&lt;/b&gt; for reason &quot;&lt;i&gt;%s&lt;/i&gt;&quot;&lt;br /&gt;&#187; %s ',
+	'LOG_BAN_IP'			=&gt; '&lt;b&gt;Banned ip&lt;/b&gt; for reason &quot;&lt;i&gt;%s&lt;/i&gt;&quot;&lt;br /&gt;&#187; %s',
+	'LOG_BAN_EMAIL'			=&gt; '&lt;b&gt;Banned email&lt;/b&gt; for reason &quot;&lt;i&gt;%s&lt;/i&gt;&quot;&lt;br /&gt;&#187; %s',
+	'LOG_UNBAN_USER'		=&gt; '&lt;b&gt;Unbanned user&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_UNBAN_IP'			=&gt; '&lt;b&gt;Unbanned ip&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_UNBAN_EMAIL'		=&gt; '&lt;b&gt;Unbanned email&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_DOWNLOAD_EXCLUDE_IP'	=&gt; '&lt;b&gt;Exluded ip/hostname from download list&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_DOWNLOAD_IP'			=&gt; '&lt;b&gt;Added ip/hostname to download list&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_DOWNLOAD_REMOVE_IP'	=&gt; '&lt;b&gt;Removed ip/hostname from download list&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_SERVER_CONFIG'		=&gt; '&lt;b&gt;Altered server settings&lt;/b&gt;',
+	'LOG_DEFAULT_CONFIG'	=&gt; '&lt;b&gt;Altered board defaults&lt;/b&gt;',
+	'LOG_SETTING_CONFIG'	=&gt; '&lt;b&gt;Altered board settings&lt;/b&gt;',
+	'LOG_COOKIE_CONFIG'		=&gt; '&lt;b&gt;Altered cookie settings&lt;/b&gt;',
+	'LOG_EMAIL_CONFIG'		=&gt; '&lt;b&gt;Altered email settings&lt;/b&gt;',
+	'LOG_AVATAR_CONFIG'		=&gt; '&lt;b&gt;Altered avatar settings&lt;/b&gt;',
+	'LOG_AUTH_CONFIG'		=&gt; '&lt;b&gt;Altered authentication settings&lt;/b&gt;',
+	'LOG_LOAD_CONFIG'		=&gt; '&lt;b&gt;Altered load settings&lt;/b&gt;',
+	'LOG_MESSAGE_CONFIG'	=&gt; '&lt;b&gt;Altered private message settings&lt;/b&gt;',
+
+	'LOG_ATTACH_CONFIG'		=&gt; '&lt;b&gt;Altered attachment settings&lt;/b&gt;',
+	'LOG_ATTACH_EXT_ADD'	=&gt; '&lt;b&gt;Added or edited attachment extension&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ATTACH_EXT_DEL'	=&gt; '&lt;b&gt;Removed attachment extension&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ATTACH_EXT_UPDATE'	=&gt; '&lt;b&gt;Updated attachment extension&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ATTACH_EXTGROUP_ADD' =&gt; '&lt;b&gt;Added extension group&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ATTACH_EXTGROUP_EDIT' =&gt; '&lt;b&gt;Edited extension group&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ATTACH_EXTGROUP_DEL' =&gt; '&lt;b&gt;Removed extension group&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ATTACH_FILEUPLOAD'	=&gt; '&lt;b&gt;Orphan File uploaded to Post Number %1$d - %2$s&lt;/b&gt;',
+	'LOG_ATTACH_ORPHAN_DEL'	=&gt; '&lt;b&gt;Orphan Files deleted&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'log_prune_user_deac'	=&gt; '&lt;b&gt;Users Deactivated&lt;/b&gt;&lt;br /&gt;%s',
+	'log_prune_user_del_del'=&gt; '&lt;b&gt;Users Pruned and Posts Deleted&lt;/b&gt;&lt;br /&gt;%s',
+	'log_prune_user_del_anon'=&gt; '&lt;b&gt;Users Pruned and Posts Retained&lt;/b&gt;&lt;br /&gt;%s',
+
+	'LOG_RESYNC_STATS'		=&gt; '&lt;b&gt;Post, topic and user stats reset&lt;/b&gt;',
+	'LOG_RESYNC_POSTCOUNTS'	=&gt; '&lt;b&gt;User postcounts synced&lt;/b&gt;',
+	'LOG_RESET_DATE'		=&gt; '&lt;b&gt;Board start date reset&lt;/b&gt;',
+	'LOG_RESET_ONLINE'		=&gt; '&lt;b&gt;Most users online reset&lt;/b&gt;',
+
+	'LOG_ACL_MOD_DEL'			=&gt; '&lt;b&gt;Removed Moderators&lt;/b&gt; from %s&lt;br /&gt;&#187; %s',
+	'LOG_ACL_MOD_ADD'			=&gt; '&lt;b&gt;Added or edited Moderators&lt;/b&gt; from %s&lt;br /&gt;&#187; %s',
+	'LOG_ACL_SUPERMOD_DEL'		=&gt; '&lt;b&gt;Removed Super Moderators&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ACL_SUPERMOD_ADD'		=&gt; '&lt;b&gt;Added or edited Super Moderators&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ACL_ADMIN_DEL'			=&gt; '&lt;b&gt;Removed Administrators&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ACL_ADMIN_ADD'			=&gt; '&lt;b&gt;Added or edited Administrators&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ACL_FORUM_DEL'			=&gt; '&lt;b&gt;Removed Forum access&lt;/b&gt; from %s&lt;br /&gt;&#187; %s',
+	'LOG_ACL_FORUM_ADD'			=&gt; '&lt;b&gt;Added or edited Forum access&lt;/b&gt; from %s&lt;br /&gt;&#187; %s',
+	'LOG_ACL_USER_ADD'			=&gt; '&lt;b&gt;Edited User permissions&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ACL_GROUP_ADD'			=&gt; '&lt;b&gt;Edited Group permissions&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ACL_PRESET_ADD'		=&gt; '&lt;b&gt;Added or edited permission preset&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ACL_PRESET_DEL'		=&gt; '&lt;b&gt;Deleted permission preset&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_FORUM_ADD'			=&gt; '&lt;b&gt;Created new forum&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_FORUM_MOVE_UP'		=&gt; '&lt;b&gt;Moved forum&lt;/b&gt; %s &lt;b&gt;above&lt;/b&gt; %s',
+	'LOG_FORUM_MOVE_DOWN'	=&gt; '&lt;b&gt;Moved forum&lt;/b&gt; %s &lt;b&gt;below&lt;/b&gt; %s',
+	'LOG_FORUM_EDIT'		=&gt; '&lt;b&gt;Edited forum details&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_FORUM_SYNC'		=&gt; '&lt;b&gt;Re-synchronised forum&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_FORUM_DEL_POSTS'	=&gt; '&lt;b&gt;Deleted forum and its messages&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_FORUM_DEL_FORUMS'	=&gt; '&lt;b&gt;Deleted forum and its subforums&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_FORUM_DEL_POSTS_MOVE_FORUMS'	=&gt; '&lt;b&gt;Deleted forum and its messages, moved subforums&lt;/b&gt; to %s&lt;br /&gt;&#187; %s',
+	'LOG_FORUM_DEL_MOVE_POSTS_FORUMS'	=&gt; '&lt;b&gt;Deleted forum and its subforums, moved messages&lt;/b&gt; to %s&lt;br /&gt;&#187; %s',
+	'LOG_FORUM_DEL_MOVE_POSTS'	=&gt; '&lt;b&gt;Deleted forum and moved posts &lt;/b&gt; to %s&lt;br /&gt;&#187; %s',
+	'LOG_FORUM_DEL_MOVE_FORUMS'	=&gt; '&lt;b&gt;Deleted forum and moved subforums&lt;/b&gt; to %s&lt;br /&gt;&#187; %s',
+	'LOG_FORUM_DEL_POSTS_FORUMS'=&gt; '&lt;b&gt;Deleted forum, its messages and subforums&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_FORUM_DEL_MOVE_POSTS_MOVE_FORUMS'	=&gt; '&lt;b&gt;Deleted forum, moved posts&lt;/b&gt; to %s &lt;b&gt;and subforums&lt;/b&gt; to %s&lt;br /&gt;&#187; %s',
+
+	'LOG_GROUP_UPDATED'		=&gt; '&lt;b&gt;Usergroup details updated&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_GROUP_CREATED'		=&gt; '&lt;b&gt;New usergroup created&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_MODS_ADDED'		=&gt; '&lt;b&gt;Added new leaders to usergroup&lt;/b&gt; %s&lt;br /&gt;&#187; %s',
+	'LOG_USERS_ADDED'		=&gt; '&lt;b&gt;Added new members to usergroup&lt;/b&gt; %s&lt;br /&gt;&#187; %s',
+	'LOG_GROUP_DEFAULTS'	=&gt; '&lt;b&gt;Group made default for members&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_USERS_APPROVED'	=&gt; '&lt;b&gt;Users approved in usergroup&lt;/b&gt; %s&lt;br /&gt;&#187; %s',
+	'LOG_GROUP_DEMOTED'		=&gt; '&lt;b&gt;Leaders demoted in usergroup&lt;/b&gt; %s&lt;br /&gt;&#187; %s',
+	'LOG_GROUP_PROMOTED'	=&gt; '&lt;b&gt;Members promoted to leader in usergroup&lt;/b&gt; %s&lt;br /&gt;&#187; %s',
+	'LOG_GROUP_REMOVE'		=&gt; '&lt;b&gt;Members removed from usergroup&lt;/b&gt; %s&lt;br /&gt;&#187; %s',
+	'LOG_GROUP_DELETE'		=&gt; '&lt;b&gt;Usergroup deleted&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_ADD_STYLE'		=&gt; '&lt;b&gt;Added new style&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_EDIT_STYLE'	=&gt; '&lt;b&gt;Edited style&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_EXPORT_STYLE'	=&gt; '&lt;b&gt;Exported style&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_DELETE_STYLE'	=&gt; '&lt;b&gt;Deleted style&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_ADD_THEME_FS'		=&gt; '&lt;b&gt;Add new theme on filesystem&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ADD_THEME_DB'		=&gt; '&lt;b&gt;Added new theme to database&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_EDIT_THEME'		=&gt; '&lt;b&gt;Edited theme&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_EDIT_THEME_DETAILS'=&gt; '&lt;b&gt;Edited theme details&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_EXPORT_THEME'		=&gt; '&lt;b&gt;Exported theme&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_DELETE_THEME'		=&gt; '&lt;b&gt;Theme deleted&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_ADD_TEMPLATE_FS'		=&gt; '&lt;b&gt;Add new template set on filesystem&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ADD_TEMPLATE_DB'		=&gt; '&lt;b&gt;Added new template set to database&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_EDIT_TEMPLATE'			=&gt; '&lt;b&gt;Edited template set&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_EDIT_TEMPLATE_DETAILS'	=&gt; '&lt;b&gt;Edited template details&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_EXPORT_TEMPLATE'		=&gt; '&lt;b&gt;Exported template set&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_DELETE_TEMPLATE'		=&gt; '&lt;b&gt;Deleted template set&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_EDIT_TEMPLATE'			=&gt; '&lt;b&gt;Edited template&lt;/b&gt;&lt;br /&gt;&#187; %s [%s]',
+	'LOG_CLEAR_TPLCACHE'		=&gt; '&lt;b&gt;Cleared template cache&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_ADD_IMAGESET'			=&gt; '&lt;b&gt;Added new imageset&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_EDIT_IMAGESET'			=&gt; '&lt;b&gt;Edited imageset&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_EDIT_IMAGESET_DETAILS'	=&gt; '&lt;b&gt;Edited imageset details&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_EXPORT_IMAGESET'		=&gt; '&lt;b&gt;Exported imageset&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_DELETE_IMAGESET'		=&gt; '&lt;b&gt;Deleted imageset&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_BBCODE_ADD'		=&gt; '&lt;b&gt;Added new BBCode&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_BBCODE_EDIT'		=&gt; '&lt;b&gt;Edited BBCode&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_BBCODE_DELETE'		=&gt; '&lt;b&gt;Deleted BBCode&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_JAB_PASSCHG'	=&gt; '&lt;b&gt;Jabber password changed&lt;/b&gt;',
+	'LOG_JAB_REGISTER'	=&gt; '&lt;b&gt;Jabber account registered&lt;/b&gt;',
+	'LOG_JAB_CHANGED'	=&gt; '&lt;b&gt;Jabber account changed&lt;/b&gt;',
+
+	'LOG_BOT_ADDED'		=&gt; '&lt;b&gt;New bot added&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_BOT_UPDATED'	=&gt; '&lt;b&gt;Existing bot updated&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_BOT_DELETE'	=&gt; '&lt;b&gt;Deleted bot&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_DELETE_LANGUAGE_PACK'		=&gt; '&lt;b&gt;Deleted language pack&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_LANGUAGE_PACK_INSTALLED'	=&gt; '&lt;b&gt;Installed language pack&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_UPDATE_LANG_DETAILS'		=&gt; '&lt;b&gt;Updated language pack details&lt;/b&gt;&lt;br /&gt;&#187; %s',
+);
+
+// Index page
+$this-&gt;lang += array(
+	'WELCOME_PHPBB'	=&gt; 'Welcome to phpBB',
+	'ADMIN_INTRO'	=&gt; 'Thank you for choosing phpBB as your forum solution. This screen will give you a quick overview of all the various statistics of your board. The links on the left hand side of this screen allow you to control every aspect of your forum experience. Each page will have instructions on how to use the tools.',
+
+	'FORUM_STATS'	=&gt; 'Forum Statistics',
+	'STATISTIC'		=&gt; 'Statistic',
+	'VALUE'			=&gt; 'Value',
+	'NUMBER_POSTS'	=&gt; 'Number of posts',
+	'POSTS_PER_DAY' =&gt; 'Posts per day',
+	'NUMBER_TOPICS' =&gt; 'Number of topics',
+	'TOPICS_PER_DAY'=&gt; 'Topics per day',
+	'NUMBER_USERS'	=&gt; 'Number of users',
+	'USERS_PER_DAY' =&gt; 'Users per day',
+	'NUMBER_FILES'	=&gt; 'Number of Attachments',
+	'FILES_PER_DAY'	=&gt; 'Attachments per day',
+	'BOARD_STARTED' =&gt; 'Board started',
+	'AVATAR_DIR_SIZE'	=&gt; 'Avatar directory size',
+	'UPLOAD_DIR_SIZE'	=&gt; 'Upload directory size',
+	'DATABASE_SIZE'		=&gt; 'Database size',
+	'GZIP_COMPRESSION'	=&gt; 'Gzip compression',
+	'NOT_AVAILABLE'		=&gt; 'Not available',
+	'ON'				=&gt; 'ON',
+	'OFF'				=&gt; 'OFF',
+	'RESET_ONLINE'		=&gt; 'Reset Online',
+	'RESET_DATE'		=&gt; 'Reset Date',
+	'RESYNC_STATS'		=&gt; 'Resync Stats',
+	'RESYNC_POSTCOUNTS'	=&gt; 'Resync Postcounts',
+
+	'INACTIVE_USERS'		=&gt; 'Inactive Users',
+	'INACTIVE_USERS_EXPLAIN'=&gt; 'This is a list of users who have registered but whos accounts are inactive. You can activate, delete or remind (by sending an email) these users if you wish.',
+	'NO_INACTIVE_USERS'		=&gt; 'No inactive users',
+	'ACTIVATE'				=&gt; 'Activate',
+	'REMIND'				=&gt; 'Remind',
+
+	'ADMIN_LOG'					=&gt; 'Logged administrator actions',
+	'ADMIN_LOG_INDEX_EXPLAIN'	=&gt; 'This gives an overview of the last five actions carried out by board administrators. A full copy of the log can be viewed from the appropriate menu item to the left.',
+	'IP'	=&gt; 'User IP',
+	'ACTION'=&gt; 'Action',
+);
+
+// Restore/Backup
+$this-&gt;lang += array(
+	'Database_Utilities' =&gt; 'Database Utilities',
+
+	'Backup'			=&gt; 'Backup',
+	'Backup_explain'	=&gt; 'Here you can backup all your phpBB related data. You may store the resulting archive in your store/ folder or download it directly. Depending on your server configuration you be able to compress the file in a number of formats. If you wish to include any additional &quot;custom&quot; tables please list them in the additional tables field, separated by commas. ',
+	'Backup_options'	=&gt; 'Backup options',
+	'Backup_type'		=&gt; 'Backup type',
+	'Start_backup'		=&gt; 'Start Backup',
+	'Full_backup'		=&gt; 'Full',
+	'Structure_only'	=&gt; 'Structure Only',
+	'Data_only'			=&gt; 'Data only',
+	'INC_SEARCH_INDEX'			=&gt; 'Include Search Index tables',
+	'INC_SEARCH_INDEX_EXPLAIN'	=&gt; 'Saying no here will reduce the size of the backup by ignoring the search indexes.',
+	'Additional_tables'			=&gt; 'Additional tables',
+	'Additional_tables_explain' =&gt; 'Include the names of other tables you wish to backup here, comma separated.',
+	'Compress_file'			=&gt; 'Compress file',
+	'Store_local'			=&gt; 'Store file locally',
+	'Store_local_explain'	=&gt; 'To store the file on the server rather than download it specify a path here relative to the phpBB2 root.',
+	'Backup_download'		=&gt; 'Your download will start shortly please wait till it begins',
+	'Backup_writing'		=&gt; 'The backup file is being generated please wait till it completes',
+	'Backup_success'		=&gt; 'The backup file has been created successfully in the location you specified',
+	'Backups_not_supported' =&gt; 'Sorry but database backups are not currently supported for your database system',
+
+	'Restore' =&gt; 'Restore',
+	'Restore_explain' =&gt; 'This will perform a full restore of all phpBB tables from a saved file. You can &lt;u&gt;either&lt;/u&gt; upload the backup file via this form or upload it manually to a location on the server. If your server supports it you may use a gzip compressed text file and it will automatically be decompressed. &lt;b&gt;WARNING&lt;/b&gt; This will overwrite any existing data. The restore may take a long time to process please do not move from this page till it is complete.',
+	'Upload_file' =&gt; 'Upload backup file',
+	'Select_file' =&gt; 'Select a file',
+	'Local_backup_file' =&gt; 'Location of backup file',
+	'Local_backup_file_explain' =&gt; 'Location on the server where backup file is stored relative to the phpBB root, e.g. ../tmp/backup.sql',
+	'Supported_extensions' =&gt; 'Supported extensions',
+	'Start_Restore' =&gt; 'Start Restore',
+	'Restore_success' =&gt; 'The Database has been successfully restored.&lt;br /&gt;&lt;br /&gt;Your board should be back to the state it was when the backup was made.',
+	'Restore_Error_filename' =&gt; 'The file you uploaded had an unsupported extension.',
+	'Compress_unsupported' =&gt; 'The version of PHP installed on this server does not support the type of compression used for your backup. Please use a compression method listed on the previous page.',
+	'Restore_Error_no_file' =&gt; 'No file was uploaded',
+);
+
+// Permissions
+$this-&gt;lang += array(
+	'ACL_EXPLAIN'			=&gt; 'Permissions are based on a simple YES / NO system. Setting an option to NO for a user or usergroup overrides any other value assigned to it. If you do not wish to assign a value for an option for this user or group select UNSET. If values are assigned for this option elsewhere they will be used in preference, else NO is assumed.',
+	'PERMISSIONS_EXPLAIN'	=&gt; 'Here you can alter which users and groups can access which forums. To assign moderators or define administrators please use the appropriate page (see left hand side menu).',
+	'MODERATORS'			=&gt; 'Moderators',
+	'MODERATORS_EXPLAIN'	=&gt; 'Here you can assign users and groups as forum moderators. To assign users access to forums, to define super moderators or administrators please use the appropriate page (see left hand side menu). If you are permitted you can also change permissions for this forum from this page. Use the select box to change views.',
+	'SUPER_MODERATORS'			=&gt; 'Super Moderators',
+	'SUPER_MODERATORS_EXPLAIN'	=&gt; 'Here you can assign users and groups as super moderators. Super Moderators are like ordinary moderators accept they have access to every forum on your board. To assign users access to forums or define administrators please use the appropriate page (see left hand side menu). If you are permitted you can also set permissions for forum options from this page. Use the select box to change views.',
+	'ADMINISTRATORS_EXPLAIN'	=&gt; 'Here you can assign administrator rights to users or groups. All users with admin permissions can view the administration panel. If you are permitted you can also change permissions for forums, super moderator and moderator options from this page. Use the select box to change views.',
+	'USER_PERMISSIONS'			=&gt; 'User Permissions',
+	'USER_PERMISSIONS_EXPLAIN'	=&gt; 'Here you can set user based permissions. These include capabilities such as the use of avatars, sending private messages, etc. To alter these settings for large numbers of users the Group permissions system is the prefered method.',
+	'GROUP_PERMISSIONS'			=&gt; 'Group Permissions',
+	'GROUP_PERMISSIONS_EXPLAIN' =&gt; 'Here you can set usergroup based permissions. These include capabilities such as the use of avatars, sending private messages, etc. To alter these settings for single users the User permissions system is the prefered method.',
+	'DEPENDENCIES'			=&gt;	'Dependencies',
+	'DEPENDENCIES_EXPLAIN'	=&gt;	'Here you can define relationships between administrator or moderator permission options and forum options. Using this you can automatically update forum permissions based on setting admin or moderator options. While this can save time care should be taken in defining these dependencies. Remember, these settings apply to all users and all groups.',
+
+	'LOOK_UP_GROUP'		=&gt; 'Look up Usergroup',
+	'MANAGE_USERS'		=&gt; 'Manage Users',
+	'ADD_USERS'			=&gt; 'Add Users',
+	'MANAGE_GROUPS'		=&gt; 'Manage Groups',
+	'ADD_GROUPS'		=&gt; 'Add Groups',
+	'ALLOWED_USERS'		=&gt; 'Allowed users',
+	'DISALLOWED_USERS'	=&gt; 'Disallowed users',
+	'ALLOWED_GROUPS'	=&gt; 'Allowed groups',
+	'DISALLOWED_GROUPS' =&gt; 'Disallowed groups',
+	'REMOVE_SELECTED'	=&gt; 'Remove selected',
+	'SET_OPTIONS'	=&gt; 'Set Options',
+	'OPTION'		=&gt; 'Option',
+	'YES'			=&gt; 'Yes',
+	'NO'			=&gt; 'No',
+	'UNSET'			=&gt; 'Unset',
+	'IGNORE'		=&gt; 'Ignore',
+	'PRESETS'		=&gt; 'Presets',
+	'ALL_YES'		=&gt; 'All Yes',
+	'ALL_NO'		=&gt; 'All No',
+	'ALL_UNSET'		=&gt; 'All Unset',
+	'ALL_IGNORE'	=&gt; 'All Ignore',
+	'USER_PRESETS'	=&gt; 'User presets',
+	'FROM_PARENT'	=&gt; 'From Parent',
+	'SELECT_VIEW'	=&gt; 'Select view',
+	'ACL_SUBFORUMS'			=&gt; 'Assign to sub-forums',
+	'ACL_SUBFORUMS_EXPLAIN'	=&gt; 'Select the subforums (if any) you want to inherit these permissions',
+	'PRESETS_EXPLAIN'		=&gt; 'To update or delete an existing preset select it from the list.',
+	'SELECT_PRESET'			=&gt; 'Select preset',
+	'PRESET_NAME'			=&gt; 'Preset name',
+	'EMPTY'					=&gt; 'Empty',
+	'WARNING'			=&gt; 'Warning',
+	'WARNING_EXPLAIN'	=&gt; 'You have altered settings for one or alternative views. Be sure to verify these settings before updating',
+	'NOTIFY'			=&gt; 'Notification',
+	'SELECTED_USER'		=&gt; 'Selected User',
+	'SELECTED_USERS'	=&gt; 'Selected Users',
+	'SELECTED_GROUP'	=&gt; 'Selected Group',
+	'SELECTED_GROUPS'	=&gt; 'Selected Groups',
+	'SELECTED_FORUM'	=&gt; 'Selected Forum',
+	'SELECTED_FORUMS'	=&gt; 'Selected Forums',
+	'WILL_SET_OPTIONS'	=&gt; 'Will set options in',
+	'INHERIT_PARENT'	=&gt; 'Inherit Parent',
+	'SAVE'				=&gt; 'Save',
+
+	'ACL_VIEW_FORUM'	=&gt; 'Forum Options',
+	'ACL_VIEW_MOD'		=&gt; 'Moderator Options',
+	'ACL_VIEW_SUPERMOD'	=&gt; 'Supermod Options',
+	'ACL_VIEW_ADMIN'	=&gt; 'Admin Options',
+
+	'AUTH_UPDATED'	=&gt; 'Permissions have been updated',
+
+	'acl_a_server' 		=&gt; 'Can alter server and email settings',
+	'acl_a_defaults' 	=&gt; 'Can alter board defaults',
+	'acl_a_board' 		=&gt; 'Can alter board settings',
+	'acl_a_cookies' 	=&gt; 'Can alter cookie settings',
+	'acl_a_names' 		=&gt; 'Can alter disallowed names',
+	'acl_a_words' 		=&gt; 'Can alter word censors',
+	'acl_a_icons' 		=&gt; 'Can alter topic icons and smilies',
+	'acl_a_search' 		=&gt; 'Can re-index search tables',
+	'acl_a_prune' 		=&gt; 'Can prune forums',
+	'acl_a_bbcode' 		=&gt; 'Can define BBCode tags',
+	'acl_a_attach' 		=&gt; 'Can manage attachments',
+	'acl_a_ranks'		=&gt; 'Can manage ranks',
+	'acl_a_user' 		=&gt; 'Can manage users',
+	'acl_a_userdel' 	=&gt; 'Can delete or prune users',
+	'acl_a_useradd' 	=&gt; 'Can add new users',
+	'acl_a_group' 		=&gt; 'Can manage groups',
+	'acl_a_groupdel' 	=&gt; 'Can delete groups',
+	'acl_a_groupadd' 	=&gt; 'Can add new groups',
+	'acl_a_forum' 		=&gt; 'Can manage forums',
+	'acl_a_forumdel' 	=&gt; 'Can delete forums',
+	'acl_a_forumadd' 	=&gt; 'Can add new forums',
+	'acl_a_ban' 		=&gt; 'Can manage bans',
+	'acl_a_auth' 		=&gt; 'Can alter forum permissions',
+	'acl_a_authmods' 	=&gt; 'Can alter moderator permissions',
+	'acl_a_authadmins' 	=&gt; 'Can alter admin permissions',
+	'acl_a_authusers' 	=&gt; 'Can alter user permissions',
+	'acl_a_authgroups' 	=&gt; 'Can alter group permissions',
+	'acl_a_email' 		=&gt; 'Can send mass email',
+	'acl_a_styles' 		=&gt; 'Can manage styles',
+	'acl_a_backup' 		=&gt; 'Can backup database',
+	'acl_a_restore' 	=&gt; 'Can restore database',
+	'acl_a_clearlogs' 	=&gt; 'Can clear admin and mod logs',
+	'acl_a_events' 		=&gt; 'Can use event system',
+	'acl_a_cron' 		=&gt; 'Can use cron system',
+	'acl_a_authdeps'	=&gt; 'Can set dependencies',
+
+	'acl_m_edit'	=&gt; 'Can edit posts',
+	'acl_m_delete'	=&gt; 'Can delete posts',
+	'acl_m_move'	=&gt; 'Can move topics',
+	'acl_m_lock'	=&gt; 'Can lock topics',
+	'acl_m_split'	=&gt; 'Can split topics',
+	'acl_m_merge'	=&gt; 'Can merge topics',
+	'acl_m_approve' =&gt; 'Can approve posts',
+	'acl_m_unrate'	=&gt; 'Can un-rate posts',
+	'acl_m_auth'	=&gt; 'Can set permissions',
+	'acl_m_ip'		=&gt; 'Can view IP\'s',
+	'acl_m_info'	=&gt; 'Can alter forum info',
+
+	'acl_f_list'		=&gt; 'Can see forum',
+	'acl_f_read'		=&gt; 'Can read forum',
+	'acl_f_post'		=&gt; 'Can post in forum',
+	'acl_f_reply'		=&gt; 'Can reply to posts',
+	'acl_f_quote'		=&gt; 'Can quote posts',
+	'acl_f_edit'		=&gt; 'Can edit own posts',
+	'acl_f_user_lock'	=&gt; 'Can lock own topics',
+	'acl_f_delete'		=&gt; 'Can delete own posts',
+	'acl_f_poll'		=&gt; 'Can create polls',
+	'acl_f_vote'		=&gt; 'Can vote in polls',
+	'acl_f_votechg'		=&gt; 'Can change existing vote',
+	'acl_f_announce'	=&gt; 'Can post announcements',
+	'acl_f_sticky'		=&gt; 'Can post stickies',
+	'acl_f_attach'		=&gt; 'Can attach files',
+	'acl_f_download'	=&gt; 'Can download files',
+	'acl_f_html'		=&gt; 'Can post HTML',
+	'acl_f_bbcode'		=&gt; 'Can post BBCode',
+	'acl_f_smilies'		=&gt; 'Can post smilies',
+	'acl_f_img'			=&gt; 'Can post images',
+	'acl_f_flash'		=&gt; 'Can post Flash',
+	'acl_f_sigs'		=&gt; 'Can use signatures',
+	'acl_f_search'		=&gt; 'Can search the forum',
+	'acl_f_email'		=&gt; 'Can email topics',
+	'acl_f_rate'		=&gt; 'Can rate posts',
+	'acl_f_report'		=&gt; 'Can report posts',
+	'acl_f_print'		=&gt; 'Can print topics',
+	'acl_f_ignoreflood' =&gt; 'Can ignore flood limit',
+	'acl_f_postcount'	=&gt; 'Increment post counter',
+	'acl_f_moderate'	=&gt; 'Posts are moderated',
+	'acl_f_bump'		=&gt; 'Can bump topics',
+	'acl_f_subscribe'	=&gt; 'Can subscribe forum',
+
+	'acl_u_hideonline'	=&gt; 'Can hide online status',
+	'acl_u_viewonline'	=&gt; 'Can view all online',
+	'acl_u_viewprofile'	=&gt; 'Can view profiles',
+	'acl_u_sendemail'	=&gt; 'Can send emails',
+	'acl_u_sendim'		=&gt; 'Can send instant messages',
+	'acl_u_sendpm'		=&gt; 'Can send private messages',
+	'acl_u_readpm'		=&gt; 'Can read private messages',
+	'acl_u_chgavatar'	=&gt; 'Can change avatar',
+	'acl_u_chgemail'	=&gt; 'Can change email address',
+	'acl_u_chgname'		=&gt; 'Can change username',
+	'acl_u_chggrp'		=&gt; 'Can change default usergroup',
+	'acl_u_chgpasswd'	=&gt; 'Can change password',
+	'acl_u_chgcensors'	=&gt; 'Can disable word censors',
+	'acl_u_search'		=&gt; 'Can search board',
+	'acl_u_savedrafts'	=&gt; 'Can save drafts',
+	'acl_u_download'	=&gt; 'Can download files',
+	'acl_u_attach'		=&gt; 'Can attach files',
+	'acl_u_sig'			=&gt; 'Can use signature',
+
+	'acl_u_pm_attach'	=&gt; 'Can attach files in private messages',
+	'acl_u_pm_html'		=&gt; 'Can post HTML in private messages',
+	'acl_u_pm_bbcode'	=&gt; 'Can post BBCode in private messages',
+	'acl_u_pm_smilies'	=&gt; 'Can post smilies in private messages',
+	'acl_u_pm_download'	=&gt; 'Can download files in private messages',
+	'acl_u_pm_report'	=&gt; 'Can report private messages',
+	'acl_u_pm_edit'		=&gt; 'Can edit own private messages',
+	'acl_u_pm_printpm'	=&gt; 'Can print private messages',
+	'acl_u_pm_emailpm'	=&gt; 'Can email private messages',
+	'acl_u_pm_forward'	=&gt; 'Can forward private messages',
+	'acl_u_pm_delete'	=&gt; 'Can remove private messages from own folder',
+	'acl_u_pm_img'		=&gt; 'Can post images in private messages',
+	'acl_u_pm_flash'	=&gt; 'Can post Flash in private messages'
+);
+
+// User pruning
+$this-&gt;lang += array(
+	'PRUNE_USERS_EXPLAIN'	=&gt; 'Here you can delete (or deactivate) users from you board. This can be done in a variety of ways; by post count, last activity, etc. Each of these criteria can be combined, i.e. you can prune users last active before 2002-01-01 with fewer than 10 posts. Alternatively you can enter a list of users directly into the text box, any criteria entered will be ignored. Take care with this facility! Once a user is deleted there is no way back.',
+	'SELECT_USERS_EXPLAIN'	=&gt; 'Enter specific usernames here, they will be used in preference to the criteria above.',
+
+	'LAST_ACTIVE_EXPLAIN'		=&gt; 'Enter a date in yyyy-mm-dd format.',
+	'JOINED_EXPLAIN'			=&gt; 'Enter a date in yyyy-mm-dd format.',
+	'DELETE_USER_POSTS'			=&gt; 'Delete pruned user posts',
+	'DELETE_USER_POSTS_EXPLAIN' =&gt; 'Removes posts made by deleted users, has no effect if users are deactivated.',
+	'DEACTIVATE_DELETE'			=&gt; 'Deactivate or delete',
+	'DEACTIVATE_DELETE_EXPLAIN'	=&gt; 'Choose whether to deactivate users or delete them entirely, note there is no undo!',
+	'DEACTIVATE'				=&gt; 'Deactivate',
+	'DELETE_USERS'				=&gt; 'Delete',
+
+	'USER_DEACTIVATE_SUCCESS'	=&gt; 'The selected users have been deactivated successfully',
+	'USER_DELETE_SUCCESS'		=&gt; 'The selected users have been deleted successfully',
+);
+
+// Banning
+$this-&gt;lang += array(
+	'BAN_EXPLAIN'				=&gt; 'Here you can control the banning of users by name, IP or email address. These methods prevent a user reaching any part of the board. You can give a short (255 character) reason for the ban if you wish. This will be displayed in the admin log. The length of a ban can also be specified. If you want the ban to end on a specific date rather than after a set time period select &lt;u&gt;Until&lt;/u&gt; for the ban length and enter a date in yyyy-mm-dd format.',
+	'BAN_EXCLUDE'				=&gt; 'Exclude from banning',
+
+	'BAN_REASON'	=&gt; 'Reason for ban',
+	'BAN_LENGTH'	=&gt; 'Length of ban',
+	'PERMANENT'		=&gt; 'Permanent',
+	'30_MINS'		=&gt; '30 Minutes',
+	'1_HOUR'		=&gt; '1 Hour',
+	'6_HOURS'		=&gt; '6 Hours',
+	'OTHER'			=&gt; 'Until',
+
+	'BAN_USERNAME_EXPLAIN'		=&gt; 'You can ban multiple users in one go by entering each name on a new line. Use the &lt;u&gt;Find a Username&lt;/u&gt; facility to look up and add one or more users automatically.',
+	'UNBAN_USERNAME'			=&gt; 'Un-ban or Un-exclude usernames',
+	'UNBAN_USERNAME_EXPLAIN'	=&gt; 'You can unban (or un-exclude) multiple users in one go using the appropriate combination of mouse and keyboard for your computer and browser. Excluded users have a grey background.',
+	'BAN_USER_EXCLUDE_EXPLAIN'	=&gt; 'Enable this to exclude the entered users from all current bans.',
+	'NO_BANNED_USERS'			=&gt; 'No banned usernames',
+
+	'IP_HOSTNAME'			=&gt; 'IP addresses or hostnames',
+	'BAN_IP_EXPLAIN'		=&gt; 'To specify several different IP\'s or hostnames enter each on a new line. To specify a range of IP addresses separate the start and end with a hyphen (-), to specify a wildcard use *',
+	'UNBAN_IP'				=&gt; 'Un-ban or Un-exclude IPs',
+	'UNBAN_IP_EXPLAIN'		=&gt; 'You can unban (or un-exclude) multiple IP addresses in one go using the appropriate combination of mouse and keyboard for your computer and browser. Excluded IP\'s have a grey background.',
+	'BAN_IP_EXCLUDE_EXPLAIN'=&gt; 'Enable this to exclude the entered IP from all current bans.',
+	'NO_BANNED_IP'			=&gt; 'No banned IP addresses',
+
+	'BAN_EMAIL'					=&gt; 'Ban one or more email addresses',
+	'BAN_EMAIL_EXPLAIN'			=&gt; 'To specify more than one email address enter each on a new line. To match partial addresses use * as the wildcard, e.g. *@hotmail.com, *@*.domain.tld, etc.',
+	'UNBAN_EMAIL'				=&gt; 'Un-ban or Un-exclude Emails',
+	'UNBAN_EMAIL_EXPLAIN'		=&gt; 'You can unban (or un-exclude) multiple email addresses in one go using the appropriate combination of mouse and keyboard for your computer and browser. Excluded email addresses have a grey background.',
+	'BAN_EMAIL_EXCLUDE_EXPLAIN' =&gt; 'Enable this to exclude the entered email address from all current bans.',
+	'NO_BANNED_EMAIL'			=&gt; 'No banned email addresses',
+
+	'BAN_UPDATE_SUCESSFUL'	=&gt; 'The banlist has been updated successfully',
+);
+
+// Jabber settings
+$this-&gt;lang += array(
+	'IM_EXPLAIN'	=&gt; 'Here you can enable and control the use Jabber for instant messaging and board notices. Jabber is an opensource protocol and therefore available for use by anyone. Some Jabber servers include gateways or transports which allow you to contact users on other networks. Not all servers offer all transports and changes in protocols can prevent transports from operating. Note that it may take several seconds to update Jabber account details, do not stop the script till completed!',
+
+	'JAB_ENABLE'			=&gt; 'Enable Jabber',
+	'JAB_ENABLE_EXPLAIN'	=&gt; 'Enables use of jabber messaging and notifications',
+
+	'JAB_SERVER'			=&gt; 'Jabber server',
+	'JAB_SERVER_EXPLAIN'	=&gt; 'See %sjabber.org%s for a list of servers',
+	'JAB_PORT'				=&gt; 'Jabber port',
+	'JAB_PORT_EXPLAIN'		=&gt; 'Leave blank unless you know it is not 5222',
+	'JAB_USERNAME'			=&gt; 'Jabber username',
+	'JAB_USERNAME_EXPLAIN'	=&gt; 'If this user is not registered it will be created if possible.',
+	'JAB_PASSWORD'			=&gt; 'Jabber password',
+	'JAB_RESOURCE'			=&gt; 'Jabber resource',
+	'JAB_RESOURCE_EXPLAIN'	=&gt; 'The resource locates this particular connection, e.g. board, home, etc.',
+
+	'JAB_PASS_CHANGED'		=&gt; 'Jabber password changed successfully',
+	'JAB_REGISTERED'		=&gt; 'New account registered successfully',
+	'JAB_CHANGED'			=&gt; 'Jabber account changed successfully',
+
+	'ERR_JAB_USERNAME'		=&gt; 'The username specified already exists, please choose an alternative.',
+	'ERR_JAB_REGISTER'		=&gt; 'An error occured trying to register this account, %s',
+	'ERR_JAB_PASSCHG'		=&gt; 'Could not change password',
+	'ERR_JAB_PASSFAIL'		=&gt; 'Password update failed, %s',
+);
+
+// Message Settings
+$this-&gt;lang += array(
+	'MESSAGE_SETTINGS_EXPLAIN'	=&gt; 'Here you can set all default settings for private messaging',
+
+	'BOXES_MAX'					=&gt; 'Max private message folders',
+	'BOXES_MAX_EXPLAIN'			=&gt; 'By default users may create this many personal folders for private messages..',
+	'BOXES_LIMIT'				=&gt; 'Max private messages per box',
+	'BOXES_LIMIT_EXPLAIN'		=&gt; 'Users may receive no more than this many messages in each of their private message boxes or zero for unlimited messages.',
+	'FULL_FOLDER_ACTION'		=&gt; 'Full folder default action',
+	'FULL_FOLDER_ACTION_EXPLAIN'=&gt; 'Default Action to take if an users folder is full and if the users folder action set is not applicable. For the special folder &quot;SENTBOX&quot; the default action is always deleting old messages.',
+	'HOLD_NEW_MESSAGES'			=&gt; 'Hold new messages',
+	'PM_EDIT_TIME'				=&gt; 'Limit editing time',
+	'PM_EDIT_TIME_EXPLAIN'		=&gt; 'Limits the time available to edit a private message not already delivered, zero equals infinity',
+
+	'ALLOW_MASS_PM'		=&gt; 'Allow Mass PM\'s',
+	'ALLOW_HTML_PM'		=&gt; 'Allow HTML in private messages',
+	'ALLOW_BBCODE_PM'	=&gt; 'Allow BBCode in private messages',
+	'ALLOW_SMILIES_PM'	=&gt; 'Allow smilies in private messages',
+	'ALLOW_DOWNLOAD_PM'	=&gt; 'Allow downloading of attachments in private messages',
+	'ALLOW_REPORT_PM'	=&gt; 'Allow reporting of private messages',
+	'ALLOW_FORWARD_PM'	=&gt; 'Allow forwarding of private messages',
+	'ALLOW_PRINT_PM'	=&gt; 'Allow print view in private messaging',
+	'ALLOW_EMAIL_PM'	=&gt; 'Allow emailing private messages',
+	'ALLOW_IMG_PM'		=&gt; 'Allow use of IMG BBCode Tag',
+	'ALLOW_FLASH_PM'	=&gt; 'Allow use of FLASH BBCode Tag',
+	'ENABLE_PM_ICONS'	=&gt; 'Enable use of topic icons in private messages'
+);
+
+// Cookie settings
+$this-&gt;lang += array(
+	'COOKIE_SETTINGS_EXPLAIN'	=&gt; 'These details define the data used to send cookies to your users browsers. In most cases the default values for the cookie settings should be sufficient. If you do need to change any do so with care, incorrect settings can prevent users logging in.',
+
+	'COOKIE_DOMAIN'			=&gt; 'Cookie domain',
+	'COOKIE_NAME'			=&gt; 'Cookie name',
+	'COOKIE_PATH'			=&gt; 'Cookie path',
+	'COOKIE_SECURE'			=&gt; 'Cookie secure',
+	'COOKIE_SECURE_EXPLAIN' =&gt; 'If your server is running via SSL set this to enabled else leave as disabled',
+);
+
+// Avatar settings
+$this-&gt;lang += array(
+	'AVATAR_SETTINGS_EXPLAIN'	=&gt; 'Avatars are generally small, unique images a user can associate with themselves. Depending on the style they are usually displayed below the username when viewing topics. Here you can determine how users can define their avatars. Please note that in order to upload avatars you need to have created the directory you name below and ensure it can be written to by the web server. Please also note that filesize limits are only imposed on uploaded avatars, they do not apply to remotely linked images.',
+	'ALLOW_LOCAL'				=&gt; 'Enable gallery avatars',
+	'ALLOW_REMOTE'				=&gt; 'Enable remote avatars',
+	'ALLOW_REMOTE_EXPLAIN'		=&gt; 'Avatars linked to from another website',
+	'ALLOW_UPLOAD'				=&gt; 'Enable avatar uploading',
+	'MAX_FILESIZE'				=&gt; 'Maximum Avatar File Size',
+	'MAX_FILESIZE_EXPLAIN'		=&gt; 'For uploaded avatar files',
+	'MIN_AVATAR_SIZE'			=&gt; 'Minimum Avatar Dimensions',
+	'MIN_AVATAR_SIZE_EXPLAIN'	=&gt; '(Height x Width in pixels)',
+	'MAX_AVATAR_SIZE'			=&gt; 'Maximum Avatar Dimensions',
+	'MAX_AVATAR_SIZE_EXPLAIN'	=&gt; '(Height x Width in pixels)',
+	'AVATAR_STORAGE_PATH'		=&gt; 'Avatar Storage Path',
+	'AVATAR_STORAGE_PATH_EXPLAIN'	=&gt; 'Path under your phpBB root dir, e.g. images/avatars/upload',
+	'AVATAR_GALLERY_PATH'			=&gt; 'Avatar Gallery Path',
+	'AVATAR_GALLERY_PATH_EXPLAIN'	=&gt; 'Path under your phpBB root dir for pre-loaded images, e.g. images/avatars/gallery',
+);
+
+// Server settings
+$this-&gt;lang += array(
+	'SERVER_SETTINGS_EXPLAIN'	=&gt; 'Here you define server and domain dependant settings. Please ensure the data you enter is accurate, errors will result in emails containing incorrect information. When entering the domain name remember it does include <A HREF="http://">http://</A> or other protocol term. Only alter the port number if you know your server uses a different value, port 80 is correct in most cases.',
+	'SERVER_NAME'				=&gt; 'Domain Name',
+	'SERVER_NAME_EXPLAIN'		=&gt; 'The domain name this board runs from',
+	'SCRIPT_PATH'				=&gt; 'Script path',
+	'SCRIPT_PATH_EXPLAIN'		=&gt; 'The path where phpBB2 is located relative to the domain name',
+	'SERVER_PORT'				=&gt; 'Server Port',
+	'SERVER_PORT_EXPLAIN'		=&gt; 'The port your server is running on, usually 80, only change if different',
+	'IP_VALID'					=&gt; 'Session IP validation',
+	'IP_VALID_EXPLAIN'			=&gt; 'Determines how much of the users IP is used to validate a session; All compares the complete address, A.B.C the first x.x.x, A.B the first x.x, None disables checking.',
+	'ALL'						=&gt; 'All',
+	'CLASS_C'					=&gt; 'A.B.C',
+	'CLASS_B'					=&gt; 'A.B',
+	'BROWSER_VALID'				=&gt; 'Validate browser',
+	'BROWSER_VALID_EXPLAIN'		=&gt; 'Enables browser validation for each session inproving security.',
+	'ENABLE_GZIP'				=&gt; 'Enable GZip Compression',
+	'SMILIES_PATH'				=&gt; 'Smilies storage path',
+	'SMILIES_PATH_EXPLAIN'		=&gt; 'Path under your phpBB root dir, e.g. images/smilies',
+	'ICONS_PATH'				=&gt; 'Post icons storage path',
+	'ICONS_PATH_EXPLAIN'		=&gt; 'Path under your phpBB root dir, e.g. images/icons',
+	'UPLOAD_ICONS_PATH'			=&gt; 'Extension group icons storage path',
+	'UPLOAD_ICONS_PATH_EXPLAIN'	=&gt; 'Path under your phpBB root dir, e.g. images/upload_icons',
+	'RANKS_PATH'				=&gt; 'Rank image storage path',
+	'RANKS_PATH_EXPLAIN'		=&gt; 'Path under your phpBB root dir, e.g. images/ranks',
+);
+
+// Load settings
+$this-&gt;lang += array(
+	'LOAD_SETTINGS_EXPLAIN'		=&gt; 'Here you can enable and disable certain board functions to reduce the amount of processing required. On most servers there is no need to disable any functions. However on certain systems or in shared hosting environments it may be beneficial to disable capabilities you do not really need. You can also specify limits for system load and active sessions beyond which the board will go offline.',
+	'LIMIT_LOAD'				=&gt; 'Limit system load',
+	'LIMIT_LOAD_EXPLAIN'		=&gt; 'If the 1 minute system load exceeds this value the board will go offline, 1.0 equals ~100% utilisation of one processor. This only functions on UNIX based servers.',
+	'LIMIT_SESSIONS'			=&gt; 'Limit sessions',
+	'LIMIT_SESSIONS_EXPLAIN'	=&gt; 'If the number of sessions exceeds this value within a one minute period the board will go offline. Set to 0 for unlimited sessions.',
+	'SESSION_LENGTH'			=&gt; 'Session length',
+	'SESSION_LENGTH_EXPLAIN'	=&gt; 'Sessions will expire after this time, in seconds.',
+	'YES_POST_MARKING'			=&gt; 'Enable dotted topics',
+	'YES_POST_MARKING_EXPLAIN'	=&gt; 'Indicates whether user has posted to a topic.',
+	'YES_READ_MARKING'			=&gt; 'Enable server-side topic marking',
+	'YES_READ_MARKING_EXPLAIN'	=&gt; 'Stores read/unread status information in the database rather than a cookie.',
+	'ONLINE_LENGTH'				=&gt; 'View online time span',
+	'ONLINE_LENGTH_EXPLAIN'		=&gt; 'Time in minutes after which inactive users will not appear in viewonline listings, lower equals less processing.',
+	'YES_ONLINE'				=&gt; 'Enable online user listings',
+	'YES_ONLINE_EXPLAIN'		=&gt; 'Display online user information on index, forum and topic pages.',
+	'YES_ONLINE_GUESTS'			=&gt; 'Enable online guest listings in viewonline',
+	'YES_ONLINE_GUESTS_EXPLAIN'	=&gt; 'Allow display of guest user informations in viewonline.',
+	'YES_ONLINE_TRACK'			=&gt; 'Enable display of user online img',
+	'YES_ONLINE_TRACK_EXPLAIN'	=&gt; 'Display online information for user in profiles and viewtopic.',
+	'YES_BIRTHDAYS'				=&gt; 'Enable birthday listing',
+	'YES_MODERATORS'			=&gt; 'Enable display of Moderators',
+	'YES_JUMPBOX'				=&gt; 'Enable display of Jumpbox',
+	'YES_SEARCH'				=&gt; 'Enable search facilities',
+	'YES_SEARCH_EXPLAIN'		=&gt; 'User and backend search functions including fulltext updates when posting.',
+	'YES_SEARCH_UPDATE'			=&gt; 'Enable fulltext updating',
+	'YES_SEARCH_UPDATE_EXPLAIN'	=&gt; 'Updating of fulltext indexes when posting, overriden if search is disabled.',
+	'YES_SEARCH_PHRASE'			=&gt; 'Enable phrase searching',
+	'YES_SEARCH_PHRASE_EXPLAIN'	=&gt; 'Searching for phrases requires additional processing.',
+	'RECOMPILE_TEMPLATES'		=&gt; 'Recompile stale templates',
+	'RECOMPILE_TEMPLATES_EXPLAIN'=&gt; 'Check for updated template files on filesystem and recompile.',
+);
+
+// Email settings
+$this-&gt;lang += array(
+	'EMAIL_SETTINGS_EXPLAIN'	=&gt; 'This information is used when the board sends emails to your users. Please ensure the email address you specify is valid, any bounced or undeliverable messages will likely be sent to that address. If your host does not provide a native (PHP based) email service you can instead send messages directly using SMTP. This requires the address of an appropriate server (ask your provider if necessary), do not specify any old name here! If the server requires authentication (and only if it does) enter the necessary username and password. Please note only basic authentication is offered, different authentication implementations are not currently supported.',
+	'ENABLE_EMAIL'				=&gt; 'Enable board-wide emails',
+	'ENABLE_EMAIL_EXPLAIN'		=&gt; 'If this is set to disabled no emails will be sent by the board at all.',
+	'BOARD_EMAIL_FORM'			=&gt; 'Users send email via board',
+	'BOARD_EMAIL_FORM_EXPLAIN'	=&gt; 'Instead of showing the users email address users are able to send emails via the board.',
+	'BOARD_HIDE_EMAILS'			=&gt; 'Hide email addresses',
+	'BOARD_HIDE_EMAILS_EXPLAIN'	=&gt; 'This function keeps email addresses completely private.',
+	'EMAIL_FUNCTION_NAME'		=&gt; 'Email Function Name',
+	'EMAIL_FUNCTION_NAME_EXPLAIN' =&gt; 'The email function used to send mails through PHP.',
+	'EMAIL_PACKAGE_SIZE'		=&gt; 'Email Package Size',
+	'EMAIL_PACKAGE_SIZE_EXPLAIN' =&gt; 'This is the number of emails sent in one package.',
+	'ADMIN_EMAIL'				=&gt; 'Return Email Address',
+	'ADMIN_EMAIL_EXPLAIN'		=&gt; 'This will be used as the return address on all emails.',
+	'EMAIL_SIG'					=&gt; 'Email Signature',
+	'EMAIL_SIG_EXPLAIN'			=&gt; 'This text will be attached to all emails the board sends.',
+	'CONTACT_EMAIL'				=&gt; 'Contact email address',
+	'CONTACT_EMAIL_EXPLAIN'		=&gt; 'This address will be used whenever a specific contact point is needed, e.g. spam, error output, etc.',
+	'USE_SMTP'					=&gt; 'Use SMTP Server for email',
+	'USE_SMTP_EXPLAIN'			=&gt; 'Say yes if you want or have to send email via a named server instead of the local mail function.',
+	'SMTP_SERVER'				=&gt; 'SMTP Server Address',
+	'SMTP_PORT'					=&gt; 'SMTP Server Port',
+	'SMTP_PORT_EXPLAIN'			=&gt; 'Only change this if you know your SMTP server is on a different port.',
+	'SMTP_AUTH_METHOD'			=&gt; 'Authentication method for SMTP',
+	'SMTP_AUTH_METHOD_EXPLAIN'	=&gt; 'Only used if a username/password is set, ask your provider if you are unsure which method to use.',
+	'SMTP_LOGIN'				=&gt; 'LOGIN',
+	'SMTP_PLAIN'				=&gt; 'PLAIN',
+	'SMTP_CRAM_MD5'				=&gt; 'CRAM-MD5',
+	'SMTP_DIGEST_MD5'			=&gt; 'DIGEST-MD5',
+	'SMTP_POP_BEFORE_SMTP'		=&gt; 'POP-BEFORE-SMTP',
+	'SMTP_USERNAME'				=&gt; 'SMTP Username',
+	'SMTP_USERNAME_EXPLAIN'		=&gt; 'Only enter a username if your smtp server requires it.',
+	'SMTP_PASSWORD'				=&gt; 'SMTP Password',
+	'SMTP_PASSWORD_EXPLAIN'		=&gt; 'Only enter a password if your smtp server requires it.',
+);
+
+// Board settings
+$this-&gt;lang += array(
+	'BOARD_SETTINGS_EXPLAIN'	=&gt; 'Here you can determine the basic operation of your board, from the site name through user registration to private messaging.',
+	'SITE_NAME'					=&gt; 'Site name',
+	'SITE_DESC'					=&gt; 'Site description',
+	'DISABLE_BOARD'				=&gt; 'Disable board',
+	'DISABLE_BOARD_EXPLAIN'		=&gt; 'This will make the board unavailable to users. You can also enter a short (255 character) message to display if you wish.',
+	'ACC_ACTIVATION'			=&gt; 'Account activation',
+	'ACC_ACTIVATION_EXPLAIN'	=&gt; 'This determines whether users have immediate access to the board or if confirmation is required. You can also completely disable new registrations.',
+	'ACC_NONE'					=&gt; 'None',
+	'ACC_USER'					=&gt; 'User',
+	'ACC_ADMIN'					=&gt; 'Admin',
+	'ACC_USER_ADMIN'			=&gt; 'User + Admin',
+	'ACC_DISABLE'				=&gt; 'Disable',
+	'VISUAL_CONFIRM'			=&gt; 'Enable visual confirmation',
+	'VISUAL_CONFIRM_EXPLAIN'	=&gt; 'Requires new users enter a random code matching an image to help prevent mass registrations.',
+	'LOGIN_LIMIT'				=&gt; 'Login attempts',
+	'LOGIN_LIMIT_EXPLAIN'		=&gt; 'Number of failed logins users can make before being locked out that session',
+	'REG_LIMIT'					=&gt; 'Registration attempts',
+	'REG_LIMIT_EXPLAIN'			=&gt; 'Number of attempts users can make at the confirmation code before being locked out that session.',
+	'FORCE_PASS_CHANGE'			=&gt; 'Force password change',
+	'FORCE_PASS_CHANGE_EXPLAIN'	=&gt; 'Require user to change their password after a set number of days or zero to disable.',
+	'CHAR_LIMIT'				=&gt; 'Max characters per post',
+	'CHAR_LIMIT_EXPLAIN'		=&gt; 'Set to 0 for unlimited characters.',
+	'SMILIES_LIMIT'				=&gt; 'Max smilies per post',
+	'SMILIES_LIMIT_EXPLAIN'		=&gt; 'Set to 0 for unlimited smilies.',
+	'QUOTE_DEPTH_LIMIT'			=&gt; 'Max nested quotes per post',
+	'QUOTE_DEPTH_LIMIT_EXPLAIN'	=&gt; 'Set to 0 for unlimited depth.',
+	'USERNAME_LENGTH'			=&gt; 'Username length',
+	'USERNAME_LENGTH_EXPLAIN'	=&gt; 'Minimum and maximum number of characters in usernames.',
+	'USERNAME_CHARS'			=&gt; 'Limit username chars',
+	'USERNAME_CHARS_EXPLAIN'	=&gt; 'Restrict type of characters that may be used in usernames, spacers are; space, -, +, _, [ and ]',
+	'PASSWORD_LENGTH'			=&gt; 'Password length',
+	'PASSWORD_LENGTH_EXPLAIN'	=&gt; 'Minimum and maximum number of characters in passwords.',
+	'PASSWORD_TYPE'				=&gt; 'Password complexity',
+	'PASSWORD_TYPE_EXPLAIN'		=&gt; 'Determines how complex a password needs to be when set or altered, subsequent options include the previous ones.',
+	'PASS_TYPE_ANY'				=&gt; 'No requirements',
+	'PASS_TYPE_CASE'			=&gt; 'Must be mixed case',
+	'PASS_TYPE_ALPHA'			=&gt; 'Must contain alphanumerics',
+	'PASS_TYPE_SYMBOL'			=&gt; 'Must contain symbols',
+	'MIN_CHARS'					=&gt; 'Min',
+	'MAX_CHARS'					=&gt; 'Max',
+	'ALLOW_EMAIL_REUSE'			=&gt; 'Allow Email address re-use',
+	'ALLOW_EMAIL_REUSE_EXPLAIN'	=&gt; 'Different users can register with the same email address.',
+	'USERNAME_CHARS_ANY'		=&gt; 'Any character',
+	'USERNAME_ALPHA_ONLY'		=&gt; 'Alphanumeric only',
+	'USERNAME_ALPHA_SPACERS'	=&gt; 'Alphanumeric and spacers',
+	'ENABLE_COPPA'				=&gt; 'Enable COPPA',
+	'ENABLE_COPPA_EXPLAIN'		=&gt; 'This requires users to declare whether they are 13 or over for compliance with the U.S. COPPA act.',
+	'COPPA_FAX'					=&gt; 'COPPA Fax Number',
+	'COPPA_MAIL'				=&gt; 'COPPA Mailing Address',
+	'COPPA_MAIL_EXPLAIN'		=&gt; 'This is the mailing address where parents will send COPPA registration forms',
+	'BOARD_PM'					=&gt; 'Private Messaging',
+	'BOARD_PM_EXPLAIN'			=&gt; 'Enable or disable private messaging for all users.',
+	'EDIT_TIME'					=&gt; 'Limit editing time',
+	'EDIT_TIME_EXPLAIN'			=&gt; 'Limits the time available to edit a new post, zero equals infinity',
+	'DISPLAY_LAST_EDITED'		=&gt; 'Display last edited time information',
+	'DISPLAY_LAST_EDITED_EXPLAIN' =&gt; 'Choose if the last edited by information to be displayed on posts',
+	'FLOOD_INTERVAL'			=&gt; 'Flood Interval',
+	'FLOOD_INTERVAL_EXPLAIN'	=&gt; 'Number of seconds a user must wait between posting new messages. To enable users to ignore this alter their permissions.',
+	'BUMP_INTERVAL'				=&gt; 'Bump Interval',
+	'BUMP_INTERVAL_EXPLAIN'		=&gt; 'Number of minutes, hours or days between the last post to a topic and the ability to bump this topic.',
+	'SEARCH_INTERVAL'			=&gt; 'Search Flood Interval',
+	'SEARCH_INTERVAL_EXPLAIN'	=&gt; 'Number of seconds users must wait between searches.',
+	'MIN_SEARCH_CHARS'			=&gt; 'Min characters indexed by search',
+	'MIN_SEARCH_CHARS_EXPLAIN'	=&gt; 'Words with at least this many characters will be indexed for searching.',
+	'MAX_SEARCH_CHARS'			=&gt; 'Max characters indexed by search',
+	'MAX_SEARCH_CHARS_EXPLAIN'	=&gt; 'Words with no more than this many characters will be indexed for searching.',
+	'TOPICS_PER_PAGE'			=&gt; 'Topics Per Page',
+	'POSTS_PER_PAGE'			=&gt; 'Posts Per Page',
+	'HOT_THRESHOLD'				=&gt; 'Posts for Popular Threshold',
+	'MAX_POLL_OPTIONS'			=&gt; 'Max number of poll options',
+);
+
+// Auth settings
+$this-&gt;lang += array(
+	'AUTH_SETTINGS_EXPLAIN'	=&gt; 'phpBB2 supports authentication plug-ins, or modules. These allow you determine how users are authenticated when they log into the board. By default three plug-ins are provided; DB, LDAP and Apache. Not all methods require additional information so only fill out fields if they are relevant to the selected method.',
+	'AUTH_METHOD'			=&gt; 'Select an authentication method',
+	'LDAP_SERVER'			=&gt; 'LDAP server name',
+	'LDAP_SERVER_EXPLAIN'	=&gt; 'If using LDAP this is the name or IP address of the server.',
+	'LDAP_DN'				=&gt; 'LDAP base dn',
+	'LDAP_DN_EXPLAIN'		=&gt; 'This is the Distinguished Name, locating the user information, e.g. o=My Company,c=US',
+	'LDAP_UID'				=&gt; 'LDAP uid',
+	'LDAP_UID_EXPLAIN'		=&gt; 'This is the key under which to search for a given login identity, e.g. uid, sn, etc.',
+);
+
+// Board defaults
+$this-&gt;lang += array(
+	'BOARD_DEFAULTS_EXPLAIN'	=&gt; 'These settings allow you to define a number of default or global settings used by the board. For example, to disable the use of HTML across the entire board alter the relevant setting below. This data is also used for new user registrations and (where relevant) guest users. Please note that registered users can override some of these options with their own settings.',
+	'DEFAULT_STYLE'				=&gt; 'Default Style',
+	'OVERRIDE_STYLE'			=&gt; 'Override user style',
+	'OVERRIDE_STYLE_EXPLAIN'	=&gt; 'Replaces users style with the default.',
+	'DEFAULT_LANGUAGE'			=&gt; 'Default Language',
+	'DEFAULT_DATE_FORMAT'		=&gt; 'Date Format',
+	'DEFAULT_DATE_FORMAT_EXPLAIN'=&gt; 'The date format is the same as the PHP date function.',
+	'SYSTEM_TIMEZONE'			=&gt; 'System Timezone',
+	'SYSTEM_DST'				=&gt; 'Enable Daylight Savings Time',
+	'ALLOW_TOPIC_NOTIFY'		=&gt; 'Allow Topic Watching',
+	'ALLOW_FORUM_NOTIFY'		=&gt; 'Allow Forum Watching',
+	'ALLOW_NAME_CHANGE'			=&gt; 'Allow Username changes',
+
+	'MIN_RATINGS'				=&gt; 'Ratings count before karma',
+	'MIN_RATINGS_EXPLAIN'		=&gt; 'Number of distinct ratings before users karma is calculated.',
+	'ALLOW_ATTACHMENTS'			=&gt; 'Allow Attachments',
+	'ALLOW_PM_ATTACHMENTS'		=&gt; 'Allow Attachments in Private Messages',
+	'ALLOW_HTML'				=&gt; 'Allow HTML',
+	'ALLOWED_TAGS'				=&gt; 'Allowed HTML tags',
+	'ALLOWED_TAGS_EXPLAIN'		=&gt; 'Separate tags with commas.',
+	'ALLOW_BBCODE'				=&gt; 'Allow BBCode',
+	'ALLOW_SMILIES'				=&gt; 'Allow Smilies',
+	'ALLOW_SIG'					=&gt; 'Allow Signatures',
+	'MAX_SIG_LENGTH'			=&gt; 'Maximum signature length',
+	'MAX_SIG_LENGTH_EXPLAIN'	=&gt; 'Maximum number of characters in user signatures.',
+	'ALLOW_NO_CENSORS'			=&gt; 'Allow Disable of Censors',
+	'ALLOW_NO_CENSORS_EXPLAIN'	=&gt; 'User can disable word censoring.',
+	'ALLOW_BOOKMARKS'			=&gt; 'Allow bookmarking topics',
+	'ALLOW_BOOKMARKS_EXPLAIN'	=&gt; 'User is able to store personal bookmarks'
+);
+
+// Karma settings
+$this-&gt;lang += array(
+	'KARMA_SETTINGS'		=&gt; 'Karma Settings',
+	'KARMA_SETTINGS_EXPLAIN'=&gt; 'Here you can enable and disable the user Karma rating system. You can also modify the weighting factors used to derive each users karma.',
+	'ENABLE_KARMA'			=&gt; 'Enable Karma',
+
+	'KARMA_HIST_WEIGHT'			=&gt; 'Historical ratings weighting',
+	'KARMA_HIST_WEIGHT_EXPLAIN'	=&gt; 'Ratings made before the previous 30 days',
+	'KARMA_DAY_WEIGHT'			=&gt; 'Recent ratings weighting',
+	'KARMA_DAY_WEIGHT_EXPLAIN'	=&gt; 'Ratings made in past 30 days',
+	'KARMA_REG_WEIGHT'			=&gt; 'Membership length weighting',
+	'KARMA_REG_WEIGHT_EXPLAIN'	=&gt; 'Total length of membership',
+	'KARMA_POST_WEIGHT'			=&gt; 'Total posts weighting',
+);
+
+// Avatars
+$this-&gt;lang += array(
+	'AVATARS_GALLERY'	=&gt; 'Avatar Gallery',
+);
+
+// PHP info
+$this-&gt;lang += array(
+	'PHP_INFO_EXPLAIN'	=&gt; 'This page lists information on the version of PHP installed on this server. It includes details of loaded modules, available variables and default settings. This information may be useful when diagnosing problems. Please be aware that some hosting companies will limit what information is displayed here for security reasons. You are advised to not give out any details on this page except when asked by support or other Team Member on the support forums.',
+);
+
+// Forum admin
+$this-&gt;lang += array(
+	'FORUM_ADMIN'			=&gt; 'Forum Administration',
+	'FORUM_ADMIN_EXPLAIN'	=&gt; 'In phpBB 2.2 there are no categories, everything is forum based. Each forum can have an unlimited number of sub-forums and you can determine whether each may be posted to or not (i.e. whether it acts like an old category). Here you can add, edit, delete, lock, unlock individual forums as well as set certain additional controls. If your posts and topics have got out of sync you can also resynchronise a forum.',
+	'FORUM_EDIT_EXPLAIN'	=&gt; 'The form below will allow you to customise this forum. Please note that moderation and post count controls are set via forum permissions for each user or usergroup.',
+	'FORUM_DELETE'			=&gt; 'Delete Forum',
+	'FORUM_DELETE_EXPLAIN'	=&gt; 'The form below will allow you to delete a forum and decide where you want to put all topics (or forums) it contained.',
+
+	'EDIT_FORUM'	=&gt; 'Edit forum',
+	'CREATE_FORUM'	=&gt; 'Create new forum',
+	'REMOVE'		=&gt; 'Remove',
+	'EDIT'			=&gt; 'Edit',
+	'MOVE_UP'		=&gt; 'Move up',
+	'MOVE_DOWN'		=&gt; 'Move down',
+	'RESYNC'		=&gt; 'Sync',
+	'UPDATE'		=&gt; 'Update',
+
+	'FORUM_SETTINGS'	=&gt; 'Forum Settings',
+	'FORUM_GENERAL'		=&gt; 'General Forum Settings',
+	'FORUM_TYPE'		=&gt; 'Forum Type',
+	'TYPE_FORUM'		=&gt; 'Forum',
+	'TYPE_CAT'			=&gt; 'Category',
+	'TYPE_LINK'			=&gt; 'Link',
+	'FORUM_NAME'		=&gt; 'Forum Name',
+	'FORUM_DESC'		=&gt; 'Description',
+	'FORUM_DESC_EXPLAIN'=&gt; 'Any markup entered here will displayed as is.',
+	'FORUM_LINK'		=&gt; 'Forum Link',
+	'FORUM_LINK_EXPLAIN'=&gt; 'Full URL to location clicking this forum will take the user.',
+	'FORUM_LINK_TRACK'	=&gt; 'Track Link Redirects',
+	'FORUM_LINK_TRACK_EXPLAIN'	=&gt; 'Records the number of times a forum link was clicked.',
+	'FORUM_STATUS'		=&gt; 'Forum Status',
+	'FORUM_STYLE'		=&gt; 'Forum Style',
+	'FORUM_IMAGE'		=&gt; 'Forum Image',
+	'FORUM_IMAGE_EXPLAIN'=&gt; 'Location, relative to the phpBB root directory, of an image to associate with this forum.',
+	'FORUM_PARENT'		=&gt; 'Parent Forum',
+
+	'FORUM_RULES'			=&gt; 'Forum Rules',
+	'FORUM_RULES_EXPLAIN'	=&gt; 'Forum Rules are displayed at any page within the given forum.',
+	'FORUM_RULES_LINK'		=&gt; 'Link to Forum Rules',
+	'FORUM_RULES_LINK_EXPLAIN'=&gt; 'You are able to enter the URL of the page/post containing your forum rules here. This setting will override the Forum Rules text you specified.',
+	'FORUM_RULES_PREVIEW'	=&gt; 'Forum Rules preview',
+	'PARSE_BBCODE'			=&gt; 'Parse BBCode',
+	'PARSE_SMILIES'			=&gt; 'Parse Smilies',
+	'PARSE_URLS'			=&gt; 'Parse Links',
+
+	'NO_PARENT'			=&gt; 'No Parent',
+	'LINK'				=&gt; 'Link',
+	'LOCKED'			=&gt; 'Locked',
+	'UNLOCKED'			=&gt; 'Unlocked',
+	'ENABLE_NEWS'		=&gt; 'Set as news forum',
+	'ENABLE_NEWS_EXPLAIN' =&gt; 'If set to yes posts in this forum will be displayed as news items.',
+	'ENABLE_RECENT'		=&gt; 'Display active topics',
+	'ENABLE_RECENT_EXPLAIN' =&gt; 'If set to yes topics made to this forum will be shown in the active topics list.',
+	'DISPLAY_ACTIVE_TOPICS'			=&gt; 'Enable active topics',
+	'DISPLAY_ACTIVE_TOPICS_EXPLAIN'	=&gt; 'If set to yes active topics in selected subforums will be displayed under this category.',
+	'ENABLE_INDEXING'	=&gt; 'Enable search indexing',
+	'ENABLE_INDEXING_EXPLAIN'	=&gt; 'If set to yes posts made to this forum will be indexed for searching.',
+	'ENABLE_TOPIC_ICONS'=&gt; 'Enable Topic Icons',
+	'LIST_INDEX'		=&gt; 'List Forum On Index',
+	'LIST_INDEX_EXPLAIN'=&gt; 'Displays a link to this forum under the root parent forum on the index.',
+	'FORUM_AUTO_PRUNE'			=&gt; 'Enable Auto-Pruning',
+	'FORUM_AUTO_PRUNE_EXPLAIN'	=&gt; 'Prunes the forum of topics, set the frequency/age parameters below.',
+	'AUTO_PRUNE_FREQ'			=&gt; 'Auto-prune Frequency',
+	'AUTO_PRUNE_FREQ_EXPLAIN'	=&gt; 'Time in days between pruning events.',
+	'AUTO_PRUNE_DAYS'			=&gt; 'Auto-prune Post Age',
+	'AUTO_PRUNE_DAYS_EXPLAIN'	=&gt; 'Number of days since last post after which topic is removed.',
+	'AUTO_PRUNE_VIEWED'			=&gt; 'Auto-prune Post Viewed Age',
+	'AUTO_PRUNE_VIEWED_EXPLAIN'	=&gt; 'Number of days since topic was viewed after which topic is removed.',
+	'PRUNE_OLD_POLLS'			=&gt; 'Prune Old Polls',
+	'PRUNE_OLD_POLLS_EXPLAIN'	=&gt; 'Removes topics with polls not voted in for post age days.',
+	'PRUNE_FINISHED_POLLS'		=&gt; 'Prune Closed Polls',
+	'PRUNE_FINISHED_POLLS_EXPLAIN'=&gt; 'Removes topics with polls which have ended.',
+	'PRUNE_ANNOUNCEMENTS'		=&gt; 'Prune Announcements',
+	'PRUNE_STICKY'				=&gt; 'Prune Stickies',
+	'FORUM_TOPICS_PAGE'			=&gt; 'Topics Per Page',
+	'FORUM_TOPICS_PAGE_EXPLAIN'	=&gt; 'If non-zero this value will override the default topics per page setting.',
+	'ACTIVE_TOPICS_PAGE'			=&gt; 'Number of active topics',
+	'ACTIVE_TOPICS_PAGE_EXPLAIN'	=&gt; 'If non-zero this value will override the default topics per page setting.',
+	'FORUM_PASSWORD'			=&gt; 'Forum Password',
+	'FORUM_PASSWORD_EXPLAIN'	=&gt; 'Defines a password for this forum, use the permission system in preference.',
+	'FORUM_PASSWORD_CONFIRM'	=&gt; 'Confirm Forum Password',
+	'FORUM_PASSWORD_CONFIRM_EXPLAIN'	=&gt; 'Only needs to be set if a forum password is entered.',
+
+	'MOVE_POSTS_TO'		=&gt; 'Move posts',
+	'MOVE_SUBFORUMS_TO' =&gt; 'Move subforums',
+	'DELETE_ALL_POSTS'	=&gt; 'Delete posts',
+	'DELETE_SUBFORUMS'	=&gt; 'Delete subforums and posts',
+
+	'NO_DESTINATION_FORUM'		=&gt; 'You have not specified a forum to move content to',
+	'FORUM_PASSWORD_MISMATCH'	=&gt; 'The passwords you entered did not match.',
+	'FORUM_NAME_EMPTY'			=&gt; 'You must enter a name for this forum.',
+	'FORUM_DATA_NEGATIVE'		=&gt; 'Pruning parameters cannot be negative.',
+	'FORUM_CREATED'				=&gt; 'Forum created successfully.',
+	'FORUM_UPDATED'				=&gt; 'Forum informations updated successfully.',
+	'REDIRECT_ACL'				=&gt; 'To set permissions for this forum click %sHERE%s.',
+	'FORUM_DELETED'				=&gt; 'Forum successfully deleted',
+	'FORUM_RESYNCED'			=&gt; 'Forum successfully resynced',
+);
+
+// Smiley and topic icons
+$this-&gt;lang += array(
+	'ICONS_EXPLAIN'	=&gt; 'From this page you can add, remove and edit the icons users may add to their topics or posts. These icons are generally displayed next to topic titles on the forum listing, or the post subjects in topic listings. You can also install and create new packages of icons.',
+	'SMILIES_EXPLAIN' =&gt; 'Smilies or emoticons are typically small, sometimes animated images used to convey an emotion or feeling. From this page you can add, remove and edit the emoticons users can use in their posts and private messages. You can also install and create new packages of smilies.',
+	'IMPORT_SMILIES'	=&gt; 'Install smilies pak',
+	'EXPORT_SMILIES'	=&gt; 'Create smilies pak',
+	'IMPORT_ICONS'	=&gt; 'Install icons pak',
+	'EXPORT_ICONS'	=&gt; 'Create icons pak',
+	'MASS_ADD_SMILIES'=&gt; 'Add multiple smilies',
+	'ADD_SMILIES'	=&gt; 'Add single smiley',
+	'ADD_ICONS'		=&gt; 'Add single icon',
+	'ADD_ICONS'		=&gt; 'Add multiple icons',
+	'EDIT_SMILIES'	=&gt; 'Edit smilies',
+	'EDIT_ICONS'	=&gt; 'Edit Icons',
+	'SMILIES_NOT_DISPLAYED' =&gt; 'The following smilies are not displayed on the posting page',
+	'ICONS_NOT_DISPLAYED' =&gt; 'The following icons are not displayed on the posting page',
+	'CODE'			=&gt; 'Code',
+	'EMOTION'		=&gt; 'Emotion',
+	'REORDER'		=&gt; 'Reorder',
+	'DISPLAY'		=&gt; 'Display',
+	'DIMENSIONS'	=&gt; 'Dimensions',
+	'FIRST'			=&gt; 'First',
+	'AFTER_SMILIES'	=&gt; 'After %s',
+	'AFTER_ICONS'	=&gt; 'After %s',
+
+	'SMILIES_CONFIG'	=&gt; 'Smiley configuration',
+	'SMILIES_IMAGE'		=&gt; 'Smiley image',
+	'SMILIES_CODE'		=&gt; 'Smiley code',
+	'SMILIES_URL'		=&gt; 'Smiley image file',
+	'SMILIES_ORDER'		=&gt; 'Smiley order',
+	'SMILIES_EMOTION'	=&gt; 'Emotion',
+	'SMILIES_ADD'		=&gt; 'Add a new Smiley',
+	'SMILIES_EDIT'		=&gt; 'Edit Smiley',
+	'SMILIES_LOCATION'	=&gt; 'Smiley location',
+	'SMILIES_WIDTH'		=&gt; 'Smiley width',
+	'SMILIES_HEIGHT'	=&gt; 'Smiley height',
+
+	'ICONS_CONFIG'		=&gt; 'Icon configuration',
+	'ICONS_IMAGE'		=&gt; 'Icon image',
+	'ICONS_LOCATION'	=&gt; 'Icon location',
+	'ICONS_URL'			=&gt; 'Icon image file',
+	'ICONS_ORDER'		=&gt; 'Icon order',
+	'ICONS_ADD'			=&gt; 'Add a new Icon',
+	'ICONS_EDIT'		=&gt; 'Edit Icon',
+	'ICONS_WIDTH'		=&gt; 'Icon width',
+	'ICONS_HEIGHT'		=&gt; 'Icon height',
+
+	'EXPORT_SMILIES_EXPLAIN' =&gt; 'To create a package of your currently installed smilies, click %sHERE%s to download the smilies.pak file. Once downloaded create a zip or tgz file containing all of your smilies plus this .pak configuration file.',
+	'EXPORT_ICONS_EXPLAIN' =&gt; 'To create a package of your currently installed icons, click %sHERE%s to download the icons package file. Once downloaded create a zip or tgz file containing all of your icons plus this .pak configuration file.',
+	'NO_SMILIES_EXPORT'	=&gt; 'You have no smilies with which to create a package.',
+	'NO_ICONS_EXPORT'	=&gt; 'You have no icons with which to create a package.',
+	'WRONG_PAK_TYPE'	=&gt; 'The specified package does not contain the appropriate data.',
+	'SELECT_PACKAGE'	=&gt; 'Select a package file',
+	'DELETE_ALL'		=&gt; 'Delete all',
+	'KEEP_ALL'			=&gt; 'Keep all',
+	'REPLACE_MATCHES'	=&gt; 'Replace matches',
+	'NO_SMILIES_PAK'	=&gt; 'No smiley packages found.',
+	'CURRENT_SMILIES'	=&gt; 'Current smilies',
+	'SMILIES_IMPORT_SUCCESS' =&gt; 'The smilies pack was imported successfully',
+	'NO_ICONS_PAK' =&gt; 'No icon packages found.',
+	'CURRENT_ICONS' =&gt; 'Current icons',
+	'DISPLAY_ON_POSTING'	=&gt; 'Display on posting',
+	
+	'ICONS_IMPORT_SUCCESS' =&gt; 'The icons pack was imported successfully',
+	'SMILIES_DELETED' =&gt; 'The smiley has been removed successfully.',
+	'SMILIES_EDITED' =&gt; 'The smiley has been updated successfully.',
+	'SMILIES_ADDED' =&gt; 'The smiley has been added successfully.',
+	'SMILIES_IMPORTED' =&gt; 'The smilies pack has been installed successfully.',
+	'ICONS_DELETED' =&gt; 'The icon has been removed successfully.',
+	'ICONS_EDITED' =&gt; 'The icon has been updated successfully.',
+	'ICONS_ADDED' =&gt; 'The icon has been added successfully.',
+	'ICONS_IMPORTED' =&gt; 'The icons pack has been installed successfully.',
+);
+
+// Custom bbcodes
+$this-&gt;lang += array(
+	'BBCODES'						=&gt;	'BBCodes',
+	'BBCODES_EXPLAIN'			=&gt;	'BBCode is a special implementation of HTML offering greater control over what and how something is displayed. Additionnally, you can save users from typing sometimes very long HTML code by providing them a single BBCode as replacement. From this page you can add, remove and edit custom BBCodes',
+
+	'TOO_MANY_BBCODES'		=&gt;	'You cannot create any more BBCodes. Please remove one or more BBCodes then try again',
+	'BBCODE_NOT_EXIST'		=&gt;	'The BBCode you selected does not exist',
+	'BBCODE_ADDED'				=&gt;	'BBCode added successfully',
+	'BBCODE_EDITED'				=&gt;	'BBCode edited successfully',
+
+	'BBCODE_TAG'					=&gt;	'Tag',
+	'ADD_BBCODE'					=&gt;	'Add a new BBCode',
+
+	// Note to translators: you can translate everything but what's between { and }
+	'BBCODE_USAGE'							=&gt;	'BBCode usage',
+	'BBCODE_USAGE_EXPLAIN'			=&gt;	'Here you define how to use the bbcode. Replace any variable input by the corresponding token (see below)',
+	'BBCODE_USAGE_EXAMPLE'			=&gt;	'[colour={COLOR}]{TEXT}[/colour]&lt;br /&gt;&lt;br /&gt;[font={TEXT1}]{TEXT2}[/font]',
+	'HTML_REPLACEMENT'					=&gt;	'HTML replacement',
+	'HTML_REPLACEMENT_EXPLAIN'		=&gt;	'Here you define the default HTML replacement (each template can have its own HTML replacement). Do not forget to put back tokens you used above!',
+	'HTML_REPLACEMENT_EXAMPLE'	=&gt;	'&lt;font color=&quot;{COLOR}&quot;&gt;{TEXT}&lt;/font&gt;&lt;br /&gt;&lt;br /&gt;&lt;font face=&quot;{TEXT1}&quot;&gt;{TEXT2}&lt;/font&gt;',
+	'TOKENS'										=&gt;	'Tokens',
+	'TOKENS_EXPLAIN'						=&gt;	'Tokens are placeholders for user input. The input will be validated only if it matches the corresponding definition. If needed, you can number them by adding a number as the last character between the braces, e.g. {USERNAME1}, {USERNAME2}.&lt;br /&gt;&lt;br /&gt;In addition to these tokens you can use any of lang string present in your language/ directory like this: {L_&lt;i&gt;&lt;stringname&gt;&lt;/i&gt;} where &lt;i&gt;&lt;stringname&gt;&lt;/i&gt; is the name of the translated string you want to add. For example, {L_WROTE} will be displayed as &quot;wrote&quot; or its translation according to user\'s locale',
+
+	'EXAMPLE'										=&gt;	'Example:',
+	'EXAMPLES'									=&gt;	'Examples:',
+
+	'TOKEN'							=&gt;	'Token',
+	'TOKEN_DEFINITION'	 	=&gt;	'What can it be?',
+
+	'tokens'	=&gt;	array(
+		'TEXT'			=&gt;	'Any text, including foreign characters, numbers, etc...',
+		'NUMBER'		=&gt;	'Any serie of digits',
+		'EMAIL'			=&gt;	'A valid email address',
+		'URL'				=&gt;	'A valid URL using any protocol (http, ftp, etc... cannot be used for javascript exploits). If none is given, &quot;<A HREF="http://">http://</A>&quot; is prepended to to the string',
+		'LOCAL_URL'	=&gt;	'A local URL. The URL must be relative to the topic page and cannot contain a server name or protocol',
+		'COLOR'		=&gt;	'A HTML color, can be either in the numeric form #FF1234 or an english name such as &quot;blue&quot;'
+	)
+);
+
+// User admin
+$this-&gt;lang += array(
+	'USER_ADMIN'			=&gt; 'User Administration',
+	'USER_ADMIN_EXPLAIN'	=&gt; 'Here you can change your users information and certain specific options. To modify the users permissions please use the user and group permissions system.',
+	'SELECT_USER'			=&gt; 'Select User',
+
+	'SELECT_FORM'			=&gt; 'Select form',
+	'USER_ADMIN_OVERVIEW'	=&gt; 'Overview',
+	'USER_ADMIN_FEEDBACK'	=&gt; 'Feedback',
+	'USER_ADMIN_PROFILE'	=&gt; 'Profile',
+	'USER_ADMIN_PREFS'		=&gt; 'Preferences',
+	'USER_ADMIN_AVATAR'		=&gt; 'Avatar',
+	'USER_ADMIN_SIG'		=&gt; 'Signature',
+	'USER_ADMIN_GROUP'		=&gt; 'Groups',
+	'USER_ADMIN_PERM'		=&gt; 'Permissions',
+	'USER_ADMIN_ATTACH'		=&gt; 'Attachments',
+
+	'FOUNDER'				=&gt; 'Founder',
+	'FOUNDER_EXPLAIN'		=&gt; 'Founders can never be banned, deleted or altered by non-founder members',
+	'USER_INFO'				=&gt; 'Basic information',
+	'REGISTERED'			=&gt; 'Registered',
+	'REGISTERED_IP'			=&gt; 'Registered from IP',
+	'LAST_ACTIVE'			=&gt; 'Last active',
+	'WARNINGS'				=&gt; 'Warnings',
+	'WARNINGS_EXPLAIN'		=&gt; 'You can directly alter the warnings this users has received.',
+	'USER_TOOLS'			=&gt; 'Basic tools',
+	'QUICK_TOOLS'			=&gt; 'Quick tools',
+	'DELETE_USER'			=&gt; 'Delete users',
+	'DELETE_USER_EXPLAIN'	=&gt; 'Please note that deleting a user is final, they cannot be recovered',
+	'RETAIN_POSTS'			=&gt; 'Retain posts',
+	'DELETE_POSTS'			=&gt; 'Delete posts',
+	'USER_ADMIN_BAN_USER'	=&gt; 'Ban by username',
+	'USER_ADMIN_BAN_EMAIL'	=&gt; 'Ban by email',
+	'USER_ADMIN_BAN_IP'		=&gt; 'Ban by IP',
+	'USER_ADMIN_FORCE'		=&gt; 'Force re-activation',
+	'USER_ADMIN_DEACTIVATE'	=&gt; 'Deactivate account',
+	'USER_ADMIN_ACTIVATE'	=&gt; 'Activate account',
+	'USER_ADMIN_MOVE_POSTS'	=&gt; 'Move all posts',
+	'MOVE_POSTS_EXPLAIN'	=&gt; 'Please select the forum to which you wish to move all the posts this user has made.',
+
+	'USER_POSTING_PREFS'	=&gt; 'Posting preferences',
+
+	'ADMIN_SIGNATURE_PREVIEW'	=&gt; 'Users signature will appear like this',
+
+	'USER_ADMIN_BAN_NAME_REASON'	=&gt; 'Username banned via user management',
+	'USER_ADMIN_BAN_IP_REASON'		=&gt; 'IP banned via user management',
+	'USER_ADMIN_BAN_EMAIL_REASON'	=&gt; 'Email address banned via user management',
+
+	'USER_DELETED'			=&gt; 'User deleted successfully',
+	'USER_OVERVIEW_UPDATED'	=&gt; 'User details updated',
+	'USER_PROFILE_UPDATED'	=&gt; 'User profile updated',
+	'USER_PREFS_UPDATED'	=&gt; 'User preferences updated',
+	'USER_ADMIN_INACTIVE'	=&gt; 'User deactivated successfully',
+	'USER_ADMIN_ACTIVE'		=&gt; 'User activated successfully',
+);
+
+// Group admin
+$this-&gt;lang += array(
+	'GROUP_MANAGE_EXPLAIN' =&gt; 'From this panel you can administer all your usergroups, you can; delete, create and edit existing groups. You may choose moderators, toggle open/closed group status and set the group name and description.',
+
+	'USER_DEF_GROUPS'			=&gt; 'User defined groups',
+	'USER_DEF_GROUPS_EXPLAIN'	=&gt; 'These are groups created by you or another admin on this board. You can manage memberships as well as edit group properties or even delete the group. By clicking &quot;Default&quot; you can set the relevant group to the default for all its members.',
+	'SPECIAL_GROUPS'			=&gt; 'Predefined groups',
+	'SPECIAL_GROUPS_EXPLAIN'	=&gt; 'Pre-defined groups are special groups, they cannot be deleted or directly modified. However you can still add users and alter basic settings. By clicking &quot;Default&quot; you can set the relevant group to the default for all its members.',
+	'TOTAL_MEMBERS'			=&gt; 'Members',
+	'GROUP_DEFS_UPDATED'	=&gt; 'Default group set for all members',
+	'CREATE_GROUP'			=&gt; 'Create new group',
+
+	'GROUP_LIST'			=&gt; 'Current members',
+	'GROUP_LIST_EXPLAIN'	=&gt; 'This is a complete list of all the current users with membership of this group. You can delete members (except in certain special groups) or add new ones as you see fit.',
+	'GROUP_MEMBERS'			=&gt; 'Group members',
+	'GROUP_MEMBERS_EXPLAIN' =&gt; 'This is a complete listing of all the members of this usergroup. It includes seperate sections for leaders, pending and existing members. From here you can manage all aspects of who has membership of this group and what their role is. To remove a leader but keep them in the group use Demote rather than delete. Similarly use Promote to make an existing member a leader.',
+	'GROUP_LEAD'			=&gt; 'Group leaders',
+	'GROUP_APPROVED'		=&gt; 'Approved Members',
+	'GROUP_PENDING'			=&gt; 'Pending Members',
+	'GROUPS_NO_MEMBERS'		=&gt; 'This group has no members',
+	'GROUPS_NO_MODS'		=&gt; 'No group leaders defined',
+	'SELECT_OPTION'	=&gt; 'Select option',
+	'GROUP_DEFAULT'	=&gt; 'Default',
+	'GROUP_APPROVE'	=&gt; 'Approve',
+	'GROUP_PROMOTE'	=&gt; 'Promote',
+	'GROUP_DEMOTE'	=&gt; 'Demote',
+	'GROUP_DELETE'	=&gt; 'Delete',
+
+	'ADD_USERS_EXPLAIN'				=&gt; 'Here you can add new users to the group. You may select whether this group becomes the new default for the selected users. Additionally you can define them as group leaders. Please enter each username on a seperate line.',
+	'USER_DEFAULT'			=&gt; 'User default',
+	'USER_GROUP_DEFAULT'	=&gt; 'Set as default group',
+	'USER_GROUP_DEFAULT_EXPLAIN'	=&gt; 'Saying yes here will set this group as the default group for the added users',
+	'USER_GROUP_LEADER'		=&gt; 'Set as group leader',
+	'GROUP_USERS_EXIST'		=&gt; 'The selected users are already members.',
+	'GROUP_USERS_ADDED'		=&gt; 'New users added to group successfully.',
+	'GROUP_MODS_ADDED'		=&gt; 'New group moderators added successfully.',
+	'USERS_APPROVED'		=&gt; 'Users approved successfully.',
+
+	'GROUP_EDIT_EXPLAIN'	=&gt; 'Here you can edit an existing group. You can change its name, description and type (open, closed, etc.). You can also set certain groupwide options such as colouration, rank, etc. Changes made here override users current settings. Please note that group members can alter their avatar unless you set appropriate user permissions.',
+	'GROUP_DETAILS'			=&gt; 'Group details',
+	'GROUP_NAME'			=&gt; 'Group name',
+	'GROUP_DESC'			=&gt; 'Group description',
+	'GROUP_TYPE'			=&gt; 'Group type',
+	'GROUP_TYPE_EXPLAIN'	=&gt; 'This determines which users can join or view this group.',
+	'GROUP_OPEN'			=&gt; 'Open',
+	'GROUP_REQUEST'			=&gt; 'Request',
+	'GROUP_CLOSED'			=&gt; 'Closed',
+	'GROUP_HIDDEN'			=&gt; 'Hidden',
+	'GROUP_COLOR'			=&gt; 'Group colour',
+	'GROUP_COLOR_EXPLAIN'	=&gt; 'Defines the colour members usernames will appear in, leave blank for user default.',
+	'FORCE_COLOR'			=&gt; 'Force update',
+	'GROUP_RANK'			=&gt; 'Group rank',
+	'GROUP_AVATAR'			=&gt; 'Group avatar',
+	'GROUP_AVATAR_EXPLAIN'	=&gt; 'This image will be displayed in the Group Control Panel.',
+	'GROUP_UPDATED'			=&gt; 'Group preferences updated successfully.',
+	'GROUP_CREATED'			=&gt; 'Group has been created successfully',
+
+	'GROUP_SETTINGS_SAVE'		=&gt; 'Groupwide settings',
+	'GROUP_SETTINGS'			=&gt; 'Set user preferences',
+	'GROUP_SETTINGS_EXPLAIN'	=&gt; 'Here you can force changes in users current preferences. Please note these settings are not saved for the group itself. They are intended as a quick method of altering the preferences of all users in this group.',
+	'GROUP_LANG'				=&gt; 'Group language',
+	'GROUP_TIMEZONE'			=&gt; 'Group timezone',
+	'GROUP_DST'					=&gt; 'Group daylight savings',
+
+	'GROUP_MODS_DEMOTED'		=&gt; 'Group leaders demoted successfully',
+	'GROUP_MODS_PROMOTED'		=&gt; 'Group members promoted successfully',
+	'GROUP_USERS_REMOVE'		=&gt; 'Users removed from group and new defaults set successfully',
+	'GROUP_DELETED'				=&gt; 'Group deleted and user default groups set successfully',
+
+	'GROUP_ERR_USERNAME'	=&gt; 'No group name specified.',
+	'GROUP_ERR_USER_LONG'	=&gt; 'Group name too long.',
+	'GROUP_ERR_DESC_LONG'	=&gt; 'Group description too long.',
+	'GROUP_ERR_TYPE'		=&gt; 'Inappropriate group type specified.',
+	'GROUP_ERR_USERS_EXIST' =&gt; 'The specified users are already members of this group',
+);
+
+// Forum Pruning
+$this-&gt;lang += array(
+	'FORUM_PRUNE_EXPLAIN' =&gt; 'This will delete any topic which has not been posted to within the number of days you select. If you do not enter a number then all topics will be deleted. It will not remove topics in which polls are still running nor will it remove announcements. You will need to remove these topics manually.',
+	'PRUNE_NOT_POSTED'	=&gt; 'Days since last posted',
+	'PRUNE_NOT_VIEWED'	=&gt; 'Days since last viewed',
+
+	'TOPICS_PRUNED'		=&gt; 'Topics pruned',
+	'POSTS_PRUNED'		=&gt; 'Posts pruned',
+	'PRUNE_SUCCESS'		=&gt; 'Pruning of forums was successful',
+);
+
+// Word censors
+$this-&gt;lang += array(
+	'WORDS_TITLE' =&gt; 'Word Censoring',
+	'WORDS_EXPLAIN' =&gt; 'From this control panel you can add, edit, and remove words that will be automatically censored on your forums. In addition people will not be allowed to register with usernames containing these words. Wildcards (*) are accepted in the word field, eg. *test* will match detestable, test* would match testing, *test would match detest.',
+	'WORD' =&gt; 'Word',
+	'EDIT_WORD' =&gt; 'Edit word censor',
+	'REPLACEMENT' =&gt; 'Replacement',
+	'ADD_WORD' =&gt; 'Add new word',
+	'UPDATE_WORD' =&gt; 'Update word censor',
+	'ENTER_WORD' =&gt; 'You must enter a word and its replacement',
+	'NO_WORD' =&gt; 'No word selected for editing',
+	'WORD_UPDATED' =&gt; 'The selected word censor has been successfully updated',
+	'WORD_ADDED' =&gt; 'The word censor has been successfully added',
+	'WORD_REMOVED' =&gt; 'The selected word censor has been successfully removed',
+);
+
+// Mass email
+$this-&gt;lang += array(
+	'MASS_EMAIL_EXPLAIN'	=&gt; 'Here you can email a message to either all of your users, or all users of a specific group.  To do this, an email will be sent out to the administrative email address supplied, with a blind carbon copy sent to all recipients. If you are emailing a large group of people please be patient after submitting and do not stop the page halfway through. It is normal for a mass emailing to take a long time, you will be notified when the script has completed',
+	'COMPOSE'				=&gt; 'Compose',
+	'SEND_TO_GROUP'			=&gt; 'Send to group',
+	'SEND_TO_USERS'			=&gt; 'Send to users',
+	'SEND_TO_USERS_EXPLAIN'	=&gt; 'Entering names here will override any group selected above. Enter each username on a new line.',
+	'MASS_MESSAGE'			=&gt; 'Your message',
+	'MASS_MESSAGE_EXPLAIN'	=&gt; 'Please note that you may enter only plain text. All markup will be removed before sending.',
+	'ALL_USERS'				=&gt; 'All Users',
+	'NO_EMAIL_SUBJECT'		=&gt; 'You must specify a subject for your message.',
+	'NO_EMAIL_MESSAGE'		=&gt; 'You must enter a message.',
+	'EMAIL_SENT'			=&gt; 'Your message has been queued for sending.',
+	'EMAIL_SEND_ERROR'		=&gt; 'There were one or more errors while sending the email. Please check the %sError Log%s for detailed error messages.',
+	'SEND_IMMEDIATLY'		=&gt; 'Send immediatly',
+	'LOG_SESSION'			=&gt; 'Log Mail Session',
+	'MAIL_PRIORITY'			=&gt; 'Mail Priority',
+	'MAIL_LOW_PRIORITY'		=&gt; 'Low',
+	'MAIL_NORMAL_PRIORITY'	=&gt; 'Normal',
+	'MAIL_HIGH_PRIORITY'	=&gt; 'High'
+);
+
+// Ranks
+$this-&gt;lang += array(
+	'RANKS_EXPLAIN' =&gt; 'Using this form you can add, edit, view and delete ranks. You can also create custom ranks which can be applied to a user via the user management facility',
+	'ADD_RANK' =&gt; 'Add new rank',
+	'RANK_TITLE' =&gt; 'Rank Title',
+	'RANK_SPECIAL' =&gt; 'Set as Special Rank',
+	'RANK_MINIMUM' =&gt; 'Minimum Posts',
+	'RANK_IMAGE' =&gt; 'Rank Image',
+	'RANK_IMAGE_EXPLAIN' =&gt; 'Use this to define a small image associated with the rank. The path is relative to the root phpBB2 directory.',
+	'MUST_SELECT_RANK' =&gt; 'You must select a rank.',
+	'NO_ASSIGNED_RANK' =&gt; 'No special rank assigned.',
+	'RANK_UPDATED' =&gt; 'The rank was successfully updated.',
+	'RANK_ADDED' =&gt; 'The rank was successfully added.',
+	'RANK_REMOVED' =&gt; 'The rank was successfully deleted.',
+	'NO_UPDATE_RANKS' =&gt; 'The rank was successfully deleted. However user accounts using this rank were not updated.  You will need to manually reset the rank on these accounts.',
+);
+
+// Disallowed names
+$this-&gt;lang += array(
+	'Disallow_control' =&gt; 'Username Disallow Control',
+	'Disallow_explain' =&gt; 'Here you can control usernames which will not be allowed to be used.  Disallowed usernames are allowed to contain a wildcard character of *.  Please note that you will not be allowed to specify any username that has already been registered, you must first delete that name then disallow it',
+	'Delete_disallow' =&gt; 'Delete',
+	'Delete_disallow_title' =&gt; 'Remove a Disallowed Username',
+	'Delete_disallow_explain' =&gt; 'You can remove a disallowed username by selecting the username from this list and clicking submit',
+	'Add_disallow' =&gt; 'Add',
+	'Add_disallow_title' =&gt; 'Add a disallowed username',
+	'Add_disallow_explain' =&gt; 'You can disallow a username using the wildcard character * to match any character',
+	'No_disallowed' =&gt; 'No Disallowed Usernames',
+	'Disallowed_deleted' =&gt; 'The disallowed username has been successfully removed',
+	'Disallow_successful' =&gt; 'The disallowed username has been successfully added',
+	'Disallowed_already' =&gt; 'The name you entered could not be disallowed. It either already exists in the list, exists in the word censor list, or a matching username is present',
+);
+
+// Styling
+$this-&gt;lang += array(
+	'STYLES'			=&gt; 'Styles',
+	'STYLES_EXPLAIN'	=&gt; 'Here you can manage the available styles on your board. A style consists off a template, theme and imageset. You may alter existing styles, delete, deactivate, reactivate, create or import new ones. You can also see what a style will look like using the preview function. The current default style is noted by the presence of an asterix, * Also listed is the total user count for each style, note that overriding user styles will not be reflected here.',
+	'STYLE_NAME'			=&gt; 'Style name',
+	'STYLE_USED_BY'			=&gt; 'Used by',
+	'STYLE_ACTIVATE'		=&gt; 'Activate',
+	'STYLE_DEACTIVATE'		=&gt; 'Deactivate',
+	'CREATE_STYLE'			=&gt; 'Create new style',
+	'INSTALLED_STYLE'		=&gt; 'Installed styles',
+	'UNINSTALLED_STYLE'		=&gt; 'Uninstalled styles',
+	'NO_UNINSTALLED_STYLE'	=&gt; 'No uninstalled styles detected',
+	'DEACTIVATE_DEFAULT'	=&gt; 'You cannot deactivate the default style.',
+
+	'EDIT_DETAILS_STYLE'		=&gt; 'Edit Style',
+	'EDIT_DETAILS_STYLE_EXPLAIN'=&gt; 'Using the form below you can modify this existing style. You may alter the combination of template, theme and imageset which define the style itself. You may also deactivate the style and alter its name.',
+	'STYLE_ACTIVE'				=&gt; 'Active',
+	'STYLE_DEFAULT'				=&gt; 'Make default style',
+	'STYLE_IMAGESET'			=&gt; 'Imageset',
+	'STYLE_THEME'				=&gt; 'Theme',
+	'STYLE_TEMPLATE'			=&gt; 'Template',
+	'STYLE_ADDED'				=&gt; 'Style added successfully',
+	'STYLE_EDITED'				=&gt; 'Style edited successfully',
+
+	'ADD_STYLE'				=&gt; 'Create Style',
+	'ADD_STYLE_EXPLAIN'		=&gt; 'Here you can create a new style. Depending on your server configuration and file permissions you may have additional options. For example you may be able to base this style on an existing one. You may also be able to upload or import (from the store directory) a style archive. If you upload or import an archive the style name will be determined automatically.',
+	'INSTALL_STYLE'			=&gt; 'Install Style',
+	'INSTALL_STYLE_EXPLAIN'	=&gt; 'Here you can install a new style and if appropriate the corresponding style elements. If you already have the relevant style elements installed they will not be overwritten. Some styles require existing style elements to already be installed. If you try installing such a style and do not have the required elements you will be notified.',
+	'STYLE_BASIS'			=&gt; 'Style based on',
+	'SELECT_STYLE'			=&gt; 'Select style',
+	'STYLE_UPLOAD_BASIS'	=&gt; 'Upload a style',
+	'STYLE_IMPORT_BASIS'	=&gt; 'Import style from store',
+
+	'STYLE_EXPORT'			=&gt; 'Export Style',
+	'STYLE_EXPORT_EXPLAIN'	=&gt; 'Here you can export a style in the form of an archive. A style does not need to contain all elements but it must contain at least one. For example if you have created a new theme and imageset for a commonly used template you could simply export the theme and imageset and ommit the template. You may select whether to download the file directly or to place it in your store folder for download later or via FTP.',
+	'INCLUDE_TEMPLATE'		=&gt; 'Include template',
+	'INCLUDE_THEME'			=&gt; 'Include theme',
+	'INCLUDE_IMAGESET'		=&gt; 'Include imageset',
+	'STYLE_EXPORTED'		=&gt; 'Style exported succesfully and stored in %s',
+
+	'DELETE_STYLE'			=&gt; 'Delete style',
+	'DELETE_STYLE_EXPLAIN'	=&gt; 'Here you can remove the selected style. You cannot remove all the style elements from here. These must be deleted individually via their respective forms. Take care in deleting styles there is no undo facility.',
+	'REPLACE_STYLE'			=&gt; 'Replace style with',
+	'REPLACE_STYLE_EXPLAIN'	=&gt; 'This style will replace the one being deleted for members that use it.',
+	'ONLY_STYLE'			=&gt; 'This is the only remaining style, you cannot delete it',
+	'STYLE_DELETED'			=&gt; 'Style deleted successfully',
+
+	'TEMPLATES'					=&gt; 'Templates',
+	'TEMPLATES_EXPLAIN'			=&gt; 'A Template set comprises all the markup used to generate the layout of your board. Here you can  edit existing template sets, delete, export, import and preview sets. You can also modify the templating code used to generate BBCode.',
+	'CREATE_TEMPLATE'			=&gt; 'Create new template set',
+	'INSTALLED_TEMPLATE'		=&gt; 'Installed templates',
+	'UNINSTALLED_TEMPLATE'		=&gt; 'Uninstalled templates',
+	'NO_UNINSTALLED_TEMPLATE'	=&gt; 'No uninstalled templates detected',
+
+	'EDIT_TEMPLATE'			=&gt; 'Edit Template',
+	'EDIT_TEMPLATE_EXPLAIN'	=&gt; 'Here you can edit your template set directly. Please remember that these edits are permanent and cannot be undone once submitted. If PHP can write to the template files in your styles directory any changes here will be written directly to those files. If PHP cannot write to those files they will be copied into the database and all changes will only be reflected there. Please take care when editing your template set, remember to close all replacement variable terms {XXXX} and conditional statements.',
+	'SELECTED_TEMPLATE'		=&gt; 'Selected template set:',
+	'RAW_HTML'				=&gt; 'Raw HTML',
+	'TEMPLATE_UPDATED'		=&gt; 'Template updated successfully',
+
+	'EDIT_DETAILS_TEMPLATE'			=&gt; 'Edit template details',
+	'EDIT_DETAILS_TEMPLATE_EXPLAIN'	=&gt; 'Here you can edit certain templates details such as its name. You may also have the option to switch storage of the stylesheet from the filesystem to the database and vice versa. This option depends on your PHP configuration and whether your template set can be written to by the webserver.',
+	'ADD_TEMPLATE'				=&gt; 'Create Template',
+	'ADD_TEMPLATE_EXPLAIN'		=&gt; 'Here you can add a new template. Depending on your server configuration and file permissions you may have additional options here. For example you may be able to base this template set on an existing one. You may also be able to upload or import (from the store directory) a template archive. If you upload or import an archive the template name can be optionally taken from the archive name (to do this leave the template name blank).',
+	'INSTALL_TEMPLATE'			=&gt; 'Install Template',
+	'INSTALL_TEMPLATE_EXPLAIN'	=&gt; 'Here you can install a new template set. Depending on your server configuration you may have a number of options here.',
+	'TEMPLATE_NAME'				=&gt; 'Template name',
+	'SELECT_TEMPLATE'			=&gt; 'Select template',
+	'TEMPLATE_BASIS'			=&gt; 'Template set based on',
+	'TEMPLATE_UPLOAD_BASIS'		=&gt; 'Upload a template',
+	'TEMPLATE_IMPORT_BASIS'		=&gt; 'Import template from store',
+	'TEMPLATE_LOCATION'			=&gt; 'Store templates in',
+	'TEMPLATE_LOCATION_EXPLAIN'	=&gt; 'Images are always stored on the filesystem.',
+	'TEMPLATE_ADDED'			=&gt; 'Template set added and stored on filesystem',
+	'TEMPLATE_ADDED_DB'			=&gt; 'Template set added and stored in database',
+
+	'TEMPLATE_CACHE'		=&gt; 'Template Cache',
+	'TEMPLATE_CACHE_EXPLAIN'=&gt; 'By default phpBB caches the compiled version of its templates. This decreases the load on the server each time a page is viewed and thus may reduce the page generation time. Here you can view the cache status of each file and delete individual files or the entire cache.',
+	'CACHE_FILENAME'		=&gt; 'Template file',
+	'CACHE_FILESIZE'		=&gt; 'Filesize',
+	'CACHE_CACHED'			=&gt; 'Cached',
+	'CACHE_MODIFIED'		=&gt; 'Modified',
+	'NO_CACHED_TPL_FILES'		=&gt; 'No cached files for this template',
+	'TEMPLATE_CACHE_CLEARED'=&gt; 'Cached templates deleted',
+
+	'TEMPLATE_EXPORT'			=&gt; 'Export Templates',
+	'TEMPLATE_EXPORT_EXPLAIN'	=&gt; 'Here you can export a template set in the form of an archive. This archive will contain all the files necessary to install the templates on another board. You may select whether to download the file directly or to place it in your store folder for download later or via FTP.',
+	'TEMPLATE_EXPORTED'		=&gt; 'Templates exported succesfully and stored in %s',
+
+	'DELETE_TEMPLATE'			=&gt; 'Delete Template',
+	'DELETE_TEMPLATE_EXPLAIN'	=&gt; 'Here you can remove the selected template set from the database. Additionally, if you have permission you can elect to remove the set from the filesystem. Please note that there is no undo capability. When the templates are deleted they are gone for good. It is recommended that you first export your set for possible future use.',
+	'REPLACE_TEMPLATE'			=&gt; 'Replate template with',
+	'REPLACE_TEMPLATE_EXPLAIN'	=&gt; 'This template set will replace the one you are deleting in any styles that use it.',
+	'TEMPLATE_DELETED'			=&gt; 'Template set deleted successfully',
+	'TEMPLATE_DELETED_FS'		=&gt; 'Template set removed from database but some files may remain on the filesystem',
+	'ONLY_TEMPLATE'				=&gt; 'This is the only remaining template set, you cannot delete it',
+
+	'THEMES'				=&gt; 'Themes',
+	'THEMES_EXPLAIN'		=&gt; 'From here you can create, install, edit, delete and export themes. A theme is the combination of colours and images that are applied to your templates to define the basic look of your forum. The range of options open to you depends on the configuration of your server and phpBB installation, see the Manual for further details. Please note that when creating new themes the use of an existing theme as a basis is optional.',
+	'SELECT_THEME_BASIS'	=&gt; 'Select optional basis',
+	'THEME_VERSION_DIFF'	=&gt; 'This theme was designed for a version of phpBB 2.2 different from that installed you may encounter some issues in its use.',
+	'CREATE_THEME'			=&gt; 'Create new theme',
+	'INSTALLED_THEME'		=&gt; 'Installed themes',
+	'UNINSTALLED_THEME'		=&gt; 'Uninstalled themes',
+	'NO_UNINSTALLED_THEME'	=&gt; 'No uninstalled themes detected',
+
+	'DELETE_THEME'			=&gt; 'Delete theme',
+	'DELETE_THEME_EXPLAIN'	=&gt; 'Here you can remove the selected theme from the database. Additionally, if you have permission you can elect to remove the theme from the filesystem. Please note that there is no undo capability. When the theme is deleted it is gone for good. It is recommended that you first export your theme for possible future use.',
+	'REPLACE_THEME'			=&gt; 'Replace theme with',
+	'REPLACE_THEME_EXPLAIN'	=&gt; 'This theme will replace the one you are deleting in any styles that use it.',
+	'THEME_DELETED'			=&gt; 'Theme deleted successfully',
+	'THEME_DELETED_FS'		=&gt; 'Theme removed from database but files remain on the filesystem',
+	'ONLY_THEME'			=&gt; 'This is the only remaining theme, you cannot delete it',
+
+	'EDIT_DETAILS_THEME'		=&gt; 'Edit theme details',
+	'EDIT_DETAILS_THEME_EXPLAIN'=&gt; 'Here you can edit certain theme details such as its name. You may also have the option to switch storage of the stylesheet from the filesystem to the database and vice versa. This option depends on your PHP configuration and whether your stylesheet can be written to by the webserver.',
+	'ADD_THEME'			=&gt; 'Create Theme',
+	'ADD_THEME_EXPLAIN'	=&gt; 'Here you can add a new theme. Depending on your server configuration and file permissions you may have additional options here. For example you may be able to base this theme on an existing one. You may also be able to upload or import (from the store directory) a theme archive. If you upload or import an archive the theme name can be optionally taken from the archive name (to do this leave the theme name blank).',
+	'INSTALL_THEME'			=&gt; 'Install Theme',
+	'INSTALL_THEME_EXPLAIN'	=&gt; 'Here you can install your selected theme. You can edit certain details if you wish or use the installation defaults.',
+	'THEME_NAME'			=&gt; 'Theme Name',
+	'THEME_BASIS'			=&gt; 'Theme Basis',
+	'THEME_BASIS'			=&gt; 'Theme based on',
+	'THEME_UPLOAD_BASIS'	=&gt; 'Upload a theme',
+	'THEME_IMPORT_BASIS'	=&gt; 'Import theme from store',
+	'THEME_LOCATION'		=&gt; 'Store stylesheet in',
+	'THEME_LOCATION_EXPLAIN'=&gt; 'Images are always stored on the filesystem.',
+
+	'EDIT_THEME'			=&gt; 'Edit theme',
+	'EDIT_THEME_EXPLAIN'	=&gt; 'Here you can edit the selected theme, changing colours, images, etc. You can switch between a simplified interface where you can set basic colours, etc. and a more advanced &quot;raw CSS&quot; mode. The raw mode allows you add additional parameters such as borders, etc. Only set parameters you need else leave them blank or unset. Default classes used by this theme are coloured red in the select box. You may also add additional &quot;custom&quot; classes should your template or style make use of them.',
+	'SELECTED_THEME'		=&gt; 'Selected theme',
+	'SELECT_CLASS'			=&gt; 'Select class',
+	'SHOW_RAW_CSS'			=&gt; 'Show CSS',
+	'HIDE_RAW_CSS'			=&gt; 'Hide CSS',
+	'SHOW_RAW_CSS_NOTE'		=&gt; 'Note',
+	'SHOW_RAW_CSS_EXPLAIN'	=&gt; 'Enter each element on a new line, ending with a ; Expand the data for each element, e.g. do not use font: use font-family:, font-weight:, etc.',
+	'CSS_CAT_LAYOUT'	=&gt; 'Layout',
+	'CSS_#HEADER'		=&gt; 'Header',
+	'CSS_#LOGO'			=&gt; 'Header logo',
+	'CSS_#MENU'			=&gt; 'Menu container',
+	'CSS_#INFO'			=&gt; 'Info container',
+	'CSS_#FOOTER'		=&gt; 'Footer',
+	'CSS_CAT_TEXT'		=&gt; 'Text Classes',
+	'CSS_BODY'			=&gt; 'Body',
+	'CSS_P'				=&gt; 'Paragraph',
+	'CSS_H1'			=&gt; 'Header 1',
+	'CSS_H2'			=&gt; 'Header 2',
+	'CSS_H3'			=&gt; 'Header 3',
+	'CSS_TABLETITLE'	=&gt; 'Table Title',
+	'CSS_CATTITLE'		=&gt; 'Category Title',
+	'CSS_TOPICTITLE'	=&gt; 'Topic Titles',
+	'CSS_TOPICAUTHOR'	=&gt; 'Topic Author',
+	'CSS_TOPICDETAILS'	=&gt; 'Topic Details',
+	'CSS_POSTBODY'		=&gt; 'Post Text',
+	'CSS_POSTHILIT'		=&gt; 'Post Highlight',
+	'CSS_POSTAUTHOR'	=&gt; 'Post Author',
+	'CSS_POSTDETAILS'	=&gt; 'Post Details',
+	'CSS_MAINMENU'		=&gt; 'Main Menu',
+	'CSS_NAV'			=&gt; 'Navigation',
+	'CSS_GENMED'		=&gt; 'General Medium',
+	'CSS_GENSMALL'		=&gt; 'General Small',
+	'CSS_COPYRIGHT'		=&gt; 'Copyright',
+	'CSS_CAT_TABLES'	=&gt; 'Tabular Classes',
+	'CSS_TABLE'			=&gt; 'Table',
+	'CSS_TH'			=&gt; 'Table Header',
+	'CSS_TD'			=&gt; 'Table Data',
+	'CSS_CAT'			=&gt; 'Category Header',
+	'CSS_CATDIV'		=&gt; 'Category Fade',
+	'CSS_ROW1'			=&gt; 'Alternate Row 1',
+	'CSS_ROW2'			=&gt; 'Alternate Row 2',
+	'CSS_ROW3'			=&gt; 'Alternate Row 3',
+	'CSS_SPACER'		=&gt; 'Spacer Row',
+	'CSS_HR'			=&gt; 'Horizontal Rule',
+	'CSS_CAT_FORMS'		=&gt; 'Form Classes',
+	'CSS_FORM'			=&gt; 'Form',
+	'CSS_INPUT'			=&gt; 'Input',
+	'CSS_SELECT'		=&gt; 'Select',
+	'CSS_TEXTAREA'		=&gt; 'Textarea',
+	'CSS_POST'			=&gt; 'Text Input',
+	'CSS_BTNMAIN'		=&gt; 'Primary Buttons',
+	'CSS_BTNLITE'		=&gt; 'Secondary Buttons',
+	'CSS_BTNBBCODE'		=&gt; 'BBCode Buttons',
+	'CSS_CAT_BBCODE'	=&gt; 'BBCode Classes',
+	'CSS_B'				=&gt; 'Bold',
+	'CSS_U'				=&gt; 'Underline',
+	'CSS_I'				=&gt; 'Italics',
+	'CSS_COLOR'			=&gt; 'Colour',
+	'CSS_SIZE'			=&gt; 'Size',
+	'CSS_CODE'			=&gt; 'Code',
+	'CSS_QUOTE'			=&gt; 'Quote',
+	'CSS_FLASH'			=&gt; 'Flash',
+	'CSS_SYNTAXBG'		=&gt; 'Syntax Background',
+	'CSS_SYNTAXCOMMENT'	=&gt; 'Syntax Comments',
+	'CSS_SYNTAXDEFAULT'	=&gt; 'Syntax Default',
+	'CSS_SYNTAXHTML'	=&gt; 'Syntax HTML',
+	'CSS_SYNTAXKEYWORD'	=&gt; 'Syntax Keyword',
+	'CSS_SYNTAXSTRING'	=&gt; 'Syntax String',
+	'CSS_CAT_CUSTOM'	=&gt; 'Custom Classes',
+	'CSS_ANCHOR_LINK'	=&gt; 'Link',
+	'CSS_ANCHOR_ACTIVE'	=&gt; 'Active',
+	'CSS_ANCHOR_VISITED'=&gt; 'Visited',
+	'CSS_ANCHOR_HOVER'	=&gt; 'Hover',
+
+	'CSS_PARAMETER'		=&gt; 'Parameter',
+	'CSS_VALUE'			=&gt; 'Value',
+	'RAW_CSS'			=&gt; 'Raw CSS',
+	'BACKGROUND'		=&gt; 'Background',
+	'BACKGROUND_COLOUR' =&gt; 'Background colour',
+	'BACKGROUND_IMAGE'	=&gt; 'Background image',
+	'BACKGROUND_REPEAT' =&gt; 'Repeat background',
+	'REPEAT_NO'			=&gt; 'None',
+	'REPEAT_X'			=&gt; 'Only horizontally',
+	'REPEAT_Y'			=&gt; 'Only vertically',
+	'REPEAT_ALL'		=&gt; 'Both directions',
+	'FOREGROUND'		=&gt; 'Foreground',
+	'COLOUR_EXPLAIN'	=&gt; 'This is a hex-triplet of the form #RRGGBB or colour name',
+	'FONT_COLOUR'		=&gt; 'Font colour',
+	'FONT_FACE'			=&gt; 'Font face',
+	'FONT_FACE_EXPLAIN' =&gt; 'You can specify multiple fonts seperated by commas.',
+	'FONT_SIZE'			=&gt; 'Font size',
+	'UNDERLINE'			=&gt; 'Underline',
+	'ITALIC'			=&gt; 'Italic',
+	'BOLD'				=&gt; 'Bold',
+	'LINE_SPACING'		=&gt; 'Line spacing',
+	'CUSTOM_CLASS'			=&gt; 'Custom Class',
+	'CUSTOM_CLASS_EXPLAIN'	=&gt; 'You can add additional classes to this theme if you wish. You must provide the actual CSS class name below, it must be the same as that you have or will use in your template. Please remember that class names may contain only alphanumeric characters, periods (.), colons (:) and number/hash/pound (#). The new class will be added to the Custom Class category in the select box above.',
+	'CSS_CLASS_NAME'		=&gt; 'CSS class name',
+	'CUSTOM_CLASS'			=&gt; 'Custom Class',
+
+	'THEME_CLASS_ADDED'		=&gt; 'Custom class added successfully',
+	'THEME_UPDATED'			=&gt; 'Class updated successfully',
+	'THEME_ADDED_DB'		=&gt; 'New theme added to database',
+	'THEME_ADDED'			=&gt; 'New theme added on filesystem',
+	'THEME_DETAILS_UPDATE'	=&gt; 'Theme details updated',
+
+	'THEME_EXPORT'			=&gt; 'Export Theme',
+	'THEME_EXPORT_EXPLAIN'	=&gt; 'Here you can export a theme in the form of an archive. This archive will contain all the data necessary to install the theme on another board. You may select whether to download the file directly or to place it in your store folder for download later or via FTP.',
+	'THEME_EXPORTED'		=&gt; 'Theme exported succesfully and stored in %s',
+
+	'IMAGESETS'					=&gt; 'Imagesets',
+	'IMAGESETS_EXPLAIN'			=&gt; 'Imagesets comprise all the button, forum, folder, etc. and other non-style specific images used by the board. Here you can edit, export or delete existing imagesets and import or activate new sets.',
+	'CREATE_IMAGESET'			=&gt; 'Create new imageset',
+	'INSTALLED_IMAGESET'		=&gt; 'Installed imagesets',
+	'UNINSTALLED_IMAGESET'		=&gt; 'Uninstalled imagesets',
+	'NO_UNINSTALLED_IMAGESET'	=&gt; 'No uninstalled imagesets detected',
+
+	'EDIT_IMAGESET'			=&gt; 'Edit Imageset',
+	'EDIT_IMAGESET_EXPLAIN'	=&gt; 'Here you can edit the individual images which define the imageset. You can also specify  dimensions for the image. Dimensions are optional, specifying them can overcome certain rendering issues with some browsers. By not specifying them you reduce the size of the database record a little.',
+	'SELECTED_IMAGESET'		=&gt; 'Selected imageset',
+	'SELECT_IMAGE'			=&gt; 'Select image',
+	'IMAGE'					=&gt; 'Image',
+	'CURRENT_IMAGE'			=&gt; 'Current Image',
+	'SELECTED_IMAGE'		=&gt; 'Selected Image',
+	'DIMENSIONS'			=&gt; 'Include dimensions',
+	'DIMENSIONS_EXPLAIN'	=&gt; 'Selecting yes here will include width/height parameters.',
+	'IMAGE_PARAMETER'		=&gt; 'Parameter',
+	'IMAGE_VALUE'			=&gt; 'Value',
+	'LOCALISED_IMAGES'		=&gt; 'Localised',
+	'GLOBAL_IMAGES'			=&gt; 'Global',
+	'IMG_CAT_BUTTONS'		=&gt; 'Localised buttons',
+	'IMG_BTN_POST'			=&gt; 'New topic',
+	'IMG_BTN_REPLY'			=&gt; 'Reply topic',
+	'IMG_BTN_LOCKED'		=&gt; 'Topic locked',
+	'IMG_BTN_POST_PM'		=&gt; 'New message',
+	'IMG_BTN_REPLY_PM'		=&gt; 'Reply message',
+	'IMG_BTN_DELETE'		=&gt; 'Delete post',
+	'IMG_BTN_QUOTE'			=&gt; 'Quote post',
+	'IMG_BTN_PROFILE'		=&gt; 'Show profile',
+	'IMG_BTN_EMAIL'			=&gt; 'Send email',
+	'IMG_BTN_SEARCH'		=&gt; 'Search posts',
+	'IMG_BTN_WWW'			=&gt; 'Website',
+	'IMG_BTN_IP'			=&gt; 'Show IP',
+	'IMG_BTN_EDIT'			=&gt; 'Edit post',
+	'IMG_BTN_AIM'			=&gt; 'AIM',
+	'IMG_BTN_ICQ'			=&gt; 'ICQ',
+	'IMG_BTN_JABBER'		=&gt; 'Jabber',
+	'IMG_BTN_YIM'			=&gt; 'YIM',
+	'IMG_BTN_MSNM'			=&gt; 'MSNM',
+	'IMG_BTN_ONLINE'		=&gt; 'User online',
+	'IMG_BTN_OFFLINE'		=&gt; 'User offline',
+	'IMG_BTN_REPORT'		=&gt; 'Report post',
+	'IMG_BTN_PM'			=&gt; 'Send message',
+	'IMG_BTN_FRIEND'		=&gt; 'Add as friend',
+	'IMG_BTN_FOE'			=&gt; 'Add as foe',
+	'IMG_CAT_ICONS'			=&gt; 'General icons',
+	'IMG_ICON_UNAPPROVED'	=&gt; 'Post unapproved',
+	'IMG_ICON_REPORTED'		=&gt; 'Post reported',
+	'IMG_ICON_ATTACH'		=&gt; 'Attachment',
+	'IMG_ICON_POST'			=&gt; 'Minipost',
+	'IMG_ICON_POST_NEW'		=&gt; 'New minipost',
+	'IMG_ICON_POST_LATEST'	=&gt; 'Last post',
+	'IMG_ICON_POST_NEWEST'	=&gt; 'Newest post',
+	'IMG_CAT_FORUMS'		=&gt; 'Forum icons',
+	'IMG_FORUM'				=&gt; 'Forum',
+	'IMG_FORUM_NEW'			=&gt; 'Forum new posts',
+	'IMG_FORUM_LOCKED'		=&gt; 'Forum locked',
+	'IMG_FORUM_LINK'		=&gt; 'Forum link',
+	'IMG_SUB_FORUM'			=&gt; 'Subforum',
+	'IMG_SUB_FORUM_NEW'		=&gt; 'Subforum new posts',
+	'IMG_CAT_FOLDERS'				=&gt; 'Topic icons',
+	'IMG_FOLDER'					=&gt; 'Topic',
+	'IMG_FOLDER_NEW'				=&gt; 'Topic new posts',
+	'IMG_FOLDER_LOCKED'				=&gt; 'Topic locked',
+	'IMG_FOLDER_POSTED'				=&gt; 'Topic posted to',
+	'IMG_FOLDER_NEW_POSTED'			=&gt; 'Topic posted to new',
+	'IMG_FOLDER_LOCKED_NEW'			=&gt; 'Topic locked new',
+	'IMG_FOLDER_LOCKED_POSTED'		=&gt; 'Topic locked posted to',
+	'IMG_FOLDER_LOCKED_NEW_POSTED'	=&gt; 'Topic locked posted to new',
+	'IMG_FOLDER_HOT'				=&gt; 'Topic hot',
+	'IMG_FOLDER_HOT_NEW'			=&gt; 'Topic hot new posts',
+	'IMG_FOLDER_HOT_POSTED'			=&gt; 'Topic hot posted to',
+	'IMG_FOLDER_HOT_NEW_POSTED'		=&gt; 'Topic hot posted to new',
+	'IMG_FOLDER_STICKY'				=&gt; 'Sticky topic',
+	'IMG_FOLDER_STICKY_POSTED'		=&gt; 'Sticky topic posted to',
+	'IMG_FOLDER_STICKY_NEW'			=&gt; 'Sticky topic new posts',
+	'IMG_FOLDER_STICKY_NEW_POSTED'	=&gt; 'Sticky topic posted to new',
+	'IMG_FOLDER_ANNOUNCE'				=&gt; 'Announcement',
+	'IMG_FOLDER_ANNOUNCE_NEW'			=&gt; 'Announcement new posts',
+	'IMG_FOLDER_ANNOUNCE_POSTED'		=&gt; 'Announcement posted to',
+	'IMG_FOLDER_ANNOUNCE_NEW_POSTED'	=&gt; 'Announcement posted to new',
+	'IMG_FOLDER_GLOBAL'				=&gt; 'Global',
+	'IMG_FOLDER_GLOBAL_NEW'			=&gt; 'Global new posts',
+	'IMG_FOLDER_GLOBAL_POSTED'		=&gt; 'Global posted to',
+	'IMG_FOLDER_GLOBAL_NEW_POSTED'	=&gt; 'Global posted to new',
+	'IMG_CAT_POLLS'		=&gt; 'Polling images',
+	'IMG_POLL_LEFT'		=&gt; 'Poll left end',
+	'IMG_POLL_RIGHT'	=&gt; 'Poll right end',
+	'IMG_POLL_CENTER'	=&gt; 'Poll centre',
+	'IMG_CAT_KARMA'		=&gt; 'Karma images',
+	'IMG_KARMA_LEFT'	=&gt; 'Karma left end',
+	'IMG_KARMA_CENTER'	=&gt; 'Karma centre',
+	'IMG_KARMA_RIGHT'	=&gt; 'Karma right end',
+	'IMG_CAT_CUSTOM'	=&gt; 'Custom images',
+	'IMAGESET_UPDATED'	=&gt; 'Imageset updated successfully',
+
+	'EDIT_DETAILS_IMAGESET'	=&gt; 'Edit imageset details',
+	'EDIT_DETAILS_IMAGESET_EXPLAIN'=&gt; 'Here you can edit certain imageset details such as its name.',
+	'ADD_IMAGESET'			=&gt; 'Create Imageset',
+	'ADD_IMAGESET_EXPLAIN'	=&gt; 'Here you can create a new imageset. Depending on your server configuration and file permissions you may have additional options here. For example you may be able to base this imageset on an existing one. You may also be able to upload or import (from the store directory) a imageset archive. If you upload or import an archive the imageset name can be optionally taken from the archive name (to do this leave the imageset name blank).',
+	'INSTALL_IMAGESET'			=&gt; 'Install Imageset',
+	'INSTALL_IMAGESET_EXPLAIN'	=&gt; 'Here you can install your selected imageset. You can edit certain details if you wish or use the installation defaults.',
+	'IMAGESET_NAME'				=&gt; 'Imageset Name',
+	'IMAGESET_BASIS'			=&gt; 'Imageset Basis',
+	'IMAGESET_BASIS'			=&gt; 'Imageset based on',
+	'IMAGESET_UPLOAD_BASIS'		=&gt; 'Upload a imageset',
+	'IMAGESET_IMPORT_BASIS'		=&gt; 'Import imageset from store',
+
+	'IMAGESET_EXPORT'			=&gt; 'Export Imageset',
+	'IMAGESET_EXPORT_EXPLAIN'	=&gt; 'Here you can export an imageset in the form of an archive. This archive will contain all the data necessary to install the set of images on another board. You may select whether to download the file directly or to place it in your store folder for download later or via FTP.',
+	'IMAGESET_EXPORTED'		=&gt; 'Imageset exported succesfully and stored in %s',
+	'DELETE_IMAGESET'			=&gt; 'Delete Imageset',
+	'DELETE_IMAGESET_EXPLAIN'	=&gt; 'Here you can remove the selected imageset from the database. Additionally, if you have permission you can elect to remove the set from the filesystem. Please note that there is no undo capability. When the imageset is deleted it is gone for good. It is recommended that you first export your set for possible future use.',
+	'REPLACE_IMAGESET'			=&gt; 'Replace imageset with',
+	'REPLACE_IMAGESET_EXPLAIN'	=&gt; 'This imageset will replace the one you are deleting in any styles that use it.',
+	'IMAGESET_DELETED'			=&gt; 'Imageset set deleted successfully',
+	'IMAGESET_DELETED_FS'		=&gt; 'Imageset set removed from database but some files may remain on the filesystem',
+	'ONLY_IMAGESET'				=&gt; 'This is the only remaining imageset, you cannot delete it',
+
+	'STYLE_ERR_NOT_STYLE'		=&gt; 'The imported or uploaded file did not contain a valid style archive.',
+	'STYLE_ERR_MORE_ELEMENTS'	=&gt; 'You must select at least two style elements.',
+	'STYLE_ERR_STYLE_NAME'		=&gt; 'You must supply a name for this style',
+	'STYLE_ERR_NAME_LONG'		=&gt; 'The style name can be no longer than 30 characters',
+	'STYLE_ERR_NAME_EXIST'		=&gt; 'A style with that name already exists',
+	'STYLE_ERR_COPY_LONG'		=&gt; 'The copyright can be no longer than 60 characters',
+	'STYLE_ERR_NO_IDS'			=&gt; 'You must select a template, theme and imageset for this style',
+	'STYLE_ERR_NAME_CHARS'		=&gt; 'The style name can only contain alphanumeric characters, -, +, _ and space',
+	'REQUIRES_TEMPLATE'			=&gt; 'This style requires the %s template set to be installed.',
+	'REQUIRES_THEME'			=&gt; 'This style requires the %s theme to be installed.',
+	'REQUIRES_IMAGESET'			=&gt; 'This style requires the %s imageset to be installed.',
+	'TEMPLATE_ERR_STYLE_NAME'	=&gt; 'You must supply a name for this templates',
+	'TEMPLATE_ERR_NAME_CHARS'	=&gt; 'The template name can only contain alphanumeric characters, -, +, _ and space',
+	'TEMPLATE_ERR_NAME_LONG'	=&gt; 'The template name can be no longer than 30 characters',
+	'TEMPLATE_ERR_NAME_EXIST'	=&gt; 'A template set with that name already exists',
+	'TEMPLATE_ERR_COPY_LONG'	=&gt; 'The copyright can be no longer than 60 characters',
+	'TEMPLATE_ERR_ARCHIVE'		=&gt; 'Please select an archive method',
+	'TEMPLATE_ERR_NOT_TEMPLATE'	=&gt; 'The archive you specified does not contain a valid template set.',
+	'ERR_TPLCACHE_READ'			=&gt; 'Cannot read the cache directory',
+	'THEME_ERR_STYLE_NAME'		=&gt; 'You must supply a name for this theme',
+	'THEME_ERR_NAME_CHARS'		=&gt; 'The theme name can only contain alphanumeric characters, -, +, _ and space',
+	'THEME_ERR_NAME_LONG'		=&gt; 'The theme name can be no longer than 30 characters',
+	'THEME_ERR_NAME_EXIST'		=&gt; 'A theme with that name already exists',
+	'THEME_ERR_COPY_LONG'		=&gt; 'The copyright can be no longer than 60 characters',
+	'THEME_ERR_ARCHIVE'			=&gt; 'Please select an archive method',
+	'THEME_ERR_NOT_THEME'		=&gt; 'The archive you specified does not contain a valid theme.',
+	'THEME_ERR_CLASS_CHARS'		=&gt; 'Only alphanumeric characters plus ., : and # are valid in class names.',
+	'IMAGESET_ERR_STYLE_NAME'	=&gt; 'You must supply a name for this imageset',
+	'IMAGESET_ERR_NAME_CHARS'	=&gt; 'The imageset name can only contain alphanumeric characters, -, +, _ and space',
+	'IMAGESET_ERR_NAME_LONG'	=&gt; 'The imageset name can be no longer than 30 characters',
+	'IMAGESET_ERR_NAME_EXIST'	=&gt; 'A imageset with that name already exists',
+	'IMAGESET_ERR_COPY_LONG'	=&gt; 'The copyright can be no longer than 60 characters',
+	'IMAGESET_ERR_ARCHIVE'		=&gt; 'Please select an archive method',
+	'IMAGESET_ERR_NOT_IMAGESET'	=&gt; 'The archive you specified does not contain a valid imageset.',
+
+	'ARCHIVE_FORMAT'		=&gt; 'Archive file type',
+	'ALLOWED_FILETYPES'		=&gt; 'Allowed filetypes',
+	'SELECT_BASIS'			=&gt; 'Select optional basis',
+	'TEXT_COLUMNS'			=&gt; 'Columns',
+	'TEXT_ROWS'				=&gt; 'Rows',
+	'COPYRIGHT'				=&gt; 'Copyright',
+	'CACHE'					=&gt; 'Cache',
+	'EXPORT'				=&gt; 'Export',
+	'DETAILS'				=&gt; 'Details',
+	'REFRESH'				=&gt; 'Refresh',
+	'STORE_DATABASE'		=&gt; 'Database',
+	'STORE_FILESYSTEM'		=&gt; 'Filesystem',
+	'DELETE_FROM_FS'		=&gt; 'Delete from filesystem',
+	'INSTALL'				=&gt; 'Install',
+	'FROM'					=&gt; 'from', // &quot;Create new style .... from ...&quot;
+	'OPTIONAL_BASIS'		=&gt; 'Optional basis',
+	'NO_IMAGESET'			=&gt; 'Cannot find imageset on filesystem',
+	'NO_THEME'				=&gt; 'Cannot find theme on filesystem',
+	'NO_TEMPLATE'			=&gt; 'Cannot find template on filesystem',
+	'NO_STYLE'				=&gt; 'Cannot find style on filesystem',
+	'NO_BASIS'				=&gt; 'Do not use basis',
+	'NO_IMPORT'				=&gt; 'Do not import',
+	'UPLOAD_WRONG_TYPE'		=&gt; 'Only the following filetypes are accepted: %s',
+);
+
+// Search indexing
+$this-&gt;lang += array(
+	'SEARCH_INDEX_EXPLAIN' =&gt; 'phpBB2 uses a fulltext search system. This breaks down each post into seperate words and then, if the word does not already exist it stores those words in a table. In turn the post is linked to each word it contains in this table. This allows quick searching of large databases and helps reduce load on the server compared to most other methods.&lt;/p&gt;&lt;p&gt;However, if the tables get out of sync for some reason or you change the minimum, maximum or disallowed list of words the tables need updating. This facility allows you to do just that.&lt;/p&gt;&lt;p&gt;Please be aware this procedure can take a long time, particularly on large databases. During this period your forum will be automatically shut down to prevent people posting. You can cancel the procedure at any time. Please remember this is an intensive operation and should only be carried out when absolutely necessarily. Do not run this script too often!&lt;/p&gt;',
+	'SEARCH_INDEX_CANCEL'		=&gt; 'Re-indexing of search system has been cancelled. Please note this will result in searches returning incomplete results. You can re-index the posts again at any stage.',
+	'SEARCH_INDEXING_COMPLETE'	=&gt; 'Re-indexing of search system has been completed. You can re-index the posts again at any stage.',
+	'START' =&gt; 'Start',
+	'STOP'	=&gt; 'Stop',
+);
+
+// Admin logs
+$this-&gt;lang += array(
+	'ADMIN_LOGS_EXPLAIN'	=&gt; 'This lists all the actions carried out by board administrators. You can sort by username, date, IP or action. If you have appropriate permissions you can also clear individual operations or the log as a whole.',
+	'MOD_LOGS_EXPLAIN'		=&gt; 'This lists the actions carried out by board moderators, select a forum from the drop down list. You can sort by username, date, IP or action. If you have appropriate permissions you can also clear individual operations or the log as a whole.',
+	'CRITICAL_LOGS_EXPLAIN'	=&gt; 'This lists the actions carried out by the board itself. These log provides you with information you are able to use for solving specific problems, for example non-delivery of emails. You can sort by username, date, IP or action. If you have appropriate permissions you can also clear individual operations or the log as a whole.',
+	'DISPLAY_LOG'			=&gt; 'Display entries from previous',
+
+	'ALL_ENTRIES'	=&gt; 'All entries',
+	'SORT_IP'		=&gt; 'IP address',
+	'SORT_DATE'		=&gt; 'Date',
+	'SORT_ACTION'	=&gt; 'Log action',
+	'NO_ENTRIES'	=&gt; 'No log entries for this period',
+);
+
+// Attachments
+$this-&gt;lang += array(
+	'ATTACHMENT_SETTINGS'			=&gt; 'Attachment Settings',
+	'ATTACHMENT_SETTINGS_EXPLAIN'	=&gt; 'Here you can configure the Main Settings for Attachments and the associated Special Categories.',
+
+	'UPLOAD_DIR'					=&gt; 'Upload Directory',
+	'UPLOAD_DIR_EXPLAIN'			=&gt; 'Storage Path for Attachments.',
+	'DISPLAY_ORDER'					=&gt; 'Attachment Display Order',
+	'DISPLAY_ORDER_EXPLAIN'			=&gt; 'Display attachments ordered by time.',
+	'ATTACH_MAX_FILESIZE'			=&gt; 'Maximum filesize',
+	'ATTACH_MAX_FILESIZE_EXPLAIN'	=&gt; 'Maximum size of each file, 0 is unlimited.',
+	'ATTACH_QUOTA'					=&gt; 'Total attachment quota',
+	'ATTACH_QUOTA_EXPLAIN'			=&gt; 'Maximum drive space available for attachments in total, 0 is unlimited.',
+	'ATTACH_MAX_PM_FILESIZE'		=&gt; 'Maximum filesize messaging',
+	'ATTACH_MAX_PM_FILESIZE_EXPLAIN' =&gt; 'Maximum drive space available per user for private message attachments, 0 is unlimited.',
+	'MAX_ATTACHMENTS'				=&gt; 'Max attachments per post',
+	'MAX_ATTACHMENTS_PM'			=&gt; 'Max attachments per message',
+
+	'SETTINGS_CAT_IMAGES'		=&gt; 'Image category settings',
+	'ASSIGNED_GROUP'			=&gt; 'Assigned Group',
+	'DISPLAY_INLINED'			=&gt; 'Display images inline',
+	'DISPLAY_INLINED_EXPLAIN'	=&gt; 'If set to No image attachments will show as a link.',
+	'CREATE_THUMBNAIL'			=&gt; 'Create thumbnail',
+	'CREATE_THUMBNAIL_EXPLAIN'	=&gt; 'Create a thumbnail in all possible situations.',
+	'MIN_THUMB_FILESIZE'		=&gt; 'Minimum thumbnail filesize',
+	'MIN_THUMB_FILESIZE_EXPLAIN' =&gt; 'Do not create a thumbnail for images smaller than this.',
+	'IMAGICK_PATH'				=&gt; 'Imagemagick path',
+	'IMAGICK_PATH_EXPLAIN'		=&gt; 'Full path to the imagemagick convert application, e.g. /usr/bin/',
+	'SEARCH_IMAGICK'			=&gt; 'Search for Imagemagick',
+	'MAX_IMAGE_SIZE'			=&gt; 'Maximum Image Dimensions',
+	'MAX_IMAGE_SIZE_EXPLAIN'	=&gt; 'Maximum size of image attachments, 0px by 0px disables image attachments.',
+	'IMAGE_LINK_SIZE'			=&gt; 'Image Link Dimensions',
+	'IMAGE_LINK_SIZE_EXPLAIN'	=&gt; 'Display image attachment as link if image is larger than this, set to 0px by 0px to disable.',
+
+	'NO_UPLOAD_DIR'		=&gt; 'The upload directory you specified does not exist.',
+	'UPLOAD_NOT_DIR'	=&gt; 'The upload location you specified does not appear to be a directory.',
+	'NO_WRITE_UPLOAD'	=&gt; 'The upload directory you specified cannot be written to. Please alter the permissions to allow the webserver to write to it.',
+
+	'ATTACHMENTS'				=&gt; 'Attachments',
+	'ATTACH_EXTENSIONS_URL'		=&gt; 'Extensions',
+	'ATTACH_EXT_GROUPS_URL'		=&gt; 'Extension Groups',
+	'ATTACH_ORPHAN_URL'			=&gt; 'Orphan Attachments',
+
+	'EXTENSION_GROUPS_TITLE'	=&gt; 'Manage Extension Groups',
+	'EXTENSION_GROUPS_TITLE_EXPLAIN'	=&gt; 'Here you can add, delete and modify your Extension Groups, you can disable Extension Groups, assign a special Category to them, change the download mechanism and you can define an Upload Icon which will be displayed in front of an Attachment belonging to the Group.',
+	'EXTENSION_GROUPS'			=&gt; 'Extension Groups',
+	'EXTENSION_GROUP'			=&gt; 'Extension Group',
+	'SPECIAL_CATEGORY'			=&gt; 'Special Category',
+	'SPECIAL_CATEGORY_EXPLAIN'	=&gt; 'Special Categories differ between the way presented within posts.',
+	'DOWNLOAD_MODE'				=&gt; 'Download Mode',
+	'DOWNLOAD_MODE_EXPLAIN'		=&gt; 'If you experience problems downloading files, set this to &quot;physical&quot;, the user will be directed to the file directly. Do not set it to physical if not really needed, it discloses the filename.',
+	'UPLOAD_ICON'				=&gt; 'Upload Icon',
+	'MAX_EXTGROUP_FILESIZE'		=&gt; 'Maximum Filesize',
+	'ASSIGNED_EXTENSIONS'		=&gt; 'Assigned Extensions',
+	'ADD_EXTENSION_GROUP'		=&gt; 'Add Extension Group',
+	'EDIT_EXTENSION_GROUP'		=&gt; 'Edit Extension Group',
+	'NO_EXT_GROUP_SPECIFIED'	=&gt; 'No Extension Group specified',
+	'NO_EXT_GROUP_NAME'			=&gt; 'No Group Name entered',
+	'SUCCESS_EXTENSION_GROUP_ADD'	=&gt; 'Extension Group successfully added',
+	'SUCCESS_EXTENSION_GROUP_EDIT'	=&gt; 'Extension Group successfully updated',
+	'EXTENSION_GROUP_EXIST'		=&gt; 'The Extension Group %s already exist',
+	'EXTENSION_GROUP_DELETED'	=&gt; 'Extension Group successfully deleted',
+	'ALLOWED_FORUMS'			=&gt; 'Allowed Forums',
+	'ALLOWED_FORUMS_EXPLAIN'	=&gt; 'Able to post the assigned extensions at the selected (or all if selected) forums',
+	'ALLOW_IN_PM'				=&gt; 'Allowed in private messaging',
+	'ALLOW_ALL_FORUMS'			=&gt; 'Allow All Forums',
+	'ALLOW_SELECTED_FORUMS'		=&gt; 'Only Forums selected below',
+	'GO_TO_EXTENSIONS'			=&gt; 'Go to Extension Management Screen',
+
+	'CAT_IMAGES'				=&gt; 'Images',
+	'CAT_WM_FILES'				=&gt; 'Win Media Streams',
+	'CAT_RM_FILES'				=&gt; 'Real Media Streams',
+	'MODE_INLINE'				=&gt; 'Inline',
+	'MODE_PHYSICAL'				=&gt; 'Physical',
+	'NO_IMAGE'					=&gt; 'No Image',
+
+	'MANAGE_EXTENSIONS'			=&gt; 'Manage Extensions',
+	'MANAGE_EXTENSIONS_EXPLAIN' =&gt; 'Here you can manage your allowed extensions. To activate your Extensions, please refer to the extension groups management panel. We strongly recommend not to allow scripting extensions (such as php, php3, php4, phtml, pl, cgi, asp, aspx...)',
+	'ADD_EXTENSION'				=&gt; 'Add extension',
+	'EXTENSIONS_UPDATED'		=&gt; 'Extensions successfully updated',
+	'EXTENSION_EXIST'			=&gt; 'The Extension %s already exist',
+	'NOT_ASSIGNED'				=&gt; 'Not assigned',
+
+	'ORPHAN_ATTACHMENTS'		=&gt; 'Orphan Attachments', // Title
+	'ORPHAN_ATTACHMENTS_EXPLAIN' =&gt; 'Here you are able to see files within the Attachments upload directory but not assigned to posts. This happens mostly if users are attaching files but not submitting the post. You are able to delete the files or attach them to existing posts. Attaching to posts requires a valid post id, you have to determine this id by yourself, this feature is mainly for those people wanting to upload files with another program and assigning those (mostly large) files to an existing post.',
+	'UPLOADING_FILES'			=&gt; 'Uploading Files',
+	'UPLOADING_FILE_TO'			=&gt; 'Uploading File &quot;%1$s&quot; to Post Number %2$d...',
+	'UPLOAD_DENIED_FORUM'		=&gt; 'You do not have the permission to upload files to forum &quot;%s&quot;',
+	'ATTACH_POST_ID'			=&gt; 'Post ID',
+	'ATTACH_TO_POST'			=&gt; 'Attach file to post',
+	'SUCCESSFULLY_UPLOADED'		=&gt; 'Succeessfully uploaded',
+	'ADMIN_UPLOAD_ERROR'		=&gt; 'Errors while trying to attach file: %s',
+
+	'SECURE_DOWNLOADS'				=&gt; 'Enable secure downloads',
+	'SECURE_DOWNLOADS_EXPLAIN'		=&gt; 'With this option enabled, downloads are limited to IP\'s/hostnames you defined.',
+	'SECURE_ALLOW_DENY'				=&gt; 'Allow/Deny List',
+	'SECURE_ALLOW_DENY_EXPLAIN'		=&gt; 'Allow or Deny the list of addresses, this setting only applies to downloading files',
+	'ORDER_ALLOW_DENY'				=&gt; 'Allow',
+	'ORDER_DENY_ALLOW'				=&gt; 'Deny',
+	'SECURE_EMPTY_REFERER'			=&gt; 'Allow empty referer',
+	'SECURE_EMPTY_REFERER_EXPLAIN'	=&gt; 'Secure downloads are based on referers. Do you want to allow downloads for those ommitting the referer?',
+
+	'DEFINE_ALLOWED_IPS'			=&gt; 'Define allowed IPs/Hostnames',
+	'DEFINE_DISALLOWED_IPS'			=&gt; 'Define disallowed IPs/Hostnames',
+	'EXCLUDE_FROM_ALLOWED_IP'		=&gt; 'Exclude IP from allowed IPs/Hostnames',
+	'EXCLUDE_FROM_DISALLOWED_IP'	=&gt; 'Exclude IP from disallowed IPs/Hostnames',
+	'REMOVE_ALLOWED_IPS'			=&gt; 'Remove or Un-exclude allowed IPs/Hostnames',
+	'REMOVE_DISALLOWED_IPS'			=&gt; 'Remove or Un-exclude disallowed IPs/Hostnames',
+	'DOWNLOAD_ADD_IPS_EXPLAIN'		=&gt; 'To specify several different IP\'s or hostnames enter each on a new line. To specify a range of IP addresses separate the start and end with a hyphen (-), to specify a wildcard use *',
+	'DOWNLOAD_REMOVE_IPS_EXPLAIN'	=&gt; 'You can remove (or un-exclude) multiple IP addresses in one go using the appropriate combination of mouse and keyboard for your computer and browser. Excluded IP\'s have a blue background.',
+	'EXCLUDE_ENTERED_IP'			=&gt; 'Enable this to exclude the entered IP/Hostname.',
+	'NO_IPS_DEFINED'				=&gt; 'No IPs or Hostnames defined',
+	'SECURE_DOWNLOAD_UPDATE_SUCCESS'=&gt; 'The IP list has been updated successfully',
+	'SECURE_DOWNLOAD_NOTICE'		=&gt; 'Secure Downloads are not enabled. The settings below will be applied after enabling secure downloads.'
+);
+
+// Installation
+$this-&gt;lang += array(
+	'WELCOME_INSTALL'	=&gt; 'Welcome to phpBB 2 Installation',
+
+	'INSTALL_REQUIRED'		=&gt; 'Required',
+	'INSTALL_OPTIONAL'		=&gt; 'Optional',
+	'UNAVAILABLE'	=&gt; 'Unavailable',
+	'AVAILABLE'		=&gt; 'Available',
+	'TESTS_PASSED'	=&gt; 'Tests passed',
+	'TESTS_FAILED'	=&gt; 'Tests failed',
+
+	'INSTALL_ADVICE'	=&gt; 'Installation Compatibility',
+	'INSTALL_ADVICE_EXPLAIN'=&gt; 'Before proceeding with full installation phpBB will carry out some tests on your server and basic install. Please ensure you read through the results thoroughly and do not proceed until all tests are passed.',
+	'PHP_AND_APPS'			=&gt; 'PHP and Applications',
+	'INSTALL_REQUIRED_PHP'	=&gt; 'You must be running at least PHP 4.1.0 with support for at least one compatible database. If no support modules are shown as available you should contact your hosting provider or review the relevant PHP installation documentation for advice. If &quot;safe mode&quot; is displayed below your PHP installation is running in that mode. This will impose limitations on remote administration and similar features.',
+	'INSTALL_OPTIONAL_PHP'	=&gt; 'These modules or applications are optional, you do not need these to use phpBB 2.2. However if you do have them they will will enable greater functionality.',
+	'PHP_VERSION_REQD'	=&gt; 'PHP version &gt;= 4.1.0',
+	'PHP_SAFE_MODE'		=&gt; 'Safe Mode',
+	'PHP_REQD_DB'		=&gt; 'Supported Databases',
+	'DLL_FIREBIRD'		=&gt; 'Firebird 1.5+',
+	'DLL_MYSQL'			=&gt; 'MySQL 3.23.x/4.x',
+	'DLL_MYSQL4'		=&gt; 'MySQL 4.1+',
+	'DLL_MYSQLI'		=&gt; 'MySQL 4.1+ with MySQLi Extension',
+	'DLL_MSSQL'			=&gt; 'MSSQL Server 2000',
+	'DLL_MSSQL-ODBC'	=&gt; 'MSSQL Server 2000 via ODBC',
+	'DLL_ORACLE'		=&gt; 'Oracle',
+	'DLL_POSTGRES'		=&gt; 'PostgreSQL 7.x',
+	'DLL_SQLITE'		=&gt; 'SQLite',
+	'DLL_MBSTRING'		=&gt; 'Multi-byte character support',
+	'DLL_ZLIB'			=&gt; 'zlib Compression support [ Visual confirmation, gz, .tar.gz, .zip ]',
+	'DLL_FTP'			=&gt; 'Remote FTP support [ Installation ]',
+	'DLL_XML'			=&gt; 'XML support [ Jabber ]',
+	'DLL_MHASH'			=&gt; 'Mhash hashing support [ Jabber ]',
+	'APP_MAGICK'		=&gt; 'Imagemagick support [ Attachments ]',
+	'NO_LOCATION'		=&gt; 'Cannot determine location',
+	'DIRECTORIES_AND_FILES'		=&gt; 'Directory and file setup',
+	'INSTALL_REQUIRED_FILES'	=&gt; 'In order to function correctly phpBB needs to be able to access or write to certain files or directories. If you see &quot;Not Found&quot; you need to create the relevant file or directory. If you see &quot;Unwriteable&quot; you need to change the permissions on the file or directory to allow phpBB to write to it.',
+	'INSTALL_OPTIONAL_FILES'	=&gt; 'These files, directories or permissions are optional. The installation routines will attempt to use various techniques to complete if they do not exist or cannot be written to. However, the presence of these files, directories or permissions will speed installation.',
+	'FILE_FOUND'		=&gt; 'Found',
+	'FILE_NOT_FOUND'	=&gt; 'Cannot find',
+	'FILE_WRITEABLE'	=&gt; 'Writeable',
+	'FILE_UNWRITEABLE'	=&gt; 'Unwriteable',
+	'INSTALL_NEXT'		=&gt; 'Next stage',
+	'INSTALL_NEXT_PASS'	=&gt; 'All the basic tests have been passed and you may proceed to the next stage of installation. If you have changed any permissions, modules, etc. and wish to re-test you can do so if you wish.',
+	'INSTALL_NEXT_FAIL'	=&gt; 'Some tests failed and you should correct these problems before proceeding to the next stage. Failure to do so may result in an incomplete installation.',
+
+	'INITIAL_CONFIG'		=&gt; 'Basic Configuration',
+	'INITIAL_CONFIG_EXPLAIN'=&gt; 'Now that install has determined your server can run phpBB you need to supply some specific information. If you do not know how to connect to your database please contact your hosting provider (in the first instance) or  use the phpBB support forums. When entering data please ensure you check it thoroughly before continuing.',
+	'ADMIN_CONFIG'			=&gt; 'Admin Configuration',
+	'DEFAULT_LANG'			=&gt; 'Default board language',
+	'ADMIN_USERNAME'		=&gt; 'Administrator username',
+	'CONTACT_EMAIL'			=&gt; 'Contact email address',
+	'CONTACT_EMAIL_CONFIRM'	=&gt; 'Confirm contact email',
+	'ADMIN_PASSWORD'		=&gt; 'Administrator password',
+	'ADMIN_PASSWORD_CONFIRM'=&gt; 'Confirm administrator password',
+	'DB_CONFIG'			=&gt; 'Database Configuration',
+	'DBMS'				=&gt; 'Database type',
+	'DB_HOST'			=&gt; 'Database server hostname or DSN',
+	'DB_HOST_EXPLAIN'	=&gt; 'DSN stands for Data Source Name and is relevant only for ODBC installs.',
+	'DB_PORT'			=&gt; 'Database server port',
+	'DB_PORT_EXPLAIN'	=&gt; 'Leave this blank unless you know the server operates on a non-standard port.',
+	'DB_NAME'			=&gt; 'Database name',
+	'DB_USERNAME'		=&gt; 'Database username',
+	'DB_PASSWORD'		=&gt; 'Database password',
+	'TABLE_PREFIX'		=&gt; 'Prefix for tables in database',
+	'DB_TEST'			=&gt; 'Test Connection',
+	'INSTALL_DB_CONNECT'=&gt; 'Successfull Connection',
+	'SERVER_CONFIG'			=&gt; 'Server Configuration',
+	'SERVER_NAME'			=&gt; 'Domain name',
+	'SERVER_NAME_EXPLAIN'	=&gt; 'The domain name this board runs from',
+	'SCRIPT_PATH'			=&gt; 'Script path',
+	'SCRIPT_PATH_EXPLAIN'	=&gt; 'The path where phpBB2 is located relative to the domain name',
+	'SERVER_PORT'			=&gt; 'Server port',
+	'SERVER_PORT_EXPLAIN'	=&gt; 'The port your server is running on, usually 80, only change if different',
+	'CACHE_STORE'			=&gt; 'Cache type',
+	'CACHE_STORE_EXPLAIN'	=&gt; 'The physical location where data is cached, filesystem is prefered.',
+	'INSTALL_TEST'	=&gt; 'Test Again',
+	'INSTALL_NEXT'	=&gt; 'Next Stage',
+	'INSTALL_START'	=&gt; 'Start Install',
+
+	'INSTALL_SEND_CONFIG'	=&gt; 'Unfortunately phpBB could not write the configuration information directly to your config.php. This may be because the file does not exist or is not writeable. A number of options will be listed below enabling you to complete installation of config.php.',
+	'FTP_CONFIG'		=&gt; 'Transfer config by FTP',
+	'FTP_CONFIG_EXPLAIN'=&gt; 'phpBB has detected the presence of the ftp module on this server. You may attempt to install your config.php via this if you wish. You will need to supply the information listed below. Remember your username and password are those to your server! (ask your hosting provider for details if you are unsure what these are)',
+	'FTP_PATH'			=&gt; 'FTP Path',
+	'FTP_PATH_EXPLAIN'	=&gt; 'This is the path from your root directory to that of phpBB2, e.g. htdocs/phpBB2/',
+	'FTP_USERNAME'		=&gt; 'FTP Username',
+	'FTP_PASSWORD'		=&gt; 'FTP Password',
+	'FTP_UPLOAD'		=&gt; 'Upload',
+	'DL_CONFIG'			=&gt; 'Download config',
+	'DL_CONFIG_EXPLAIN'	=&gt; 'You may download the complete config.php to your own PC. You will then need to upload the file manually, replacing any existing config.php in your phpBB 2.2 root directory. Please remember to upload the file in ASCII format (see your FTP application documentation if you are unsure how to achieve this). When you have uploaded the config.php please click &quot;Done&quot; to move to the next stage.',
+	'DL_DOWNLOAD'		=&gt; 'Download',
+	'DL_DONE'			=&gt; 'Done',
+	'RETRY_WRITE'			=&gt; 'Retry writing config',
+	'RETRY_WRITE_EXPLAIN'	=&gt; 'If you wish you can change the permissions on config.php to allow phpBB to write to it. Should you wish to do that you can click Retry below to try again. Remember to return the permissions on config.php after phpBB2 has finished installation.',
+	'CONFIG_RETRY'			=&gt; 'Retry',
+
+	'INSTALL_CONGRATS'			=&gt; 'Congratulations',
+	'INSTALL_CONGRATS_EXPLAIN'	=&gt; 'You have now successfully installed phpBB 2.2. Clicking the button below will take you to your Administration Control Panel (ACP). Take some time to examine the options available to you. Remember that help is available online via the Userguide and the phpBB support forums, see the %sREADME%s for further information.',
+	'INSTALL_LOGIN'				=&gt; 'Login',
+
+	'INST_ERR_FATAL'			=&gt; 'Fatal installation error',
+	'INST_ERR_MISSING_DATA'		=&gt; 'You must fill out all fields in this block',
+	'INST_ERR_NO_DB'			=&gt; 'Cannot load the PHP module for the selected database type',
+	'INST_ERR_EMAIL_MISMATCH'	=&gt; 'The emails you entered did not match.',
+	'INST_ERR_PASSWORD_MISMATCH'=&gt; 'The passwords you entered did not match.',
+	'INST_ERR_DB_CONNECT'		=&gt; 'Could not connect to the database, see error message below',
+	'INST_ERR_DB_NO_ERROR'		=&gt; 'No error message given',
+	'INST_ERR_PREFIX'			=&gt; 'Tables with the specified prefix already exist, please choose an alternative.',
+	'INST_ERR_FATAL_DB'			=&gt; 'A fatal and unrecoverable database error has occured. This may be because the specified user does not have appropriate rights to CREATE TABLES or INSERT data, etc. Further information may be given below. Please contact your hosting provider in the first instance or the support forums of phpBB for further assistance.',
+	'INST_ERR_FTP_PATH'			=&gt; 'Could not change to the given directory, please check the path.',
+	'INST_ERR_FTP_LOGIN'		=&gt; 'Could not login to ftp server, check your username and password',
+);
+
+// Bots
+$this-&gt;lang += array(
+	'BOTS_EXPLAIN'	=&gt; 'Bots or crawlers are automated agents most commonly used by search engines to update their databases. Since they rarely make proper use of sessions they can distort visitor counts, increase load and sometimes fail to index sites correctly. Here you can define a special type of user to overcome these problems.',
+
+	'BOT_NAME'			=&gt; 'Bot name',
+	'BOT_LAST_VISIT'	=&gt; 'Last visit',
+	'BOT_NEVER'			=&gt; 'Never',
+	'BOT_ACTIVATE'		=&gt; 'Activate',
+	'BOT_DEACTIVATE'	=&gt; 'Deactivate',
+	'BOT_ADD'			=&gt; 'Add bot',
+
+	'BOT_EDIT'			=&gt; 'Edit bots',
+	'BOT_EDIT_EXPLAIN'	=&gt; 'Here you can add or edit an existing bot entry. You may define an agent string and/or one or more IP addresses (or range of addresses) to match. Be careful when defining matching agent strings or addresses. You may also specify a style and language that the bot will view the board using. This may allow you to reduce bandwidth use by setting a simple style for bots. Remember to set appropriate permissions for the special Bot usergroup.',
+	'BOT_NAME_EXPLAIN'	=&gt; 'Used only for your own information.',
+	'BOT_LANG'			=&gt; 'Bot language',
+	'BOT_LANG_EXPLAIN'	=&gt; 'The language presented to the bot as it browses.',
+	'BOT_STYLE'			=&gt; 'Bot style',
+	'BOT_STYLE_EXPLAIN'	=&gt; 'The style used for the board by the bot.',
+	'BOT_VIS'			=&gt; 'Bot visible',
+	'BOT_VIS_EXPLAIN'	=&gt; 'Allow bot to be seen by all users in online lists.',
+	'BOT_ACTIVE'		=&gt; 'Bot active',
+	'BOT_AGENT'			=&gt; 'Agent match',
+	'BOT_AGENT_EXPLAIN'	=&gt; 'A string matching the bots browser agent, partial matches are allowed.',
+	'BOT_IP'			=&gt; 'Bot IP address',
+	'BOT_IP_EXPLAIN'	=&gt; 'Partial matches are allowed, seperate addresses with an apostrophe. A single hostname may be entered instead of an IP.',
+
+	'BOT_ADDED'		=&gt; 'New bot successfully added',
+	'BOT_UPDATED'	=&gt; 'Existing bot updated successfully',
+	'BOT_DELETED'	=&gt; 'Bot deleted successfully',
+
+	'NO_BOT'	=&gt; 'Found no bot with the specified ID',
+	'ERR_BOT_NO_MATCHES'	=&gt; 'You must supply at least one of an agent or IP for this bot match.',
+	'ERR_BOT_NO_IP'			=&gt; 'The IP addresses you supplied were invalid or the hostname could not be resolved.',
+);
+
+// Custom profile fields
+$this-&gt;lang += array(
+	'FIELD_INT'		=&gt; 'Numbers',
+	'FIELD_STRING'	=&gt; 'Single Textfield',
+	'FIELD_TEXT'	=&gt; 'Textarea',
+	'FIELD_BOOL'	=&gt; 'Boolean (Yes/No)',
+	'FIELD_DROPDOWN'=&gt; 'Dropdown Box',
+	'FIELD_DATE'	=&gt; 'Date',
+
+	'NO_FIELD_TYPE'				=&gt; 'No Field type specified',
+	'FIRST_OPTION'				=&gt; 'First Option',
+	'SECOND_OPTION'				=&gt; 'Second Option',
+	'EMPTY_FIELD_IDENT'			=&gt; 'Empty field name',
+	'INVALID_CHARS_FIELD_IDENT'	=&gt; 'Field name can only contain lowercase a-z and _',
+	'EMPTY_USER_FIELD_NAME'		=&gt; 'Empty Field Name presented to the user',
+
+	'PROFILE_BASIC_OPTIONS'		=&gt; 'Basic Options',
+	'PROFILE_TYPE_OPTIONS'		=&gt; 'Profile type specific options',
+	'PROFILE_LANG_OPTIONS'		=&gt; 'Language specific options',
+
+	'STEP_1_TITLE_CREATE'		=&gt; 'Add Profile Field',
+	'STEP_1_TITLE_EDIT'			=&gt; 'Edit Profile Field',
+
+	'STEP_1_EXPLAIN_CREATE'		=&gt; 'Here you can enter the first basic parameters of your new profile field. These informations are needed for the second step where you are able to set remaining options and where you are able to preview and tweak your profile field further.',
+	'STEP_1_EXPLAIN_EDIT'		=&gt; 'Here you can change the basic parameters of your profile field. The relevant options are re-calculated within the second step, where you are able to preview and test the changed settings.',
+
+	'STEP_2_TITLE_CREATE'		=&gt; 'Profile type specific options',
+	'STEP_2_TITLE_EDIT'			=&gt; 'Profile type specific options',
+
+	'STEP_2_EXPLAIN_CREATE'		=&gt; 'Here you are able to define some common options. Further you are able to preview the field you generated, as the user will see it. Play around with it until you are satisfied as how the field behaves.',
+	'STEP_2_EXPLAIN_EDIT'		=&gt; 'Here you are able to change some common options. Further you are able to preview the changed field, as the user will see it. Play around with it until you are satisfied as how the field behaves.&lt;br /&gt;&lt;b&gt;Please note that changes to profile fields will not affect existing profile fields entered by your users.&lt;/b&gt;',
+
+	'STEP_3_TITLE_CREATE'		=&gt; 'Remaining Language Definitions',
+	'STEP_3_TITLE_EDIT'			=&gt; 'Language Definitions',
+
+	'STEP_3_EXPLAIN_CREATE'		=&gt; 'Since you have more than one board language installed, you have to fill out the remaining language items too. The profile field will work with the default language enabled, you are able to fill out the remaining language items later too.',
+	'STEP_3_EXPLAIN_EDIT'		=&gt; 'Since you have more than one board language installed, you now can change or add the remaining language items too. The profile field will work with the default language enabled.',
+
+	'ROWS'						=&gt; 'Rows',
+	'COLUMNS'					=&gt; 'Columns',
+	'UPDATE_PREVIEW'			=&gt; 'Update Preview',
+	'PREVIEW_PROFILE_FIELD'		=&gt; 'Preview Profile Field',
+	'EVERYTHING_OK'				=&gt; 'Everything OK',
+
+	'STRING_DEFAULT_VALUE_EXPLAIN'	=&gt; 'Enter a default phrase to be displayed, a default value. Leave empty if you want to show it empty at the first place.',
+	'TEXT_DEFAULT_VALUE_EXPLAIN'=&gt; 'Enter a default text to be displayed, a default value. Leave empty if you want to show it empty at the first place.',
+	'BOOL_ENTRIES_EXPLAIN'		=&gt; 'Enter your options now',
+	'DROPDOWN_ENTRIES_EXPLAIN'	=&gt; 'Enter your options now, every option in one line',
+
+	'REQUIRED_FIELD'			=&gt; 'Required Field',
+	'REQUIRED_FIELD_EXPLAIN'	=&gt; 'Force profile field to be filled out or specified by user',
+	'DISPLAY_AT_REGISTRATION'	=&gt; 'Display at registration screen',
+	'HIDE_PROFILE_FIELD'		=&gt; 'Hide Profile Field',
+	'HIDE_PROFILE_FIELD_EXPLAIN'=&gt; 'Only Administrators and Moderators are able to see/fill out this profile field',
+	'EXCLUDE_FROM_VIEW'			=&gt; 'Do not display profile field',
+	'EXCLUDE_FROM_VIEW_EXPLAIN'	=&gt; 'The profile field will not be shown on viewtopic/viewprofile/memberlist/etc.',
+
+	'ADDED_PROFILE_FIELD'		=&gt; 'Successfully added custom profile field',
+	'CREATE_NEW_FIELD'			=&gt; 'Create New Field',
+	'REMOVED_PROFILE_FIELD'		=&gt; 'Successfully removed profile field.',
+	'CONFIRM_DELETE_PROFILE_FIELD'	=&gt; 'Are you sure you want to delete this profile field?',
+	'PROFILE_FIELD_ACTIVATED'	=&gt; 'Profile field successfully activated',
+	'PROFILE_FIELD_DEACTIVATED'	=&gt; 'Profile field successfully deactivated',
+	'CHANGED_PROFILE_FIELD'		=&gt; 'Successfully changed profile field',
+
+	'LOG_CREATE_PROFILE_FIELD'		=&gt; '&lt;b&gt;Profile field added&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_EDIT_PROFILE_FIELD'		=&gt; '&lt;b&gt;Profile field changed&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ACTIVATE_PROFILE_FIELD'	=&gt; '&lt;b&gt;Profile field activated&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_DEACTIVATE_PROFILE_FIELD'	=&gt; '&lt;b&gt;Profile field deactivated&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_REMOVED_PROFILE_FIELD'		=&gt; '&lt;b&gt;Profile field removed&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'CHARS_ANY'		=&gt; 'Any character',
+	'NUMBERS_ONLY'	=&gt; 'Only numbers (0-9)',
+	'ALPHA_ONLY'		=&gt; 'Alphanumeric only',
+	'ALPHA_SPACERS'	=&gt; 'Alphanumeric and spacers',
+
+	'FIELD_TYPE'			=&gt; 'Field Type',
+	'FIELD_TYPE_EXPLAIN'	=&gt; 'You are not able to change the field type later.',
+	'FIELD_IDENT'			=&gt; 'Field Name',
+	'FIELD_IDENT_EXPLAIN'	=&gt; 'The Field Name is a name for you to identify the profile field, it is not displayed to the user.',
+	'LANG_SPECIFIC_OPTIONS'	=&gt; 'Language specific options [&lt;b&gt;%s&lt;/b&gt;]',
+	'USER_FIELD_NAME'		=&gt; 'Field Name presented to the user',
+	'FIELD_DESCRIPTION'		=&gt; 'Field Description',
+	'FIELD_DESCRIPTION_EXPLAIN'	=&gt; 'The Explanation for this field presented to the user',
+
+	'CP_LANG_NAME'			=&gt; 'Field Name presented to the user',
+	'CP_LANG_EXPLAIN'		=&gt; 'Field Description',
+	'CP_LANG_EXPLAIN_EXPLAIN'	=&gt; 'The Explanation for this field presented to the user',
+	'CP_LANG_DEFAULT_VALUE'	=&gt; 'Default Value',
+	'CP_LANG_OPTIONS'		=&gt; 'Options',
+
+	'FIELD_LENGTH'			=&gt; 'Length of input box',
+	'MIN_FIELD_CHARS'		=&gt; 'Minimum number of characters',
+	'MAX_FIELD_CHARS'		=&gt; 'Maximum number of characters',
+	'MIN_FIELD_NUMBER'		=&gt; 'Lowest allowed number',
+	'MAX_FIELD_NUMBER'		=&gt; 'Highest allowed number',
+	'DEFAULT_VALUE'			=&gt; 'Default Value',
+	'FIELD_VALIDATION'		=&gt; 'Field Validation',
+	'ENTRIES'				=&gt; 'Entries',
+	'BOOL_TYPE_EXPLAIN'		=&gt; 'Define the Type, either a checkbox or radio buttons',
+	'RADIO_BUTTONS'			=&gt; 'Radio Buttons',
+	'CHECKBOX'				=&gt; 'Checkbox',
+	'NO_VALUE_OPTION'		=&gt; 'Option equal to non entered value',
+	'NO_VALUE_OPTION_EXPLAIN'	=&gt; 'Value for a non-entry. If the field is required, the user gets an error if he choose the option selected here',
+	'ALWAYS_TODAY'			=&gt; 'Always the current date',
+
+	'DEFAULT_ISO_LANGUAGE'	=&gt; 'Default Language [%s]',
+	'ISO_LANGUAGE'			=&gt; 'Language [%s]',
+
+	'NO_FIELD_ID'			=&gt; 'No field id specified',
+	'FIELD_NOT_FOUND'		=&gt; 'Profile field not found',
+	'NO_FIELD_ENTRIES'		=&gt; 'No Entries defined',
+);
+
+// Language Packs
+$this-&gt;lang += array(
+	'LANGUAGE_PACKS_EXPLAIN'	=&gt; 'Here you are able to install/remove language packs',
+	'LANGUAGE_PACK_NAME'		=&gt; 'Name',
+	'LANGUAGE_PACK_LOCALNAME'	=&gt; 'Local name',
+	'LANGUAGE_PACK_ISO'			=&gt; 'ISO',
+	'LANGUAGE_PACK_USED_BY'		=&gt; 'Used by',
+	'INSTALLED_LANGUAGE_PACKS'	=&gt; 'Installed language packs',
+	'UNINSTALLED_LANGUAGE_PACKS'=&gt; 'Uninstalled language packs',
+	'NO_UNINSTALLED_LANGUAGE_PACKS'	=&gt; 'No uninstalled language packs',
+	'NO_LANG_ID'				=&gt; 'You haven\'t specified a language pack',
+	'NO_REMOVE_DEFAULT_LANG'	=&gt; 'You are not able to remove the default language pack.&lt;br /&gt;If you want to remove this language pack, change your boards default language first.',
+	'LANGUAGE_PACK_DELETED'		=&gt; 'The language pack &lt;b&gt;%s&lt;/b&gt; has been removed successfully. All users using this language have been resetted to the boards default language.',
+	'LANGUAGE_PACK_NOT_EXIST'	=&gt; 'The selected language pack does not exist.',
+	'LANGUAGE_PACK_ALREADY_INSTALLED'	=&gt; 'This language pack is already installed.',
+	'INVALID_LANGUAGE_PACK'		=&gt; 'The selected language pack seems to be not valid. Please verify the language pack and upload it again if necessary.',
+	'LANGUAGE_PACK_INSTALLED'	=&gt; 'The language pack &lt;b&gt;%s&lt;/b&gt; has been successfully installed.',
+	'LANGUAGE_PACK_DETAILS'		=&gt; 'Language Pack Details',
+	'WRONG_LANGUAGE_FILE'		=&gt; 'Selected language file is invalid',
+	'LANGUAGE_DETAILS_UPDATED'	=&gt; 'Language details successfully updated',
+
+	'LANG_ENGLISH_NAME'			=&gt; 'English name',
+	'LANG_LOCAL_NAME'			=&gt; 'Local name',
+	'LANG_ISO_CODE'				=&gt; 'ISO Code',
+	'LANG_AUTHOR'				=&gt; 'Language Pack Author',
+
+	'MISSING_LANGUAGE_FILE'		=&gt; 'Missing Language File: &lt;span style=&quot;color:red&quot;&gt;%s&lt;/span&gt;',
+	'THOSE_MISSING_LANG_FILES'	=&gt; 'The following language files are missing from the %s language folder',
+	'MISSING_LANG_VARIABLES'	=&gt; 'Missing Language Variables',
+	'THOSE_MISSING_LANG_VARIABLES'	=&gt; 'The following language variables are missing from the &lt;b&gt;%s&lt;/b&gt; language pack',
+
+	'LANGUAGE_KEY'				=&gt; 'Language Key',
+	'LANGUAGE_VARIABLE'			=&gt; 'Language Variable',
+	'LANGUAGE_FILES'			=&gt; 'Language Files',
+	'HELP_FILES'				=&gt; 'Help Files',
+	'EMAIL_TEMPLATES'			=&gt; 'Email Templates',
+
+	'LANGUAGE_ENTRIES'			=&gt; 'Language Entries',
+	'LANGUAGE_ENTRIES_EXPLAIN'	=&gt; 'Here you are able to change existing language pack entries or not already translated ones.&lt;br /&gt;&lt;b&gt;Note:&lt;/b&gt; Once you changed a language file, the changes will be stored within a seperate folder for you to download. The changes will not be seen by your users until you replace the original language files at your webspace (by uploading them).',
+	'REMOVE_FROM_STORAGE_FOLDER'=&gt; 'Remove from storage folder',
+	'FILE_CONTENTS'				=&gt; 'File Contents',
+	'FILE_FROM_STORAGE'			=&gt; 'File from storage folder',
+	'SUBMIT_AND_DOWNLOAD'		=&gt; 'Submit and Download File',
+	'SELECT_DOWNLOAD_FORMAT'	=&gt; 'Select download format',
+	'DOWNLOAD_AS'				=&gt; 'Download as',
+	'DOWNLOAD'					=&gt; 'Download',
+);
+
+?&gt;
\ No newline at end of file

Added: cms/trunk/modules/forums/language/admin_common.php
===================================================================
--- cms/trunk/modules/forums/language/admin_common.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/language/admin_common.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,599 @@
+&lt;?php
+/** 
+*
+* acp common [English]
+*
+* @package language
+* @version $Id: common.php,v 1.57 2006/08/10 13:33:06 naderman Exp $
+* @copyright (c) 2005 phpBB Group 
+* @license <A HREF="http://opensource.org/licenses/gpl-license.php">http://opensource.org/licenses/gpl-license.php</A> GNU Public License 
+*
+*/
+
+// DEVELOPERS PLEASE NOTE
+//
+// Placeholders can now contain order information, e.g. instead of
+// 'Page %s of %s' you can (and should) write 'Page %1$s of %2$s', this allows
+// translators to re-order the output of data while ensuring it remains correct
+//
+// You do not need this where single placeholders are used, e.g. 'Message %d' is fine
+// equally where a string contains only two placeholders which are used to wrap text
+// in a url you again do not need to specify an order e.g., 'Click %sHERE%s' is fine
+
+// Common
+$this-&gt;lang += array(
+	'ACP_ADMINISTRATORS'		=&gt; 'Administrators',
+	'ACP_ADMIN_LOGS'			=&gt; 'Admin Log',
+	'ACP_ADMIN_ROLES'			=&gt; 'Admin Roles',
+	'ACP_ATTACHMENTS'			=&gt; 'Attachments',
+	'ACP_ATTACHMENT_SETTINGS'	=&gt; 'Attachment Settings',
+	'ACP_AUTH_SETTINGS'			=&gt; 'Authentication',
+	'ACP_AUTOMATION'			=&gt; 'Automation',
+	'ACP_AVATAR_SETTINGS'		=&gt; 'Avatar Settings',
+
+	'ACP_BACKUP'				=&gt; 'Backup',
+	'ACP_BAN'					=&gt; 'Banning',
+	'ACP_BAN_EMAILS'			=&gt; 'Ban Emails',
+	'ACP_BAN_IPS'				=&gt; 'Ban IPs',
+	'ACP_BAN_USERNAMES'			=&gt; 'Ban Usernames',
+	'ACP_BASIC_PERMISSIONS'		=&gt; 'Basic Permissions',
+	'ACP_BBCODES'				=&gt; 'BBCodes',
+	'ACP_BOARD_CONFIGURATION'	=&gt; 'Board Configuration',
+	'ACP_BOARD_DEFAULTS'		=&gt; 'Board Defaults',
+	'ACP_BOARD_FEATURES'		=&gt; 'Board Features',
+	'ACP_BOARD_MANAGEMENT'		=&gt; 'Board Management',
+	'ACP_BOARD_SETTINGS'		=&gt; 'Board Settings',
+	'ACP_BOTS'					=&gt; 'Spiders/Robots',
+	
+	'ACP_CAPTCHA'				=&gt; 'CAPTCHA',
+
+	'ACP_CAT_DATABASE'			=&gt; 'Database',
+	'ACP_CAT_DOT_MODS'			=&gt; '.Mods',
+	'ACP_CAT_FORUMS'			=&gt; 'Forums',
+	'ACP_CAT_GENERAL'			=&gt; 'General',
+	'ACP_CAT_MAINTENANCE'		=&gt; 'Maintenance',
+	'ACP_CAT_PERMISSIONS'		=&gt; 'Permissions',
+	'ACP_CAT_POSTING'			=&gt; 'Posting',
+	'ACP_CAT_STYLES'			=&gt; 'Styles',
+	'ACP_CAT_SYSTEM'			=&gt; 'System',
+	'ACP_CAT_USERGROUP'			=&gt; 'Users and Groups',
+	'ACP_CAT_USERS'				=&gt; 'Users',
+	'ACP_CLIENT_COMMUNICATION'	=&gt; 'Client Communication',
+	'ACP_COOKIE_SETTINGS'		=&gt; 'Cookie Settings',
+	'ACP_CRITICAL_LOGS'			=&gt; 'Error Log',
+	'ACP_CUSTOM_PROFILE_FIELDS'	=&gt; 'Custom Profile Fields',
+	
+	'ACP_DATABASE'				=&gt; 'Database Management',
+	'ACP_DISALLOW'				=&gt; 'Disallow',
+	'ACP_DISALLOW_USERNAMES'	=&gt; 'Disallow Usernames',
+	
+	'ACP_EMAIL_SETTINGS'		=&gt; 'Email Settings',
+	'ACP_EXTENSION_GROUPS'		=&gt; 'Manage Extension Groups',
+	
+	'ACP_FORUM_BASED_PERMISSIONS'	=&gt; 'Forum Based Permissions',
+	'ACP_FORUM_LOGS'				=&gt; 'Forum Logs',
+	'ACP_FORUM_MANAGEMENT'			=&gt; 'Forum Management',
+	'ACP_FORUM_MODERATORS'			=&gt; 'Forum Moderators',
+	'ACP_FORUM_PERMISSIONS'			=&gt; 'Forum Permissions',
+	'ACP_FORUM_ROLES'				=&gt; 'Forum Roles',
+
+	'ACP_GENERAL_CONFIGURATION'		=&gt; 'General Configuration',
+	'ACP_GENERAL_TASKS'				=&gt; 'General Tasks',
+	'ACP_GLOBAL_MODERATORS'			=&gt; 'Global Moderators',
+	'ACP_GLOBAL_PERMISSIONS'		=&gt; 'Global Permissions',
+	'ACP_GROUPS'					=&gt; 'Groups',
+	'ACP_GROUPS_FORUM_PERMISSIONS'	=&gt; 'Groups Forum Permissions',
+	'ACP_GROUPS_MANAGE'				=&gt; 'Manage Groups',
+	'ACP_GROUPS_MANAGEMENT'			=&gt; 'Group Management',
+	'ACP_GROUPS_PERMISSIONS'		=&gt; 'Groups Permissions',
+	
+	'ACP_ICONS'					=&gt; 'Topic Icons',
+	'ACP_ICONS_SMILIES'			=&gt; 'Topic Icons/Smilies',
+	'ACP_IMAGESETS'				=&gt; 'Imagesets',
+	'ACP_INDEX'					=&gt; 'Admin index',
+	
+	'ACP_JABBER_SETTINGS'		=&gt; 'Jabber Settings',
+	
+	'ACP_LANGUAGE'				=&gt; 'Language Management',
+	'ACP_LANGUAGE_PACKS'		=&gt; 'Language Packs',
+	'ACP_LOAD_SETTINGS'			=&gt; 'Load Settings',
+	'ACP_LOGGING'				=&gt; 'Logging',
+	
+	'ACP_MAIN'					=&gt; 'Admin index',
+	'ACP_MANAGE_EXTENSIONS'		=&gt; 'Manage Extensions',
+	'ACP_MANAGE_FORUMS'			=&gt; 'Manage Forums',
+	'ACP_MANAGE_RANKS'			=&gt; 'Manage Ranks',
+	'ACP_MANAGE_REASONS'		=&gt; 'Manage Report/Denial Reasons',
+	'ACP_MANAGE_USERS'			=&gt; 'Manage Users',
+	'ACP_MASS_EMAIL'			=&gt; 'Mass Email',
+	'ACP_MESSAGES'				=&gt; 'Messages',
+	'ACP_MESSAGE_SETTINGS'		=&gt; 'Private Message Settings',
+	'ACP_MODULE_MANAGEMENT'		=&gt; 'Module Management',
+	'ACP_MOD_LOGS'				=&gt; 'Moderator Log',
+	'ACP_MOD_ROLES'				=&gt; 'Moderator Roles',
+	
+	'ACP_ORPHAN_ATTACHMENTS'	=&gt; 'Orphan Attachments',
+	
+	'ACP_PERMISSIONS'			=&gt; 'Permissions',
+	'ACP_PERMISSION_MASKS'		=&gt; 'Permission Masks',
+	'ACP_PERMISSION_ROLES'		=&gt; 'Permission Roles',
+	'ACP_PERMISSION_SETTINGS'	=&gt; 'Permission Settings',
+	'ACP_PERMISSION_TRACE'		=&gt; 'Permission Trace',
+	'ACP_PHP_INFO'				=&gt; 'PHP Information',
+	'ACP_POST_SETTINGS'			=&gt; 'Post Settings',
+	'ACP_PRUNE_FORUMS'			=&gt; 'Prune Forums',
+	'ACP_PRUNE_USERS'			=&gt; 'Prune Users',
+	'ACP_PRUNING'				=&gt; 'Pruning',
+	
+	'ACP_QUICK_ACCESS'			=&gt; 'Quick Access',
+	
+	'ACP_RANKS'					=&gt; 'Ranks',
+	'ACP_REASONS'				=&gt; 'Report/Denial Reasons',
+	'ACP_REGISTER_SETTINGS'		=&gt; 'User Registration Settings',
+
+	'ACP_RESTORE'				=&gt; 'Restore',
+
+	'ACP_SEARCH'				=&gt; 'Search Configuration',
+	'ACP_SEARCH_INDEX'			=&gt; 'Search Index',
+	'ACP_SEARCH_SETTINGS'		=&gt; 'Search Settings',
+
+	'ACP_SECURITY_SETTINGS'		=&gt; 'Security Settings',
+	'ACP_SERVER_CONFIGURATION'	=&gt; 'Server Configuration',
+	'ACP_SERVER_SETTINGS'		=&gt; 'Server Settings',
+	'ACP_SIGNATURE_SETTINGS'	=&gt; 'Signature Settings',
+	'ACP_SMILIES'				=&gt; 'Smilies',
+	'ACP_SPECIAL_PERMISSIONS'	=&gt; 'Special Permissions',
+	'ACP_STYLE_COMPONENTS'		=&gt; 'Style Components',
+	'ACP_STYLE_MANAGEMENT'		=&gt; 'Style Management',
+	'ACP_STYLES'				=&gt; 'Styles',
+	
+	'ACP_TEMPLATES'				=&gt; 'Templates',
+	'ACP_THEMES'				=&gt; 'Themes',
+	
+	'ACP_UPDATE'					=&gt; 'Updating',
+	'ACP_USERS_FORUM_PERMISSIONS'	=&gt; 'Users Forum Permissions',
+	'ACP_USERS_LOGS'				=&gt; 'User Logs',
+	'ACP_USERS_PERMISSIONS'			=&gt; 'Users Permissions',
+	'ACP_USER_ATTACH'				=&gt; 'Attachments',
+	'ACP_USER_AVATAR'				=&gt; 'Avatar',
+	'ACP_USER_FEEDBACK'				=&gt; 'Feedback',
+	'ACP_USER_GROUPS'				=&gt; 'Groups',
+	'ACP_USER_MANAGEMENT'			=&gt; 'User Management',
+	'ACP_USER_OVERVIEW'				=&gt; 'Overview',
+	'ACP_USER_PERM'					=&gt; 'Permissions',
+	'ACP_USER_PREFS'				=&gt; 'Preferences',
+	'ACP_USER_PROFILE'				=&gt; 'Profile',
+	'ACP_USER_RANK'					=&gt; 'Rank',
+	'ACP_USER_ROLES'				=&gt; 'User Roles',
+	'ACP_USER_SECURITY'				=&gt; 'User Security',
+	'ACP_USER_SIG'					=&gt; 'Signature',
+
+	'ACP_VC_SETTINGS'					=&gt; 'Visual Confirmation Settings',
+	'ACP_VC_CAPTCHA_DISPLAY'			=&gt; 'CAPTCHA Image Preview',
+	'ACP_VERSION_CHECK'					=&gt; 'Check for Updates',
+	'ACP_VIEW_ADMIN_PERMISSIONS'		=&gt; 'View Admin Permissions',
+	'ACP_VIEW_FORUM_MOD_PERMISSIONS'	=&gt; 'View Forum Moderator Permissions',
+	'ACP_VIEW_FORUM_PERMISSIONS'		=&gt; 'View Forum Permissions',
+	'ACP_VIEW_GLOBAL_MOD_PERMISSIONS'	=&gt; 'View Global Moderator Permissions',
+	'ACP_VIEW_USER_PERMISSIONS'			=&gt; 'View User Permissions',
+	
+	'ACP_WORDS'					=&gt; 'Word Censoring',
+
+	'ACTION'				=&gt; 'Action',
+	'ACTIONS'				=&gt; 'Actions',
+	'ACTIVATE'				=&gt; 'Activate',
+	'ADD'					=&gt; 'Add',
+	'ADMIN'					=&gt; 'Administration',
+	'ADMIN_INDEX'			=&gt; 'Admin Index',
+	'ADMIN_PANEL'			=&gt; 'Administration Control Panel',
+
+	'BACK'					=&gt; 'Back',
+
+	'COLOUR_SWATCH'			=&gt; 'Web-safe colour swatch',
+	'CONFIG_UPDATED'		=&gt; 'Configuration updated successfully',
+	'CONFIRM_OPERATION'		=&gt; 'Are you sure you wish to carry out this operation?',
+
+	'DEACTIVATE'				=&gt; 'Deactivate',
+	'DIMENSIONS'				=&gt; 'Dimensions',
+	'DISABLE'					=&gt; 'Disable',
+	'DOWNLOAD'					=&gt; 'Download',
+	'DOWNLOAD_AS'				=&gt; 'Download as',
+	'DOWNLOAD_STORE'			=&gt; 'Download or Store file',
+	'DOWNLOAD_STORE_EXPLAIN'	=&gt; 'You may directly download the file or save it in your store/ folder.',
+
+	'EDIT'					=&gt; 'Edit',
+	'ENABLE'				=&gt; 'Enable',
+	'EXPORT_DOWNLOAD'		=&gt; 'Download',
+	'EXPORT_STORE'			=&gt; 'Store',
+
+	'FORUM_INDEX'			=&gt; 'Forum Index',
+
+	'GENERAL_OPTIONS'		=&gt; 'General Options',
+	'GENERAL_SETTINGS'		=&gt; 'General Settings',
+	'GLOBAL_MASK'			=&gt; 'Global Permission Mask',
+
+	'INSTALL'				=&gt; 'Install',
+	'IP'					=&gt; 'User IP',
+	'IP_HOSTNAME'			=&gt; 'IP addresses or hostnames',
+
+	'LOGGED_IN_AS'			=&gt; 'You are logged in as:',
+	'LOGIN_ADMIN'			=&gt; 'To administer the board you must be an authenticated user.',
+	'LOGIN_ADMIN_CONFIRM'	=&gt; 'To administer the board you must re-authenticate yourself.',
+	'LOGIN_ADMIN_SUCCESS'	=&gt; 'You have successfully authenticated and will now be redirected to the Administration Control Panel',
+	'LOOK_UP_FORUM'			=&gt; 'Select a Forum',
+
+	'MANAGE'				=&gt; 'Manage',
+	'MOVE_DOWN'				=&gt; 'Move Down',
+	'MOVE_UP'				=&gt; 'Move Up',
+
+	'NOTIFY'				=&gt; 'Notification',
+	'NO_ADMIN'				=&gt; 'You are not authorised to administer this board.',
+	'NO_EMAILS_DEFINED'		=&gt; 'No valid email addresses found',
+
+	'OFF'					=&gt; 'OFF',
+	'ON'					=&gt; 'ON',
+
+	'PARSE_BBCODE'			=&gt; 'Parse BBCode',
+	'PARSE_SMILIES'			=&gt; 'Parse Smilies',
+	'PARSE_URLS'			=&gt; 'Parse Links',
+	'PROCEED_TO_ACP'		=&gt; '%sProceed to the ACP%s',
+	'REMIND'				=&gt; 'Remind',
+	'REORDER'				=&gt; 'Reorder',
+	'RESYNC'				=&gt; 'Sync',
+	'RETURN_TO'				=&gt; 'Return to ...',
+
+	'SELECT_ANONYMOUS'		=&gt; 'Select Anonymous User',
+	'SELECT_OPTION'			=&gt; 'Select option',
+
+	'UCP'					=&gt; 'User Control Panel',
+	'USERNAMES_EXPLAIN'		=&gt; 'Place each username on a seperate line',
+	'USER_CONTROL_PANEL'	=&gt; 'User Control Panel',
+
+	'WARNING'				=&gt; 'Warning',
+
+	'DEBUG_EXTRA_WARNING'	=&gt; 'The DEBUG_EXTRA constant is defined which is only meant for development purposes by the developers.&lt;br /&gt;The board is running additional code to display sql reports, which slows down the board in a significant manner. Additionally sql errors are always displayed with a full backtrace to all users instead of displaying it solely to administrators, which is the default setting.&lt;br /&gt;&lt;br /&gt;With this said, please be aware that you are currently running your installation in &lt;b&gt;Debug Mode&lt;/b&gt; and should you take this board live, please remove the constant from the config file.',
+);
+
+// PHP info
+$this-&gt;lang += array(
+	'ACP_PHP_INFO_EXPLAIN'	=&gt; 'This page lists information on the version of PHP installed on this server. It includes details of loaded modules, available variables and default settings. This information may be useful when diagnosing problems. Please be aware that some hosting companies will limit what information is displayed here for security reasons. You are advised to not give out any details on this page except when asked by support or other Team Member on the support forums.',
+);
+
+// Logs
+$this-&gt;lang += array(
+	'ACP_ADMIN_LOGS_EXPLAIN'	=&gt; 'This lists all the actions carried out by board administrators. You can sort by username, date, IP or action. If you have appropriate permissions you can also clear individual operations or the log as a whole.',
+	'ACP_CRITICAL_LOGS_EXPLAIN'	=&gt; 'This lists the actions carried out by the board itself. These log provides you with information you are able to use for solving specific problems, for example non-delivery of emails. You can sort by username, date, IP or action. If you have appropriate permissions you can also clear individual operations or the log as a whole.',
+	'ACP_MOD_LOGS_EXPLAIN'		=&gt; 'This lists the actions carried out by board moderators, select a forum from the drop down list. You can sort by username, date, IP or action. If you have appropriate permissions you can also clear individual operations or the log as a whole.',
+	'ACP_USERS_LOGS_EXPLAIN'	=&gt; 'This lists all actions carried out by users or on users.',
+	'ALL_ENTRIES'				=&gt; 'All entries',
+
+	'DISPLAY_LOG'	=&gt; 'Display entries from previous',
+
+	'NO_ENTRIES'	=&gt; 'No log entries for this period',
+
+	'SORT_IP'		=&gt; 'IP address',
+	'SORT_DATE'		=&gt; 'Date',
+	'SORT_ACTION'	=&gt; 'Log action',
+);
+
+// Index page
+$this-&gt;lang += array(
+	'ADMIN_INTRO'				=&gt; 'Thank you for choosing phpBB as your forum solution. This screen will give you a quick overview of all the various statistics of your board. The links on the left hand side of this screen allow you to control every aspect of your forum experience. Each page will have instructions on how to use the tools.',
+	'ADMIN_LOG'					=&gt; 'Logged administrator actions',
+	'ADMIN_LOG_INDEX_EXPLAIN'	=&gt; 'This gives an overview of the last five actions carried out by board administrators. A full copy of the log can be viewed from the appropriate menu item or following the link below.',
+	'AVATAR_DIR_SIZE'			=&gt; 'Avatar directory size',
+
+	'BOARD_STARTED'		=&gt; 'Board started',
+
+	'DATABASE_SERVER_INFO'	=&gt; 'Database server',
+	'DATABASE_SIZE'			=&gt; 'Database size',
+
+	'FILES_PER_DAY'		=&gt; 'Attachments per day',
+	'FORUM_STATS'		=&gt; 'Forum Statistics',
+
+	'GZIP_COMPRESSION'	=&gt; 'Gzip compression',
+
+	'INACTIVE_USERS'			=&gt; 'Inactive Users',
+	'INACTIVE_USERS_EXPLAIN'	=&gt; 'This is a list of users who have registered but whos accounts are inactive. You can activate, delete or remind (by sending an email) these users if you wish.',
+
+	'NO_INACTIVE_USERS'	=&gt; 'No inactive users',
+	'NOT_AVAILABLE'		=&gt; 'Not available',
+	'NUMBER_FILES'		=&gt; 'Number of Attachments',
+	'NUMBER_POSTS'		=&gt; 'Number of posts',
+	'NUMBER_TOPICS'		=&gt; 'Number of topics',
+	'NUMBER_USERS'		=&gt; 'Number of users',
+
+	'POSTS_PER_DAY'		=&gt; 'Posts per day',
+
+	'RESET_DATE'			=&gt; 'Reset Date',
+	'RESET_ONLINE'			=&gt; 'Reset Online',
+	'RESYNC_POSTCOUNTS'		=&gt; 'Resync Postcounts',
+	'RESYNC_POST_MARKING'	=&gt; 'Resync dotted topics',
+	'RESYNC_STATS'			=&gt; 'Resync Stats',
+
+	'STATISTIC'			=&gt; 'Statistic',
+
+	'TOPICS_PER_DAY'	=&gt; 'Topics per day',
+
+	'UPLOAD_DIR_SIZE'	=&gt; 'Upload directory size',
+	'USERS_PER_DAY'		=&gt; 'Users per day',
+
+	'VALUE'				=&gt; 'Value',
+	'VIEW_ADMIN_LOG'	=&gt; 'View administrator log',
+
+	'WELCOME_PHPBB'			=&gt; 'Welcome to phpBB',
+);
+
+// Log Entries
+$this-&gt;lang += array(
+	'LOG_ACL_ADD_USER_GLOBAL_U_'		=&gt; '&lt;b&gt;Added or edited users user permissions&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ACL_ADD_GROUP_GLOBAL_U_'		=&gt; '&lt;b&gt;Added or edited groups user permissions&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ACL_ADD_USER_GLOBAL_M_'		=&gt; '&lt;b&gt;Added or edited users global moderator permissions&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ACL_ADD_GROUP_GLOBAL_M_'		=&gt; '&lt;b&gt;Added or edited groups global moderator permissions&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ACL_ADD_USER_GLOBAL_A_'		=&gt; '&lt;b&gt;Added or edited users admin permissions&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ACL_ADD_GROUP_GLOBAL_A_'		=&gt; '&lt;b&gt;Added or edited groups admin permissions&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_ACL_ADD_ADMIN_GLOBAL_A_'		=&gt; '&lt;b&gt;Added or edited Administrators&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ACL_ADD_MOD_GLOBAL_M_'			=&gt; '&lt;b&gt;Added or edited Global Moderators&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_ACL_ADD_USER_LOCAL_F_'			=&gt; '&lt;b&gt;Added or edited users forum access&lt;/b&gt; from %1$s&lt;br /&gt;&#187; %2$s',
+	'LOG_ACL_ADD_USER_LOCAL_M_'			=&gt; '&lt;b&gt;Added or edited users forum moderator access&lt;/b&gt; from %1$s&lt;br /&gt;&#187; %2$s',
+	'LOG_ACL_ADD_GROUP_LOCAL_F_'		=&gt; '&lt;b&gt;Added or edited groups forum access&lt;/b&gt; from %1$s&lt;br /&gt;&#187; %2$s',
+	'LOG_ACL_ADD_GROUP_LOCAL_M_'		=&gt; '&lt;b&gt;Added or edited groups forum moderator access&lt;/b&gt; from %1$s&lt;br /&gt;&#187; %2$s',
+
+	'LOG_ACL_ADD_MOD_LOCAL_M_'			=&gt; '&lt;b&gt;Added or edited Moderators&lt;/b&gt; from %1$s&lt;br /&gt;&#187; %2$s',
+	'LOG_ACL_ADD_FORUM_LOCAL_F_'		=&gt; '&lt;b&gt;Added or edited Forum Permissions&lt;/b&gt; from %1$s&lt;br /&gt;&#187; %2$s',
+
+	'LOG_ACL_DEL_ADMIN_GLOBAL_A_'		=&gt; '&lt;b&gt;Removed Administrators&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ACL_DEL_MOD_GLOBAL_M_'			=&gt; '&lt;b&gt;Removed Global Moderators&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ACL_DEL_MOD_LOCAL_M_'			=&gt; '&lt;b&gt;Removed Moderators&lt;/b&gt; from %1$s&lt;br /&gt;&#187; %2$s',
+	'LOG_ACL_DEL_FORUM_LOCAL_F_'		=&gt; '&lt;b&gt;Removed User/Group Forum Permissions&lt;/b&gt; from %1$s&lt;br /&gt;&#187; %2$s',
+
+	'LOG_ACL_TRANSFER_PERMISSIONS'		=&gt; '&lt;b&gt;Permissions transfered from&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ACL_RESTORE_PERMISSIONS'		=&gt; '&lt;b&gt;Own permissions restored after using permissions from&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	
+	'LOG_ADMIN_AUTH_FAIL'		=&gt; '&lt;b&gt;Failed administration login attempt&lt;/b&gt;',
+	'LOG_ADMIN_AUTH_SUCCESS'	=&gt; '&lt;b&gt;Successful administration login&lt;/b&gt;',
+
+	'LOG_ATTACH_EXT_ADD'		=&gt; '&lt;b&gt;Added or edited attachment extension&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ATTACH_EXT_DEL'		=&gt; '&lt;b&gt;Removed attachment extension&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ATTACH_EXT_UPDATE'		=&gt; '&lt;b&gt;Updated attachment extension&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ATTACH_EXTGROUP_ADD'	=&gt; '&lt;b&gt;Added extension group&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ATTACH_EXTGROUP_EDIT'	=&gt; '&lt;b&gt;Edited extension group&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ATTACH_EXTGROUP_DEL'	=&gt; '&lt;b&gt;Removed extension group&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ATTACH_FILEUPLOAD'		=&gt; '&lt;b&gt;Orphan File uploaded to Post&lt;/b&gt;&lt;br /&gt;&#187; ID %1$d - %2$s',
+	'LOG_ATTACH_ORPHAN_DEL'		=&gt; '&lt;b&gt;Orphan Files deleted&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_BAN_EXCLUDE_USER'	=&gt; '&lt;b&gt;Excluded user from ban&lt;/b&gt; for reason &quot;&lt;i&gt;%1$s&lt;/i&gt;&quot;&lt;br /&gt;&#187; %2$s ',
+	'LOG_BAN_EXCLUDE_IP'	=&gt; '&lt;b&gt;Excluded ip from ban&lt;/b&gt; for reason &quot;&lt;i&gt;%1$s&lt;/i&gt;&quot;&lt;br /&gt;&#187; %2$s ',
+	'LOG_BAN_EXCLUDE_EMAIL' =&gt; '&lt;b&gt;Excluded email from ban&lt;/b&gt; for reason &quot;&lt;i&gt;%1$s&lt;/i&gt;&quot;&lt;br /&gt;&#187; %2$s ',
+	'LOG_BAN_USER'			=&gt; '&lt;b&gt;Banned User&lt;/b&gt; for reason &quot;&lt;i&gt;%1$s&lt;/i&gt;&quot;&lt;br /&gt;&#187; %2$s ',
+	'LOG_BAN_IP'			=&gt; '&lt;b&gt;Banned ip&lt;/b&gt; for reason &quot;&lt;i&gt;%1$s&lt;/i&gt;&quot;&lt;br /&gt;&#187; %2$s',
+	'LOG_BAN_EMAIL'			=&gt; '&lt;b&gt;Banned email&lt;/b&gt; for reason &quot;&lt;i&gt;%1$s&lt;/i&gt;&quot;&lt;br /&gt;&#187; %2$s',
+	'LOG_UNBAN_USER'		=&gt; '&lt;b&gt;Unbanned user&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_UNBAN_IP'			=&gt; '&lt;b&gt;Unbanned ip&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_UNBAN_EMAIL'		=&gt; '&lt;b&gt;Unbanned email&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_BBCODE_ADD'		=&gt; '&lt;b&gt;Added new BBCode&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_BBCODE_EDIT'		=&gt; '&lt;b&gt;Edited BBCode&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_BBCODE_DELETE'		=&gt; '&lt;b&gt;Deleted BBCode&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_BOT_ADDED'		=&gt; '&lt;b&gt;New bot added&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_BOT_DELETE'	=&gt; '&lt;b&gt;Deleted bot&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_BOT_UPDATED'	=&gt; '&lt;b&gt;Existing bot updated&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_CLEAR_ADMIN'		=&gt; '&lt;b&gt;Cleared admin log&lt;/b&gt;',
+	'LOG_CLEAR_CRITICAL'	=&gt; '&lt;b&gt;Cleared error log&lt;/b&gt;',
+	'LOG_CLEAR_MOD'			=&gt; '&lt;b&gt;Cleared moderator log&lt;/b&gt;',
+	'LOG_CLEAR_USER'		=&gt; '&lt;b&gt;Cleared user log&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_CLEAR_USERS'		=&gt; '&lt;b&gt;Cleared user logs&lt;/b&gt;',
+
+	'LOG_CONFIG_ATTACH'			=&gt; '&lt;b&gt;Altered attachment settings&lt;/b&gt;',
+	'LOG_CONFIG_AUTH'			=&gt; '&lt;b&gt;Altered authentication settings&lt;/b&gt;',
+	'LOG_CONFIG_AVATAR'			=&gt; '&lt;b&gt;Altered avatar settings&lt;/b&gt;',
+	'LOG_CONFIG_COOKIE'			=&gt; '&lt;b&gt;Altered cookie settings&lt;/b&gt;',
+	'LOG_CONFIG_EMAIL'			=&gt; '&lt;b&gt;Altered email settings&lt;/b&gt;',
+	'LOG_CONFIG_FEATURES'		=&gt; '&lt;b&gt;Altered board features&lt;/b&gt;',
+	'LOG_CONFIG_LOAD'			=&gt; '&lt;b&gt;Altered load settings&lt;/b&gt;',
+	'LOG_CONFIG_MESSAGE'		=&gt; '&lt;b&gt;Altered private message settings&lt;/b&gt;',
+	'LOG_CONFIG_POST'			=&gt; '&lt;b&gt;Altered post settings&lt;/b&gt;',
+	'LOG_CONFIG_REGISTRATION'	=&gt; '&lt;b&gt;Altered user registration settings&lt;/b&gt;',
+	'LOG_CONFIG_SEARCH'			=&gt; '&lt;b&gt;Altered search settings&lt;/b&gt;',
+	'LOG_CONFIG_SECURITY'		=&gt; '&lt;b&gt;Altered security settings&lt;/b&gt;',
+	'LOG_CONFIG_SERVER'			=&gt; '&lt;b&gt;Altered server settings&lt;/b&gt;',
+	'LOG_CONFIG_SETTINGS'		=&gt; '&lt;b&gt;Altered board settings&lt;/b&gt;',
+	'LOG_CONFIG_SIGNATURE'		=&gt; '&lt;b&gt;Altered signature settings&lt;/b&gt;',
+	'LOG_CONFIG_VISUAL'			=&gt; '&lt;b&gt;Altered visual confirmation settings&lt;/b&gt;',
+
+	'LOG_APPROVE_TOPIC'			=&gt; '&lt;b&gt;Approved topic&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_BUMP_TOPIC'			=&gt; '&lt;b&gt;User bumped topic&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_DELETE_POST'			=&gt; '&lt;b&gt;Deleted post&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_DELETE_TOPIC'			=&gt; '&lt;b&gt;Deleted topic&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_FORK'					=&gt; '&lt;b&gt;Copied topic&lt;/b&gt;&lt;br /&gt;&#187; from %s',
+	'LOG_LOCK'					=&gt; '&lt;b&gt;Locked topic&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_LOCK_POST'				=&gt; '&lt;b&gt;Locked post&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_MERGE'					=&gt; '&lt;b&gt;Merged posts&lt;/b&gt; into topic&lt;br /&gt;&#187;%s',
+	'LOG_MOVE'					=&gt; '&lt;b&gt;Moved topic&lt;/b&gt;&lt;br /&gt;&#187; from %s',
+	'LOG_TOPIC_DELETED'			=&gt; '&lt;b&gt;Deleted topic&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_TOPIC_RESYNC'			=&gt; '&lt;b&gt;Resynchronised topic counters&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_TOPIC_TYPE_CHANGED'	=&gt; '&lt;b&gt;Changed topic type&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_UNLOCK'				=&gt; '&lt;b&gt;Unlocked topic&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_UNLOCK_POST'			=&gt; '&lt;b&gt;Unlocked post&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_DISALLOW_ADD'		=&gt; '&lt;b&gt;Added disallowed username&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_DISALLOW_DELETE'	=&gt; '&lt;b&gt;Deleted disallowed username&lt;/b&gt;',
+
+	'LOG_DB_BACKUP'			=&gt; '&lt;b&gt;Database backup&lt;/b&gt;',
+	'LOG_DB_RESTORE'		=&gt; '&lt;b&gt;Database restore&lt;/b&gt;',
+
+	'LOG_DOWNLOAD_EXCLUDE_IP'	=&gt; '&lt;b&gt;Exluded ip/hostname from download list&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_DOWNLOAD_IP'			=&gt; '&lt;b&gt;Added ip/hostname to download list&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_DOWNLOAD_REMOVE_IP'	=&gt; '&lt;b&gt;Removed ip/hostname from download list&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_ERROR_JABBER'		=&gt; '&lt;b&gt;Jabber Error&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_ERROR_EMAIL'		=&gt; '&lt;b&gt;Email Error&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	
+	'LOG_FORUM_ADD'							=&gt; '&lt;b&gt;Created new forum&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_FORUM_DEL_FORUM'					=&gt; '&lt;b&gt;Deleted forum&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_FORUM_DEL_FORUMS'					=&gt; '&lt;b&gt;Deleted forum and its subforums&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_FORUM_DEL_MOVE_FORUMS'				=&gt; '&lt;b&gt;Deleted forum and moved subforums&lt;/b&gt; to %1$s&lt;br /&gt;&#187; %2$s',
+	'LOG_FORUM_DEL_MOVE_POSTS'				=&gt; '&lt;b&gt;Deleted forum and moved posts &lt;/b&gt; to %1$s&lt;br /&gt;&#187; %2$s',
+	'LOG_FORUM_DEL_MOVE_POSTS_FORUMS'		=&gt; '&lt;b&gt;Deleted forum and its subforums, moved messages&lt;/b&gt; to %1$s&lt;br /&gt;&#187; %2$s',
+	'LOG_FORUM_DEL_MOVE_POSTS_MOVE_FORUMS'	=&gt; '&lt;b&gt;Deleted forum, moved posts&lt;/b&gt; to %1$s &lt;b&gt;and subforums&lt;/b&gt; to %2$s&lt;br /&gt;&#187; %3$s',
+	'LOG_FORUM_DEL_POSTS'					=&gt; '&lt;b&gt;Deleted forum and its messages&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_FORUM_DEL_POSTS_FORUMS'			=&gt; '&lt;b&gt;Deleted forum, its messages and subforums&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_FORUM_DEL_POSTS_MOVE_FORUMS'		=&gt; '&lt;b&gt;Deleted forum and its messages, moved subforums&lt;/b&gt; to %1$s&lt;br /&gt;&#187; %2$s',
+	'LOG_FORUM_EDIT'						=&gt; '&lt;b&gt;Edited forum details&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_FORUM_MOVE_DOWN'					=&gt; '&lt;b&gt;Moved forum&lt;/b&gt; %1$s &lt;b&gt;below&lt;/b&gt; %2$s',
+	'LOG_FORUM_MOVE_UP'						=&gt; '&lt;b&gt;Moved forum&lt;/b&gt; %1$s &lt;b&gt;above&lt;/b&gt; %2$s',
+	'LOG_FORUM_SYNC'						=&gt; '&lt;b&gt;Re-synchronised forum&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_GROUP_CREATED'		=&gt; '&lt;b&gt;New usergroup created&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_GROUP_DEFAULTS'	=&gt; '&lt;b&gt;Group made default for members&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_GROUP_DELETE'		=&gt; '&lt;b&gt;Usergroup deleted&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_GROUP_DEMOTED'		=&gt; '&lt;b&gt;Leaders demoted in usergroup&lt;/b&gt; %1$s&lt;br /&gt;&#187; %2$s',
+	'LOG_GROUP_PROMOTED'	=&gt; '&lt;b&gt;Members promoted to leader in usergroup&lt;/b&gt; %1$s&lt;br /&gt;&#187; %2$s',
+	'LOG_GROUP_REMOVE'		=&gt; '&lt;b&gt;Members removed from usergroup&lt;/b&gt; %1$s&lt;br /&gt;&#187; %2$s',
+	'LOG_GROUP_UPDATED'		=&gt; '&lt;b&gt;Usergroup details updated&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_MODS_ADDED'		=&gt; '&lt;b&gt;Added new leaders to usergroup&lt;/b&gt; %1$s&lt;br /&gt;&#187; %2$s',
+	'LOG_USERS_APPROVED'	=&gt; '&lt;b&gt;Users approved in usergroup&lt;/b&gt; %1$s&lt;br /&gt;&#187; %2$s',
+	'LOG_USERS_ADDED'		=&gt; '&lt;b&gt;Added new members to usergroup&lt;/b&gt; %1$s&lt;br /&gt;&#187; %2$s',
+
+	'LOG_IMAGESET_ADD_DB'		=&gt; '&lt;b&gt;Added new imageset to database&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_IMAGESET_ADD_FS'		=&gt; '&lt;b&gt;Add new imageset on filesystem&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_IMAGESET_DELETE'		=&gt; '&lt;b&gt;Deleted imageset&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_IMAGESET_EDIT_DETAILS'	=&gt; '&lt;b&gt;Edited imageset details&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_IMAGESET_EDIT'			=&gt; '&lt;b&gt;Edited imageset&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_IMAGESET_EXPORT'		=&gt; '&lt;b&gt;Exported imageset&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_IMAGESET_REFRESHED'	=&gt; '&lt;b&gt;Refreshed imageset&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_INDEX_ACTIVATE'	=&gt; '&lt;b&gt;Activated inactive users&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_INDEX_DELETE'		=&gt; '&lt;b&gt;Deleted inactive users&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_INDEX_REMIND'		=&gt; '&lt;b&gt;Sent reminder emails to inactive users&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_INSTALL_CONVERTED'	=&gt; '&lt;b&gt;Converted from %1$s to phpBB %2$s&lt;/b&gt;',
+	'LOG_INSTALL_INSTALLED'	=&gt; '&lt;b&gt;Installed phpBB %s&lt;/b&gt;',
+
+	'LOG_IP_BROWSER_CHECK'	=&gt; '&lt;b&gt;Session IP/Browser check failed&lt;/b&gt;&lt;br /&gt;&#187;User IP &quot;&lt;i&gt;%1$s&lt;/i&gt;&quot; checked against session IP &quot;&lt;i&gt;%2$s&lt;/i&gt;&quot; and user browser string &quot;&lt;i&gt;%3$s&lt;/i&gt;&quot; checked against session browser string &quot;&lt;i&gt;%4$s&lt;/i&gt;&quot;.',
+
+	'LOG_JAB_CHANGED'			=&gt; '&lt;b&gt;Jabber account changed&lt;/b&gt;',
+	'LOG_JAB_PASSCHG'			=&gt; '&lt;b&gt;Jabber password changed&lt;/b&gt;',
+	'LOG_JAB_REGISTER'			=&gt; '&lt;b&gt;Jabber account registered&lt;/b&gt;',
+	'LOG_JAB_SETTINGS_CHANGED'	=&gt; '&lt;b&gt;Jabber settings changed&lt;/b&gt;',
+
+	'LOG_LANGUAGE_PACK_DELETED'		=&gt; '&lt;b&gt;Deleted language pack&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_LANGUAGE_PACK_INSTALLED'	=&gt; '&lt;b&gt;Installed language pack&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_LANGUAGE_PACK_UPDATED'		=&gt; '&lt;b&gt;Updated language pack details&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_LANGUAGE_FILE_REPLACED'	=&gt; '&lt;b&gt;Replaced language file&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_MASS_EMAIL'		=&gt; '&lt;b&gt;Sent mass email&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_MCP_CHANGE_POSTER'	=&gt; '&lt;b&gt;Changed poster in topic &quot;%1$s&quot;&lt;/b&gt;&lt;br /&gt;&#187; from %2$s to %3$s',
+
+	'LOG_MODULE_DISABLE'	=&gt; '&lt;b&gt;Module disabled&lt;/b&gt;',
+	'LOG_MODULE_ENABLE'		=&gt; '&lt;b&gt;Module enabled&lt;/b&gt;',
+	'LOG_MODULE_MOVE_DOWN'	=&gt; '&lt;b&gt;Module moved down&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_MODULE_MOVE_UP'	=&gt; '&lt;b&gt;Module moved up&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_MODULE_REMOVED'	=&gt; '&lt;b&gt;Module removed&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_MODULE_ADD'		=&gt; '&lt;b&gt;Module added&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_MODULE_EDIT'		=&gt; '&lt;b&gt;Module edited&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_A_ROLE_ADD'		=&gt; '&lt;b&gt;Admin Role added&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_A_ROLE_EDIT'		=&gt; '&lt;b&gt;Admin Role edited&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_A_ROLE_REMOVED'	=&gt; '&lt;b&gt;Admin Role removed&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_F_ROLE_ADD'		=&gt; '&lt;b&gt;Forum Role added&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_F_ROLE_EDIT'		=&gt; '&lt;b&gt;Forum Role edited&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_F_ROLE_REMOVED'	=&gt; '&lt;b&gt;Forum Role removed&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_M_ROLE_ADD'		=&gt; '&lt;b&gt;Moderator Role added&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_M_ROLE_EDIT'		=&gt; '&lt;b&gt;Moderator Role edited&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_M_ROLE_REMOVED'	=&gt; '&lt;b&gt;Moderator Role removed&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_U_ROLE_ADD'		=&gt; '&lt;b&gt;User Role added&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_U_ROLE_EDIT'		=&gt; '&lt;b&gt;User Role edited&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_U_ROLE_REMOVED'	=&gt; '&lt;b&gt;User Role removed&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_PROFILE_FIELD_ACTIVATE'	=&gt; '&lt;b&gt;Profile field activated&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_PROFILE_FIELD_CREATE'		=&gt; '&lt;b&gt;Profile field added&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_PROFILE_FIELD_DEACTIVATE'	=&gt; '&lt;b&gt;Profile field deactivated&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_PROFILE_FIELD_EDIT'		=&gt; '&lt;b&gt;Profile field changed&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_PROFILE_FIELD_REMOVED'		=&gt; '&lt;b&gt;Profile field removed&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_PRUNE'					=&gt; '&lt;b&gt;Pruned forums&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_AUTO_PRUNE'			=&gt; '&lt;b&gt;Auto-pruned forums&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_PRUNE_USER_DEAC'		=&gt; '&lt;b&gt;Users deactivated&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_PRUNE_USER_DEL_DEL'	=&gt; '&lt;b&gt;Users pruned and posts deleted&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_PRUNE_USER_DEL_ANON'	=&gt; '&lt;b&gt;Users pruned and posts retained&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_REASON_ADDED'		=&gt; '&lt;b&gt;Added report/denial reason&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_REASON_REMOVED'	=&gt; '&lt;b&gt;Removed report/denial reason&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_REASON_UPDATED'	=&gt; '&lt;b&gt;Updated report/denial reason&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_RESET_DATE'			=&gt; '&lt;b&gt;Board start date reset&lt;/b&gt;',
+	'LOG_RESET_ONLINE'			=&gt; '&lt;b&gt;Most users online reset&lt;/b&gt;',
+	'LOG_RESYNC_POSTCOUNTS'		=&gt; '&lt;b&gt;User postcounts synced&lt;/b&gt;',
+	'LOG_RESYNC_POST_MARKING'	=&gt; '&lt;b&gt;Dotted topics synced&lt;/b&gt;',
+	'LOG_RESYNC_STATS'			=&gt; '&lt;b&gt;Post, topic and user stats reset&lt;/b&gt;',
+
+	'LOG_STYLE_ADD'				=&gt; '&lt;b&gt;Added new style&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_STYLE_DELETE'			=&gt; '&lt;b&gt;Deleted style&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_STYLE_EDIT_DETAILS'	=&gt; '&lt;b&gt;Edited style&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_STYLE_EXPORT'			=&gt; '&lt;b&gt;Exported style&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_TEMPLATE_ADD_DB'			=&gt; '&lt;b&gt;Added new template set to database&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_TEMPLATE_ADD_FS'			=&gt; '&lt;b&gt;Add new template set on filesystem&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_TEMPLATE_CACHE_CLEARED'	=&gt; '&lt;b&gt;Deleted cached versions of template files in template set &lt;i&gt;%1$s&lt;/i&gt;&lt;/b&gt;&lt;br /&gt;&#187; %2$s',
+	'LOG_TEMPLATE_DELETE'			=&gt; '&lt;b&gt;Deleted template set&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_TEMPLATE_EDIT'				=&gt; '&lt;b&gt;Edited template set &lt;i&gt;%1$s&lt;/i&gt;&lt;/b&gt;&lt;br /&gt;&#187; %2$s',
+	'LOG_TEMPLATE_EDIT_DETAILS'		=&gt; '&lt;b&gt;Edited template details&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_TEMPLATE_EXPORT'			=&gt; '&lt;b&gt;Exported template set&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_TEMPLATE_REFRESHED'		=&gt; '&lt;b&gt;Refreshed template set&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_THEME_ADD_DB'			=&gt; '&lt;b&gt;Added new theme to database&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_THEME_ADD_FS'			=&gt; '&lt;b&gt;Add new theme on filesystem&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_THEME_DELETE'			=&gt; '&lt;b&gt;Theme deleted&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_THEME_EDIT_DETAILS'	=&gt; '&lt;b&gt;Edited theme details&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_THEME_EDIT'			=&gt; '&lt;b&gt;Edited theme &lt;i&gt;%1$s&lt;/i&gt;&lt;/b&gt;&lt;br /&gt;&#187; Modified class &lt;i&gt;%2$s&lt;/i&gt;',
+	'LOG_THEME_EDIT_ADD'		=&gt; '&lt;b&gt;Edited theme &lt;i&gt;%1$s&lt;/i&gt;&lt;/b&gt;&lt;br /&gt;&#187; Added class &lt;i&gt;%2$s&lt;/i&gt;',
+	'LOG_THEME_EXPORT'			=&gt; '&lt;b&gt;Exported theme&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_THEME_REFRESHED'		=&gt; '&lt;b&gt;Refreshed theme&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_USER_ACTIVE'		=&gt; '&lt;b&gt;User activated&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_USER_BAN_USER'		=&gt; '&lt;b&gt;Banned User via user management&lt;/b&gt; for reason &quot;&lt;i&gt;%1$s&lt;/i&gt;&quot;&lt;br /&gt;&#187; %2$s',
+	'LOG_USER_BAN_IP'		=&gt; '&lt;b&gt;Banned ip via user management&lt;/b&gt; for reason &quot;&lt;i&gt;%1$s&lt;/i&gt;&quot;&lt;br /&gt;&#187; %2$s',
+	'LOG_USER_BAN_EMAIL'	=&gt; '&lt;b&gt;Banned email via user management&lt;/b&gt; for reason &quot;&lt;i&gt;%1$s&lt;/i&gt;&quot;&lt;br /&gt;&#187; %2$s',
+	'LOG_USER_DELETED'		=&gt; '&lt;b&gt;Deleted user&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_USER_DEL_ATTACH'	=&gt; '&lt;b&gt;Removed all attachments made by the user&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_USER_DEL_AVATAR'	=&gt; '&lt;b&gt;Removed user avatar&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_USER_DEL_POSTS'	=&gt; '&lt;b&gt;Removed all posts made by the user&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_USER_DEL_SIG'		=&gt; '&lt;b&gt;Removed user signature&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_USER_INACTIVE'		=&gt; '&lt;b&gt;User deactivated&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_USER_MOVE_POSTS'	=&gt; '&lt;b&gt;Moved user posts&lt;/b&gt;&lt;br /&gt;&#187; posts by &quot;%1$s&quot; to forum &quot;%2$s&quot;',
+	'LOG_USER_NEW_PASSWORD'	=&gt; '&lt;b&gt;Changed user password&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_USER_REACTIVATE'	=&gt; '&lt;b&gt;Forced user account re-activation&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_USER_UPDATE_EMAIL'	=&gt; '&lt;b&gt;User &quot;%1$s&quot; changed email&lt;/b&gt;&lt;br /&gt;&#187; from &quot;%2$s&quot; to &quot;%3$s&quot;',
+	'LOG_USER_UPDATE_NAME'	=&gt; '&lt;b&gt;Changed username&lt;/b&gt;&lt;br /&gt;&#187; from &quot;%1$s&quot; to &quot;%2$s&quot;',
+	'LOG_USER_USER_UPDATE'	=&gt; '&lt;b&gt;Updated user details&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_USER_ACTIVE_USER'		=&gt; '&lt;b&gt;User account activated&lt;/b&gt;',
+	'LOG_USER_DEL_AVATAR_USER'	=&gt; '&lt;b&gt;User avatar removed&lt;/b&gt;',
+	'LOG_USER_DEL_SIG_USER'		=&gt; '&lt;b&gt;User signature removed&lt;/b&gt;',
+	'LOG_USER_FEEDBACK'			=&gt; '&lt;b&gt;Added user feedback&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_USER_GENERAL'			=&gt; '%s',
+	'LOG_USER_INACTIVE_USER'	=&gt; '&lt;b&gt;User account de-activated&lt;/b&gt;',
+	'LOG_USER_LOCK'				=&gt; '&lt;b&gt;User locked own topic&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_USER_MOVE_POSTS_USER'	=&gt; '&lt;b&gt;Moved all posts to forum &quot;%s&quot;&lt;/b&gt;',
+	'LOG_USER_REACTIVATE_USER'	=&gt; '&lt;b&gt;Forced user account re-activation&lt;/b&gt;',
+	'LOG_USER_UNLOCK'			=&gt; '&lt;b&gt;User unlocked own topic&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_USER_WARNING'			=&gt; '&lt;b&gt;Added user warning&lt;/b&gt;&lt;br /&gt;&#187;%s',
+	'LOG_USER_WARNING_BODY'		=&gt; '&lt;b&gt;The following warning was issued to this user&lt;/b&gt;&lt;br /&gt;&#187;%s',
+
+	'LOG_USER_GROUP_CHANGE'			=&gt; '&lt;b&gt;User changed default group&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_USER_GROUP_DEMOTE'			=&gt; '&lt;b&gt;User demoted as leaders from usergroup&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_USER_GROUP_JOIN'			=&gt; '&lt;b&gt;User joined group&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_USER_GROUP_JOIN_PENDING'	=&gt; '&lt;b&gt;User joined group and needs to be approved&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_USER_GROUP_RESIGN'			=&gt; '&lt;b&gt;User resigned membership from group&lt;/b&gt;&lt;br /&gt;&#187; %s',
+
+	'LOG_WORD_ADD'			=&gt; '&lt;b&gt;Added word censor&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_WORD_DELETE'		=&gt; '&lt;b&gt;Deleted word censor&lt;/b&gt;&lt;br /&gt;&#187; %s',
+	'LOG_WORD_EDIT'			=&gt; '&lt;b&gt;Edited word censor&lt;/b&gt;&lt;br /&gt;&#187; %s',
+);
+
+?&gt;
\ No newline at end of file

Added: cms/trunk/modules/forums/language/admin_forums.php
===================================================================
--- cms/trunk/modules/forums/language/admin_forums.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/language/admin_forums.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,124 @@
+&lt;?php
+/** 
+*
+* acp_forums [English]
+*
+* @package language
+* @version $Id: forums.php,v 1.9 2006/07/09 16:22:58 acydburn Exp $
+* @copyright (c) 2005 phpBB Group 
+* @license <A HREF="http://opensource.org/licenses/gpl-license.php">http://opensource.org/licenses/gpl-license.php</A> GNU Public License 
+*
+*/
+
+// DEVELOPERS PLEASE NOTE 
+//
+// Placeholders can now contain order information, e.g. instead of
+// 'Page %s of %s' you can (and should) write 'Page %1$s of %2$s', this allows
+// translators to re-order the output of data while ensuring it remains correct
+//
+// You do not need this where single placeholders are used, e.g. 'Message %d' is fine
+// equally where a string contains only two placeholders which are used to wrap text
+// in a url you again do not need to specify an order e.g., 'Click %sHERE%s' is fine
+
+// Forum Admin
+$this-&gt;lang += array(
+	'AUTO_PRUNE_DAYS'			=&gt; 'Auto-prune Post Age',
+	'AUTO_PRUNE_DAYS_EXPLAIN'	=&gt; 'Number of days since last post after which topic is removed.',
+	'AUTO_PRUNE_FREQ'			=&gt; 'Auto-prune Frequency',
+	'AUTO_PRUNE_FREQ_EXPLAIN'	=&gt; 'Time in days between pruning events.',
+	'AUTO_PRUNE_VIEWED'			=&gt; 'Auto-prune Post Viewed Age',
+	'AUTO_PRUNE_VIEWED_EXPLAIN'	=&gt; 'Number of days since topic was viewed after which topic is removed.',
+
+	'COPY_PERMISSIONS'				=&gt; 'Copy permissions from',
+	'COPY_PERMISSIONS_ADD_EXPLAIN'	=&gt; 'Once created, the forum will have the same permissions as the one you select here. If no forum is selected the newly created forum will not be visible until permissions had been set.',
+	'COPY_PERMISSIONS_EDIT_EXPLAIN'	=&gt; 'If you select to copy permissions, the forum will have the same permissions as the one you select here. This will overwrite any permissions you have previously set for this forum with the permissions of the forum you select here. If no forum is selected the current permissions will be kept.',
+	'CREATE_FORUM'					=&gt; 'Create new forum',
+
+	'DECIDE_MOVE_DELETE_CONTENT'		=&gt; 'Delete content or move to forum',
+	'DEFAULT_STYLE'						=&gt; 'Default Style',
+	'DELETE_ALL_POSTS'					=&gt; 'Delete posts',
+	'DELETE_SUBFORUMS'					=&gt; 'Delete subforums and posts',
+	'DISPLAY_ACTIVE_TOPICS'				=&gt; 'Enable active topics',
+	'DISPLAY_ACTIVE_TOPICS_EXPLAIN'		=&gt; 'If set to yes active topics in selected subforums will be displayed under this category.',
+
+	'EDIT_FORUM'					=&gt; 'Edit forum',
+	'ENABLE_INDEXING'				=&gt; 'Enable search indexing',
+	'ENABLE_INDEXING_EXPLAIN'		=&gt; 'If set to yes posts made to this forum will be indexed for searching.',
+	'ENABLE_POST_REVIEW'			=&gt; 'Enable post review',
+	'ENABLE_POST_REVIEW_EXPLAIN'	=&gt; 'If set to yes users are able to review their post if new posts were made to the topic while users wrote theirs. This should be disabled for chat forums.',
+	'ENABLE_RECENT'					=&gt; 'Display active topics',
+	'ENABLE_RECENT_EXPLAIN'			=&gt; 'If set to yes topics made to this forum will be shown in the active topics list.',
+	'ENABLE_TOPIC_ICONS'			=&gt; 'Enable Topic Icons',
+
+	'FORUM_ADMIN'						=&gt; 'Forum Administration',
+	'FORUM_ADMIN_EXPLAIN'				=&gt; 'In phpBB3 there are no categories, everything is forum based. Each forum can have an unlimited number of sub-forums and you can determine whether each may be posted to or not (i.e. whether it acts like an old category). Here you can add, edit, delete, lock, unlock individual forums as well as set certain additional controls. If your posts and topics have got out of sync you can also resynchronise a forum.',
+	'FORUM_AUTO_PRUNE'					=&gt; 'Enable Auto-Pruning',
+	'FORUM_AUTO_PRUNE_EXPLAIN'			=&gt; 'Prunes the forum of topics, set the frequency/age parameters below.',
+	'FORUM_CREATED'						=&gt; 'Forum created successfully.',
+	'FORUM_DATA_NEGATIVE'				=&gt; 'Pruning parameters cannot be negative.',
+	'FORUM_DELETE'						=&gt; 'Delete Forum',
+	'FORUM_DELETE_EXPLAIN'				=&gt; 'The form below will allow you to delete a forum and decide where you want to put all topics (or forums) it contained.',
+	'FORUM_DELETED'						=&gt; 'Forum successfully deleted',
+	'FORUM_DESC'						=&gt; 'Description',
+	'FORUM_DESC_EXPLAIN'				=&gt; 'Any markup entered here will displayed as is.',
+	'FORUM_EDIT_EXPLAIN'				=&gt; 'The form below will allow you to customise this forum. Please note that moderation and post count controls are set via forum permissions for each user or usergroup.',
+	'FORUM_IMAGE'						=&gt; 'Forum Image',
+	'FORUM_IMAGE_EXPLAIN'				=&gt; 'Location, relative to the phpBB root directory, of an image to associate with this forum.',
+	'FORUM_LINK_EXPLAIN'				=&gt; 'Full URL (including the protocol, for example <A HREF="http://">http://</A>) to location clicking this forum will take the user.',
+	'FORUM_LINK_TRACK'					=&gt; 'Track Link Redirects',
+	'FORUM_LINK_TRACK_EXPLAIN'			=&gt; 'Records the number of times a forum link was clicked.',
+	'FORUM_NAME'						=&gt; 'Forum Name',
+	'FORUM_NAME_EMPTY'					=&gt; 'You must enter a name for this forum.',
+	'FORUM_PARENT'						=&gt; 'Parent Forum',
+	'FORUM_PASSWORD'					=&gt; 'Forum Password',
+	'FORUM_PASSWORD_CONFIRM'			=&gt; 'Confirm Forum Password',
+	'FORUM_PASSWORD_CONFIRM_EXPLAIN'	=&gt; 'Only needs to be set if a forum password is entered.',
+	'FORUM_PASSWORD_EXPLAIN'			=&gt; 'Defines a password for this forum, use the permission system in preference.',
+	'FORUM_PASSWORD_MISMATCH'			=&gt; 'The passwords you entered did not match.',
+	'FORUM_PRUNE_SETTINGS'				=&gt; 'Forum prune settings',
+	'FORUM_RESYNCED'					=&gt; 'Forum &quot;%s&quot; successfully resynced',
+	'FORUM_RULES_EXPLAIN'				=&gt; 'Forum Rules are displayed at any page within the given forum.',
+	'FORUM_RULES_LINK'					=&gt; 'Link to Forum Rules',
+	'FORUM_RULES_LINK_EXPLAIN'			=&gt; 'You are able to enter the URL of the page/post containing your forum rules here. This setting will override the Forum Rules text you specified.',
+	'FORUM_RULES_PREVIEW'				=&gt; 'Forum Rules preview',
+	'FORUM_SETTINGS'					=&gt; 'Forum Settings',
+	'FORUM_STATUS'						=&gt; 'Forum Status',
+	'FORUM_STYLE'						=&gt; 'Forum Style',
+	'FORUM_TOPICS_PAGE'					=&gt; 'Topics Per Page',
+	'FORUM_TOPICS_PAGE_EXPLAIN'			=&gt; 'If non-zero this value will override the default topics per page setting.',
+	'FORUM_TYPE'						=&gt; 'Forum Type',
+	'FORUM_UPDATED'						=&gt; 'Forum informations updated successfully.',
+
+	'GENERAL_FORUM_SETTINGS'	=&gt; 'General Forum Settings',
+
+	'LINK'					=&gt; 'Link',
+	'LIST_INDEX'			=&gt; 'List Forum On Index',
+	'LIST_INDEX_EXPLAIN'	=&gt; 'Displays a link to this forum under the root parent forum on the index.',
+	'LOCKED'				=&gt; 'Locked',
+
+	'MOVE_POSTS_TO'		=&gt; 'Move posts',
+	'MOVE_SUBFORUMS_TO'	=&gt; 'Move subforums',
+
+	'NO_DESTINATION_FORUM'			=&gt; 'You have not specified a forum to move content to',
+	'NO_FORUM_ACTION'				=&gt; 'No action defined for what happens with the forum content',
+	'NO_PARENT'						=&gt; 'No Parent',
+	'NO_PERMISSIONS'				=&gt; 'Do not copy permissions',
+	'NO_PERMISSION_FORUM_ADD'		=&gt; 'You do not have the neccessary permissions to add forums',
+	'NO_PERMISSION_FORUM_DELETE'	=&gt; 'You do not have the neccessary permissions to delete forums',
+
+	'PARENT_NOT_EXIST'			=&gt; 'Parent does not exist',
+	'PRUNE_ANNOUNCEMENTS'		=&gt; 'Prune Announcements',
+	'PRUNE_STICKY'				=&gt; 'Prune Stickies',
+	'PRUNE_OLD_POLLS'			=&gt; 'Prune Old Polls',
+	'PRUNE_OLD_POLLS_EXPLAIN'	=&gt; 'Removes topics with polls not voted in for post age days.',
+	
+	'REDIRECT_ACL'	=&gt; 'Now you are able to %sset permissions%s for this forum.',
+
+	'TYPE_CAT'			=&gt; 'Category',
+	'TYPE_FORUM'		=&gt; 'Forum',
+	'TYPE_LINK'			=&gt; 'Link',
+
+	'UNLOCKED'			=&gt; 'Unlocked',
+);
+
+?&gt;
\ No newline at end of file

Added: cms/trunk/modules/forums/language/admin_permissions.php
===================================================================
--- cms/trunk/modules/forums/language/admin_permissions.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/language/admin_permissions.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,216 @@
+&lt;?php
+/** 
+*
+* acp_permissions [English]
+*
+* @package language
+* @version $Id: permissions.php,v 1.13 2006/08/02 15:53:19 acydburn Exp $
+* @copyright (c) 2005 phpBB Group 
+* @license <A HREF="http://opensource.org/licenses/gpl-license.php">http://opensource.org/licenses/gpl-license.php</A> GNU Public License 
+*
+*/
+
+// DEVELOPERS PLEASE NOTE 
+//
+// Placeholders can now contain order information, e.g. instead of
+// 'Page %s of %s' you can (and should) write 'Page %1$s of %2$s', this allows
+// translators to re-order the output of data while ensuring it remains correct
+//
+// You do not need this where single placeholders are used, e.g. 'Message %d' is fine
+// equally where a string contains only two placeholders which are used to wrap text
+// in a url you again do not need to specify an order e.g., 'Click %sHERE%s' is fine
+
+$this-&gt;lang += array(
+	'ACP_PERMISSIONS_EXPLAIN'	=&gt; '
+		&lt;p&gt;Permissions are highly granular and grouped into four major sections, which are:&lt;/p&gt;
+
+		&lt;h2&gt;Global Permissions&lt;/h2&gt;
+		&lt;p&gt;These are used to control access on a global level and apply to the entire bulletin board. They are further divided into Users Permissions, Groups Permissions, Administrators and Global Moderators.&lt;/p&gt;
+
+		&lt;h2&gt;Forum Based Permissions&lt;/h2&gt;
+		&lt;p&gt;These are used to control access on a per forum basis. They are further divided into Forum Permissions, Forum Moderators, Users Forum Permissions and Groups Forum Permissions.&lt;/p&gt;
+
+		&lt;h2&gt;Permission Roles&lt;/h2&gt;
+		&lt;p&gt;These are used to create different sets of permissions for the different permission types later being able to be assigned on a role-based basis. The default roles should cover the administration of bulletin boards large and small, though within each of the four divisions, you can add/edit/delete roles as you see fit.&lt;/p&gt;
+
+		&lt;h2&gt;Permission Mask&lt;/h2&gt;
+		&lt;p&gt;These are used to view the effective permissions assigned to Users, Moderators (Local and Global), Administrators or Forums.&lt;/p&gt;
+	
+		&lt;br /&gt;
+
+		&lt;p&gt;For further information on setting up and managing permissions on your phpBB3 forum, please see &lt;a href=&quot;<A HREF="http://www.phpbb.com/support/documentation/3.0/quickstart/quick_permissions.html">http://www.phpbb.com/support/documentation/3.0/quickstart/quick_permissions.html</A>&quot;&gt;Chapter 1.5 of our Quick Start Guide&lt;/a&gt;.&lt;/p&gt;
+	',
+
+	'ACL_NEVER'				=&gt; 'Never',
+	'ACL_SET'				=&gt; 'Setting Permissions',
+	'ACL_SET_EXPLAIN'		=&gt; 'Permissions are based on a simple YES/NO system. Setting an option to NEVER for a user or usergroup overrides any other value assigned to it. If you do not wish to assign a value for an option for this user or group select NO. If values are assigned for this option elsewhere they will be used in preference, else NEVER is assumed. All objects marked (with the checkbox in front of them) will copy the permission set you defined.',
+	'ACL_SETTING'			=&gt; 'Setting',
+
+	'ACL_TYPE_A_'			=&gt; 'Administrative Permissions',
+	'ACL_TYPE_F_'			=&gt; 'Forum Permissions',
+	'ACL_TYPE_M_'			=&gt; 'Moderative Permissions',
+	'ACL_TYPE_U_'			=&gt; 'User Permissions',
+
+	'ACL_TYPE_GLOBAL_A_'	=&gt; 'Administrative Permissions',
+	'ACL_TYPE_GLOBAL_U_'	=&gt; 'User Permissions',
+	'ACL_TYPE_GLOBAL_M_'	=&gt; 'Global Moderator Permissions',
+	'ACL_TYPE_LOCAL_M_'		=&gt; 'Forum Moderator Permissions',
+	'ACL_TYPE_LOCAL_F_'		=&gt; 'Forum Permissions',
+	
+	'ACL_NO'				=&gt; 'No',
+	'ACL_VIEW'				=&gt; 'Viewing Permissions',
+	'ACL_VIEW_EXPLAIN'		=&gt; 'Here you can see the effective permissions the user/group is having. A red square indicates that the user/group does not have the permission, a green square indicates that the user/group does have the permission.',
+	'ACL_YES'				=&gt; 'Yes',
+
+	'ACP_ADMINISTRATORS_EXPLAIN'				=&gt; 'Here you can assign administrator rights to users or groups. All users with admin permissions can view the administration panel.',
+	'ACP_FORUM_MODERATORS_EXPLAIN'				=&gt; 'Here you can assign users and groups as forum moderators. To assign users access to forums, to define global moderative rights or administrators please use the appropriate page.',
+	'ACP_FORUM_PERMISSIONS_EXPLAIN'				=&gt; 'Here you can alter which users and groups can access which forums. To assign moderators or define administrators please use the appropriate page.',
+	'ACP_GLOBAL_MODERATORS_EXPLAIN'				=&gt; 'Here you can assign global moderator rights to users or groups. These moderators are like ordinary moderators except they have access to every forum on your board.',
+	'ACP_GROUPS_FORUM_PERMISSIONS_EXPLAIN'		=&gt; 'Here you can assign forum permissions to groups.',
+	'ACP_GROUPS_PERMISSIONS_EXPLAIN'			=&gt; 'Here you can assign global permissions to groups - user permissions, global moderator permissions and admin permissions. User permissions include capabilities such as the use of avatars, sending private messages, etc. Global moderator permissions are blabla, administrative permissions blabla. Individual users permissions should only be changed in rare occassions, the preferred method is putting users in groups and assigning the groups permissions.',
+	'ACP_ADMIN_ROLES_EXPLAIN'					=&gt; 'Here you are able to manage the roles for administrative permissions. Roles are effective permissions, if you change a role the items having this role assigned will change it\'s permissions too.',
+	'ACP_FORUM_ROLES_EXPLAIN'					=&gt; 'Here you are able to manage the roles for forum permissions. Roles are effective permissions, if you change a role the items having this role assigned will change it\'s permissions too.',
+	'ACP_MOD_ROLES_EXPLAIN'						=&gt; 'Here you are able to manage the roles for moderative permissions. Roles are effective permissions, if you change a role the items having this role assigned will change it\'s permissions too.',
+	'ACP_USER_ROLES_EXPLAIN'					=&gt; 'Here you are able to manage the roles for user permissions. Roles are effective permissions, if you change a role the items having this role assigned will change it\'s permissions too.',
+	'ACP_USERS_FORUM_PERMISSIONS_EXPLAIN'		=&gt; 'Here you can assign forum permissions to users.',
+	'ACP_USERS_PERMISSIONS_EXPLAIN'				=&gt; 'Here you can assign global permissions to users - user permissions, global moderator permissions and admin permissions. User permissions include capabilities such as the use of avatars, sending private messages, etc. Global moderator permissions are blabla, administrative permissions blabla. To alter these settings for large numbers of users the Group permissions system is the prefered method. Users permissions should only be changed in rare occassions, the preferred method is putting users in groups and assigning the groups permissions.',
+	'ACP_VIEW_ADMIN_PERMISSIONS_EXPLAIN'		=&gt; 'Here you can view the effective administrative permissions assigned to the selected users/groups',
+	'ACP_VIEW_GLOBAL_MOD_PERMISSIONS_EXPLAIN'	=&gt; 'Here you can view the global moderative permissions assigned to the selected users/groups',
+	'ACP_VIEW_FORUM_PERMISSIONS_EXPLAIN'		=&gt; 'Here you can view the forum permissions assigned to the selected users/groups and forums',
+	'ACP_VIEW_FORUM_MOD_PERMISSIONS_EXPLAIN'	=&gt; 'Here you can view the forum moderator permissions assigned to the selected users/groups and forums',
+	'ACP_VIEW_USER_PERMISSIONS_EXPLAIN'			=&gt; 'Here you can view the effective user permissions assigned to the selected users/groups',
+
+	'ADD_GROUPS'				=&gt; 'Add Groups',
+	'ADD_PERMISSIONS'			=&gt; 'Add Permissions',
+	'ADD_USERS'					=&gt; 'Add Users',
+	'ALL_GROUPS'				=&gt; 'Select all groups',
+	'ALL_NEVER'					=&gt; 'All Never',
+	'ALL_NO'					=&gt; 'All No',
+	'ALL_USERS'					=&gt; 'Select all users',
+	'ALL_YES'					=&gt; 'All Yes',
+	'APPLY_ALL_PERMISSIONS'		=&gt; 'Apply all Permissions',
+	'APPLY_PERMISSIONS'			=&gt; 'Apply Permissions',
+	'APPLY_PERMISSIONS_EXPLAIN'	=&gt; 'The Permissions and Role defined for this item will only be applied to this item and all checked items.',
+	'AUTH_UPDATED'				=&gt; 'Permissions have been updated',
+
+	'CREATE_ROLE'				=&gt; 'Create Role',
+	'CREATE_ROLE_FROM'			=&gt; 'Use settings from...',
+	'CUSTOM'					=&gt; 'Custom...',
+
+	'DEFAULT'					=&gt; 'Default',
+	'DELETE_ROLE'				=&gt; 'Delete role',
+	'DELETE_ROLE_CONFIRM'		=&gt; 'Are you sure you want to remove this role? Items having this role assigned will &lt;strong&gt;not&lt;/strong&gt; loosing their permission settings.',
+	'DISPLAY_ROLE_ITEMS'		=&gt; 'View Items using this role',
+
+	'EDIT_PERMISSIONS'			=&gt; 'Edit Permissions',
+	'EDIT_ROLE'					=&gt; 'Edit Role',
+
+	'GROUPS_NOT_ASSIGNED'		=&gt; 'No group assigned to this role',
+
+	'LOOK_UP_FORUMS_EXPLAIN'	=&gt; 'You are able to select more than one forum',
+	'LOOK_UP_GROUP'				=&gt; 'Look up Usergroup',
+	'LOOK_UP_USER'				=&gt; 'Look up User',
+
+	'MANAGE_GROUPS'		=&gt; 'Manage Groups',
+	'MANAGE_USERS'		=&gt; 'Manage Users',
+
+	'NO_AUTH_SETTING_FOUND'		=&gt; 'Permission settings not defined.',
+	'NO_ROLE_ASSIGNED'			=&gt; 'No role assigned...',
+	'NO_ROLE_ASSIGNED_EXPLAIN'	=&gt; 'Setting to this role does not change permissions on the right. If you want to unset/remove all permissions you should use the &quot;All No&quot; link.',
+	'NO_ROLE_AVAILABLE'			=&gt; 'No role available',
+	'NO_ROLE_NAME_SPECIFIED'	=&gt; 'Please give the role a name.',
+	'NO_ROLE_SELECTED'			=&gt; 'Role could not be found.',
+	'NO_USER_GROUP_SELECTED'	=&gt; 'You haven\'t selected any user or group.',
+
+	'ONLY_FORUM_DEFINED'	=&gt; 'You only defined forums in your selection. Please also select at least one user or one group.',
+
+	'PERMISSION_APPLIED_TO_ALL'		=&gt; 'Permissions and Role will also be applied to all checked objects',
+	'PLUS_SUBFORUMS'				=&gt; '+Subforums',
+
+	'REMOVE_PERMISSIONS'			=&gt; 'Remove Permissions',
+	'REMOVE_ROLE'					=&gt; 'Remove Role',
+	'ROLE'							=&gt; 'Role',
+	'ROLE_ADD_SUCCESS'				=&gt; 'Role successfully added.',
+	'ROLE_ASSIGNED_TO'				=&gt; 'Users/Groups assigned to %s',
+	'ROLE_DELETED'					=&gt; 'Role successfully removed.',
+	'ROLE_DESCRIPTION'				=&gt; 'Role Description',
+
+	'ROLE_DESCRIPTION_ADMIN_FORUM'		=&gt; 'Can access the forum management and forum permission settings.',
+	'ROLE_DESCRIPTION_ADMIN_FULL'		=&gt; 'Has access to all admin functions of this forum.&lt;br /&gt;Not recommended.',
+	'ROLE_DESCRIPTION_ADMIN_STANDARD'	=&gt; 'Has access to most admin features but is not allowed to use server or system related tools.',
+	'ROLE_DESCRIPTION_ADMIN_USERGROUP'	=&gt; 'Can manage groups and users: Can change permissions, settings, manage bans, and manage ranks.',
+	'ROLE_DESCRIPTION_FORUM_BOT'		=&gt; 'This role is recommended for bots and search spiders.',
+	'ROLE_DESCRIPTION_FORUM_FULL'		=&gt; 'Can use all forum features, including posting of announcements and stickies. Can also ignore the flood limit.&lt;br /&gt;Not recommended for normal users.',
+	'ROLE_DESCRIPTION_FORUM_LIMITED'	=&gt; 'Can use some forum features, but cannot attach files or use post icons.',
+	'ROLE_DESCRIPTION_FORUM_NOACCESS'	=&gt; 'Can neither see nor access the forum.',
+	'ROLE_DESCRIPTION_FORUM_ONQUEUE'	=&gt; 'Can use most forum features including attachments, but posts and topics need to be approved by a moderator.',
+	'ROLE_DESCRIPTION_FORUM_POLLS'		=&gt; 'Like Standard Access but can also create polls.',
+	'ROLE_DESCRIPTION_FORUM_READONLY'	=&gt; 'Can read the forum, but cannot create new topics or reply to posts.',
+	'ROLE_DESCRIPTION_FORUM_STANDARD'	=&gt; 'Can use most forum features including attachments, but cannot lock or delete own topics, and cannot create polls.',
+	'ROLE_DESCRIPTION_MOD_FULL'			=&gt; 'Can use all moderating features, including banning.',
+	'ROLE_DESCRIPTION_MOD_QUEUE'		=&gt; 'Can use the Moderation Queue to validate and edit posts, but nothing else.',
+	'ROLE_DESCRIPTION_MOD_SIMPLE'		=&gt; 'Can only use basic topic actions. Cannot send warnings or use moderation queue.',
+	'ROLE_DESCRIPTION_MOD_STANDARD'		=&gt; 'Can use most moderating tools, but cannot ban users or change the post author.',
+	'ROLE_DESCRIPTION_USER_FULL'		=&gt; 'Can use all available forum features for users, including changing the user name or ignoring the flood limit.&lt;br /&gt;Not recommended.',
+	'ROLE_DESCRIPTION_USER_LIMITED'		=&gt; 'Can access some of the user features. Attachments, e-mails, or instant messages are not allowed.',
+	'ROLE_DESCRIPTION_USER_NOAVATAR'	=&gt; 'Has a limited feature set and is not allowed to use the Avatar feature.',
+	'ROLE_DESCRIPTION_USER_NOPM'		=&gt; 'Has a limited feature set, and is not allowed to use Private Messages.',
+	'ROLE_DESCRIPTION_USER_STANDARD'	=&gt; 'Can access most but not all user features. Cannot change user name or ignore the flood limit, for instance.',
+	
+	'ROLE_DESCRIPTION_EXPLAIN'		=&gt; 'You are able to enter a short explanation of what the role is doing or for what it is meant for. The text you enter here will be displayed within the permissions screens too.',
+	'ROLE_DETAILS'					=&gt; 'Role Details',
+	'ROLE_EDIT_SUCCESS'				=&gt; 'Role successfully edited.',
+	'ROLE_NAME'						=&gt; 'Role Name',
+	'ROLE_NAME_ALREADY_EXIST'		=&gt; 'A role named &lt;strong&gt;%s&lt;/strong&gt; already exist for the specified permission type.',
+	'ROLE_NOT_ASSIGNED'				=&gt; 'Role has not been assigned yet.',
+
+	'SELECTED_FORUM_NOT_EXIST'		=&gt; 'The selected forum(s) do not exist',
+	'SELECTED_GROUP_NOT_EXIST'		=&gt; 'The selected group(s) do not exist',
+	'SELECTED_USER_NOT_EXIST'		=&gt; 'The selected user(s) do not exist',
+	'SELECT_FORUM_SUBFORUM_EXPLAIN'	=&gt; 'The forum you select here will include all subforums into the selection',
+	'SELECT_ROLE'					=&gt; 'Select role...',
+	'SELECT_TYPE'					=&gt; 'Select type',
+	'SET_PERMISSIONS'				=&gt; 'Set permissions',
+	'SET_ROLE_PERMISSIONS'			=&gt; 'Set role permissions',
+	'SET_USERS_PERMISSIONS'			=&gt; 'Set users permissions',
+	'SET_USERS_FORUM_PERMISSIONS'	=&gt; 'Set users forum permissions',
+
+	'TRACE_DEFAULT'					=&gt; 'By default every permission is NO (unset). So the permission can be overwritten by other settings.',
+	'TRACE_FOR'						=&gt; 'Trace for',
+	'TRACE_GLOBAL_SETTING'			=&gt; '%s (global)',
+	'TRACE_GROUP_NEVER_TOTAL_NEVER'	=&gt; 'This group\'s permission is set to NEVER like the total result so the old result is kept.',
+	'TRACE_GROUP_NEVER_TOTAL_NO'	=&gt; 'This group\'s permission is set to NEVER which becomes the new total value because it wasn\'t set yet (set to NO).',
+	'TRACE_GROUP_NEVER_TOTAL_YES'	=&gt; 'This group\'s permission is set to NEVER which overwrites the total YES to a NEVER for this user.',
+	'TRACE_GROUP_NO'				=&gt; 'The permission is NO for this group so the old total value is kept.',
+	'TRACE_GROUP_YES_TOTAL_NEVER'	=&gt; 'This group\'s permission is set to YES but the total NEVER cannot be overwritten.',
+	'TRACE_GROUP_YES_TOTAL_NO'		=&gt; 'This group\'s permission is set to YES which becomes the new total value because it wasn\'t set yet (set to NO).',
+	'TRACE_GROUP_YES_TOTAL_YES'		=&gt; 'This group\'s permission is set to YES and the total permission is already set to YES, so the total result is kept.',
+	'TRACE_PERMISSION'				=&gt; 'Trace permission - %s',
+	'TRACE_SETTING'					=&gt; 'Trace setting',
+
+	'TRACE_USER_GLOBAL_YES_TOTAL_YES'		=&gt; 'The forum independent user permission evaluates to YES but the total permission is already set to YES, so the the total result is kept. %sTrace global permission%s',
+	'TRACE_USER_GLOBAL_YES_TOTAL_NEVER'		=&gt; 'The forum independent user permission evaluates to YES which overwrites the current local result NEVER. %sTrace global permission%s',
+	'TRACE_USER_GLOBAL_NEVER_TOTAL_KEPT'	=&gt; 'The forum independent user permission evaluates to NEVER which doesn\'t influence the local permission. %sTrace global permission%s',
+	'TRACE_USER_FOUNDER'			=&gt; 'The user has the founder type set, therefore admin permissions are set to YES by default.',
+	'TRACE_USER_KEPT'				=&gt; 'The user permission is NO so the old total value is kept.',
+	'TRACE_USER_NEVER_TOTAL_NEVER'	=&gt; 'The user permission is set to NEVER and the total value is set to NEVER, so nothing is changed.',
+	'TRACE_USER_NEVER_TOTAL_NO'		=&gt; 'The user permission is set to NEVER which becomes the total value because it was set to NO.',
+	'TRACE_USER_NEVER_TOTAL_YES'	=&gt; 'The user permission is set to NEVER and overwrites the previous YES.',
+	'TRACE_USER_NO_TOTAL_NO'		=&gt; 'The user permission is NO and the total value was set to NO so it defaults to NEVER.',
+	'TRACE_USER_YES_TOTAL_NEVER'	=&gt; 'The user permission is set to YES but the total NEVER cannot be overwritten.',
+	'TRACE_USER_YES_TOTAL_NO'		=&gt; 'The user permission is set to YES which becomes the total value because it was set to NO.',
+	'TRACE_USER_YES_TOTAL_YES'		=&gt; 'The user permission is set to YES and the total value is set to YES, so nothing is changed.',
+	'TRACE_WHO'						=&gt; 'Who',
+	'TRACE_TOTAL'					=&gt; 'Total',
+
+	'USERS_NOT_ASSIGNED'			=&gt; 'No user assigned to this role',
+	'USER_IS_MEMBER_OF_DEFAULT'		=&gt; 'is a member of the following default groups',
+	'USER_IS_MEMBER_OF_CUSTOM'		=&gt; 'is a member of the following custom groups',
+
+	'VIEW_ASSIGNED_ITEMS'	=&gt; 'View assigned items',
+	'VIEW_PERMISSIONS'		=&gt; 'View permissions',
+
+	'WRONG_PERMISSION_TYPE'	=&gt; 'Wrong permission type selected',
+);
+
+?&gt;
\ No newline at end of file

Added: cms/trunk/modules/forums/language/admin_permissions_phpbb.php
===================================================================
--- cms/trunk/modules/forums/language/admin_permissions_phpbb.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/language/admin_permissions_phpbb.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,215 @@
+&lt;?php
+/** 
+*
+* acp_permissions (phpBB Permission Set) [English]
+*
+* @package language
+* @version $Id: permissions_phpbb.php,v 1.13 2006/07/09 16:22:58 acydburn Exp $
+* @copyright (c) 2005 phpBB Group 
+* @license <A HREF="http://opensource.org/licenses/gpl-license.php">http://opensource.org/licenses/gpl-license.php</A> GNU Public License 
+*
+*/
+
+// DEVELOPERS PLEASE NOTE 
+//
+// Placeholders can now contain order information, e.g. instead of
+// 'Page %s of %s' you can (and should) write 'Page %1$s of %2$s', this allows
+// translators to re-order the output of data while ensuring it remains correct
+//
+// You do not need this where single placeholders are used, e.g. 'Message %d' is fine
+// equally where a string contains only two placeholders which are used to wrap text
+// in a url you again do not need to specify an order e.g., 'Click %sHERE%s' is fine
+
+/*
+	MODDERS PLEASE NOTE
+	
+	Please add your permission settings this way:
+
+	// Adding new category
+	$lang['permission_cats']['bugs'] = 'Bugs';
+
+	// Adding new permission set
+	$lang['permission_sets']['bug_'] = 'Bug Permissions';
+
+	// Adding the permissions
+	$lang = array_merge($lang, array(
+		'acl_bug_view'		=&gt; array('lang' =&gt; 'Can view bug reports', 'cat' =&gt; 'bugs'),
+		'acl_bug_post'		=&gt; array('lang' =&gt; 'Can post bugs', 'cat' =&gt; 'post'), // Using a phpBB category here
+	));
+
+	TODO:
+	You are able to put your permission sets into a seperate file too by
+	prefixing it with permissions_ and putting it into the acp language folder.
+*/
+
+// Define categories and permission types
+$this-&gt;lang += array(
+	'permission_cat'	=&gt; array(
+		'actions'		=&gt; 'Actions',
+		'content'		=&gt; 'Content',
+		'forums'		=&gt; 'Forums',
+		'misc'			=&gt; 'Misc',
+		'permissions'	=&gt; 'Permissions',
+		'pm'			=&gt; 'Private Messages',
+		'polls'			=&gt; 'Polls',
+		'post'			=&gt; 'Post',
+		'post_actions'	=&gt; 'Post Actions',
+		'posting'		=&gt; 'Posting',
+		'profile'		=&gt; 'Profile',
+		'settings'		=&gt; 'Settings',
+		'topic_actions'	=&gt; 'Topic Actions',
+		'user_group'	=&gt; 'Users &amp; Groups',
+	),
+
+	'permission_type'	=&gt; array(
+		'u_'			=&gt; 'User Permissions',
+		'a_'			=&gt; 'Admin Permissions',
+		'm_'			=&gt; 'Moderator Permissions',
+		'f_'			=&gt; 'Forum Permissions',
+	),
+);
+
+// User Permissions
+$this-&gt;lang += array(
+	'acl_u_viewprofile'	=&gt; array('lang' =&gt; 'Can view profiles', 'cat' =&gt; 'profile'),
+	'acl_u_chgname'		=&gt; array('lang' =&gt; 'Can change username', 'cat' =&gt; 'profile'),
+	'acl_u_chgpasswd'	=&gt; array('lang' =&gt; 'Can change password', 'cat' =&gt; 'profile'),
+	'acl_u_chgemail'	=&gt; array('lang' =&gt; 'Can change email address', 'cat' =&gt; 'profile'),
+	'acl_u_chgavatar'	=&gt; array('lang' =&gt; 'Can change avatar', 'cat' =&gt; 'profile'),
+	'acl_u_chggrp'		=&gt; array('lang' =&gt; 'Can change default usergroup', 'cat' =&gt; 'profile'),
+
+	'acl_u_attach'		=&gt; array('lang' =&gt; 'Can attach files', 'cat' =&gt; 'post'),
+	'acl_u_download'	=&gt; array('lang' =&gt; 'Can download files', 'cat' =&gt; 'post'),
+	'acl_u_savedrafts'	=&gt; array('lang' =&gt; 'Can save drafts', 'cat' =&gt; 'post'),
+	'acl_u_chgcensors'	=&gt; array('lang' =&gt; 'Can disable word censors', 'cat' =&gt; 'post'),
+	'acl_u_sig'			=&gt; array('lang' =&gt; 'Can use signature', 'cat' =&gt; 'post'),
+
+	'acl_u_sendpm'		=&gt; array('lang' =&gt; 'Can send private messages', 'cat' =&gt; 'pm'),
+	'acl_u_masspm'		=&gt; array('lang' =&gt; 'Can send pm to multiple users and groups', 'cat' =&gt; 'pm'),
+	'acl_u_readpm'		=&gt; array('lang' =&gt; 'Can read private messages', 'cat' =&gt; 'pm'),
+	'acl_u_pm_edit'		=&gt; array('lang' =&gt; 'Can edit own private messages', 'cat' =&gt; 'pm'),
+	'acl_u_pm_delete'	=&gt; array('lang' =&gt; 'Can remove private messages from own folder', 'cat' =&gt; 'pm'),
+	'acl_u_pm_forward'	=&gt; array('lang' =&gt; 'Can forward private messages', 'cat' =&gt; 'pm'),
+	'acl_u_pm_emailpm'	=&gt; array('lang' =&gt; 'Can email private messages', 'cat' =&gt; 'pm'),
+	'acl_u_pm_printpm'	=&gt; array('lang' =&gt; 'Can print private messages', 'cat' =&gt; 'pm'),
+	'acl_u_pm_attach'	=&gt; array('lang' =&gt; 'Can attach files in private messages', 'cat' =&gt; 'pm'),
+	'acl_u_pm_download'	=&gt; array('lang' =&gt; 'Can download files in private messages', 'cat' =&gt; 'pm'),
+	'acl_u_pm_bbcode'	=&gt; array('lang' =&gt; 'Can post BBCode in private messages', 'cat' =&gt; 'pm'),
+	'acl_u_pm_smilies'	=&gt; array('lang' =&gt; 'Can post smilies in private messages', 'cat' =&gt; 'pm'),
+	'acl_u_pm_img'		=&gt; array('lang' =&gt; 'Can post images in private messages', 'cat' =&gt; 'pm'),
+	'acl_u_pm_flash'	=&gt; array('lang' =&gt; 'Can post Flash in private messages', 'cat' =&gt; 'pm'),
+
+	'acl_u_sendemail'	=&gt; array('lang' =&gt; 'Can send emails', 'cat' =&gt; 'misc'),
+	'acl_u_sendim'		=&gt; array('lang' =&gt; 'Can send instant messages', 'cat' =&gt; 'misc'),
+	'acl_u_ignoreflood'	=&gt; array('lang' =&gt; 'Can ignore flood limit', 'cat' =&gt; 'misc'),
+	'acl_u_hideonline'	=&gt; array('lang' =&gt; 'Can hide online status', 'cat' =&gt; 'misc'),
+	'acl_u_viewonline'	=&gt; array('lang' =&gt; 'Can view all online', 'cat' =&gt; 'misc'),
+	'acl_u_search'		=&gt; array('lang' =&gt; 'Can search board', 'cat' =&gt; 'misc'),
+);
+
+// Forum Permissions
+$this-&gt;lang += array(
+	'acl_f_list'		=&gt; array('lang' =&gt; 'Can see forum', 'cat' =&gt; 'post'),
+	'acl_f_read'		=&gt; array('lang' =&gt; 'Can read forum', 'cat' =&gt; 'post'),
+	'acl_f_post'		=&gt; array('lang' =&gt; 'Can post in forum', 'cat' =&gt; 'post'),
+	'acl_f_announce'	=&gt; array('lang' =&gt; 'Can post announcements', 'cat' =&gt; 'post'),
+	'acl_f_sticky'		=&gt; array('lang' =&gt; 'Can post stickies', 'cat' =&gt; 'post'),
+	'acl_f_reply'		=&gt; array('lang' =&gt; 'Can reply to posts', 'cat' =&gt; 'post'),
+	'acl_f_icons'		=&gt; array('lang' =&gt; 'Can use post icons', 'cat' =&gt; 'post'),
+
+	'acl_f_poll'		=&gt; array('lang' =&gt; 'Can create polls', 'cat' =&gt; 'polls'),
+	'acl_f_vote'		=&gt; array('lang' =&gt; 'Can vote in polls', 'cat' =&gt; 'polls'),
+	'acl_f_votechg'		=&gt; array('lang' =&gt; 'Can change existing vote', 'cat' =&gt; 'polls'),
+
+	'acl_f_attach'		=&gt; array('lang' =&gt; 'Can attach files', 'cat' =&gt; 'content'),
+	'acl_f_download'	=&gt; array('lang' =&gt; 'Can download files', 'cat' =&gt; 'content'),
+	'acl_f_sigs'		=&gt; array('lang' =&gt; 'Can use signatures', 'cat' =&gt; 'content'),
+	'acl_f_bbcode'		=&gt; array('lang' =&gt; 'Can post BBCode', 'cat' =&gt; 'content'),
+	'acl_f_smilies'		=&gt; array('lang' =&gt; 'Can post smilies', 'cat' =&gt; 'content'),
+	'acl_f_img'			=&gt; array('lang' =&gt; 'Can post images', 'cat' =&gt; 'content'),
+	'acl_f_flash'		=&gt; array('lang' =&gt; 'Can post Flash', 'cat' =&gt; 'content'),
+
+	'acl_f_edit'		=&gt; array('lang' =&gt; 'Can edit own posts', 'cat' =&gt; 'actions'),
+	'acl_f_delete'		=&gt; array('lang' =&gt; 'Can delete own posts', 'cat' =&gt; 'actions'),
+	'acl_f_user_lock'	=&gt; array('lang' =&gt; 'Can lock own topics', 'cat' =&gt; 'actions'),
+	'acl_f_bump'		=&gt; array('lang' =&gt; 'Can bump topics', 'cat' =&gt; 'actions'),
+	'acl_f_report'		=&gt; array('lang' =&gt; 'Can report posts', 'cat' =&gt; 'actions'),
+	'acl_f_subscribe'	=&gt; array('lang' =&gt; 'Can subscribe forum', 'cat' =&gt; 'actions'),
+	'acl_f_print'		=&gt; array('lang' =&gt; 'Can print topics', 'cat' =&gt; 'actions'),
+	'acl_f_email'		=&gt; array('lang' =&gt; 'Can email topics', 'cat' =&gt; 'actions'),
+
+	'acl_f_search'		=&gt; array('lang' =&gt; 'Can search the forum', 'cat' =&gt; 'misc'),
+	'acl_f_ignoreflood' =&gt; array('lang' =&gt; 'Can ignore flood limit', 'cat' =&gt; 'misc'),
+	'acl_f_postcount'	=&gt; array('lang' =&gt; 'Increment post counter', 'cat' =&gt; 'misc'),
+	'acl_f_noapprove'	=&gt; array('lang' =&gt; 'Can post without approval', 'cat' =&gt; 'misc'),
+);
+
+// Moderator Permissions
+$this-&gt;lang += array(
+	'acl_m_edit'		=&gt; array('lang' =&gt; 'Can edit posts', 'cat' =&gt; 'post_actions'),
+	'acl_m_delete'		=&gt; array('lang' =&gt; 'Can delete posts', 'cat' =&gt; 'post_actions'),
+	'acl_m_approve'		=&gt; array('lang' =&gt; 'Can approve posts', 'cat' =&gt; 'post_actions'),
+	'acl_m_report'		=&gt; array('lang' =&gt; 'Can close and delete reports', 'cat' =&gt; 'post_actions'),
+	'acl_m_chgposter'	=&gt; array('lang' =&gt; 'Can change post author', 'cat' =&gt; 'post_actions'),
+
+	'acl_m_move'	=&gt; array('lang' =&gt; 'Can move topics', 'cat' =&gt; 'topic_actions'),
+	'acl_m_lock'	=&gt; array('lang' =&gt; 'Can lock topics', 'cat' =&gt; 'topic_actions'),
+	'acl_m_split'	=&gt; array('lang' =&gt; 'Can split topics', 'cat' =&gt; 'topic_actions'),
+	'acl_m_merge'	=&gt; array('lang' =&gt; 'Can merge topics', 'cat' =&gt; 'topic_actions'),
+
+	'acl_m_info'	=&gt; array('lang' =&gt; 'Can view post details', 'cat' =&gt; 'misc'),
+	'acl_m_warn'	=&gt; array('lang' =&gt; 'Can issue warnings', 'cat' =&gt; 'misc'),
+	'acl_m_ban'		=&gt; array('lang' =&gt; 'Can manage bans', 'cat' =&gt; 'misc'), // This moderator setting is only global (and not local)
+);
+
+// Admin Permissions
+$this-&gt;lang += array(
+	'acl_a_board'		=&gt; array('lang' =&gt; 'Can alter board settings', 'cat' =&gt; 'settings'),
+	'acl_a_server'		=&gt; array('lang' =&gt; 'Can alter server/communication settings', 'cat' =&gt; 'settings'),
+	'acl_a_jabber'		=&gt; array('lang' =&gt; 'Can alter jabber settings', 'cat' =&gt; 'settings'),
+	'acl_a_phpinfo'		=&gt; array('lang' =&gt; 'Can view php settings', 'cat' =&gt; 'settings'),
+
+	'acl_a_forum'		=&gt; array('lang' =&gt; 'Can manage forums', 'cat' =&gt; 'forums'),
+	'acl_a_forumadd'	=&gt; array('lang' =&gt; 'Can add new forums', 'cat' =&gt; 'forums'),
+	'acl_a_forumdel'	=&gt; array('lang' =&gt; 'Can delete forums', 'cat' =&gt; 'forums'),
+	'acl_a_prune'		=&gt; array('lang' =&gt; 'Can prune forums', 'cat' =&gt; 'forums'),
+
+	'acl_a_icons'		=&gt; array('lang' =&gt; 'Can alter topic icons and smilies', 'cat' =&gt; 'posting'),
+	'acl_a_words'		=&gt; array('lang' =&gt; 'Can alter word censors', 'cat' =&gt; 'posting'),
+	'acl_a_bbcode'		=&gt; array('lang' =&gt; 'Can define BBCode tags', 'cat' =&gt; 'posting'),
+	'acl_a_attach'		=&gt; array('lang' =&gt; 'Can alter attachment related settings', 'cat' =&gt; 'posting'),
+
+	'acl_a_user'		=&gt; array('lang' =&gt; 'Can manage users', 'cat' =&gt; 'user_group'),
+	'acl_a_userdel'		=&gt; array('lang' =&gt; 'Can delete/prune users', 'cat' =&gt; 'user_group'),
+	'acl_a_group'		=&gt; array('lang' =&gt; 'Can manage groups', 'cat' =&gt; 'user_group'),
+	'acl_a_groupadd'	=&gt; array('lang' =&gt; 'Can add new groups', 'cat' =&gt; 'user_group'),
+	'acl_a_groupdel'	=&gt; array('lang' =&gt; 'Can delete groups', 'cat' =&gt; 'user_group'),
+	'acl_a_ranks'		=&gt; array('lang' =&gt; 'Can manage ranks', 'cat' =&gt; 'user_group'),
+	'acl_a_profile'		=&gt; array('lang' =&gt; 'Can manage custom profile fields', 'cat' =&gt; 'user_group'),
+	'acl_a_names'		=&gt; array('lang' =&gt; 'Can manage disallowed names', 'cat' =&gt; 'user_group'),
+	'acl_a_ban'			=&gt; array('lang' =&gt; 'Can manage bans', 'cat' =&gt; 'user_group'),
+
+	'acl_a_viewauth'	=&gt; array('lang' =&gt; 'Can view permission masks', 'cat' =&gt; 'permissions'),
+	'acl_a_fauth'		=&gt; array('lang' =&gt; 'Can alter forum permissions', 'cat' =&gt; 'permissions'),
+	'acl_a_mauth'		=&gt; array('lang' =&gt; 'Can alter moderator permissions', 'cat' =&gt; 'permissions'),
+	'acl_a_aauth'		=&gt; array('lang' =&gt; 'Can alter admin permissions', 'cat' =&gt; 'permissions'),
+	'acl_a_uauth'		=&gt; array('lang' =&gt; 'Can alter user permissions', 'cat' =&gt; 'permissions'),
+	'acl_a_authgroups'	=&gt; array('lang' =&gt; 'Can alter permissions for groups', 'cat' =&gt; 'permissions'),
+	'acl_a_authusers'	=&gt; array('lang' =&gt; 'Can alter permissions for users', 'cat' =&gt; 'permissions'),
+	'acl_a_roles'		=&gt; array('lang' =&gt; 'Can manage roles', 'cat' =&gt; 'permissions'),
+	'acl_a_switchperm'	=&gt; array('lang' =&gt; 'Can use others permissions', 'cat' =&gt; 'permissions'),
+
+	'acl_a_styles'		=&gt; array('lang' =&gt; 'Can manage styles', 'cat' =&gt; 'misc'),
+	'acl_a_viewlogs'	=&gt; array('lang' =&gt; 'Can view logs', 'cat' =&gt; 'misc'),
+	'acl_a_clearlogs'	=&gt; array('lang' =&gt; 'Can clear logs', 'cat' =&gt; 'misc'),
+	'acl_a_modules'		=&gt; array('lang' =&gt; 'Can manage modules', 'cat' =&gt; 'misc'),
+	'acl_a_language'	=&gt; array('lang' =&gt; 'Can manage language packs', 'cat' =&gt; 'misc'),
+	'acl_a_email'		=&gt; array('lang' =&gt; 'Can send mass email', 'cat' =&gt; 'misc'),
+	'acl_a_bots'		=&gt; array('lang' =&gt; 'Can manage bots', 'cat' =&gt; 'misc'),
+	'acl_a_reasons'		=&gt; array('lang' =&gt; 'Can manage report/denial reasons', 'cat' =&gt; 'misc'),
+	'acl_a_backup'		=&gt; array('lang' =&gt; 'Can backup database', 'cat' =&gt; 'misc'),
+#	'acl_a_restore'		=&gt; array('lang' =&gt; 'Can restore database', 'cat' =&gt; 'misc'),
+	'acl_a_search'		=&gt; array('lang' =&gt; 'Can manage search backends and settings', 'cat' =&gt; 'misc'),
+);
+
+?&gt;
\ No newline at end of file

Added: cms/trunk/modules/forums/language/help_bbcode.php
===================================================================
--- cms/trunk/modules/forums/language/help_bbcode.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/language/help_bbcode.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,99 @@
+&lt;?php
+// -------------------------------------------------------------
+//
+// $Id: help_bbcode.php,v 1.1 2004/02/28 21:16:15 acydburn Exp $
+//
+// FILENAME  : help_bbcode.php [ English ]
+// STARTED   : Sat Dec 16, 2000
+// COPYRIGHT : &#169; 2001, 2003 phpBB Group
+// WWW       : <A HREF="http://www.phpbb.com/">http://www.phpbb.com/</A>
+// LICENCE   : GPL vs2.0 [ see /docs/COPYING ] 
+// 
+// -------------------------------------------------------------
+
+// DEVELOPERS PLEASE NOTE 
+//
+// Placeholders can now contain order information, e.g. instead of
+// 'Page %s of %s' you can (and should) write 'Page %1$s of %2$s', this allows
+// translators to re-order the output of data while ensuring it remains correct
+//
+// You do not need this where single placeholders are used, e.g. 'Message %d' is fine
+// equally where a string contains only two placeholders which are used to wrap text
+// in a url you again do not need to specify an order e.g., 'Click %sHERE%s' is fine
+
+$this-&gt;lang['help'] = array(
+	array(
+		0 =&gt; '--',
+		1 =&gt; 'Introduction'
+	),
+	array(
+		0 =&gt; 'What is BBCode?',
+		1 =&gt; 'BBCode is a special implementation of HTML. Whether you can actually use BBCode in your posts on the forum is determined by the administrator. In addition you can disable BBCode on a per post basis via the posting form. BBCode itself is similar in style to HTML, tags are enclosed in square braces [ and ] rather than &lt; and &gt; and it offers greater control over what and how something is displayed. Depending on the template you are using you may find adding BBCode to your posts is made much easier through a clickable interface above the message area on the posting form. Even with this you may find the following guide useful.'
+	),
+	array(
+		0 =&gt; '--',
+		1 =&gt; 'Text Formatting'
+	),
+	array(
+		0 =&gt; 'How to create bold, italic and underlined text',
+		1 =&gt; 'BBCode includes tags to allow you to quickly change the basic style of your text. This is achieved in the following ways: &lt;ul&gt;&lt;li&gt;To make a piece of text bold enclose it in &lt;strong&gt;[b][/b]&lt;/strong&gt;, eg. &lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[b]&lt;/strong&gt;Hello&lt;strong&gt;[/b]&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;will become &lt;strong&gt;Hello&lt;/strong&gt;&lt;/li&gt;&lt;li&gt;For underlining use &lt;strong&gt;[u][/u]&lt;/strong&gt;, for example:&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[u]&lt;/strong&gt;Good Morning&lt;strong&gt;[/u]&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;becomes &lt;u&gt;Good Morning&lt;/u&gt;&lt;/li&gt;&lt;li&gt;To italicise text use &lt;strong&gt;[i][/i]&lt;/strong&gt;, eg.&lt;br /&gt;&lt;br /&gt;This is &lt;strong&gt;[i]&lt;/strong&gt;Great!&lt;strong&gt;[/i]&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;would give This is &lt;i&gt;Great!&lt;/i&gt;&lt;/li&gt;&lt;/ul&gt;'
+	),
+	array(
+		0 =&gt; 'How to change the text colour or size',
+		1 =&gt; 'To alter the color or size of your text the following tags can be used. Keep in mind that how the output appears will depend on the viewers browser and system: &lt;ul&gt;&lt;li&gt;Changing the colour of text is achieved by wrapping it in &lt;strong&gt;[color=][/color]&lt;/strong&gt;. You can specify either a recognised colour name (eg. red, blue, yellow, etc.) or the hexadecimal triplet alternative, eg. #FFFFFF, #000000. For example, to create red text you could use:&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[color=red]&lt;/strong&gt;Hello!&lt;strong&gt;[/color]&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;or&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[color=#FF0000]&lt;/strong&gt;Hello!&lt;strong&gt;[/color]&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;will both output &lt;span style=&quot;color:red&quot;&gt;Hello!&lt;/span&gt;&lt;/li&gt;&lt;li&gt;Changing the text size is achieved in a similar way using &lt;strong&gt;[size=][/size]&lt;/strong&gt;. This tag is dependent on the template you are using but the recommended format is a numerical value representing the text size in pixels, starting at 1 (so tiny you will not see it) through to 29 (very large!
 ). For example:&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[size=9]&lt;/strong&gt;SMALL&lt;strong&gt;[/size]&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;will generally be &lt;span style=&quot;font-size:9px;&quot;&gt;SMALL&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;whereas:&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[size=24]&lt;/strong&gt;HUGE!&lt;strong&gt;[/size]&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;will be &lt;span style=&quot;font-size:24px;&quot;&gt;HUGE!&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;'
+	),
+	array(
+		0 =&gt; 'Can I combine formatting tags?',
+		1 =&gt; 'Yes, of course you can, for example to get someones attention you may write:&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[size=18][color=red][b]&lt;/strong&gt;LOOK AT ME!&lt;strong&gt;[/b][/color][/size]&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;this would output &lt;span style=&quot;color:red;font-size:18px;&quot;&gt;&lt;strong&gt;LOOK AT ME!&lt;/strong&gt;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;We don\'t recommend you output lots of text that looks like this though! Remember it is up to you, the poster to ensure tags are closed correctly. For example the following is incorrect:&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[b][u]&lt;/strong&gt;This is wrong&lt;strong&gt;[/b][/u]&lt;/strong&gt;'
+	),
+	array(
+		0 =&gt; '--',
+		1 =&gt; 'Quoting and outputting fixed-width text'
+	),
+	array(
+		0 =&gt; 'Quoting text in replies',
+		1 =&gt; 'There are two ways you can quote text, with a reference or without.&lt;ul&gt;&lt;li&gt;When you utilise the Quote function to reply to a post on the board you should notice that the post text is added to the message window enclosed in a &lt;strong&gt;[quote=&quot;&quot;][/quote]&lt;/strong&gt; block. This method allows you to quote with a reference to a person or whatever else you choose to put! For example to quote a piece of text Mr. Blobby wrote you would enter:&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[quote=&quot;Mr. Blobby&quot;]&lt;/strong&gt;The text Mr. Blobby wrote would go here&lt;strong&gt;[/quote]&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;The resulting output will automatically add, Mr. Blobby wrote: before the actual text. Remember you &lt;strong&gt;must&lt;/strong&gt; include the parenthesis &quot;&quot; around the name you are quoting, they are not optional.&lt;/li&gt;&lt;li&gt;The second method allows you to blindly quote something. To utilise this enclose the text in &lt;strong&gt;[quote][/quote]&lt;/strong&gt; tags. When you view the message it will simply show, Quote: before the text itsel!
 f.&lt;/li&gt;&lt;/ul&gt;'
+	),
+	array(
+		0 =&gt; 'Outputting code or fixed width data',
+		1 =&gt; 'If you want to output a piece of code or in fact anything that requires a  fixed width, eg. Courier type font you should enclose the text in &lt;strong&gt;[code][/code]&lt;/strong&gt; tags, eg.&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[code]&lt;/strong&gt;echo &quot;This is some code&quot;;&lt;strong&gt;[/code]&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;All formatting used within &lt;strong&gt;[code][/code]&lt;/strong&gt; tags is retained when you later view it.'
+	),
+	array(
+		0 =&gt; '--',
+		1 =&gt; 'Generating lists'
+	),
+	array(
+		0 =&gt; 'Creating an Un-ordered list',
+		1 =&gt; 'BBCode supports two types of lists, unordered and ordered. They are essentially the same as their HTML equivalents. An unordered list ouputs each item in your list sequentially one after the other indenting each with a bullet character. To create an unordered list you use &lt;strong&gt;[list][/list]&lt;/strong&gt; and define each item within the list using &lt;strong&gt;[*]&lt;/strong&gt;. For example to list your favorite colours you could use:&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[list]&lt;/strong&gt;&lt;br /&gt;&lt;strong&gt;[*]&lt;/strong&gt;Red&lt;br /&gt;&lt;strong&gt;[*]&lt;/strong&gt;Blue&lt;br /&gt;&lt;strong&gt;[*]&lt;/strong&gt;Yellow&lt;br /&gt;&lt;strong&gt;[/list]&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;This would generate the following list:&lt;ul&gt;&lt;li&gt;Red&lt;/li&gt;&lt;li&gt;Blue&lt;/li&gt;&lt;li&gt;Yellow&lt;/li&gt;&lt;/ul&gt;'
+	),
+	array(
+		0 =&gt; 'Creating an Ordered list',
+		1 =&gt; 'The second type of list, an ordered list gives you control over what is output before each item. To create an ordered list you use &lt;strong&gt;[list=1][/list]&lt;/strong&gt; to create a numbered list or alternatively &lt;strong&gt;[list=a][/list]&lt;/strong&gt; for an alphabetical list. As with the unordered list items are specified using &lt;strong&gt;[*]&lt;/strong&gt;. For example:&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[list=1]&lt;/strong&gt;&lt;br /&gt;&lt;strong&gt;[*]&lt;/strong&gt;Go to the shops&lt;br /&gt;&lt;strong&gt;[*]&lt;/strong&gt;Buy a new computer&lt;br /&gt;&lt;strong&gt;[*]&lt;/strong&gt;Swear at computer when it crashes&lt;br /&gt;&lt;strong&gt;[/list]&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;will generate the following:&lt;ol type=&quot;1&quot;&gt;&lt;li&gt;Go to the shops&lt;/li&gt;&lt;li&gt;Buy a new computer&lt;/li&gt;&lt;li&gt;Swear at computer when it crashes&lt;/li&gt;&lt;/ol&gt;Whereas for an alphabetical list you would use:&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[list=a]&lt;/strong&gt;&lt;br /&gt;&lt;strong&gt;[*]&lt;/strong&gt;The first possible answer&lt;br /&gt;&lt;strong&gt;[*]&lt;/strong&gt;The second possible answer&lt;br /&gt;&lt;strong&gt;[*]&lt;/strong&gt;The third possible answer&lt;br /&gt;&lt;strong&gt;[/list]&lt;/stro!
 ng&gt;&lt;br /&gt;&lt;br /&gt;giving&lt;ol type=&quot;a&quot;&gt;&lt;li&gt;The first possible answer&lt;/li&gt;&lt;li&gt;The second possible answer&lt;/li&gt;&lt;li&gt;The third possible answer&lt;/li&gt;&lt;/ol&gt;'
+	),
+	array(
+		0 =&gt; '--',
+		1 =&gt; 'Creating Links'
+	),
+	array(
+		0 =&gt; 'Linking to another site',
+		1 =&gt; 'phpBB BBCode supports a number of ways of creating URIs, Uniform Resource Indicators better known as URLs.&lt;ul&gt;&lt;li&gt;The first of these uses the &lt;strong&gt;[url=][/url]&lt;/strong&gt; tag, whatever you type after the = sign will cause the contents of that tag to act as a URL. For example to link to phpBB.com you could use:&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[url=<A HREF="http://www.phpbb.com/">http://www.phpbb.com/</A>]&lt;/strong&gt;Visit phpBB!&lt;strong&gt;[/url]&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;This would generate the following link, &lt;a href=&quot;<A HREF="http://www.phpbb.com/">http://www.phpbb.com/</A>&quot; target=&quot;_blank&quot;&gt;Visit phpBB!&lt;/a&gt; You will notice the link opens in a new window so the user can continue browsing the forums if they wish.&lt;/li&gt;&lt;li&gt;If you want the URL itself displayed as the link you can do this by simply using:&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[url]&lt;/strong&gt;<A HREF="http://www.phpbb.com/&lt;strong">http://www.phpbb.com/&lt;strong</A>&gt;[/url]&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;This would generate the following link, &lt;a href=&quot;<A HREF="http://www.phpbb.com/">http://www.phpbb.com/</A>&quot; target=&quot;_blank&quot;&gt;<A HREF="http://www.phpbb.com/&lt;/a">http://www.phpbb.com/&lt;/a</A>&gt;&lt;/li&gt;&lt;li&gt;Additionally phpBB features something called &lt;i&gt;Magic!
  Links&lt;/i&gt;, this will turn any syntatically correct URL into a link without you needing to specify any tags or even the leading <A HREF="http://.">http://.</A> For example typing www.phpbb.com into your message will automatically lead to &lt;a href=&quot;<A HREF="http://www.phpbb.com/">http://www.phpbb.com/</A>&quot; target=&quot;_blank&quot;&gt;www.phpbb.com&lt;/a&gt; being output when you view the message.&lt;/li&gt;&lt;li&gt;The same thing applies equally to email addresses, you can either specify an address explicitly for example:&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[email]&lt;/strong&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/viperals-svncheckins">no.one at domain.adr</A>&lt;strong&gt;[/email]&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;which will output &lt;a href=&quot;emailto:<A HREF="https://lists.berlios.de/mailman/listinfo/viperals-svncheckins">no.one at domain.adr</A>&quot;&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/viperals-svncheckins">no.one at domain.adr</A>&lt;/a&gt; or you can just type <A HREF="https://lists.berlios.de/mailman/listinfo/viperals-svncheckins">no.one at domain.adr</A> into your message and it will be automatically converted when you view.&lt;/li&gt;&lt;/ul&gt;As with all the BBCode tags you can wrap URLs around any of the other tags such as &lt;strong&gt;[img][/img]&lt;/strong&gt; (see next entry), &lt;strong&gt;[b][/b]&lt;/strong&gt;, etc. As with the formatting tags it is up to you to ensure the correct open and close order is following, for!
  example:&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[url=<A HREF="http://www.phpbb.com/">http://www.phpbb.com/</A>][img]&lt;!
 /strong&gt;
<A HREF="http://www.phpbb.com/images/phplogo.gif&lt;strong">http://www.phpbb.com/images/phplogo.gif&lt;strong</A>&gt;[/url][/img]&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;is &lt;u&gt;not&lt;/u&gt; correct which may lead to your post being deleted so take care.'
+	),
+	array(
+		0 =&gt; '--',
+		1 =&gt; 'Showing images in posts'
+	),
+	array(
+		0 =&gt; 'Adding an image to a post',
+		1 =&gt; 'phpBB BBCode incorporates a tag for including images in your posts. Two very important things to remember when using this tag are; many users do not appreciate lots of images being shown in posts and secondly the image you display must already be available on the internet (it cannot exist only on your computer for example, unless you run a webserver!). There is currently no way of storing images locally with phpBB (all these issues are expected to  be addressed in the next release of phpBB). To display an image you must surround the URL pointing to the image with &lt;strong&gt;[img][/img]&lt;/strong&gt; tags. For example:&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[img]&lt;/strong&gt;<A HREF="http://www.phpbb.com/images/phplogo.gif&lt;strong">http://www.phpbb.com/images/phplogo.gif&lt;strong</A>&gt;[/img]&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;As noted in the URL section above you can wrap an image in a &lt;strong&gt;[url][/url]&lt;/strong&gt; tag if you wish, eg.&lt;br /&gt;&lt;br /&gt;&lt;strong&gt;[url=<A HREF="http://www.phpbb.com/">http://www.phpbb.com/</A>][img]&lt;/strong&gt;<A HREF="http://www.phpbb.com/images/phplogo.gif&lt;strong">http://www.phpbb.com/images/phplogo.gif&lt;strong</A>&gt;[/img][/url]&lt;/strong&gt;&lt;br /&gt;&lt;br /&gt;woul!
 d generate:&lt;br /&gt;&lt;br /&gt;&lt;a href=&quot;<A HREF="http://www.phpbb.com/">http://www.phpbb.com/</A>&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;<A HREF="http://www.phpbb.com/images/phplogo.gif">http://www.phpbb.com/images/phplogo.gif</A>&quot; border=&quot;0&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;br /&gt;'
+	),
+	array(
+		0 =&gt; '--',
+		1 =&gt; 'Other matters'
+	),
+	array(
+		0 =&gt; 'Can I add my own tags?',
+		1 =&gt; 'No, I am afraid not directly in phpBB 2.0. We are looking at offering customisable BBCode tags for the next major version'
+	)
+);
+
+?&gt;
\ No newline at end of file

Added: cms/trunk/modules/forums/language/help_faq.php
===================================================================
--- cms/trunk/modules/forums/language/help_faq.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/language/help_faq.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,211 @@
+&lt;?php
+// -------------------------------------------------------------
+//
+// $Id: help_faq.php,v 1.2 2004/08/01 15:38:03 acydburn Exp $
+//
+// FILENAME  : help_faq.php [ English ]
+// STARTED   : Sat Dec 16, 2000
+// COPYRIGHT : &#169; 2001, 2003 phpBB Group
+// WWW       : <A HREF="http://www.phpbb.com/">http://www.phpbb.com/</A>
+// LICENCE   : GPL vs2.0 [ see /docs/COPYING ] 
+// 
+// -------------------------------------------------------------
+
+// DEVELOPERS PLEASE NOTE 
+//
+// Placeholders can now contain order information, e.g. instead of
+// 'Page %s of %s' you can (and should) write 'Page %1$s of %2$s', this allows
+// translators to re-order the output of data while ensuring it remains correct
+//
+// You do not need this where single placeholders are used, e.g. 'Message %d' is fine
+// equally where a string contains only two placeholders which are used to wrap text
+// in a url you again do not need to specify an order e.g., 'Click %sHERE%s' is fine
+
+$this-&gt;lang['help'] = array(
+	array(
+		0 =&gt; '--',
+		1 =&gt; 'Login and Registration Issues'
+	),
+	array(
+		0 =&gt; 'Why can\'t I login?',
+		1 =&gt; 'Have you registered? Seriously, you must register in order to login. Have you been banned from the board (a message will be displayed if you have)? If so then you should contact the webmaster or board administrator to find out why. If you have registered and are not banned and you still cannot login then check and double check your username and password. Usually this is the problem, if not then contact the board administrator they may have incorrect configuration settings for the board.'
+	),
+	array(
+		0 =&gt; 'Why do I need to register at all?',
+		1 =&gt; 'You may not have too, it is up to the administrator of the board as to whether you need to register in order to post messages. However registration will give you access to additional features not available to guest users such as definable avatar images, private messaging, emailing of fellow users, usergroup subscription, etc. It only takes a few moments to register so it is recommended you do so.'
+	),
+	array(
+		0 =&gt; 'Why do I get logged off automatically?',
+		1 =&gt; 'If you do not check the &lt;i&gt;Log me in automatically&lt;/i&gt; box when you login the board will only keep you logged in for a preset time. This prevents misuse of your account by anyone else. To stay logged in check the box during login, this is not recommended if you access the board from a shared computer, e.g. library, internet cafe, university cluster, etc.'
+	),
+	array(
+		0 =&gt; 'How do I prevent my username appearing in the online user listings?',
+		1 =&gt; 'In your profile you will find an option &lt;i&gt;Hide your online status&lt;/i&gt;, if you switch this &lt;i&gt;on&lt;/i&gt; you\'ll only appear to board administrators or to yourself. You will be counted as a hidden user.'
+	),
+	array(
+		0 =&gt; 'I\'ve lost my password!',
+		1 =&gt; 'Don\'t panic! While your password cannot be retrieved it can be reset. To do this go to the login page and click &lt;u&gt;I\'ve forgotten my password&lt;/u&gt;, follow the instructions and you should be back online in no time'
+	),
+	array(
+		0 =&gt; 'I registered but cannot login!',
+		1 =&gt; 'Firstly check your are entering the correct username and password. If they are okay then one of two things may have happened. If COPPA support is enabled and you clicked the &lt;u&gt;I am under 13 years old&lt;/u&gt; link while registering then you will have to follow the instructions you received. If this is not the case then does your account need activating? Some boards will require all new registrations be activated, either by yourself or by the administrator before you can logon. When you registered it would have told you whether activation was required. If you were sent an email then follow the instructions, if you did not receive the email then are you sure your email address is valid? One reason activation is used is to reduce the possibility of &lt;i&gt;rouge&lt;/i&gt; users abusing the board anonymously. If you are sure the email address you used is valid then try contacting the board administrator.'
+	),
+	array(
+		0 =&gt; 'I registered in the past but cannot login any more?!',
+		1 =&gt; 'The most likely reasons for this are; you entered an incorrect username or password (check the email you were sent when you first registered) or the administrator has deleted your account for some reason. If it is the later case then perhaps you did not post anything? It is usual for boards to periodically remove users who have not posted anything so as to reduce the size of the database. Try registering again and get involved in discussions.'
+	),
+	array(
+		0 =&gt; '--',
+		1 =&gt; 'User Preferences and settings'
+	),
+	array(
+		0 =&gt; 'How do I change my settings?',
+		1 =&gt; 'All your settings (if you are registered) are stored in the database. To alter them click the &lt;u&gt;Profile&lt;/u&gt; link (generally shown at the top of pages but this may not be the case). This will allow you to change all your settings'
+	),
+	array(
+		0 =&gt; 'The times are not correct!',
+		1 =&gt; 'The times are almost certainly correct, however what you may be seeing are times displayed in a timezone different from the one you are in. If this is the case you should change your profile setting for the timezone to match your particular area, e.g. London, Paris, New York, Sydney, etc. Please note that changing the timezone, like most settings can only be done by registered users. So if you are not registered this is a good time to do so, if you pardon the pun!'
+	),
+	array(
+		0 =&gt; 'I changed the timezone and the time is still wrong!',
+		1 =&gt; 'If you are sure you have set the timezone correctly and the time is still different the most likely answer is daylight savings time (or summer time as it is known in the UK and other places). The board is not designed to handle the changeovers between standard and daylight time so during summer months the time may be an hour different from the real local time.'
+	),
+	array(
+		0 =&gt; 'My language is not in the list!',
+		1 =&gt; 'The most likely reasons for this are either the administrator did not install your language or someone has not translated this board into your language. Try asking the board administrator if they can install the language pack you need, if it does not exist then please feel free to create a new translation. More information can be found at the phpBB Group website (see link at bottom of pages)'
+	),
+	array(
+		0 =&gt; 'How do I show an image below my username?',
+		1 =&gt; 'There may be two images below a username when viewing posts. The first is an image associated with your rank, generally these take the form of stars or blocks indicating how many posts you have made or your status on the forums. Below this may be a larger image known as an avatar, this is generally unique or personal to each user. It is up to the board administrator to enable avatars and they have a choice over the way in which avatars can be made available. If you are unable to use avatars then this is the decision of the board admin, you should ask them their reasons (we\'re sure they\'ll be good!)'
+	),
+	array(
+		0 =&gt; 'How do I change my rank?',
+		1 =&gt; 'In general you cannot directly change the wording of any rank (ranks appear below your username in topics and on your profile depending on the style used). Most boards use ranks to indicate the number of posts you have made and to identify certain users, e.g. moderators and administrators may have a special rank. Please do not abuse the board by posting unnecessarily just to increase your rank, you will probably find the moderator or administrator will simply lower your post count.'
+	),
+	array(
+		0 =&gt; 'When I click the email link for a user it asks me to login?',
+		1 =&gt; 'Sorry but only registered users can send email to people via the built-in email form (if the admin has enabled this feature). This is to prevent malicious use of the email system by anonymous users.'
+	),
+	array(
+		0 =&gt; '--',
+		1 =&gt; 'Posting Issues'
+	),
+	array(
+		0 =&gt; 'How do I post a topic in a forum?',
+		1 =&gt; 'Easy, click the relevant button on either the forum or topic screens. You may need to register before you can post a message, the facilities available to you are listed at the bottom of the forum and topic screens (the &lt;i&gt;You can post new topics, You can vote in polls, etc.&lt;/i&gt; list)'
+	),
+	array(
+		0 =&gt; 'How do I edit or delete a post?',
+		1 =&gt; 'Unless you are the board admin or forum moderator you can only edit or delete your own posts. You can edit a post (sometimes for only a limited time after it was made) by clicking the &lt;i&gt;edit&lt;/i&gt; button for the relevant post.  If someone has already replied to the post you will find a small piece of text output below the post when you return to the topic, this lists the number of times you edited it. This will only appear if no one has replied, it also will not appear if moderators or administrators edit the post (they should leave a message saying what they altered and why). Please note that normal users cannot delete a post once someone has replied.'
+	),
+	array(
+		0 =&gt; 'How do I add a signature to my post?',
+		1 =&gt; 'To add a signature to a post you must first create one, this is done via your profile. Once created you can check the &lt;i&gt;Add Signature&lt;/i&gt; box on the posting form to add your signature. You can also add a signature by default to all your posts by checking the appropriate radio box in your profile (you can still prevent a signature being added to individual posts by un-checking the add signature box on the posting form)'
+	),
+	array(
+		0 =&gt; 'How do I create a poll?',
+		1 =&gt; 'Creating a poll is easy, when you post a new topic (or edit the first post of a topic, if you have permission) you should see a &lt;i&gt;Add Poll&lt;/i&gt; form below the main posting box (if you cannot see this then you probably do not have rights to create polls). You should enter a title for the poll and then at least two options (to set an option type in the poll question and click the &lt;i&gt;Add option&lt;/i&gt; button. You can also set a time limit for the poll, 0 is an infinite poll. There will be a limit to the number of options you can list, this is set by the board administrator'
+	),
+	array(
+		0 =&gt; 'How do I edit or delete a poll?',
+		1 =&gt; 'As with posts, polls can only be edited by the original poster, a moderator or board admin. To edit a poll click the first post in the topic (this always has the poll associated with it). If no one has cast a vote then users can delete the poll or edit any poll option, however if people have already placed votes only moderators or administrators can edit or delete it. This is to prevent people rigging polls by changing options mid-way through a poll'
+	),
+	array(
+		0 =&gt; 'Why can\'t I access a forum?',
+		1 =&gt; 'Some forums may be limited to certain users or groups. To view, read, post, etc. you may need special authorisation, only the forum moderator and board admin can grant this access, you should contact them.'
+	),
+	array(
+		0 =&gt; 'Why can\'t I vote in polls?',
+		1 =&gt; 'Only registered users can vote in polls (so as to prevent spoofing of results). If you have registered and still cannot vote then you probably do not have appropriate access rights.'
+	),
+	array(
+		0 =&gt; '--',
+		1 =&gt; 'Formatting and Topic Types'
+	),
+	array(
+		0 =&gt; 'What is BBCode?',
+		1 =&gt; 'BBCode is a special implementation of HTML, whether you can use BBCode is determined by the administrator (you can also disable it on a per post basis from the posting form). BBCode itself is similar in style to HTML, tags are enclosed in square braces [ and ] rather than &lt; and &gt; and it offers greater control over what and how something is displayed. For more information on BBCode see the guide which can be accessed from the posting page.'
+	),
+	array(
+		0 =&gt; 'Can I use HTML?',
+		1 =&gt; '...'
+	),
+	array(
+		0 =&gt; 'What are Smileys?',
+		1 =&gt; 'Smileys, or Emoticons are small graphical images which can be used to express some feeling using a short code, e.g. :) means happy, :( means sad. The full list of emoticons can be seen via the posting form. Try not to overuse smileys though, they can quickly render a post unreadable and a moderator may decide to edit them out or remove the post altogether'
+	),
+	array(
+		0 =&gt; 'Can I post Images?',
+		1 =&gt; 'Images can indeed be shown in your posts. However, there is no facility at present for uploading images directly to this board. Therefore you must link to an image stored on a publicly accessible web server, e.g. <A HREF="http://www.some-unknown-place.net/my-picture.gif.">http://www.some-unknown-place.net/my-picture.gif.</A> You cannot link to pictures stored on your own PC (unless it is a publicly accessible server) nor images stored behind authentication mechanisms, e.g. hotmail or yahoo mailboxes, password protected sites, etc. To display the image use either the BBCode [img] tag or appropriate HTML (if allowed).'
+	),
+	array(
+		0 =&gt; 'What are Announcements?',
+		1 =&gt; 'Announcements often contain important information and you should read them as soon as possible. Announcements appear at the top of every page in the forum to which they are posted. Whether or not you can post an announcement depends on the permissions required, these are set by the administrator.'
+	),
+	array(
+		0 =&gt; 'What are Sticky topics?',
+		1 =&gt; 'Sticky topics appear below any announcements in viewforum and only on the first page. They are often quite important so you should read them where possible. As with announcements the board administrator determines what permissions are required to post sticky topics in each forum.'
+	),
+	array(
+		0 =&gt; 'What are Locked topics?',
+		1 =&gt; 'Locked topics are set this way by either the forum moderator or board administrator. You cannot reply to locked topics and any poll it contained is automatically ended. Topics may be locked for many reasons.'
+	),
+	array(
+		0 =&gt; '--',
+		1 =&gt; 'User Levels and Groups'
+	),
+	array(
+		0 =&gt; 'What are Administrators?',
+		1 =&gt; 'Administrators are people assigned the highest level of control over the entire board. These people can control all facets of board operation which includes setting permissions, banning users, creating usergroups or moderators, etc. They also have full moderator capabilities in all the forums.'
+	),
+	array(
+		0 =&gt; 'What are Moderators?',
+		1 =&gt; 'Moderators are individuals (or groups of individuals) whose job it is to look after the running of the forums from day to day. They have the power to edit or delete posts and lock, unlock, move, delete and split topics in the forum they moderate. Generally moderators are there to prevent people going &lt;i&gt;off-topic&lt;/i&gt; or posting abusive or offensive material.'
+	),
+	array(
+		0 =&gt; 'What are Usergroups?',
+		1 =&gt; 'Usergroups are a way in which board administrators can group users. Each user can belong to several groups (this differs from most other boards) and each group can be assigned individual access rights. This makes it easy for administrators to set up several users as moderators of a forum, or to give them access to a private forum, etc.'
+	),
+	array(
+		0 =&gt; 'How do I join a Usergroup?',
+		1 =&gt; 'To join a usergroup click the usergroup link on the page header (dependent on template design), you can then view all usergroups. Not all groups are &lt;i&gt;open access&lt;/i&gt;, some are closed and some may even have hidden memberships. If the board is open then you can request to join it by clicking the appropriate button. The user group moderator will need to approve your request, they may ask why you want to join the group. Please do not pester a group moderator if they turn your request down, they will have their reasons.'
+	),
+	array(
+		0 =&gt; 'How do I become a Usergroup Moderator?',
+		1 =&gt; 'Usergroups are initially created by the board admin, they also assign a board moderator. If you are interested in creating a usergroup then your first point of contact should be the admin, try dropping them a private message.'
+	),
+	array(
+		0 =&gt; '--',
+		1 =&gt; 'Private Messaging'
+	),
+	array(
+		0 =&gt; 'I cannot send private messages!',
+		1 =&gt; 'There are three reasons for this; you are not registered and/or not logged on, the board administrator has disabled private messaging for the entire board or the board administrator has prevented you from sending messages. If it is the later case you should try asking the administrator why.'
+	),
+	array(
+		0 =&gt; 'I keep getting unwanted private messages!',
+		1 =&gt; 'In the future we will be adding an ignore list to the private messaging system. For now though if you keep receiving unwanted private messages from someone inform the board admin, they have the power to prevent a user from sending private messages at all.'
+	),
+	array(
+		0 =&gt; 'I have received a spamming or abusive email from someone on this board!',
+		1 =&gt; 'We are sorry to hear that. The email form feature of this board includes safeguards to try and track users who send such posts. You should email the board administrator with a full copy of the email you received, it is very important this include the headers (these list details of the user that sent the email). They can then take action.'
+	),
+	array(
+		0 =&gt; '--',
+		1 =&gt; 'phpBB 2 Issues'
+	),
+	array(
+		0 =&gt; 'Who wrote this bulletin board?',
+		1 =&gt; 'This software (in its unmodified form) is produced, released and is copyright  &lt;a href=&quot;<A HREF="http://www.phpbb.com/">http://www.phpbb.com/</A>&quot; target=&quot;_blank&quot;&gt;phpBB Group&lt;/a&gt;. It is made available under the GNU General Public Licence and may be freely distributed, see link for more details'
+	),
+	array(
+		0 =&gt; 'Why isn\'t X feature available?',
+		1 =&gt; 'This software was written by and licensed through phpBB Group. If you believe a feature needs to be added then please visit the phpbb.com website and see what phpBB Group have to say. Please do not post feature requests to the board at phpbb.com, the Group uses sourceforge to handle tasking of new features. Please read through the forums and see what, if any, our position may already be for a feature and then follow the procedure given there.'
+	),
+	array(
+		0 =&gt; 'Who do I contact about abusive and/or legal matters related to this board?',
+		1 =&gt; 'You should contact the administrator of this board. If you cannot find who this you should first contact one of the forum moderators and ask them who you should in turn contact. If still get no response you should contact the owner of the domain (do a whois lookup) or, if this is running on a free service (e.g. yahoo, free.fr, f2s.com, etc.), the management or abuse department of that service. Please note that phpBB Group has absolutely no control and cannot in any way be held liable over how, where or by whom this board is used. It is absolutely pointless contacting phpBB Group in relation to any legal (cease and desist, liable, defamatory comment, etc.) matter not directly related to the phpbb.com website or the discrete software of phpBB itself. If you do email phpBB Group about any third party use of this software then you should expect a terse response or no response at all.'
+	)
+);
+
+?&gt;
\ No newline at end of file

Added: cms/trunk/modules/forums/language/index.htm
===================================================================
--- cms/trunk/modules/forums/language/index.htm	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/language/index.htm	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,10 @@
+&lt;html&gt;
+&lt;head&gt;
+&lt;title&gt;&lt;/title&gt;
+&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=iso-8859-1&quot;&gt;
+&lt;/head&gt;
+
+&lt;body bgcolor=&quot;#FFFFFF&quot; text=&quot;#000000&quot;&gt;
+
+&lt;/body&gt;
+&lt;/html&gt;

Added: cms/trunk/modules/forums/language/mcp.php
===================================================================
--- cms/trunk/modules/forums/language/mcp.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/language/mcp.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,342 @@
+&lt;?php
+/** 
+*
+* mcp [English]
+*
+* @package language
+* @version $Id: mcp.php,v 1.50 2006/08/12 19:36:36 acydburn Exp $
+* @copyright (c) 2005 phpBB Group 
+* @license <A HREF="http://opensource.org/licenses/gpl-license.php">http://opensource.org/licenses/gpl-license.php</A> GNU Public License 
+*
+*/
+
+// DEVELOPERS PLEASE NOTE
+//
+// Placeholders can now contain order information, e.g. instead of
+// 'Page %s of %s' you can (and should) write 'Page %1$s of %2$s', this allows
+// translators to re-order the output of data while ensuring it remains correct
+//
+// You do not need this where single placeholders are used, e.g. 'Message %d' is fine
+// equally where a string contains only two placeholders which are used to wrap text
+// in a url you again do not need to specify an order e.g., 'Click %sHERE%s' is fine
+
+$this-&gt;lang += array(
+	'ACTION'				=&gt; 'Action',
+	'ADD_FEEDBACK'			=&gt; 'Add feedback',
+	'ADD_FEEDBACK_EXPLAIN'	=&gt; 'If you would like to add a report on this please fill out the following form. Only use plain text; HTML, BBCode, etc. are not permitted.',
+	'ADD_WARNING'			=&gt; 'Add warning',
+	'ADD_WARNING_EXPLAIN'	=&gt; 'To send a warning to this user please fill out the following form. Only use plain text; HTML, BBCode, etc. are not permitted.',
+	'ALL_ENTRIES'			=&gt; 'All entries',
+	'ALL_NOTES_DELETED'		=&gt; 'Successfully removed all user notes',
+	'ALL_REPORTS'			=&gt; 'All reports',
+	'ALREADY_REPORTED'		=&gt; 'This post has already been reported',
+	'ALREADY_WARNED'		=&gt; 'A warning has already been issued for this post',
+	'APPROVE'				=&gt; 'Approve',
+	'APPROVE_POST'			=&gt; 'Approve post',
+	'APPROVE_POST_CONFIRM'	=&gt; 'Are you sure you want to approve this post?',
+	'APPROVE_POSTS'			=&gt; 'Approve posts',
+	'APPROVE_POSTS_CONFIRM'	=&gt; 'Are you sure you want to approve the selected posts?',
+
+	'CANNOT_MOVE_SAME_FORUM'=&gt; 'You cannot move a topic to the forum it\'s already in',
+	'CANNOT_WARN_ANONYMOUS'	=&gt; 'You cannot warn an guest user',
+	'CANNOT_WARN_SELF'		=&gt; 'You cannot warn yourself',
+	'CAN_LEAVE_BLANK'		=&gt; 'This can be left blank.',
+	'CHANGE_POSTER'			=&gt; 'Change poster',
+	'CLOSE_REPORT'			=&gt; 'Close report',
+	'CLOSE_REPORT_CONFIRM'	=&gt; 'Are you sure you want to close the selected report?',
+	'CLOSE_REPORTS'			=&gt; 'Close reports',
+	'CLOSE_REPORTS_CONFIRM'	=&gt; 'Are you sure you want to close the selected reports?',
+
+	'DELETE_POSTS'			=&gt; 'Delete posts',
+	'DELETE_POSTS_CONFIRM'	=&gt; 'Are you sure you want to delete these posts?',
+	'DELETE_POST_CONFIRM'	=&gt; 'Are you sure you want to delete this post?',
+	'DELETE_REPORT'			=&gt; 'Delete report',
+	'DELETE_REPORT_CONFIRM'	=&gt; 'Are you sure you want to delete the selected report?',
+	'DELETE_REPORTS'		=&gt; 'Delete reports',
+	'DELETE_REPORTS_CONFIRM'	=&gt; 'Are you sure you want to delete the selected reports?',
+	'DELETE_TOPICS'			=&gt; 'Delete selected topics',
+	'DELETE_TOPICS_CONFIRM'	=&gt; 'Are you sure you want to delete these topics?',
+	'DELETE_TOPIC_CONFIRM'	=&gt; 'Are you sure you want to delete this topic?',
+	'DISAPPROVE'			=&gt; 'Disapprove',
+	'DISAPPROVE_REASON'		=&gt; 'Reason for disapproval',
+	'DISAPPROVE_POST'		=&gt; 'Disapprove post',
+	'DISAPPROVE_POST_CONFIRM'	=&gt; 'Are you sure you want to disapprove this post?',
+	'DISAPPROVE_POSTS'		=&gt; 'Disapprove posts',
+	'DISAPPROVE_POSTS_CONFIRM'	=&gt; 'Are you sure you want to disapprove the selected posts?',
+	'DISPLAY_LOG'			=&gt; 'Display entries from previous',
+	'DISPLAY_OPTIONS'		=&gt; 'Display options',
+
+	'EMPTY_REPORT'			=&gt; 'You must enter a description when selecting this reason',
+	'EMPTY_TOPICS_REMOVED_WARNING'	=&gt; 'Please note that one or several topics have been removed from the database because they were or become empty',
+
+	'FEEDBACK'				=&gt; 'Feedback',
+	'FORK'					=&gt; 'Fork',
+	'FORK_TOPIC'			=&gt; 'Fork Topic',
+	'FORK_TOPIC_CONFIRM'	=&gt; 'Are you sure you want to copy this topic?',
+	'FORK_TOPICS'			=&gt; 'Fork selected topics',
+	'FORK_TOPICS_CONFIRM'	=&gt; 'Are you sure you want to copy the selected topics?',
+	'FORUM_DESC'			=&gt; 'Description',
+	'FORUM_NAME'			=&gt; 'Forum name',
+	'FORUM_NOT_EXIST'		=&gt; 'The forum you selected does not exist',
+	'FORUM_NOT_POSTABLE'	=&gt; 'The forum you selected cannot be posted to',
+	'FORUM_STATUS'			=&gt; 'Forum status',
+	'FORUM_STYLE'			=&gt; 'Forum style',
+
+	'GLOBAL_ANNOUNCEMENT'	=&gt; 'Global Announcement',
+
+	'IP_INFO'				=&gt; 'IP Information',
+
+	'LATEST_LOGS'				=&gt; 'Latest 5 logged actions',
+	'LATEST_REPORTED'			=&gt; 'Latest 5 reports',
+	'LATEST_UNAPPROVED'			=&gt; 'Latest 5 posts awaiting for approval',
+	'LATEST_WARNING_TIME'		=&gt; 'Latest warning issued',
+	'LATEST_WARNINGS'			=&gt; 'Latest 5 warnings',
+	'LEAVE_SHADOW'				=&gt; 'Leave shadow topic in place',
+	'LIST_REPORT'				=&gt; '1 report',
+	'LIST_REPORTS'				=&gt; '%d reports',
+	'LOCK'						=&gt; 'Lock',
+	'LOCK_POST_POST'			=&gt; 'Lock post',
+	'LOCK_POST_POST_CONFIRM'	=&gt; 'Are you sure you want to prevent editing this post?',
+	'LOCK_POST_POSTS'			=&gt; 'Lock selected posts',
+	'LOCK_POST_POSTS_CONFIRM'	=&gt; 'Are you sure you want to prevent editing the selected posts?',
+	'LOCK_TOPIC_CONFIRM'		=&gt; 'Are you sure you want to lock this topic?',
+	'LOCK_TOPICS'				=&gt; 'Lock selected topics',
+	'LOCK_TOPICS_CONFIRM'		=&gt; 'Are you sure you want to lock all selected topics?',
+	'LOGS_CURRENT_TOPIC'		=&gt; 'Currently viewing logs of:',
+	'LOGIN_EXPLAIN_MCP'			=&gt; 'To moderate this forum you must login.',
+	'LOGVIEW_VIEWTOPIC'			=&gt; 'View topic',
+	'LOGVIEW_VIEWLOGS'			=&gt; 'View topic log',
+	'LOGVIEW_VIEWFORUM'			=&gt; 'View forum',
+	'LOOKUP_ALL'				=&gt; 'Look up all IPs',
+	'LOOKUP_IP'					=&gt; 'Look up IP',
+
+	'MARKED_NOTES_DELETED'		=&gt; 'Successfully removed all marked user notes',
+
+	'MCP_ADD'						=&gt; 'Add a warning',
+
+	'MCP_BAN'					=&gt; 'Banning',
+	'MCP_BAN_EMAILS'			=&gt; 'Ban Emails',
+	'MCP_BAN_IPS'				=&gt; 'Ban IPs',
+	'MCP_BAN_USERNAMES'			=&gt; 'Ban Usernames',
+
+	'MCP_LOGS'						=&gt; 'Moderator logs',
+	'MCP_LOGS_FRONT'				=&gt; 'Front page',
+	'MCP_LOGS_FORUM_VIEW'			=&gt; 'Forum logs',
+	'MCP_LOGS_TOPIC_VIEW'			=&gt; 'Topic logs',
+
+	'MCP_MAIN'						=&gt; 'Main',
+	'MCP_MAIN_FORUM_VIEW'			=&gt; 'View forum',
+	'MCP_MAIN_FRONT'				=&gt; 'Front page',
+	'MCP_MAIN_POST_DETAILS'			=&gt; 'Post details',
+	'MCP_MAIN_TOPIC_VIEW'			=&gt; 'View topic',
+	'MCP_MAKE_ANNOUNCEMENT'			=&gt; 'Make Announcement',
+	'MCP_MAKE_ANNOUNCEMENT_CONFIRM'	=&gt; 'Are you sure you want to change this topic to an Announcement?',
+	'MCP_MAKE_ANNOUNCEMENTS'		=&gt; 'Make Announcements',
+	'MCP_MAKE_ANNOUNCEMENTS_CONFIRM'=&gt; 'Are you sure you want to change the selected topics to Announcements?',
+	'MCP_MAKE_GLOBAL'				=&gt; 'Make Global Announcement',
+	'MCP_MAKE_GLOBAL_CONFIRM'		=&gt; 'Are you sure you want to change this topic to a Global Announcement?',
+	'MCP_MAKE_GLOBALS'				=&gt; 'Make Global Announcements',
+	'MCP_MAKE_GLOBALS_CONFIRM'		=&gt; 'Are you sure you want to change the selected topics to Global Announcements?',
+	'MCP_MAKE_STICKY'				=&gt; 'Make Sticky',
+	'MCP_MAKE_STICKY_CONFIRM'		=&gt; 'Are you sure you want to change this topic to a Sticky?',
+	'MCP_MAKE_STICKIES'				=&gt; 'Make Stickies',
+	'MCP_MAKE_STICKIES_CONFIRM'		=&gt; 'Are you sure you want to change the selected topics to Stickies?',
+	'MCP_MAKE_NORMAL'				=&gt; 'Make Standard Topic',
+	'MCP_MAKE_NORMAL_CONFIRM'		=&gt; 'Are you sure you want to change this topic to a Standard Topic?',
+	'MCP_MAKE_NORMALS'				=&gt; 'Make Standard Topics',
+	'MCP_MAKE_NORMALS_CONFIRM'		=&gt; 'Are you sure you want to change the selected topics to Standard Topics?',
+
+	'MCP_NOTES'						=&gt; 'User notes',
+	'MCP_NOTES_FRONT'				=&gt; 'Front page',
+	'MCP_NOTES_USER'				=&gt; 'User details',
+
+	'MCP_REPORTS'					=&gt; 'Reported posts',
+	'MCP_REPORT_DETAILS'			=&gt; 'Report details',
+	'MCP_REPORTS_CLOSED'			=&gt; 'Closed reports',
+	'MCP_REPORTS_CLOSED_EXPLAIN'	=&gt; 'This is a list of all reports about posts which have previously been resolved',
+	'MCP_REPORTS_OPEN'				=&gt; 'Open reports',
+	'MCP_REPORTS_OPEN_EXPLAIN'		=&gt; 'This is a list of all reported posts which are still to be handled',
+
+	'MCP_QUEUE'								=&gt; 'Moderation queue',
+	'MCP_QUEUE_APPROVE_DETAILS'				=&gt; 'Approve details',
+	'MCP_QUEUE_UNAPPROVED_POSTS'			=&gt; 'Posts awaiting approval',
+	'MCP_QUEUE_UNAPPROVED_POSTS_EXPLAIN'	=&gt; 'This is a list of all posts which require approving before they will be visible to users',
+	'MCP_QUEUE_UNAPPROVED_TOPICS'			=&gt; 'Topics awaiting approval',
+	'MCP_QUEUE_UNAPPROVED_TOPICS_EXPLAIN'	=&gt; 'This is a list of all topics which require approving before they will be visible to users',
+
+	'MCP_VIEW_USER'			=&gt; 'View warnings for a specific user',
+
+	'MCP_WARN'				=&gt; 'Warnings',
+	'MCP_WARN_FRONT'		=&gt; 'Front page',
+	'MCP_WARN_LIST'			=&gt; 'List warnings',
+	'MCP_WARN_POST'			=&gt; 'Warn for specific post',
+	'MCP_WARN_USER'			=&gt; 'Warn user',
+
+	'MERGE_POSTS'			=&gt; 'Merge posts',
+	'MERGE_POSTS_CONFIRM'	=&gt; 'Are you sure you want to merge the selected posts?',
+	'MERGE_TOPIC_EXPLAIN'	=&gt; 'Using the form below you can merge selected posts into another topic. These posts will not be reordered and will appear as if the users posted them to the new topic.&lt;br /&gt;Please enter the destination topic id or click on the &quot;Select&quot; button to search for one',
+	'MERGE_TOPIC_ID'		=&gt; 'Destination topic id',
+	'MODERATE_FORUM'		=&gt; 'Moderate forum',
+	'MOD_OPTIONS'			=&gt; 'Moderator options',
+	'MORE_INFO'				=&gt; 'Further information',
+	'MOST_WARNINGS'			=&gt; 'Users with most warnings',
+	'MOVE_TOPIC_CONFIRM'	=&gt; 'Are you sure you want to move the topic into a new forum?',
+	'MOVE_TOPICS'			=&gt; 'Move selected topics',
+	'MOVE_TOPICS_CONFIRM'	=&gt; 'Are you sure you want to move the selected topics into a new forum?',
+
+	'NOTIFY_POSTER_APPROVAL'=&gt; 'Notify poster about approval?',
+	'NOTIFY_POSTER_DISAPPROVAL' =&gt; 'Notify poster about disapproval?',
+	'NOTIFY_USER_WARN'		=&gt; 'Notify user about warning?',
+	'NOT_MODERATOR'			=&gt; 'You are not a moderator of this forum',
+	'NO_DESTINATION_FORUM'	=&gt; 'Please select a forum for destination',
+	'NO_DESTINATION_FORUM_FOUND'	=&gt; 'There is no destination forum available.',
+	'NO_ENTRIES'			=&gt; 'No log entries for this period',
+	'NO_FEEDBACK'			=&gt; 'No feedback exists for this user',
+	'NO_FINAL_TOPIC_SELECTED'	=&gt; 'You have to select a destination topic for merging posts',
+	'NO_MATCHES_FOUND'		=&gt; 'No matches found',
+	'NO_POST'				=&gt; 'You have to select a post in order to warn the user for a post',
+	'NO_POST_REPORT'		=&gt; 'This post was not reported.',
+	'NO_POST_SELECTED'		=&gt; 'You must select at least one post to perform this action',
+	'NO_REASON_DISAPPROVAL'	=&gt; 'Please give an appropiate reason for disapproval',
+	'NO_TOPIC_ICON'			=&gt; 'None',
+	'NO_TOPIC_SELECTED'		=&gt; 'You must select at least one topic to perform this action',
+
+	'OTHER_IPS'				=&gt; 'Other IP addresses this user has posted from',
+	'ONLY_TOPIC'			=&gt; 'Only topic &quot;%s&quot;',
+	'OTHER_USERS'			=&gt; 'Users posting from this IP',
+
+	'POSTER'				=&gt; 'Poster',
+	'POSTS_APPROVED_SUCCESS'=&gt; 'The selected posts have been approved',
+	'POSTS_DELETED_SUCCESS'	=&gt; 'The selected posts have been successfully removed from the database',
+	'POSTS_DISAPPROVED_SUCCESS'=&gt; 'The selected posts have been disapproved',
+	'POSTS_LOCKED_SUCCESS'	=&gt; 'The selected posts have been locked successfully',
+	'POSTS_MERGED_SUCCESS'	=&gt; 'The selected posts have been merged',
+	'POSTS_UNLOCKED_SUCCESS'=&gt; 'The selected posts have been unlocked successfully',
+	'POSTS_PER_PAGE'		=&gt; 'Posts per page',
+	'POSTS_PER_PAGE_EXPLAIN'=&gt; '(Set to 0 to view all posts)',
+	'POST_APPROVED_SUCCESS'	=&gt; 'The selected post has been approved',
+	'POST_DELETED_SUCCESS'	=&gt; 'The selected post has been successfully removed from the database',
+	'POST_DISAPPROVED_SUCCESS'	=&gt; 'The selected post has been disapproved',
+	'POST_LOCKED_SUCCESS'	=&gt; 'Post locked successfully',
+	'POST_NOT_EXIST'		=&gt; 'The post you requested does not exist',
+	'POST_REPORTED_SUCCESS'	=&gt; 'This post has been successfully reported',
+	'POST_UNLOCKED_SUCCESS'	=&gt; 'Post unlocked successfully',
+
+	'READ_USERNOTES'		=&gt; 'User notes',
+	'READ_WARNINGS'			=&gt; 'User warnings',
+	'REPORTER'				=&gt; 'Reporter',
+	'REPORTED'				=&gt; 'Reported',
+	'REPORTED_BY'			=&gt; 'Reported by',
+	'REPORTED_ON_DATE'		=&gt; 'on',
+	'REPORTS_CLOSED_SUCCESS'	=&gt; 'The selected reports have been closed successfully.',
+	'REPORTS_DELETED_SUCCESS'	=&gt; 'The selected reports have been deleted successfully.',
+	'REPORTS_TOTAL'			=&gt; 'In total there are &lt;strong&gt;%d&lt;/strong&gt; reports to review',
+	'REPORTS_ZERO_TOTAL'	=&gt; 'There are no reports to review',
+	'REPORT_CLOSED'			=&gt; 'This report has previously been closed.',
+	'REPORT_CLOSED_SUCCESS'	=&gt; 'The selected report has been closed successfully.',
+	'REPORT_DELETED_SUCCESS'	=&gt; 'The selected report has been deleted successfully.',
+	'REPORT_DETAILS'		=&gt; 'Report details',
+	'REPORT_MESSAGE'		=&gt; 'Report this message',
+	'REPORT_MESSAGE_EXPLAIN'=&gt; 'Use this form to report the selected message to the board administrators. Reporting should generally be used only if the message breaks forum rules.',
+	'REPORT_NOTIFY'			=&gt; 'Notify me',
+	'REPORT_NOTIFY_EXPLAIN'	=&gt; 'Informs you when your report is dealt with',
+	'REPORT_POST_EXPLAIN'	=&gt; 'Use this form to report the selected post to the forum moderators and board administrators. Reporting should generally be used only if the post breaks forum rules.',
+	'REPORT_REASON'			=&gt; 'Report reason',
+	'REPORT_TIME'			=&gt; 'Report time',
+	'REPORT_TOTAL'			=&gt; 'In total there is &lt;strong&gt;1&lt;/strong&gt; report to review',
+	'RESYNC'				=&gt; 'Resync',
+	'RETURN_MESSAGE'		=&gt; '%sReturn to the message%s',
+	'RETURN_NEW_FORUM'		=&gt; '%sReturn to the new forum%s',
+	'RETURN_NEW_TOPIC'		=&gt; '%sReturn to the new topic%s',
+	'RETURN_POST'			=&gt; '%sReturn to the post%s',
+	'RETURN_QUEUE'			=&gt; '%sReturn to the queue%s',
+	'RETURN_REPORTS'		=&gt; '%sReturn to the reports%s',
+
+	'SEARCH_POSTS_BY_USER'	=&gt; 'Search posts by',
+	'SELECT_ACTION'			=&gt; 'Select desired action',
+	'SELECT_TOPIC'			=&gt; 'Select topic',
+	'SELECT_USER'			=&gt; 'Select user',
+	'SORT_ACTION'			=&gt; 'Log action',
+	'SORT_DATE'				=&gt; 'Date',
+	'SORT_IP'				=&gt; 'IP address',
+	'SORT_WARNINGS'			=&gt; 'Warnings',
+	'SPLIT_AFTER'			=&gt; 'Split from selected post',
+	'SPLIT_FORUM'			=&gt; 'Forum for new topic',
+	'SPLIT_POSTS'			=&gt; 'Split selected posts',
+	'SPLIT_SUBJECT'			=&gt; 'New topic title',
+	'SPLIT_TOPIC_ALL'		=&gt; 'Split topic from selected posts',
+	'SPLIT_TOPIC_ALL_CONFIRM'	=&gt; 'Are you sure you want to split this topic?',
+	'SPLIT_TOPIC_BEYOND'	=&gt; 'Split topic at selected post',
+	'SPLIT_TOPIC_BEYOND_CONFIRM'	=&gt; 'Are you sure you want to split this topic at the selected post?',
+	'SPLIT_TOPIC_EXPLAIN'	=&gt; 'Using the form below you can split a topic in two, either by selecting the posts individually or by splitting at a selected post',
+
+	'THIS_POST_IP'			=&gt; 'IP for this post',
+	'TOPICS_APPROVED_SUCCESS'	=&gt; 'The selected topics have been approved',
+	'TOPICS_DELETED_SUCCESS'=&gt; 'The selected topics have been successfully removed from the database',
+	'TOPICS_DISAPPROVED_SUCCESS'	=&gt; 'The selected topics have been disapproved',
+	'TOPICS_FORKED_SUCCESS'	=&gt; 'The selected topics have been copied successfully',
+	'TOPICS_LOCKED_SUCCESS'	=&gt; 'The selected topics have been locked',
+	'TOPICS_MOVED_SUCCESS'	=&gt; 'The selected topics have been moved successfully',
+	'TOPICS_RESYNC_SUCCESS'	=&gt; 'The selected topics have been resynchronised',
+	'TOPICS_UNLOCKED_SUCCESS'	=&gt; 'The selected topics have been unlocked',
+	'TOPIC_APPROVED_SUCCESS'	=&gt; 'The selected topic has been approved',
+	'TOPIC_DELETED_SUCCESS'	=&gt; 'The selected topic has been successfully removed from the database',
+	'TOPIC_DISAPPROVED_SUCCESS'	=&gt; 'The selected topic has been disapproved',
+	'TOPIC_FORKED_SUCCESS'	=&gt; 'The selected topic has been copied successfully',
+	'TOPIC_LOCKED_SUCCESS'	=&gt; 'The selected topic has been locked',
+	'TOPIC_MOVED_SUCCESS'	=&gt; 'The selected topic has been moved successfully',
+	'TOPIC_NOT_EXIST'		=&gt; 'The topic you selected does not exist',
+	'TOPIC_RESYNC_SUCCESS'	=&gt; 'The selected topic has been resynchronised',
+	'TOPIC_SPLIT_SUCCESS'	=&gt; 'The selected topic has been split successfully',
+	'TOPIC_TIME'			=&gt; 'Topic time',
+	'TOPIC_TYPE_CHANGED'	=&gt; 'Topic type changed successfully.',
+	'TOPIC_UNLOCKED_SUCCESS'=&gt; 'The selected topic has been unlocked',
+	'TOTAL_WARNINGS'		=&gt; 'Total Warnings',
+
+	'UNAPPROVED_POSTS_TOTAL'		=&gt; 'In total there are &lt;strong&gt;%d&lt;/strong&gt; posts waiting for approval',
+	'UNAPPROVED_POSTS_ZERO_TOTAL'	=&gt; 'There are no posts waiting for approval',
+	'UNAPPROVED_POST_TOTAL'			=&gt; 'In total there is &lt;strong&gt;1&lt;/strong&gt; post waiting for approval',
+	'UNLOCK'						=&gt; 'Unlock',
+	'UNLOCK_POST'					=&gt; 'Unlock post',
+	'UNLOCK_POST_EXPLAIN'			=&gt; 'Allow editing',
+	'UNLOCK_POST_POST'				=&gt; 'Unlock post',
+	'UNLOCK_POST_POST_CONFIRM'		=&gt; 'Are you sure you want to allow editing this post?',
+	'UNLOCK_POST_POSTS'				=&gt; 'Unlock selected posts',
+	'UNLOCK_POST_POSTS_CONFIRM'		=&gt; 'Are you sure you want to allow editing the selected posts?',
+	'UNLOCK_TOPIC'					=&gt; 'Unlock topic',
+	'UNLOCK_TOPIC_CONFIRM'			=&gt; 'Are you sure you want to unlock this topic?',
+	'UNLOCK_TOPICS'					=&gt; 'Unlock selected topics',
+	'UNLOCK_TOPICS_CONFIRM'			=&gt; 'Are you sure you want to unlock all selected topics?',
+	'USER_CANNOT_POST'				=&gt; 'You cannot post in this forum',
+	'USER_CANNOT_REPORT'			=&gt; 'You cannot report posts in this forum',
+	'USER_FEEDBACK_ADDED'			=&gt; 'User feedback added successfully',
+	'USER_WARNING_ADDED'			=&gt; 'User warned successfully',
+
+	'VIEW_DETAILS'			=&gt; 'View details',
+
+	'WARNED_USERS'			=&gt; 'Warned users',
+	'WARNED_USERS_EXPLAIN'	=&gt; 'This is a list of users with unexpired warnings issued to them',
+	'WARNING_PM_BODY'		=&gt; 'The following is a warning which has been issued to you by an administrator or moderator of this site.[quote]%s[/quote]',
+	'WARNING_PM_SUBJECT'	=&gt; 'Board Warning Issued',
+	'WARNING_POST_DEFAULT'	=&gt; 'This is a warning regarding the following post made by you: %s',
+	'WARNINGS_ZERO_TOTAL'	=&gt; 'No warnings exists',
+
+	'YOU_SELECTED_TOPIC'	=&gt; 'You selected topic number %d: %s',
+
+	'report_reasons'		=&gt; array(
+		'TITLE'	=&gt; array(
+			'WAREZ'		=&gt; 'Warez',
+			'SPAM'		=&gt; 'Spam',
+			'OFF_TOPIC'	=&gt; 'Off-topic',
+			'OTHER'		=&gt; 'Other'
+		),
+		'DESCRIPTION' =&gt; array(
+			'WAREZ'		=&gt; 'The post contains links to illegal or pirated software',
+			'SPAM'		=&gt; 'The reported post has the only purpose to advertise for a website or another product',
+			'OFF_TOPIC'	=&gt; 'The reported post is off topic',
+			'OTHER'		=&gt; 'The reported post does not fit into any other category, please use the description field'
+		)
+	),
+);
+
+?&gt;
\ No newline at end of file

Added: cms/trunk/modules/forums/language/posting.php
===================================================================
--- cms/trunk/modules/forums/language/posting.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/language/posting.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,200 @@
+&lt;?php
+// -------------------------------------------------------------
+//
+// $Id: posting.php,v 1.5 2004/07/08 22:41:03 acydburn Exp $
+//
+// FILENAME  : posting.php [ English ]
+// STARTED   : Sat Dec 16, 2000
+// COPYRIGHT : &#169; 2001, 2003 phpBB Group
+// WWW       : <A HREF="http://www.phpbb.com/">http://www.phpbb.com/</A>
+// LICENCE   : GPL vs2.0 [ see /docs/COPYING ] 
+// 
+// -------------------------------------------------------------
+
+// DEVELOPERS PLEASE NOTE 
+//
+// Placeholders can now contain order information, e.g. instead of
+// 'Page %s of %s' you can (and should) write 'Page %1$s of %2$s', this allows
+// translators to re-order the output of data while ensuring it remains correct
+//
+// You do not need this where single placeholders are used, e.g. 'Message %d' is fine
+// equally where a string contains only two placeholders which are used to wrap text
+// in a url you again do not need to specify an order e.g., 'Click %sHERE%s' is fine
+
+$this-&gt;lang += array(
+	'ADD_ATTACHMENT'			=&gt; 'Attachment uploading',
+	'ADD_ATTACHMENT_EXPLAIN'	=&gt; 'If you wish to attach one or more files enter the details below',
+	'ADD_FILE'					=&gt; 'Add the file',
+	'ADD_POLL'					=&gt; 'Poll creation',
+	'ADD_POLL_EXPLAIN'			=&gt; 'If you do not want to add a poll to your topic leave the fields blank',
+	'ALREADY_DELETED'			=&gt; 'Sorry but this message is already deleted.',
+	'ATTACH_QUOTA_REACHED'		=&gt; 'Sorry, the board attachment quota has been reached.',
+	'ATTACH_SIG'				=&gt; 'Attach a signature (signatures can be altered via the UCP)',
+
+	'BBCODE_A_HELP'				=&gt; 'Close all open BBCode tags',
+	'BBCODE_B_HELP'				=&gt; 'Bold text: [b]text[/b]  (alt+b)',
+	'BBCODE_C_HELP'				=&gt; 'Code display: [code]code[/code]  (alt+c)',
+	'BBCODE_E_HELP'				=&gt; 'List: Add list element',
+	'BBCODE_F_HELP'				=&gt; 'Font size: [size=x-small]small text[/size]',
+	'BBCODE_IS_OFF'				=&gt; '%sBBCode%s is &lt;em&gt;OFF&lt;/em&gt;',
+	'BBCODE_IS_ON'				=&gt; '%sBBCode%s is &lt;em&gt;ON&lt;/em&gt;',
+	'BBCODE_I_HELP'				=&gt; 'Italic text: [i]text[/i]  (alt+i)',
+	'BBCODE_L_HELP'				=&gt; 'List: [list]text[/list]  (alt+l)',
+	'BBCODE_O_HELP'				=&gt; 'Ordered list: [list=]text[/list]  (alt+o)',
+	'BBCODE_P_HELP'				=&gt; 'Insert image: [img]<A HREF="http://image_url[/img">http://image_url[/img</A>]  (alt+p)',
+	'BBCODE_Q_HELP'				=&gt; 'Quote text: [quote]text[/quote]  (alt+q)',
+	'BBCODE_S_HELP'				=&gt; 'Font color: [color=red]text[/color]  Tip: you can also use color=#FF0000',
+	'BBCODE_U_HELP'				=&gt; 'Underline text: [u]text[/u]  (alt+u)',
+	'BBCODE_W_HELP'				=&gt; 'Insert URL: [url]<A HREF="http://url[/url">http://url[/url</A>] or [url=<A HREF="http://url">http://url</A>]URL text[/url]  (alt+w)',
+	'BBCODE_D_HELP'				=&gt; 'Flash: [flash=height,width]<A HREF="http://url[/flash">http://url[/flash</A>]  (alt+d)',
+	'BUMP_ERROR'				=&gt; 'You cannot bump this topic so soon after the last post.',
+
+	'CANNOT_DELETE_REPLIED'		=&gt; 'Sorry but you may only delete posts which have not been replied to.',
+	'CANNOT_EDIT_POST_LOCKED'	=&gt; 'This post has been locked. You can no longer edit that post.',
+	'CANNOT_EDIT_TIME'			=&gt; 'You can no longer edit or delete that post',
+	'CANNOT_POST_ANNOUNCE'		=&gt; 'Sorry but you cannot post announcements.',
+	'CANNOT_POST_NEWS'			=&gt; 'Sorry but you cannot post news topics.',
+	'CANNOT_POST_STICKY'		=&gt; 'Sorry but you cannot post sticky topics.',
+	'CHANGE_TOPIC_TO'			=&gt; 'Change topic type to',
+	'CLOSE_TAGS'				=&gt; 'Close tags',
+	'CURRENT_TOPIC'				=&gt; 'Current topic',
+
+	'DELETE_FILE'				=&gt; 'Delete file',
+	'DELETE_MESSAGE'			=&gt; 'Delete message',
+	'DELETE_MESSAGE_CONFIRM'	=&gt; 'Are you sure you want to delete this message?',
+	'DELETE_OWN_POSTS'			=&gt; 'Sorry but you can only delete your own posts.',
+	'DELETE_POST_CONFIRM'		=&gt; 'Are you sure you want to delete this message?',
+	'DELETE_POST_WARN'			=&gt; 'Once deleted the post cannot be recovered',
+	'DISABLE_BBCODE'			=&gt; 'Disable BBCode',
+	'DISABLE_MAGIC_URL'			=&gt; 'Do not automatically parse URLs',
+	'DISABLE_SMILIES'			=&gt; 'Disable smilies',
+	'DISALLOWED_EXTENSION'		=&gt; 'The extension %s is not allowed',
+	'DRAFT_LOADED'				=&gt; 'Draft loaded into posting area, you may want to finish your post now.&lt;br /&gt;Your Draft will be deleted after submitting this post.',
+	'DRAFT_SAVED'				=&gt; 'Draft successfully saved.',
+	'DRAFT_TITLE'				=&gt; 'Draft title',
+
+	'EDIT_REASON'				=&gt; 'Reason for editing this post',
+	'EMPTY_FILEUPLOAD'			=&gt; 'The uploaded file is empty',
+	'EMPTY_MESSAGE'				=&gt; 'You must enter a message when posting.',
+	'EMPTY_REMOTE_DATA'			=&gt; 'File could not be uploaded, please try uploading the file manually.',
+
+	'FLASH_IS_OFF'				=&gt; '[flash] is &lt;em&gt;OFF&lt;/em&gt;',
+	'FLASH_IS_ON'				=&gt; '[flash] is &lt;em&gt;ON&lt;/em&gt;',
+	'FLOOD_ERROR'				=&gt; 'You cannot make another post so soon after your last.',
+	'FONT_COLOR'				=&gt; 'Font color',
+	'FONT_HUGE'					=&gt; 'Huge',
+	'FONT_LARGE'				=&gt; 'Large',
+	'FONT_NORMAL'				=&gt; 'Normal',
+	'FONT_SIZE'					=&gt; 'Font size',
+	'FONT_SMALL'				=&gt; 'Small',
+	'FONT_TINY'					=&gt; 'Tiny',
+
+	'GENERAL_UPLOAD_ERROR'		=&gt; 'Could not upload attachment to %s',
+
+	'IMAGES_ARE_OFF'			=&gt; '[img] is &lt;em&gt;OFF&lt;/em&gt;',
+	'IMAGES_ARE_ON'				=&gt; '[img] is &lt;em&gt;ON&lt;/em&gt;',
+	'INVALID_FILENAME'			=&gt; '%s is an invalid filename',
+
+	'LOAD'						=&gt; 'Load',
+	'LOAD_DRAFT'				=&gt; 'Load draft',
+	'LOAD_DRAFT_EXPLAIN'		=&gt; 'Here you are able to select the draft you want to continue writing. Your current post will be canceled, all current post contents will be deleted. View, edit and delete drafts within your User Control Panel.',
+	'LOGIN_EXPLAIN_POST'		=&gt; 'You need to login in order to post within this forum',
+	'LOGIN_EXPLAIN_REPLY'		=&gt; 'You need to login in order to reply to topics within this forum',
+
+	'MAX_FONT_SIZE_EXCEEDED'	=&gt; 'You may only use fonts up to size %1$d.',
+	'MAX_FLASH_HEIGHT_EXCEEDED'	=&gt; 'Your flash files may only be up to %1$d pixels high.',
+	'MAX_FLASH_WIDTH_EXCEEDED'	=&gt; 'Your flash files may only be up to %1$d pixels wide.',
+	'MAX_IMG_HEIGHT_EXCEEDED'	=&gt; 'Your images may only be up to %1$d pixels high.',
+	'MAX_IMG_WIDTH_EXCEEDED'	=&gt; 'Your images may only be up to %1$d pixels wide.',
+
+	'MESSAGE_BODY_EXPLAIN'		=&gt; 'Enter your message here, it may contain no more than &lt;strong&gt;%d&lt;/strong&gt; characters.',
+	'MESSAGE_DELETED'			=&gt; 'Your message has been deleted successfully',
+	'MORE_SMILIES'				=&gt; 'View more smilies',
+
+	'NOTIFY_REPLY'				=&gt; 'Send me an email when a reply is posted',
+	'NOT_UPLOADED'				=&gt; 'File could not be uploaded.',
+	'NO_DELETE_POLL_OPTIONS'	=&gt; 'You cannot delete existing poll options',
+	'NO_POLL_TITLE'				=&gt; 'You have to enter a poll title',
+	'NO_POST'					=&gt; 'The requested post does not exist.',
+	'NO_POST_MODE'				=&gt; 'No post mode specified',
+	'NO_TOPIC_ICON'				=&gt; 'None',
+
+	'PARTIAL_UPLOAD'			=&gt; 'The uploaded file was only partially uploaded',
+	'PHP_SIZE_NA'				=&gt; 'The attachment\'s filesize is too large.&lt;br /&gt;Could not determine the maximum size defined by PHP in php.ini.',
+	'PHP_SIZE_OVERRUN'			=&gt; 'The attachment\'s filesize is too large, the maximum upload size is %d MB.&lt;br /&gt;Please note this is set in php.ini and cannot be overriden.',
+	'PLACE_INLINE'				=&gt; 'Place inline',
+	'POLL_DELETE'				=&gt; 'Delete poll',
+	'POLL_FOR'					=&gt; 'Run poll for',
+	'POLL_FOR_EXPLAIN'			=&gt; 'Enter 0 or leave blank for a never ending poll',
+	'POLL_MAX_OPTIONS'			=&gt; 'Options per user',
+	'POLL_MAX_OPTIONS_EXPLAIN'	=&gt; 'This is the number of options each user may select when voting.',
+	'POLL_OPTIONS'				=&gt; 'Poll options',
+	'POLL_OPTIONS_EXPLAIN'		=&gt; 'Place each option on a new line. You may enter up to &lt;strong&gt;%d&lt;/strong&gt; options',
+	'POLL_QUESTION'				=&gt; 'Poll question',
+	'POLL_VOTE_CHANGE'			=&gt; 'Allow re-voting',
+	'POLL_VOTE_CHANGE_EXPLAIN'	=&gt; 'If enabled users are able to change their vote.',
+	'POSTED_ATTACHMENTS'		=&gt; 'Posted attachments',
+	'POST_CONFIRMATION'			=&gt; 'Confirmation of post',
+	'POST_CONFIRM_EXPLAIN'		=&gt; 'To prevent automated posts the board administrator requires you to enter a confirmation code. The code is displayed in the image you should see below. If you are visually impaired or cannot otherwise read this code please contact the %sBoard Administrator%s.',
+	'POST_DELETED'				=&gt; 'Your message has been deleted successfully',
+	'POST_EDITED'				=&gt; 'Your message has been edited successfully',
+	'POST_EDITED_MOD'			=&gt; 'Your message has been edited but requires approval',
+	'POST_GLOBAL'				=&gt; 'Global',
+	'POST_ICON'					=&gt; 'Post icon',
+	'POST_NORMAL'				=&gt; 'Normal',
+	'POST_REPLY'				=&gt; 'Post a reply',
+	'POST_REVIEW'				=&gt; 'Post review',
+	'POST_REVIEW_EXPLAIN'		=&gt; 'At least one new post has been made to this topic. You may wish to review your post in light of this.',
+	'POST_STORED'				=&gt; 'Your message has been posted successfully',
+	'POST_STORED_MOD'			=&gt; 'Your message has been saved but requires approval',
+	'POST_TOPIC'				=&gt; 'Post a new topic',
+	'POST_TOPIC_AS'				=&gt; 'Post topic as',
+	'PROGRESS_BAR'				=&gt; 'Progress bar',
+
+	'QUOTE_DEPTH_EXCEEDED'		=&gt; 'You may embed only %1$d quotes within each other.',
+
+	'SAVE'						=&gt; 'Save',
+	'SAVE_DATE'					=&gt; 'Saved at',
+	'SAVE_DRAFT'				=&gt; 'Save Draft',
+	'SAVE_DRAFT_CONFIRM'		=&gt; 'Please note that saved drafts only include the subject and the message, any other element will be removed. Do you want to save your draft now?',
+	'SMILIES'					=&gt; 'Smilies',
+	'SMILIES_ARE_OFF'			=&gt; 'Smilies are &lt;em&gt;OFF&lt;/em&gt;',
+	'SMILIES_ARE_ON'			=&gt; 'Smilies are &lt;em&gt;ON&lt;/em&gt;',
+	'STICKY_ANNOUNCE_TIME_LIMIT'=&gt; 'Sticky/Announcement time limit',
+	'STICK_TOPIC_FOR'			=&gt; 'Stick topic for',
+	'STICK_TOPIC_FOR_EXPLAIN'	=&gt; 'Enter 0 or leave blank for a never ending Sticky/Announcement',
+	'STYLES_TIP'				=&gt; 'Tip: Styles can be applied quickly to selected text',
+
+	'TOO_FEW_CHARS'				=&gt; 'Your message contains too few characters.',
+	'TOO_FEW_POLL_OPTIONS'		=&gt; 'You must enter at least two poll options',
+	'TOO_MANY_ATTACHMENTS'		=&gt; 'Cannot add another attachment, %d is the maxmimum.',
+	'TOO_MANY_CHARS'			=&gt; 'Your message contains too many characters.',
+	'TOO_MANY_POLL_OPTIONS'		=&gt; 'You have tried to enter too many poll options',
+	'TOO_MANY_SMILIES'			=&gt; 'Your message contains too many smilies. A maximum of %d smilies are allowed.',
+	'TOO_MANY_URLS'				=&gt; 'Your message contains too many urls. A maximum of %d urls are allowed.',
+	'TOO_MANY_USER_OPTIONS'		=&gt; 'You cannot specify more Options per User than existing poll options',
+	'TOPIC_BUMPED'				=&gt; 'Topic has been bumped successfully',
+
+	'UNAUTHORISED_BBCODE'		=&gt; 'You cannot use certain bbcodes: ',
+	'UNGLOBALISE_EXPLAIN'		=&gt; 'To switch this topic back from being global to a normal topic, you need to select the forum you wish this topic to be displayed.',
+	'UPDATE_COMMENT'			=&gt; 'Update comment',
+	'URL_INVALID'				=&gt; 'The URL you specified is invalid.',
+	'URL_NOT_FOUND'				=&gt; 'The file specified could not be found.',
+	'USER_CANNOT_BUMP'			=&gt; 'You cannot bump topics in this forum',
+	'USER_CANNOT_DELETE'		=&gt; 'You cannot delete posts in this forum',
+	'USER_CANNOT_EDIT'			=&gt; 'You cannot edit posts in this forum',
+	'USER_CANNOT_REPLY'			=&gt; 'You cannot reply in this forum',
+	'USER_CANNOT_FORUM_POST'	=&gt; 'You are not able to do posting operations on this forum due to the forum type not supporting it.',
+	'USERNAME_DISALLOWED'		=&gt; 'The username you entered has been banned.',
+	'USERNAME_TAKEN'			=&gt; 'The username you entered is already in use, please select an alternative.',
+
+	'VIEW_MESSAGE'				=&gt; '%sView your submitted message%s',
+
+	'WRONG_FILESIZE'			=&gt; 'The file is too big, maximum allowed size is %1d %2s',
+	'WRONG_SIZE'				=&gt; 'The image must be at least %1$d pixels wide, %2$d pixels high and at most %3$d pixels wide and %4$d pixels high. The submitted image is %5$d pixels wide and %6$d pixels high.',
+	'HTML_IS_OFF'				=&gt; 'HTML is &lt;u&gt;OFF&lt;/u&gt;',
+	'HTML_IS_ON'				=&gt; 'HTML is &lt;u&gt;ON&lt;/u&gt;',
+	'DISABLE_HTML'				=&gt; 'Disable HTML',
+);
+
+?&gt;
\ No newline at end of file

Added: cms/trunk/modules/forums/language/search.php
===================================================================
--- cms/trunk/modules/forums/language/search.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/language/search.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,81 @@
+&lt;?php
+/** 
+*
+* search [English]
+*
+* @package language
+* @version $Id: search.php,v 1.11 2006/07/27 19:02:47 naderman Exp $
+* @copyright (c) 2005 phpBB Group 
+* @license <A HREF="http://opensource.org/licenses/gpl-license.php">http://opensource.org/licenses/gpl-license.php</A> GNU Public License 
+*
+*/
+
+// DEVELOPERS PLEASE NOTE 
+//
+// Placeholders can now contain order information, e.g. instead of
+// 'Page %s of %s' you can (and should) write 'Page %1$s of %2$s', this allows
+// translators to re-order the output of data while ensuring it remains correct
+//
+// You do not need this where single placeholders are used, e.g. 'Message %d' is fine
+// equally where a string contains only two placeholders which are used to wrap text
+// in a url you again do not need to specify an order e.g., 'Click %sHERE%s' is fine
+
+$this-&gt;lang += array(
+	'ALL_AVAILABLE'			=&gt; 'All available',
+	'ALL_RESULTS'			=&gt; 'All results',
+
+	'DISPLAY_RESULTS'		=&gt; 'Display results as',
+
+	'FOUND_SEARCH_MATCH'	=&gt; 'Search found %d match',
+	'FOUND_SEARCH_MATCHES'	=&gt; 'Search found %d matches',
+	'FOUND_MORE_SEARCH_MATCHES'	=&gt; 'Search found more than %d matches',
+
+	'GLOBAL'				=&gt; 'Global topic',
+
+	'IGNORED_TERMS'			=&gt; 'ignored',
+	'IGNORED_TERMS_EXPLAIN'	=&gt; 'The following words in your search query were ignored: &lt;b&gt;%s&lt;/b&gt;',
+
+	'NO_KEYWORDS'			=&gt; 'You must specify at least one word to search for. Each word must consist of at least %d characters and must not contain more than %d characters excluding wildcards.',
+	'NO_RECENT_SEARCHES'	=&gt; 'No searches have been carried out recently',
+	'NO_SEARCH'				=&gt; 'Sorry but you are not permitted to use the search system.',
+	'NO_SEARCH_RESULTS'		=&gt; 'No suitable matches were found.',
+	'NO_SEARCH_TIME'		=&gt; 'Sorry but you cannot use search at this time. Please try again in a few minutes.',
+	'WORD_IN_NO_POST'		=&gt; 'No posts were found because the word %s is not contained in any post.',
+	'WORDS_IN_NO_POST'		=&gt; 'No posts were found because the words %s are not contained in any post.',
+
+	'POST_CHARACTERS'		=&gt; 'characters of posts',
+
+	'RECENT_SEARCHES'		=&gt; 'Recent searches',
+	'RESULT_DAYS'			=&gt; 'Limit results to previous',
+	'RESULT_SORT'			=&gt; 'Sort results by',
+	'RETURN_FIRST'			=&gt; 'Return first',
+
+	'SEARCHED_FOR'			=&gt; 'Search term used',
+	'SEARCHED_TOPIC'		=&gt; 'Searched topic',
+	'SEARCH_ALL_TERMS'		=&gt; 'Search for all terms or use query as entered',
+	'SEARCH_ANY_TERMS'		=&gt; 'Search for any terms',
+	'SEARCH_AUTHOR'			=&gt; 'Search for author',
+	'SEARCH_AUTHOR_EXPLAIN'	=&gt; 'Use * as a wildcard for partial matches',
+	'SEARCH_FIRST_POST'		=&gt; 'First post of topics only',
+	'SEARCH_FORUMS'			=&gt; 'Search in forums',
+	'SEARCH_FORUMS_EXPLAIN'	=&gt; 'Select the forum or forums you wish to search in. For speed all subforums can be searched by selecting the parent and setting enable search subforums below.',
+	'SEARCH_IN_RESULTS'		=&gt; 'Search these results',
+	'SEARCH_KEYWORDS_EXPLAIN'	=&gt; 'Place &lt;strong&gt;+&lt;/strong&gt; in front of a word which must be found and &lt;strong&gt;-&lt;/strong&gt; in front of a word which must not be found. Put a list of words seperated by &lt;strong&gt;|&lt;/strong&gt; into brackets if only one of the words must be found. Use * as a wildcard for partial matches.',
+	'SEARCH_MSG_ONLY'		=&gt; 'Message text only',
+	'SEARCH_OPTIONS'		=&gt; 'Search Options',
+	'SEARCH_QUERY'			=&gt; 'Search Query',
+	'SEARCH_SUBFORUMS'		=&gt; 'Search subforums',
+	'SEARCH_TITLE_MSG'		=&gt; 'Post subjects and message text',
+	'SEARCH_TITLE_ONLY'		=&gt; 'Topic titles only',
+	'SEARCH_WITHIN'			=&gt; 'Search within',
+	'SORT_ASCENDING'		=&gt; 'Ascending',
+	'SORT_AUTHOR'			=&gt; 'Author',
+	'SORT_DESCENDING'		=&gt; 'Descending',
+	'SORT_FORUM'			=&gt; 'Forum',
+	'SORT_POST_SUBJECT'		=&gt; 'Post subject',
+	'SORT_TIME'				=&gt; 'Post time',
+
+	'TOO_FEW_AUTHOR_CHARS'	=&gt; 'You must specify at least %d characters of the authors name.',
+);
+
+?&gt;
\ No newline at end of file

Added: cms/trunk/modules/forums/language/viewforum.php
===================================================================
--- cms/trunk/modules/forums/language/viewforum.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/language/viewforum.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,51 @@
+&lt;?php
+// -------------------------------------------------------------
+//
+// $Id: viewforum.php,v 1.5 2004/06/06 21:44:49 acydburn Exp $
+//
+// FILENAME  : viewforum.php [ English ]
+// STARTED   : Sat Dec 16, 2000
+// COPYRIGHT : &#169; 2001, 2003 phpBB Group
+// WWW       : <A HREF="http://www.phpbb.com/">http://www.phpbb.com/</A>
+// LICENCE   : GPL vs2.0 [ see /docs/COPYING ] 
+// 
+// -------------------------------------------------------------
+
+// DEVELOPERS PLEASE NOTE 
+//
+// Placeholders can now contain order information, e.g. instead of
+// 'Page %s of %s' you can (and should) write 'Page %1$s of %2$s', this allows
+// translators to re-order the output of data while ensuring it remains correct
+//
+// You do not need this where single placeholders are used, e.g. 'Message %d' is fine
+// equally where a string contains only two placeholders which are used to wrap text
+// in a url you again do not need to specify an order e.g., 'Click %sHERE%s' is fine
+
+$this-&gt;lang += array(
+	'ACTIVE_TOPICS'			=&gt; 'Active Topics',
+	'ANNOUNCEMENTS'			=&gt; 'Announcements',
+	
+	'ICON_ANNOUNCEMENT'		=&gt; 'Announcement',
+	'ICON_STICKY'			=&gt; 'Sticky',
+
+	'LOGIN_NOTIFY_FORUM'	=&gt; 'You have been notified about this forum, please login to view it.',
+
+	'MARK_TOPICS_READ'		=&gt; 'Mark Topics Read',
+	'MOVED_TOPIC'			=&gt; 'Moved Topic',
+
+	'NEW_POSTS_HOT'			=&gt; 'New posts [ Popular ]',
+	'NEW_POSTS_LOCKED'		=&gt; 'New posts [ Locked ]',
+	'NO_NEW_POSTS_HOT'		=&gt; 'No new posts [ Popular ]',
+	'NO_NEW_POSTS_LOCKED'	=&gt; 'No new posts [ Locked ]',
+
+	'POST_FORUM_LOCKED'		=&gt; 'Forum is locked',
+	'POST_NEW_TOPIC'		=&gt; 'Post new topic',
+	
+	'TOPICS_MARKED'			=&gt; 'The topics for this forum have now been marked read',
+
+	'VIEW_FORUM'			=&gt; 'View Forum',
+	'VIEW_FORUM_TOPIC'		=&gt; '1 Topic',
+	'VIEW_FORUM_TOPICS'		=&gt; '%d Topics',
+);
+
+?&gt;
\ No newline at end of file

Added: cms/trunk/modules/forums/language/viewtopic.php
===================================================================
--- cms/trunk/modules/forums/language/viewtopic.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/language/viewtopic.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -0,0 +1,98 @@
+&lt;?php
+// -------------------------------------------------------------
+//
+// $Id: viewtopic.php,v 1.3 2004/06/06 21:44:49 acydburn Exp $
+//
+// FILENAME  : viewtopic.php [ English ]
+// STARTED   : Sat Dec 16, 2000
+// COPYRIGHT : &#169; 2001, 2003 phpBB Group
+// WWW       : <A HREF="http://www.phpbb.com/">http://www.phpbb.com/</A>
+// LICENCE   : GPL v2.0 [ see /docs/COPYING ] 
+// 
+// -------------------------------------------------------------
+
+// DEVELOPERS PLEASE NOTE 
+//
+// Placeholders can now contain order information, e.g. instead of
+// 'Page %s of %s' you can (and should) write 'Page %1$s of %2$s', this allows
+// translators to re-order the output of data while ensuring it remains correct
+//
+// You do not need this where single placeholders are used, e.g. 'Message %d' is fine
+// equally where a string contains only two placeholders which are used to wrap text
+// in a url you again do not need to specify an order e.g., 'Click %sHERE%s' is fine
+
+$this-&gt;lang += array(
+	'ATTACHMENT'						=&gt; 'Attachment',
+	'ATTACHMENT_FUNCTIONALITY_DISABLED'	=&gt; 'Attachment has been disabled',
+
+	'BOOKMARK_ADDED'		=&gt; 'Bookmarked topic successfully.',
+	'BOOKMARK_REMOVED'		=&gt; 'Removed bookmarked topic successfully.',
+	'BOOKMARK_TOPIC'		=&gt; 'Bookmark topic',
+	'BOOKMARK_TOPIC_REMOVE'	=&gt; 'Remove from bookmarks',
+	'BUMPED_BY'				=&gt; 'Last bumped by %1$s on %2$s',
+	'BUMP_TOPIC'			=&gt; 'Bump topic',
+
+	'CODE'					=&gt; 'Code',
+
+	'DELETE_TOPIC'			=&gt; 'Delete topic',
+	'DOWNLOAD_NOTICE'		=&gt; 'You do not have the required permissions to view the files attached to this post.',
+
+	'EDITED_TIMES_TOTAL'	=&gt; 'Last edited by %1$s on %2$s, edited %3$d times in total',
+	'EDITED_TIME_TOTAL'		=&gt; 'Last edited by %1$s on %2$s, edited %3$d time in total',
+	'EMAIL_TOPIC'			=&gt; 'Email friend',
+	'ERROR_NO_ATTACHMENT'	=&gt; 'The selected Attachment does not exist anymore',
+
+	'FILE_NOT_FOUND_404'	=&gt; 'The file &lt;strong&gt;%s&lt;/strong&gt; does not exist.',
+	'FORK_TOPIC'			=&gt; 'Copy topic',
+
+	'LINKAGE_FORBIDDEN'		=&gt; 'You are not authorised to view, download or link from/to this site.',
+	'LOGIN_NOTIFY_TOPIC'	=&gt; 'You have been notified about this topic, please login to view it.',
+	'LOGIN_VIEWTOPIC'		=&gt; 'The board administrator requires you to be registered and logged in to view this topic.',
+
+	'MAKE_ANNOUNCE'				=&gt; 'Change to Announcement',
+	'MAKE_GLOBAL'				=&gt; 'Change to Global',
+	'MAKE_NORMAL'				=&gt; 'Change to Standard Topic',
+	'MAKE_STICKY'				=&gt; 'Change to Sticky',
+	'MAX_OPTIONS_SELECT'		=&gt; 'You may select up to &lt;strong&gt;%d&lt;/strong&gt; options',
+	'MAX_OPTION_SELECT'			=&gt; 'You may select &lt;strong&gt;1&lt;/strong&gt; option',
+	'MISSING_INLINE_ATTACHMENT'	=&gt; 'The attachment &lt;strong&gt;%s&lt;/strong&gt; is no longer available',
+	'MOVE_TOPIC'				=&gt; 'Move topic',
+
+	'NO_ATTACHMENT_SELECTED'=&gt; 'You haven\'t selected an attachment to download or view.',
+	'NO_NEWER_TOPICS'		=&gt; 'There are no newer topics in this forum',
+	'NO_OLDER_TOPICS'		=&gt; 'There are no older topics in this forum',
+	'NO_UNREAD_POSTS'		=&gt; 'There are no new unread posts for this topic.',
+	'NO_VOTE_OPTION'		=&gt; 'You must specify an option when voting.',
+
+	'POLL_ENDED_AT'			=&gt; 'Poll ended at %s',
+	'POLL_RUN_TILL'			=&gt; 'Poll runs till %s',
+	'POLL_VOTED_OPTION'		=&gt; 'You voted for this option',
+	'POST_ENCODING'			=&gt; 'This post by &lt;strong&gt;%1$s&lt;/strong&gt; was made in a character set different to yours. %2$sView this post in its proper encoding%3$s.',
+	'PRINT_TOPIC'			=&gt; 'Print view',
+
+	'QUICK_MOD'				=&gt; 'Quick-mod tools',
+	'QUOTE'					=&gt; 'Quote',
+
+	'REPLY_TO_TOPIC'		=&gt; 'Reply to topic',
+	'RETURN_POST'			=&gt; '%sReturn to the post%s',
+
+	'SUBMIT_VOTE'			=&gt; 'Submit vote',
+
+	'TOTAL_VOTES'			=&gt; 'Total votes',
+
+	'UNLOCK_TOPIC'			=&gt; 'Unlock topic',
+
+	'VIEW_INFO'				=&gt; 'Post details',
+	'VIEW_NEXT_TOPIC'		=&gt; 'Next topic',
+	'VIEW_PREVIOUS_TOPIC'	=&gt; 'Previous topic',
+	'VIEW_RESULTS'			=&gt; 'View results',
+	'VIEW_TOPIC_POST'		=&gt; '1 Post',
+	'VIEW_TOPIC_POSTS'		=&gt; '%d Posts',
+	'VIEW_UNREAD_POST'		=&gt; 'First unread post',
+	'VISIT_WEBSITE'			=&gt; 'WWW',
+	'VOTE_SUBMITTED'		=&gt; 'Your vote has been cast',
+
+	'WROTE'					=&gt; 'wrote',
+);
+
+?&gt;
\ No newline at end of file

Modified: cms/trunk/modules/forums/main.php
===================================================================
--- cms/trunk/modules/forums/main.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/main.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -63,11 +63,11 @@
 $birthday_list = '';
 if ($config['load_birthdays'])
 {
-	$now = explode(':', gmdate('d:m'));
+	$now = getdate(gmtime());
 
 	$sql = 'SELECT user_id, username, user_colour, user_birthday 
 		FROM ' . CORE_USERS_TABLE . &quot; 
-		WHERE user_birthday LIKE '&quot; . $_CLASS['core_db']-&gt;escape(&quot;{$now[0]}-{$now[1]}-&quot;) . &quot;%'
+		WHERE user_birthday LIKE '&quot; . $_CLASS['core_db']-&gt;escape(sprintf('%2d-%2d-', $now['mday'], $now['mon'])) . &quot;%'
 			AND user_type = &quot;.USER_NORMAL;
 	$result = $_CLASS['core_db']-&gt;query($sql);
 

Modified: cms/trunk/modules/forums/mcp.php
===================================================================
--- cms/trunk/modules/forums/mcp.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/mcp.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -170,7 +170,6 @@
 	// Except he is using one of the quickmod tools for users
 	$user_quickmod_actions = array(
 		'lock'			=&gt; 'f_user_lock',
-		'unlock'		=&gt; 'f_user_lock',
 		'make_sticky'	=&gt; 'f_sticky',
 		'make_announce'	=&gt; 'f_announce',
 		'make_global'	=&gt; 'f_announce',

Modified: cms/trunk/modules/forums/posting.php
===================================================================
--- cms/trunk/modules/forums/posting.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/posting.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -918,8 +918,8 @@
 		{
 			// Lock/Unlock Topic
 			$change_topic_status = $post_data['topic_status'];
-			$perm_lock_unlock = ($_CLASS['forums_auth']-&gt;acl_get('m_lock', $forum_id) || ($_CLASS['forums_auth']-&gt;acl_get('f_user_lock', $forum_id) &amp;&amp; $_CLASS['core_user']-&gt;is_user &amp;&amp; $_CLASS['core_user']-&gt;data['user_id'] == $topic_poster));
-
+			$perm_lock_unlock = ($_CLASS['forums_auth']-&gt;acl_get('m_lock', $forum_id) || ($_CLASS['forums_auth']-&gt;acl_get('f_user_lock', $forum_id) &amp;&amp; $_CLASS['core_user']-&gt;is_user &amp;&amp; !empty($post_data['topic_poster']) &amp;&amp; $_CLASS['core_user']-&gt;data['user_id'] == $post_data['topic_poster'] &amp;&amp; $post_data['topic_status'] == ITEM_UNLOCKED)) ? true : false;
+		
 			if ($post_data['topic_status'] == ITEM_LOCKED &amp;&amp; !$topic_lock &amp;&amp; $perm_lock_unlock)
 			{
 				$change_topic_status = ITEM_UNLOCKED;
@@ -939,7 +939,7 @@
 						AND topic_moved_id = 0&quot;;
 				$_CLASS['core_db']-&gt;query($sql);
 			
-				$user_lock = ($_CLASS['forums_auth']-&gt;acl_get('f_user_lock', $forum_id) &amp;&amp; $_CLASS['core_user']-&gt;is_user &amp;&amp; $_CLASS['core_user']-&gt;data['user_id'] == $topic_poster) ? 'USER_' : '';
+				$user_lock = ($_CLASS['forums_auth']-&gt;acl_get('f_user_lock', $forum_id) &amp;&amp; $_CLASS['core_user']-&gt;is_user &amp;&amp; !empty($post_data['topic_poster']) &amp;&amp; $_CLASS['core_user']-&gt;data['user_id'] == $post_data['topic_poster']) ? 'USER_' : '';
 
 				//add_log('mod', $forum_id, $topic_id, 'LOG_' . $user_lock . (($change_topic_status == ITEM_LOCKED) ? 'LOCK' : 'UNLOCK'), $post_data['topic_title']);
 			}
@@ -1237,7 +1237,7 @@
 $s_hidden_fields .= '&lt;input type=&quot;hidden&quot; name=&quot;lastclick&quot; value=&quot;' . $current_time . '&quot; /&gt;';
 $s_hidden_fields .= ($draft_id || isset($_REQUEST['draft_loaded'])) ? '&lt;input type=&quot;hidden&quot; name=&quot;draft_loaded&quot; value=&quot;' . request_var('draft_loaded', $draft_id) . '&quot; /&gt;' : '';
 
-$form_enctype = (@ini_get('file_uploads') == '0' || strtolower(@ini_get('file_uploads')) == 'off' || @ini_get('file_uploads') == '0' || !$config['allow_attachments'] || !$_CLASS['forums_auth']-&gt;acl_gets(array('f_attach', 'u_attach'), $forum_id)) ? '' : ' enctype=&quot;multipart/form-data&quot;';
+$form_enctype = (@ini_get('file_uploads') == '0' || strtolower(@ini_get('file_uploads')) == 'off' || @ini_get('file_uploads') == '0' || !$config['allow_attachments'] || !$_CLASS['forums_auth']-&gt;acl_get('u_attach') || !$_CLASS['forums_auth']-&gt;acl_get('f_attach', $forum_id)) ? '' : ' enctype=&quot;multipart/form-data&quot;';
 
 // Start assigning vars for main posting page ...
 $_CLASS['core_template']-&gt;assign_array(array(
@@ -1281,7 +1281,7 @@
 	'S_SIGNATURE_CHECKED' 	=&gt; ($sig_checked) ? ' checked=&quot;checked&quot;' : '',
 	'S_NOTIFY_ALLOWED'		=&gt; ($_CLASS['core_user']-&gt;is_user),
 	'S_NOTIFY_CHECKED' 		=&gt; ($notify_checked) ? ' checked=&quot;checked&quot;' : '',
-	'S_LOCK_TOPIC_ALLOWED'	=&gt; (($mode == 'edit' || $mode == 'reply' || $mode == 'quote') &amp;&amp; ($_CLASS['forums_auth']-&gt;acl_get('m_lock', $forum_id) || ($_CLASS['forums_auth']-&gt;acl_get('f_user_lock', $forum_id) &amp;&amp; $_CLASS['core_user']-&gt;is_user &amp;&amp; $_CLASS['core_user']-&gt;data['user_id'] == $topic_poster))),
+	'S_LOCK_TOPIC_ALLOWED'	=&gt; (($mode == 'edit' || $mode == 'reply' || $mode == 'quote') &amp;&amp; ($_CLASS['forums_auth']-&gt;acl_get('m_lock', $forum_id) || ($_CLASS['forums_auth']-&gt;acl_get('f_user_lock', $forum_id) &amp;&amp; $_CLASS['core_user']-&gt;is_user &amp;&amp; !empty($post_data['topic_poster']) &amp;&amp; $_CLASS['core_user']-&gt;data['user_id'] == $post_data['topic_poster'] &amp;&amp; $post_data['topic_status'] == ITEM_UNLOCKED))) ? true : false,
 	'S_LOCK_TOPIC_CHECKED'	=&gt; ($lock_topic_checked) ? ' checked=&quot;checked&quot;' : '',
 	'S_LOCK_POST_ALLOWED'	=&gt; ($mode == 'edit' &amp;&amp; $_CLASS['forums_auth']-&gt;acl_get('m_edit', $forum_id)),
 	'S_LOCK_POST_CHECKED'	=&gt; ($lock_post_checked) ? ' checked=&quot;checked&quot;' : '',

Modified: cms/trunk/modules/forums/viewforum.php
===================================================================
--- cms/trunk/modules/forums/viewforum.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/viewforum.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -566,6 +566,7 @@
 			'TOPIC_ICON_IMG_WIDTH'  =&gt; empty($icons[$row['icon_id']]) ? '' :  $icons[$row['icon_id']]['width'],
 			'TOPIC_ICON_IMG_HEIGHT' =&gt; empty($icons[$row['icon_id']]) ? '' :  $icons[$row['icon_id']]['height'],
 			'ATTACH_ICON_IMG'       =&gt; ($row['topic_attachment'] &amp;&amp; $_CLASS['forums_auth']-&gt;acl_gets(array('f_download', 'u_download'), $forum_id)) ? $_CLASS['core_user']-&gt;img('icon_attach', $_CLASS['core_user']-&gt;lang['TOTAL_ATTACHMENTS']) : '',
+			'ATTACH_ICON_IMG'		=&gt; ($_CLASS['forums_auth']-&gt;acl_get('u_download') &amp;&amp; $_CLASS['forums_auth']-&gt;acl_get('f_download', $forum_id) &amp;&amp; $row['topic_attachment']) ? $_CLASS['core_user']-&gt;img('icon_topic_attach', $_CLASS['core_user']-&gt;lang['TOTAL_ATTACHMENTS']) : '',
 			'UNAPPROVED_IMG'		=&gt; ($topic_unapproved || $posts_unapproved) ? $_CLASS['core_user']-&gt;img('icon_unapproved', ($topic_unapproved) ? 'TOPIC_UNAPPROVED' : 'POSTS_UNAPPROVED') : '',
 
 			'S_TOPIC_UNAPPROVED'	=&gt; $topic_unapproved,

Modified: cms/trunk/modules/forums/viewtopic.php
===================================================================
--- cms/trunk/modules/forums/viewtopic.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/forums/viewtopic.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -524,23 +524,23 @@
 	for ($i = 0; $i &lt; $count; $i++)
 	{
 		$poll_info[$i]['poll_option_text'] = censor_text($poll_info[$i]['poll_option_text']);
+		$poll_info[$i]['poll_option_text'] = str_replace(&quot;\n&quot;, '&lt;br /&gt;', $poll_info[$i]['poll_option_text']);
 
 		if ($poll_bbcode !== false)
 		{
 			$poll_bbcode-&gt;bbcode_second_pass($poll_info[$i]['poll_option_text'], $poll_info[$i]['bbcode_uid'], $poll_option['bbcode_bitfield']);
 		}
 		$poll_info[$i]['poll_option_text'] = smiley_text($poll_info[$i]['poll_option_text']);
-		$poll_info[$i]['poll_option_text'] = str_replace(&quot;\n&quot;, '&lt;br /&gt;', $poll_info[$i]['poll_option_text']);
 	}
 
 	$topic_data['poll_title'] = censor_text($topic_data['poll_title']);
+	$topic_data['poll_title'] = str_replace(&quot;\n&quot;, '&lt;br /&gt;', $topic_data['poll_title']);
 
 	if ($poll_bbcode !== false)
 	{
 		$poll_bbcode-&gt;bbcode_second_pass($topic_data['poll_title'], $poll_info[0]['bbcode_uid'], $poll_info[0]['bbcode_bitfield']);
 	}
 	$topic_data['poll_title'] = smiley_text($topic_data['poll_title']);
-	$topic_data['poll_title'] = str_replace(&quot;\n&quot;, '&lt;br /&gt;', $topic_data['poll_title']);
 
 	unset($poll_bbcode);
 	
@@ -560,6 +560,8 @@
 		);
 	}
 
+	$poll_end = $topic_data['poll_length'] + $topic_data['poll_start'];
+
 	$_CLASS['core_template']-&gt;assign_array(array(
 		'POLL_QUESTION'		=&gt; $topic_data['poll_title'],
 		'TOTAL_VOTES' 		=&gt; $poll_total,
@@ -567,7 +569,7 @@
 		'POLL_RIGHT_CAP_IMG'=&gt; $_CLASS['core_user']-&gt;img('poll_right'),
 
 		'L_MAX_VOTES'		=&gt; ($topic_data['poll_max_options'] == 1) ? $_CLASS['core_user']-&gt;lang['MAX_OPTION_SELECT'] : sprintf($_CLASS['core_user']-&gt;lang['MAX_OPTIONS_SELECT'], $topic_data['poll_max_options']), 
-		'L_POLL_LENGTH'		=&gt; ($topic_data['poll_length']) ? sprintf($_CLASS['core_user']-&gt;lang['POLL_RUN_TILL'], $_CLASS['core_user']-&gt;format_date($topic_data['poll_length'] + $topic_data['poll_start'])) : '', 
+		'L_POLL_LENGTH'		=&gt; ($topic_data['poll_length']) ? sprintf($_CLASS['core_user']-&gt;lang[($poll_end &gt; $_CLASS['core_user']-&gt;time) ? 'POLL_RUN_TILL' : 'POLL_ENDED_AT'], $_CLASS['core_user']-&gt;format_date($poll_end)) : '',
 
 		'S_HAS_POLL'		=&gt; true, 
 		'S_CAN_VOTE'		=&gt; $s_can_vote, 
@@ -578,7 +580,7 @@
 		'U_VIEW_RESULTS'	=&gt; generate_link($viewtopic_url . '&amp;view=viewpoll', false))
 	);
 
-	unset($poll_info, $voted_id);
+	unset($poll_end, $poll_info, $voted_id);
 }
 else
 {
@@ -647,8 +649,7 @@
 
 $result = $_CLASS['core_db']-&gt;query($sql);
 
-$today = explode('-', date('j-n-Y', $_CLASS['core_user']-&gt;time));
-$today = array('day' =&gt; (int) $today[0], 'month' =&gt; (int) $today[1], 'year' =&gt; (int) $today[2]);
+$now = getdate($_CLASS['core_user']-&gt;time);
 
 // Posts are stored in the $rowset array while $attach_list, $user_cache
 // and the global bbcode_bitfield are built
@@ -872,18 +873,18 @@
 
 				if ($bday_year)
 				{
-					$diff = $today['month'] - $bday_month;
+					$diff = $now['mon'] - $bday_month;
 					
 					if ($diff == 0)
 					{
-						$diff = ($today['day'] - $bday_day &lt; 0) ? 1 : 0;
+						$diff = ($now['mday'] - $bday_day &lt; 0) ? 1 : 0;
 					}
 					else
 					{
 						$diff = ($diff &lt; 0) ? 1 : 0;
 					}
 					
-					$user_cache[$poster_id]['age'] = (int) ($today['year'] - $bday_year - $diff);
+					$user_cache[$poster_id]['age'] = (int) ($now['year'] - $bday_year - $diff);
 				}
 			}
 		}
@@ -915,7 +916,7 @@
 // Pull attachment data
 if (!empty($attach_list))
 {
-	if ($_CLASS['forums_auth']-&gt;acl_gets(array('f_download', 'u_download'), $forum_id))
+	if ($_CLASS['forums_auth']-&gt;acl_get('u_download') &amp;&amp; $_CLASS['forums_auth']-&gt;acl_get('f_download', $forum_id))
 	{
 		$sql = 'SELECT * 
 			FROM ' . FORUMS_ATTACHMENTS_TABLE . '
@@ -1019,6 +1020,7 @@
 	if ($user_cache[$poster_id]['sig'] &amp;&amp; empty($user_cache[$poster_id]['sig_parsed']))
 	{
 		$user_cache[$poster_id]['sig'] = censor_text($user_cache[$poster_id]['sig']);
+		$user_cache[$poster_id]['sig'] = str_replace(&quot;\n&quot;, '&lt;br /&gt;', $user_cache[$poster_id]['sig']);
 
 		if ($user_cache[$poster_id]['sig_bbcode_bitfield'])
 		{
@@ -1026,7 +1028,6 @@
 		}
 
 		$user_cache[$poster_id]['sig'] = smiley_text($user_cache[$poster_id]['sig']);
-		$user_cache[$poster_id]['sig'] = str_replace(&quot;\n&quot;, '&lt;br /&gt;', $user_cache[$poster_id]['sig']);
 		$user_cache[$poster_id]['sig_parsed'] = true;
 	}
 
@@ -1037,6 +1038,7 @@
 	}
 
 	$row['post_text'] = censor_text($row['post_text']);
+	$row['post_text'] = str_replace(&quot;\n&quot;, '&lt;br /&gt;', $row['post_text']);
 
 	// Second parse bbcode here
 	if ($row['bbcode_bitfield'])
@@ -1061,7 +1063,7 @@
 	// Highlight active words (primarily for search)
 	if ($highlight_match)
 	{
-		$message = preg_replace('#(?!&lt;.*)(?&lt;!\w)(' . $highlight_match . ')(?!\w|[^&lt;&gt;]*&gt;)#i', '&lt;span class=&quot;posthilit&quot;&gt;\1&lt;/span&gt;', $message);
+		$message = preg_replace('#(?!(?:&lt;(?:s(?:cript|tyle))?)[^&lt;]*)(?&lt;!\w)(' . $highlight_match . ')(?!\w|[^&lt;&gt;]*(?:&lt;/s(?:cript|tyle))?&gt;)#is', '&lt;span class=&quot;posthilit&quot;&gt;\1&lt;/span&gt;', $message);
 	}
 
 	if ($row['enable_html'] &amp;&amp; ($config['allow_html'] &amp;&amp; $_CLASS['forums_auth']-&gt;acl_get('f_html', $forum_id)))
@@ -1072,7 +1074,6 @@
 
 	// Replace naughty words such as farty pants
 	$row['post_subject'] = censor_text($row['post_subject']);
-	$row['post_text'] = str_replace(&quot;\n&quot;, '&lt;br /&gt;', $row['post_text']);
 
 	// Editing information
 	if (($row['post_edit_count'] &amp;&amp; $config['display_last_edited']) || $row['post_edit_reason'])
@@ -1092,7 +1093,7 @@
 			$result2 = $_CLASS['core_db']-&gt;query($sql);
 			while ($user_edit_row = $_CLASS['core_db']-&gt;fetch_row_assoc($result2))
 			{
-				$user_edit_row['username'] = ($user_edit_row['user_colour']) ? '&lt;span style=&quot;color:#' . $user_edit_row['user_colour'] . '&quot;&gt;' . $user_edit_row['username'] . '&lt;/span&gt;' : $user_edit_row['username'];
+				$user_edit_row['username'] = ($user_edit_row['user_colour']) ? '&lt;span style=&quot;color:#' . $user_edit_row['user_colour'] . '&quot;&gt;&lt;strong&gt;' . $user_edit_row['username'] . '&lt;/strong&gt;&lt;/span&gt;' : $user_edit_row['username'];
 				$post_edit_list[$user_edit_row['user_id']] = $user_edit_row;
 			}
 			$_CLASS['core_db']-&gt;free_result($result2);
@@ -1256,7 +1257,7 @@
 
 // Quick mod tools
 $topic_mod = '';
-$topic_mod .= ($_CLASS['forums_auth']-&gt;acl_get('m_lock', $forum_id) || ($_CLASS['forums_auth']-&gt;acl_get('f_user_lock', $forum_id) &amp;&amp; $_CLASS['core_user']-&gt;data['user_id'] != ANONYMOUS &amp;&amp; $_CLASS['core_user']-&gt;data['user_id'] == $topic_data['topic_poster'])) ? (($topic_data['topic_status'] == ITEM_UNLOCKED) ? '&lt;option value=&quot;lock&quot;&gt;' . $_CLASS['core_user']-&gt;lang['LOCK_TOPIC'] . '&lt;/option&gt;' : '&lt;option value=&quot;unlock&quot;&gt;' . $_CLASS['core_user']-&gt;lang['UNLOCK_TOPIC'] . '&lt;/option&gt;') : '';
+$topic_mod .= ($_CLASS['forums_auth']-&gt;acl_get('m_lock', $forum_id) || ($_CLASS['forums_auth']-&gt;acl_get('f_user_lock', $forum_id) &amp;&amp; $_CLASS['core_user']-&gt;is_user &amp;&amp; $_CLASS['core_user']-&gt;data['user_id'] == $topic_data['topic_poster'] &amp;&amp; $topic_data['topic_status'] == ITEM_UNLOCKED)) ? (($topic_data['topic_status'] == ITEM_UNLOCKED) ? '&lt;option value=&quot;lock&quot;&gt;' . $_CLASS['core_user']-&gt;lang['LOCK_TOPIC'] . '&lt;/option&gt;' : '&lt;option value=&quot;unlock&quot;&gt;' . $_CLASS['core_user']-&gt;lang['UNLOCK_TOPIC'] . '&lt;/option&gt;') : '';
 $topic_mod .= ($_CLASS['forums_auth']-&gt;acl_get('m_delete', $forum_id)) ? '&lt;option value=&quot;delete_topic&quot;&gt;' . $_CLASS['core_user']-&gt;lang['DELETE_TOPIC'] . '&lt;/option&gt;' : '';
 $topic_mod .= ($_CLASS['forums_auth']-&gt;acl_get('m_move', $forum_id)) ? '&lt;option value=&quot;move&quot;&gt;' . $_CLASS['core_user']-&gt;lang['MOVE_TOPIC'] . '&lt;/option&gt;' : '';
 $topic_mod .= ($_CLASS['forums_auth']-&gt;acl_get('m_split', $forum_id)) ? '&lt;option value=&quot;split&quot;&gt;' . $_CLASS['core_user']-&gt;lang['SPLIT_TOPIC'] . '&lt;/option&gt;' : '';

Modified: cms/trunk/modules/members_list/index.php
===================================================================
--- cms/trunk/modules/members_list/index.php	2006-08-20 18:00:53 UTC (rev 186)
+++ cms/trunk/modules/members_list/index.php	2006-09-12 14:55:25 UTC (rev 187)
@@ -365,17 +365,20 @@
 		}
 		unset($active_t_row);
 
-		if ($member['user_sig_bbcode_bitfield'] &amp;&amp; $member['user_sig'])
+		if ($member['user_sig'])
 		{
-			require_once SITE_FILE_ROOT.'includes/forums/bbcode.php';
+			$member['user_sig'] = censor_text($member['user_sig']);
+			$member['user_sig'] = str_replace(&quot;\n&quot;, '&lt;br /&gt;', $member['user_sig']);
+			
+			if ($member['user_sig_bbcode_bitfield'])
+			{
+				require_once SITE_FILE_ROOT.'includes/forums/bbcode.php';
 
-			$bbcode = new bbcode();
-			$bbcode-&gt;bbcode_second_pass($member['user_sig'], $member['user_sig_bbcode_uid'], $member['user_sig_bbcode_bitfield']);
-		}
+				$bbcode = new bbcode();
+				$bbcode-&gt;bbcode_second_pass($member['user_sig'], $member['user_sig_bbcode_uid'], $member['user_sig_bbcode_bitfield']);
+			}
 
-		if ($member['user_sig'])
-		{
-			$member['user_sig'] = censor_text(smiley_text($member['user_sig']));
+			$member['user_sig'] = smiley_text($member['user_sig']);
 		}
 
 		$poster_avatar = '';
@@ -411,8 +414,33 @@
 	
 		$last_visit = ($member['session_time']) ? $member['session_time'] : $member['user_last_visit'];
 		$online = ($member['session_time'] &gt;= ($_CLASS['core_user']-&gt;time - $_CORE_CONFIG['server']['session_length']));
-	
+
+		$age = '';
+	
+		if ($data['user_birthday'])
+		{
+			list($bday_day, $bday_month, $bday_year) = array_map('intval', explode('-', $data['user_birthday']));
+	
+			if ($bday_year)
+			{
+				$now = getdate(gmtime());
+	
+				$diff = $now['mon'] - $bday_month;
+				if ($diff == 0)
+				{
+					$diff = ($now['mday'] - $bday_day &lt; 0) ? 1 : 0;
+				}
+				else
+				{
+					$diff = ($diff &lt; 0) ? 1 : 0;
+				}
+	
+				$age = (int) ($now['year'] - $bday_year - $diff);
+			}
+		}
+
 		$_CLASS['core_template']-&gt;assign_array(array(
+			'AGE'			=&gt; $age,
 			'USERNAME'		=&gt; $member['username'],
 			'USER_COLOR'	=&gt; ($member['user_colour']) ? $member['user_colour'] : '',
 			'RANK_TITLE'	=&gt; $rank_title,
@@ -453,7 +481,7 @@
 			'LOCATION'		=&gt; (!empty($member['user_from'])) ? censor_text($member['user_from']) : '',
 			'OCCUPATION'    =&gt; (!empty($member['user_occ'])) ? str_replace(&quot;\n&quot;, '&lt;br /&gt;', censor_text($member['user_occ'])) : '',
 			'INTERESTS'		=&gt; (!empty($member['user_interests'])) ? str_replace(&quot;\n&quot;, '&lt;br /&gt;', censor_text($member['user_interests'])) : '',
-			'SIGNATURE'		=&gt; (!empty($member['user_sig'])) ? str_replace(&quot;\n&quot;, '&lt;br /&gt;', $member['user_sig']) : '',
+			'SIGNATURE'		=&gt; $member['user_sig'],
 
 			'AVATAR_IMG'	=&gt; $poster_avatar,
 			'PM_IMG'		=&gt; $_CLASS['core_user']-&gt;img('btn_pm', $_CLASS['core_user']-&gt;lang['MESSAGE']),


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000107.html">[Viperals-svncheckins] r188 - in cms/trunk: . admin admin/functions	includes includes/auth includes/cache includes/display	includes/forums includes/forums/admin install javascript	modules/control_panel/modules modules/forums	modules/forums/admin modules/forums/language
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#106">[ date ]</a>
              <a href="thread.html#106">[ thread ]</a>
              <a href="subject.html#106">[ subject ]</a>
              <a href="author.html#106">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/viperals-svncheckins">More information about the Viperals-svncheckins
mailing list</a><br>
</body></html>
