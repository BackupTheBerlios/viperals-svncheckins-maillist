<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Viperals-svncheckins] r153 - in cms/trunk: . admin images images/icons images/icons/misc images/icons/smilies images/modules images/modules/forums images/modules/forums/adm images/modules/forums/adm/images images/modules/forums/icons images/modules/forums/icons/misc images/modules/forums/icons/smile includes includes/forums includes/forums/admin install
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/viperals-svncheckins/2005-October/index.html" >
   <LINK REL="made" HREF="mailto:viperals-svncheckins%40lists.berlios.de?Subject=Re%3A%20%5BViperals-svncheckins%5D%20r153%20-%20in%20cms/trunk%3A%20.%20admin%20images%20images/icons%20images/icons/misc%20images/icons/smilies%20images/modules%20images/modules/forums%20images/modules/forums/adm%20images/modules/forums/adm/images%20images/modules/forums/icons%20images/modules/forums/icons/misc%20images/modules/forums/icons/smile%20includes%20includes/forums%20includes/forums/admin%20install&In-Reply-To=%3C200510010138.j911cULi026292%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000074.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Viperals-svncheckins] r153 - in cms/trunk: . admin images images/icons images/icons/misc images/icons/smilies images/modules images/modules/forums images/modules/forums/adm images/modules/forums/adm/images images/modules/forums/icons images/modules/forums/icons/misc images/modules/forums/icons/smile includes includes/forums includes/forums/admin install</H1>
    <B>Ryan Marshall at BerliOS</B> 
    <A HREF="mailto:viperals-svncheckins%40lists.berlios.de?Subject=Re%3A%20%5BViperals-svncheckins%5D%20r153%20-%20in%20cms/trunk%3A%20.%20admin%20images%20images/icons%20images/icons/misc%20images/icons/smilies%20images/modules%20images/modules/forums%20images/modules/forums/adm%20images/modules/forums/adm/images%20images/modules/forums/icons%20images/modules/forums/icons/misc%20images/modules/forums/icons/smile%20includes%20includes/forums%20includes/forums/admin%20install&In-Reply-To=%3C200510010138.j911cULi026292%40sheep.berlios.de%3E"
       TITLE="[Viperals-svncheckins] r153 - in cms/trunk: . admin images images/icons images/icons/misc images/icons/smilies images/modules images/modules/forums images/modules/forums/adm images/modules/forums/adm/images images/modules/forums/icons images/modules/forums/icons/misc images/modules/forums/icons/smile includes includes/forums includes/forums/admin install">viperal at berlios.de
       </A><BR>
    <I>Sat Oct  1 03:38:30 CEST 2005</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000074.html">[Viperals-svncheckins] r154 - cms/trunk/includes/display
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#73">[ date ]</a>
              <a href="thread.html#73">[ thread ]</a>
              <a href="subject.html#73">[ subject ]</a>
              <a href="author.html#73">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: viperal
Date: 2005-10-01 03:38:23 +0200 (Sat, 01 Oct 2005)
New Revision: 153

Added:
   cms/trunk/images/icons/
   cms/trunk/images/icons/index.htm
   cms/trunk/images/icons/misc/
   cms/trunk/images/icons/misc/arrow_bold_ltr.gif
   cms/trunk/images/icons/misc/arrow_bold_rgt.gif
   cms/trunk/images/icons/misc/asterix.gif
   cms/trunk/images/icons/misc/index.htm
   cms/trunk/images/icons/misc/musical.gif
   cms/trunk/images/icons/misc/square.gif
   cms/trunk/images/icons/smilies/
   cms/trunk/images/icons/smilies/alien_grn.gif
   cms/trunk/images/icons/smilies/exclaim.gif
   cms/trunk/images/icons/smilies/idea.gif
   cms/trunk/images/icons/smilies/index.htm
   cms/trunk/images/icons/smilies/mr_green.gif
   cms/trunk/images/icons/smilies/question.gif
   cms/trunk/images/icons/smilies/redface_anim.gif
   cms/trunk/images/modules/
   cms/trunk/images/modules/forums/
   cms/trunk/images/modules/forums/adm/
   cms/trunk/images/modules/forums/adm/images/
   cms/trunk/images/modules/forums/adm/images/cellpic1.gif
   cms/trunk/images/modules/forums/adm/images/cellpic3.gif
   cms/trunk/images/modules/forums/adm/images/header_bg.jpg
   cms/trunk/images/modules/forums/adm/images/header_left.jpg
   cms/trunk/images/modules/forums/adm/images/icon_folder.gif
   cms/trunk/images/modules/forums/adm/images/icon_folder_link.gif
   cms/trunk/images/modules/forums/adm/images/icon_folder_lock.gif
   cms/trunk/images/modules/forums/adm/images/icon_subfolder.gif
   cms/trunk/images/modules/forums/adm/images/no_avatar.gif
   cms/trunk/images/modules/forums/adm/images/no_image.png
   cms/trunk/images/modules/forums/icons/
   cms/trunk/images/modules/forums/icons/index.htm
   cms/trunk/images/modules/forums/icons/misc/
   cms/trunk/images/modules/forums/icons/misc/arrow_bold_rgt.gif
   cms/trunk/images/modules/forums/icons/misc/asterix.gif
   cms/trunk/images/modules/forums/icons/misc/index.htm
   cms/trunk/images/modules/forums/icons/misc/musical.gif
   cms/trunk/images/modules/forums/icons/misc/square.gif
   cms/trunk/images/modules/forums/icons/smile/
   cms/trunk/images/modules/forums/icons/smile/alien_grn.gif
   cms/trunk/images/modules/forums/icons/smile/exclaim.gif
   cms/trunk/images/modules/forums/icons/smile/idea.gif
   cms/trunk/images/modules/forums/icons/smile/index.htm
   cms/trunk/images/modules/forums/icons/smile/mr_green.gif
   cms/trunk/images/modules/forums/icons/smile/question.gif
   cms/trunk/images/modules/forums/icons/smile/redface_anim.gif
   cms/trunk/images/modules/forums/index.htm
   cms/trunk/images/modules/forums/spacer.gif
Removed:
   cms/trunk/images/Thumbs.db
Modified:
   cms/trunk/.htaccess
   cms/trunk/admin/menu.php
   cms/trunk/admin/users.php
   cms/trunk/feed.php
   cms/trunk/includes/forums/admin/admin_forums.php
   cms/trunk/includes/forums/admin/admin_search.php
   cms/trunk/includes/forums/functions_admin.php
   cms/trunk/includes/forums/functions_display.php
   cms/trunk/includes/functions.php
   cms/trunk/includes/mailer.php
   cms/trunk/install/build_data.php
Log:


Modified: cms/trunk/.htaccess
===================================================================
--- cms/trunk/.htaccess	2005-09-30 15:58:35 UTC (rev 152)
+++ cms/trunk/.htaccess	2005-10-01 01:38:23 UTC (rev 153)
@@ -3,11 +3,14 @@
 #php_flag magic_quotes_gpc 0
 
 &lt;LimitExcept GET PUT POST&gt;
-order allow,deny
-allow from all
+	order allow,deny
+	allow from all
 &lt;/LimitExcept&gt;
 
-ErrorDocument 403 error.php?error=403
-ErrorDocument 404 error.php?error=404
+ErrorDocument 400 /error.php
+ErrorDocument 401 /error.php
+ErrorDocument 403 /error.php
+ErrorDocument 404 /error.php
+ErrorDocument 500 /error.php
 
 Options -Indexes
\ No newline at end of file

Modified: cms/trunk/admin/menu.php
===================================================================
--- cms/trunk/admin/menu.php	2005-09-30 15:58:35 UTC (rev 152)
+++ cms/trunk/admin/menu.php	2005-10-01 01:38:23 UTC (rev 153)
@@ -99,7 +99,7 @@
 			{
 				$content[$name] .= '
 				&lt;tr&gt;
-					&lt;td class=&quot;row2&quot; nowrap=&quot;nowrap&quot;&gt;&lt;/td&gt;
+					&lt;td class=&quot;row2&quot; height=&quot;6&quot; nowrap=&quot;nowrap&quot;&gt;&lt;/td&gt;
 				&lt;/tr&gt;
 				';
 			}

Modified: cms/trunk/admin/users.php
===================================================================
--- cms/trunk/admin/users.php	2005-09-30 15:58:35 UTC (rev 152)
+++ cms/trunk/admin/users.php	2005-10-01 01:38:23 UTC (rev 153)
@@ -63,14 +63,14 @@
 
 				$data['activation']		= in_array($activation, $activation_array) ? $activation : USER_ACTIVATION_NONE;
 		 		$data['coppa_enable']	= get_variable('coppa_enable', 'POST') ? 1 : 0;
-		 		$data['coppa_fax']		= get_variable('coppa_fax', 'POST');
-		 		$data['coppa_mail']		= get_variable('coppa_mail', 'POST');
+		 		$data['coppa_fax']		= get_variable('coppa_fax', 'POST', '');
+		 		$data['coppa_mail']		= get_variable('coppa_mail', 'POST', '');
 		 		$data['enable_confirm']	= get_variable('enable_confirm', 'POST') ? 1 : 0;
-		 		$data['min_name_chars']	= get_variable('min_name_chars', 'POST', 0, 'INT');
-		 		$data['max_name_chars']	= get_variable('max_name_chars', 'POST', 0, 'INT');
-		 		$data['min_pass_chars']	= get_variable('min_pass_chars', 'POST', 0, 'INT');
-		 		$data['max_pass_chars']	= get_variable('max_pass_chars', 'POST', 0, 'INT');
-		 		$data['max_reg_attempts'] = get_variable('coppa_fax', 'POST', 0, 'INT');
+		 		$data['min_name_chars']	= get_variable('min_name_chars', 'POST', 0, 'int');
+		 		$data['max_name_chars']	= get_variable('max_name_chars', 'POST', 0, 'int');
+		 		$data['min_pass_chars']	= get_variable('min_pass_chars', 'POST', 0, 'int');
+		 		$data['max_pass_chars']	= get_variable('max_pass_chars', 'POST', 0, 'int');
+		 		$data['max_reg_attempts'] = get_variable('coppa_fax', 'POST', 0, 'int');
 
 				foreach ($data as $name =&gt; $setting)
 				{

Modified: cms/trunk/feed.php
===================================================================
--- cms/trunk/feed.php	2005-09-30 15:58:35 UTC (rev 152)
+++ cms/trunk/feed.php	2005-10-01 01:38:23 UTC (rev 153)
@@ -32,17 +32,10 @@
 
 if (!defined('ARTICLES_TABLE'))
 {
-	define('ARTICLES_TABLE', $prefix.'articles');
+	define('ARTICLES_TABLE', $table_prefix.'articles');
 }
 
-if (isset($_GET['mode']) &amp;&amp; $_GET['mode'] == 'cms')
-{
-	$result = $_CLASS['core_db']-&gt;query_limit('SELECT articles_id, articles_title, articles_intro, articles_text, articles_posted, articles_starts, poster_name FROM ' . ARTICLES_TABLE . ' ORDER BY articles_order ASC', 3);
-}
-else
-{
-	$result = $_CLASS['core_db']-&gt;query_limit('SELECT articles_id, articles_title, articles_intro, articles_text, articles_posted, articles_starts, poster_name FROM ' . ARTICLES_TABLE . ' ORDER BY articles_order ASC', 10);
-}
+$result = $_CLASS['core_db']-&gt;query_limit('SELECT articles_id, articles_title, articles_intro, articles_text, articles_posted, articles_starts, poster_name FROM ' . ARTICLES_TABLE . ' ORDER BY articles_order ASC', 10);
 
 $last_post_time = 0;
 
@@ -72,7 +65,7 @@
 
 $_CLASS['core_template']-&gt;assign_array(array(
 	'SITE_NAME' 	=&gt; $_CORE_CONFIG['global']['site_name'],
-	'SITE_URL' 		=&gt; $_CORE_CONFIG['global']['site_url'],
+	'SITE_URL' 		=&gt; generate_link(false, array('full' =&gt; true, 'sid' =&gt; false)),
 	'LANG'			=&gt; 'en-us',
 	'LAST_MODIFIED'	=&gt; $last_modified ,
 	'TIME'			=&gt; gmdate('M d Y H:i:s') .' GMT'

Deleted: cms/trunk/images/Thumbs.db
===================================================================
(Binary files differ)

Added: cms/trunk/images/icons/index.htm
===================================================================
--- cms/trunk/images/icons/index.htm	2005-09-30 15:58:35 UTC (rev 152)
+++ cms/trunk/images/icons/index.htm	2005-10-01 01:38:23 UTC (rev 153)
@@ -0,0 +1,10 @@
+&lt;html&gt;
+&lt;head&gt;
+&lt;title&gt;&lt;/title&gt;
+&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=iso-8859-1&quot;&gt;
+&lt;/head&gt;
+
+&lt;body bgcolor=&quot;#FFFFFF&quot; text=&quot;#000000&quot;&gt;
+
+&lt;/body&gt;
+&lt;/html&gt;

Added: cms/trunk/images/icons/misc/arrow_bold_ltr.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/icons/misc/arrow_bold_ltr.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/icons/misc/arrow_bold_rgt.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/icons/misc/arrow_bold_rgt.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/icons/misc/asterix.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/icons/misc/asterix.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/icons/misc/index.htm
===================================================================
--- cms/trunk/images/icons/misc/index.htm	2005-09-30 15:58:35 UTC (rev 152)
+++ cms/trunk/images/icons/misc/index.htm	2005-10-01 01:38:23 UTC (rev 153)
@@ -0,0 +1,10 @@
+&lt;html&gt;
+&lt;head&gt;
+&lt;title&gt;&lt;/title&gt;
+&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=iso-8859-1&quot;&gt;
+&lt;/head&gt;
+
+&lt;body bgcolor=&quot;#FFFFFF&quot; text=&quot;#000000&quot;&gt;
+
+&lt;/body&gt;
+&lt;/html&gt;

Added: cms/trunk/images/icons/misc/musical.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/icons/misc/musical.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/icons/misc/square.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/icons/misc/square.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/icons/smilies/alien_grn.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/icons/smilies/alien_grn.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/icons/smilies/exclaim.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/icons/smilies/exclaim.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/icons/smilies/idea.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/icons/smilies/idea.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/icons/smilies/index.htm
===================================================================
--- cms/trunk/images/icons/smilies/index.htm	2005-09-30 15:58:35 UTC (rev 152)
+++ cms/trunk/images/icons/smilies/index.htm	2005-10-01 01:38:23 UTC (rev 153)
@@ -0,0 +1,10 @@
+&lt;html&gt;
+&lt;head&gt;
+&lt;title&gt;&lt;/title&gt;
+&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=iso-8859-1&quot;&gt;
+&lt;/head&gt;
+
+&lt;body bgcolor=&quot;#FFFFFF&quot; text=&quot;#000000&quot;&gt;
+
+&lt;/body&gt;
+&lt;/html&gt;

Added: cms/trunk/images/icons/smilies/mr_green.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/icons/smilies/mr_green.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/icons/smilies/question.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/icons/smilies/question.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/icons/smilies/redface_anim.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/icons/smilies/redface_anim.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/adm/images/cellpic1.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/adm/images/cellpic1.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/adm/images/cellpic3.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/adm/images/cellpic3.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/adm/images/header_bg.jpg
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/adm/images/header_bg.jpg
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/adm/images/header_left.jpg
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/adm/images/header_left.jpg
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/adm/images/icon_folder.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/adm/images/icon_folder.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/adm/images/icon_folder_link.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/adm/images/icon_folder_link.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/adm/images/icon_folder_lock.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/adm/images/icon_folder_lock.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/adm/images/icon_subfolder.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/adm/images/icon_subfolder.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/adm/images/no_avatar.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/adm/images/no_avatar.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/adm/images/no_image.png
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/adm/images/no_image.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/icons/index.htm
===================================================================
--- cms/trunk/images/modules/forums/icons/index.htm	2005-09-30 15:58:35 UTC (rev 152)
+++ cms/trunk/images/modules/forums/icons/index.htm	2005-10-01 01:38:23 UTC (rev 153)
@@ -0,0 +1,10 @@
+&lt;html&gt;
+&lt;head&gt;
+&lt;title&gt;&lt;/title&gt;
+&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=iso-8859-1&quot;&gt;
+&lt;/head&gt;
+
+&lt;body bgcolor=&quot;#FFFFFF&quot; text=&quot;#000000&quot;&gt;
+
+&lt;/body&gt;
+&lt;/html&gt;

Added: cms/trunk/images/modules/forums/icons/misc/arrow_bold_rgt.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/icons/misc/arrow_bold_rgt.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/icons/misc/asterix.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/icons/misc/asterix.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/icons/misc/index.htm
===================================================================
--- cms/trunk/images/modules/forums/icons/misc/index.htm	2005-09-30 15:58:35 UTC (rev 152)
+++ cms/trunk/images/modules/forums/icons/misc/index.htm	2005-10-01 01:38:23 UTC (rev 153)
@@ -0,0 +1,10 @@
+&lt;html&gt;
+&lt;head&gt;
+&lt;title&gt;&lt;/title&gt;
+&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=iso-8859-1&quot;&gt;
+&lt;/head&gt;
+
+&lt;body bgcolor=&quot;#FFFFFF&quot; text=&quot;#000000&quot;&gt;
+
+&lt;/body&gt;
+&lt;/html&gt;

Added: cms/trunk/images/modules/forums/icons/misc/musical.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/icons/misc/musical.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/icons/misc/square.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/icons/misc/square.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/icons/smile/alien_grn.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/icons/smile/alien_grn.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/icons/smile/exclaim.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/icons/smile/exclaim.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/icons/smile/idea.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/icons/smile/idea.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/icons/smile/index.htm
===================================================================
--- cms/trunk/images/modules/forums/icons/smile/index.htm	2005-09-30 15:58:35 UTC (rev 152)
+++ cms/trunk/images/modules/forums/icons/smile/index.htm	2005-10-01 01:38:23 UTC (rev 153)
@@ -0,0 +1,10 @@
+&lt;html&gt;
+&lt;head&gt;
+&lt;title&gt;&lt;/title&gt;
+&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=iso-8859-1&quot;&gt;
+&lt;/head&gt;
+
+&lt;body bgcolor=&quot;#FFFFFF&quot; text=&quot;#000000&quot;&gt;
+
+&lt;/body&gt;
+&lt;/html&gt;

Added: cms/trunk/images/modules/forums/icons/smile/mr_green.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/icons/smile/mr_green.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/icons/smile/question.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/icons/smile/question.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/icons/smile/redface_anim.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/icons/smile/redface_anim.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: cms/trunk/images/modules/forums/index.htm
===================================================================
--- cms/trunk/images/modules/forums/index.htm	2005-09-30 15:58:35 UTC (rev 152)
+++ cms/trunk/images/modules/forums/index.htm	2005-10-01 01:38:23 UTC (rev 153)
@@ -0,0 +1,10 @@
+&lt;html&gt;
+&lt;head&gt;
+&lt;title&gt;&lt;/title&gt;
+&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=iso-8859-1&quot;&gt;
+&lt;/head&gt;
+
+&lt;body bgcolor=&quot;#FFFFFF&quot; text=&quot;#000000&quot;&gt;
+
+&lt;/body&gt;
+&lt;/html&gt;

Added: cms/trunk/images/modules/forums/spacer.gif
===================================================================
(Binary files differ)


Property changes on: cms/trunk/images/modules/forums/spacer.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: cms/trunk/includes/forums/admin/admin_forums.php
===================================================================
--- cms/trunk/includes/forums/admin/admin_forums.php	2005-09-30 15:58:35 UTC (rev 152)
+++ cms/trunk/includes/forums/admin/admin_forums.php	2005-10-01 01:38:23 UTC (rev 153)
@@ -1363,7 +1363,7 @@
 
 	// Delete forum ids from extension groups table
 	$sql = 'SELECT group_id, allowed_forums 
-		FROM ' . EXTENSION_GROUPS_TABLE . &quot;
+		FROM ' . FORUMS_EXTENSION_GROUPS_TABLE . &quot;
 		WHERE allowed_forums &lt;&gt; ''&quot;;
 	$result = $_CLASS['core_db']-&gt;query($sql);
 
@@ -1371,7 +1371,7 @@
 	{
 		$allowed_forums = unserialize(trim($row['allowed_forums']));
 		$allowed_forums = array_diff($allowed_forums, $forum_ids);
-		$sql = 'UPDATE ' . EXTENSION_GROUPS_TABLE . &quot; 
+		$sql = 'UPDATE ' . FORUMS_EXTENSION_GROUPS_TABLE . &quot; 
 			SET allowed_forums = '&quot; . ((sizeof($allowed_forums)) ? serialize($allowed_forums) : '') . &quot;'
 			WHERE group_id = {$row['group_id']}&quot;;
 		$_CLASS['core_db']-&gt;query($sql);
@@ -1384,28 +1384,34 @@
 	{
 		case 'MOVE_POSTS_MOVE_FORUMS':
 			add_log('admin', 'LOG_FORUM_DEL_MOVE_POSTS_MOVE_FORUMS', $posts_to_name, $subforums_to_name, $forum_name);
-			break;
+		break;
+
 		case 'MOVE_POSTS_FORUMS':
 			add_log('admin', 'LOG_FORUM_DEL_MOVE_POSTS_FORUMS', $posts_to_name, $forum_name);
-			break;
+		break;
+
 		case 'POSTS_MOVE_FORUMS':
 			add_log('admin', 'LOG_FORUM_DEL_POSTS_MOVE_FORUMS', $subforums_to_name, $forum_name);
-			break;
+		break;
+
 		case '_MOVE_FORUMS':
 			add_log('admin', 'LOG_FORUM_DEL_MOVE_FORUMS', $subforums_to_name, $forum_name);
-			break;
+		break;
+
 		case 'MOVE_POSTS_':
 			add_log('admin', 'LOG_FORUM_DEL_MOVE_POSTS', $posts_to_name, $forum_name);
 			break;
 		case 'POSTS_FORUMS':
 			add_log('admin', 'LOG_FORUM_DEL_POSTS_FORUMS', $forum_name);
-			break;
+		break;
+
 		case '_FORUMS':
 			add_log('admin', 'LOG_FORUM_DEL_FORUMS', $forum_name);
-			break;
+		break;
+
 		case 'POSTS_':
 			add_log('admin', 'LOG_FORUM_DEL_POSTS', $forum_name);
-			break; 
+		break; 
 	}
 
 	return $errors;

Modified: cms/trunk/includes/forums/admin/admin_search.php
===================================================================
--- cms/trunk/includes/forums/admin/admin_search.php	2005-09-30 15:58:35 UTC (rev 152)
+++ cms/trunk/includes/forums/admin/admin_search.php	2005-10-01 01:38:23 UTC (rev 153)
@@ -37,10 +37,21 @@
 
 	if (!$start)
 	{
-		// Empty existing tables
-		$_CLASS['core_db']-&gt;query('TRUNCATE ' . FORUMS_SEARCH_TABLE);
-		$_CLASS['core_db']-&gt;query('TRUNCATE ' . FORUMS_SEARCH_WORD_TABLE);
-		$_CLASS['core_db']-&gt;query('TRUNCATE ' . FORUMS_SEARCH_MATCH_TABLE);
+		switch ($_CLASS['core_db']-&gt;db_layer)
+		{
+			case 'sqlite':
+			case 'sqlite_pdo':
+				$_CLASS['core_db']-&gt;query('DELETE FROM ' . FORUMS_SEARCH_TABLE);
+				$_CLASS['core_db']-&gt;query('DELETE FROM ' . FORUMS_SEARCH_WORD_TABLE);
+				$_CLASS['core_db']-&gt;query('DELETE FROM ' . FORUMS_SEARCH_MATCH_TABLE);
+			break;
+			
+			default:
+				$_CLASS['core_db']-&gt;query('TRUNCATE ' . FORUMS_SEARCH_TABLE);
+				$_CLASS['core_db']-&gt;query('TRUNCATE ' . FORUMS_SEARCH_WORD_TABLE);
+				$_CLASS['core_db']-&gt;query('TRUNCATE ' . FORUMS_SEARCH_MATCH_TABLE);
+			break;
+		}
 	}
 
 	// Fetch a batch of posts_text entries
@@ -64,32 +75,31 @@
 			$count++;
 		}
 		$_CLASS['core_db']-&gt;free_result($result);
-	}
 
-	if (($start + $count) &lt; $total_posts)
-	{
-		redirect(generate_link('forums&amp;file=admin_search&amp;position=' . ($start + $count), array('admin' =&gt; true)), 3);
+		if (($start + $count) &lt; $total_posts)
+		{
+			redirect(generate_link('Forums&amp;file=admin_search&amp;position=' . ($start + $count), array('admin' =&gt; true)), 3);
+		}
+		else
+		{
+			// search tidy
+			$fulltext-&gt;search_tidy();
+			$_CLASS['core_db']-&gt;optimize_tables();
+		}
 	}
-	else
-	{
-		// search tidy
-		$fulltext-&gt;search_tidy();
-		$_CLASS['core_db']-&gt;optimize_tables();
 
-		adm_page_header($_CLASS['core_user']-&gt;lang['SEARCH_INDEX']);
+	adm_page_header($_CLASS['core_user']-&gt;get_lang('SEARCH_INDEX'));
 
 ?&gt;
 
-&lt;h1&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['SEARCH_INDEX']; ?&gt;&lt;/h1&gt;
+&lt;h1&gt;&lt;?php echo $_CLASS['core_user']-&gt;get_lang('SEARCH_INDEX'); ?&gt;&lt;/h1&gt;
 
-&lt;p&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['SEARCH_INDEX_COMPLETE']; ?&gt;&lt;/p&gt;
+&lt;p&gt;&lt;?php echo $_CLASS['core_user']-&gt;get_lang('SEARCH_INDEX_COMPLETE'); ?&gt;&lt;/p&gt;
 
 &lt;?php
 
-		adm_page_footer();
+	adm_page_footer();
 
-	}
-
 	die;
 }
 else if (isset($_POST['cancel']))
@@ -117,7 +127,7 @@
 
 &lt;p&gt;&lt;?php echo $_CLASS['core_user']-&gt;lang['SEARCH_INDEX_EXPLAIN']; ?&gt;&lt;/p&gt;
 
-&lt;form method=&quot;post&quot; action=&quot;&lt;?php echo generate_link('forums&amp;file=admin_search', array('admin' =&gt; true)); ?&gt;&quot;&gt;&lt;table cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot; bgcolor=&quot;#98AAB1&quot;&gt;
+&lt;form method=&quot;post&quot; action=&quot;&lt;?php echo generate_link('Forums&amp;file=admin_search', array('admin' =&gt; true)); ?&gt;&quot;&gt;&lt;table cellspacing=&quot;1&quot; cellpadding=&quot;4&quot; border=&quot;0&quot; align=&quot;center&quot; bgcolor=&quot;#98AAB1&quot;&gt;
 	&lt;tr&gt;
 		&lt;td class=&quot;cat&quot; height=&quot;28&quot; align=&quot;center&quot;&gt;&nbsp;&lt;input type=&quot;submit&quot; name=&quot;start&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['START']; ?&gt;&quot; class=&quot;btnmain&quot; /&gt; &nbsp; &lt;input type=&quot;submit&quot; name=&quot;cancel&quot; value=&quot;&lt;?php echo $_CLASS['core_user']-&gt;lang['CANCEL']; ?&gt;&quot; class=&quot;btnmain&quot; /&gt;&nbsp;&lt;/td&gt;
 	&lt;/tr&gt;

Modified: cms/trunk/includes/forums/functions_admin.php
===================================================================
--- cms/trunk/includes/forums/functions_admin.php	2005-09-30 15:58:35 UTC (rev 152)
+++ cms/trunk/includes/forums/functions_admin.php	2005-10-01 01:38:23 UTC (rev 153)
@@ -2053,7 +2053,7 @@
 
 			foreach ($forum_id as $forum)
 			{
-				$sql = 'DELETE FROM '.ACL_TABLE.&quot;
+				$sql = 'DELETE FROM '. FORUMS_ACL_TABLE . &quot;
 					WHERE $id_field = $ug_id
 						AND forum_id = $forum
 						$auth_sql&quot;;
@@ -2081,7 +2081,7 @@
 			$cur_options = array();
 
 			$sql = &quot;SELECT auth_option, is_global, is_local
-				FROM &quot; . ACL_OPTIONS_TABLE . &quot;
+				FROM &quot; . FORUMS_ACL_OPTIONS_TABLE . &quot;
 				ORDER BY auth_option_id&quot;;
 			$result = $_CLASS['core_db']-&gt;query($sql);
 
@@ -2148,7 +2148,7 @@
 							break;
 							
 						default:
-							$sql = 'INSERT INTO ' . ACL_OPTIONS_TABLE . &quot; (auth_option, is_global, is_local)
+							$sql = 'INSERT INTO ' . FORUMS_ACL_OPTIONS_TABLE . &quot; (auth_option, is_global, is_local)
 								VALUES ($option, &quot; . $type_sql[$type] . &quot;)&quot;;
 							$_CLASS['core_db']-&gt;query($sql);
 							$sql = '';
@@ -2158,7 +2158,7 @@
 
 			if ($sql != '')
 			{
-				$sql = 'INSERT INTO ' . ACL_OPTIONS_TABLE . &quot; (auth_option, is_global, is_local)
+				$sql = 'INSERT INTO ' . FORUMS_ACL_OPTIONS_TABLE . &quot; (auth_option, is_global, is_local)
 					VALUES $sql&quot;;
 				$_CLASS['core_db']-&gt;query($sql);
 			}
@@ -2182,7 +2182,7 @@
 	$update_sql = $empty_forums = array();
 
 	$sql = 'SELECT ' . $type . '_id, MAX(post_id) as last_post_id
-		FROM ' . POSTS_TABLE . &quot;
+		FROM ' . FORUMS_POSTS_TABLE . &quot;
 		WHERE post_approved = 1
 			AND {$type}_id IN (&quot; . implode(', ', $ids) . &quot;)
 		GROUP BY {$type}_id&quot;;
@@ -2216,7 +2216,7 @@
 	if (!empty($last_post_ids))
 	{
 		$sql = 'SELECT p.' . $type . '_id, p.post_id, p.post_time, p.poster_id, p.post_username, u.user_id, u.username
-			FROM ' . POSTS_TABLE . ' p, ' . USERS_TABLE . ' u
+			FROM ' . FORUMS_POSTS_TABLE . ' p, ' . USERS_TABLE . ' u
 			WHERE p.poster_id = u.user_id
 				AND p.post_id IN (' . implode(', ', $last_post_ids) . ')';
 		$result = $_CLASS['core_db']-&gt;query($sql);
@@ -2237,7 +2237,7 @@
 		return;
 	}
 
-	$table = ($type == 'forum') ? FORUMS_TABLE : TOPICS_TABLE;
+	$table = ($type == 'forum') ? FORUMS_FORUMS_TABLE : FORUMS_TOPICS_TABLE;
 
 	foreach ($update_sql as $update_id =&gt; $update_sql_ary)
 	{
@@ -2255,17 +2255,13 @@
 function tidy_database()
 {
 	global $_CLASS;
-
+return;
 	$remove_date = time() - (3 * 62 * 24 * 3600);
 
 	$sql = 'DELETE FROM ' . FORUMS_TRACK_TABLE . '
 		WHERE mark_time &lt; ' . $remove_date;
 	$_CLASS['core_db']-&gt;query($sql);
 
-	$sql = 'DELETE FROM ' . TOPICS_TRACK_TABLE . '
-		WHERE mark_time &lt; ' . $remove_date;
-	$_CLASS['core_db']-&gt;query($sql);
-
 	set_config('database_last_gc', time(), true);
 }
 

Modified: cms/trunk/includes/forums/functions_display.php
===================================================================
--- cms/trunk/includes/forums/functions_display.php	2005-09-30 15:58:35 UTC (rev 152)
+++ cms/trunk/includes/forums/functions_display.php	2005-10-01 01:38:23 UTC (rev 153)
@@ -166,11 +166,10 @@
 		{
 			$forum_id36 = base_convert($forum_id, 10, 36);
 			$row['mark_time'] = isset($tracking_topics[$forum_id36][0]) ? (int) base_convert($tracking_topics[$forum_id36][0], 36, 10) : 0;
-		//echo $forum_id36.' - '.$row['mark_time'].'&lt;br/&gt;';
 		}
 
 		if ($row['mark_time'] &lt; $row['forum_last_post_time'])
-		{//echo $parent_id.' - '.$row['mark_time'] .' - '. $row['forum_last_post_time'].'&lt;br/&gt;';
+		{
 			$forum_unread[$parent_id] = true;
 		}
 	}
@@ -273,12 +272,13 @@
 		// Which folder should we display?
 		if ($row['forum_status'] == ITEM_LOCKED)
 		{
-			$folder_image = 'forum_locked';
+// forum_locked_new , need an image for this one
+			$folder_image = empty($forum_unread[$forum_id]) ? 'forum_locked' : 'folder_locked_new';
 			$folder_alt = 'FORUM_LOCKED';
 		}
 		else
 		{
-			$folder_alt = (!empty($forum_unread[$forum_id])) ? 'NEW_POSTS' : 'NO_NEW_POSTS';
+			$folder_alt = empty($forum_unread[$forum_id]) ? 'NO_NEW_POSTS' : 'NEW_POSTS';
 		}
 
 		// Create last post link information, if appropriate

Modified: cms/trunk/includes/functions.php
===================================================================
--- cms/trunk/includes/functions.php	2005-09-30 15:58:35 UTC (rev 152)
+++ cms/trunk/includes/functions.php	2005-10-01 01:38:23 UTC (rev 153)
@@ -594,6 +594,7 @@
 		{
 			include_once($file);
 		}
+
 		$_CLASS[$name] =&amp; new $class;
 	}
 }

Modified: cms/trunk/includes/mailer.php
===================================================================
--- cms/trunk/includes/mailer.php	2005-09-30 15:58:35 UTC (rev 152)
+++ cms/trunk/includes/mailer.php	2005-10-01 01:38:23 UTC (rev 153)
@@ -94,7 +94,6 @@
 	{
 		if (isset($address['address']))
 		{
-			echo ($address['name'] &amp;&amp; $this-&gt;named_addresses) ?  '&quot;' . mail_encode($address['name'], $this-&gt;encoding) . '&quot; &lt;' . $address['address'] . '&gt;' : $address['address'];
 			return ($address['name'] &amp;&amp; $this-&gt;named_addresses) ?  '&quot;' . mail_encode($address['name'], $this-&gt;encoding) . '&quot; &lt;' . $address['address'] . '&gt;' : $address['address'];
 		}
 

Modified: cms/trunk/install/build_data.php
===================================================================
--- cms/trunk/install/build_data.php	2005-09-30 15:58:35 UTC (rev 152)
+++ cms/trunk/install/build_data.php	2005-10-01 01:38:23 UTC (rev 153)
@@ -482,4 +482,16 @@
 $_CLASS['core_db']-&gt;query('INSERT INTO '.$table_prefix.&quot;forums_extensions (group_id, extension) VALUES (5, 'rm')&quot;);
 $_CLASS['core_db']-&gt;query('INSERT INTO '.$table_prefix.&quot;forums_extensions (group_id, extension) VALUES (6, 'wma')&quot;);
 $_CLASS['core_db']-&gt;query('INSERT INTO '.$table_prefix.&quot;forums_extensions (group_id, extension) VALUES (6, 'wmv')&quot;);
+
+$_CLASS['core_db']-&gt;query('INSERT INTO '.$table_prefix.&quot;forums_icons (icons_url, icons_width, icons_height, icons_order, display_on_posting) VALUES ('misc/arrow_bold_rgt.gif', 19, 19, 1, 1)&quot;);
+$_CLASS['core_db']-&gt;query('INSERT INTO '.$table_prefix.&quot;forums_icons (icons_url, icons_width, icons_height, icons_order, display_on_posting) VALUES ('smilies/redface_anim.gif', 19, 19, 9, 1)&quot;);
+$_CLASS['core_db']-&gt;query('INSERT INTO '.$table_prefix.&quot;forums_icons (icons_url, icons_width, icons_height, icons_order, display_on_posting) VALUES ('smilies/mr_green.gif', 19, 19, 10, 1)&quot;);
+$_CLASS['core_db']-&gt;query('INSERT INTO '.$table_prefix.&quot;forums_icons (icons_url, icons_width, icons_height, icons_order, display_on_posting) VALUES ('misc/musical.gif', 19, 19, 4, 1)&quot;);
+$_CLASS['core_db']-&gt;query('INSERT INTO '.$table_prefix.&quot;forums_icons (icons_url, icons_width, icons_height, icons_order, display_on_posting) VALUES ('misc/asterix.gif', 19, 19, 2, 1)&quot;);
+$_CLASS['core_db']-&gt;query('INSERT INTO '.$table_prefix.&quot;forums_icons (icons_url, icons_width, icons_height, icons_order, display_on_posting) VALUES ('misc/square.gif', 19, 19, 3, 1)&quot;);
+$_CLASS['core_db']-&gt;query('INSERT INTO '.$table_prefix.&quot;forums_icons (icons_url, icons_width, icons_height, icons_order, display_on_posting) VALUES ('smilies/alien_grn.gif', 19, 19, 5, 1)&quot;);
+$_CLASS['core_db']-&gt;query('INSERT INTO '.$table_prefix.&quot;forums_icons (icons_url, icons_width, icons_height, icons_order, display_on_posting) VALUES ('smilies/idea.gif', 19, 19, 8, 1)&quot;);
+$_CLASS['core_db']-&gt;query('INSERT INTO '.$table_prefix.&quot;forums_icons (icons_url, icons_width, icons_height, icons_order, display_on_posting) VALUES ('smilies/question.gif', 19, 19, 6, 1)&quot;);
+$_CLASS['core_db']-&gt;query('INSERT INTO '.$table_prefix.&quot;forums_icons (icons_url, icons_width, icons_height, icons_order, display_on_posting) VALUES ('smilies/exclaim.gif', 19, 19, 7, 1)&quot;);
+
 ?&gt;
\ No newline at end of file


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000074.html">[Viperals-svncheckins] r154 - cms/trunk/includes/display
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#73">[ date ]</a>
              <a href="thread.html#73">[ thread ]</a>
              <a href="subject.html#73">[ subject ]</a>
              <a href="author.html#73">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/viperals-svncheckins">More information about the Viperals-svncheckins
mailing list</a><br>
</body></html>
